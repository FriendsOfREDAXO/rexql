window.rexQL=window.rexQL||{};rexQL.playground={init:function(){const t=document.getElementById("graphql-query"),n=document.getElementById("api-key-input"),e=document.getElementById("execute-query"),r=document.getElementById("clear-result"),c=document.getElementById("introspect"),a=document.getElementById("query-result");!t||!e||(e.addEventListener("click",function(){const i=t.value.trim();rexQL.playground.executeQuery(i,n.value.trim(),a,e,c)}),c.addEventListener("click",function(){rexQL.playground.executeQuery("\n{\n  __schema {\n    queryType {\n      name\n      fields {\n        name\n        type {\n          name\n          kind\n        }\n      }\n    }\n  }\n}",n.value.trim(),a,e,c)}),r.addEventListener("click",function(){a.textContent="Führen Sie eine Query aus, um Ergebnisse zu sehen..."}))},executeQuery:function(t,n,e,r,c){var s;if(!t){alert("Bitte geben Sie eine GraphQL Query ein.");return}e.textContent="Führe Query aus...",r.disabled=!0,c.disabled=!0;const a={query:t},i={"Content-Type":"application/json"};n&&(i["X-API-KEY"]=n);const d=((s=document.querySelector("[data-endpoint-url]"))==null?void 0:s.getAttribute("data-endpoint-url"))||window.rexQLEndpointUrl||"/api/graphql";fetch(d,{method:"POST",headers:i,body:JSON.stringify(a)}).then(o=>{if(!o.ok)throw new Error("HTTP "+o.status+": "+o.statusText);return o.json()}).then(o=>{if(o.errors&&o.errors.length>0){let l="GraphQL Fehler:\n";o.errors.forEach(u=>{u.message.includes("API-Schlüssel erforderlich")?l+="• Authentifizierung erforderlich: Bitte geben Sie einen gültigen API-Schlüssel ein.\n":u.message.includes("invalid_api_key")?l+="• Ungültiger API-Schlüssel: Überprüfen Sie Ihren API-Schlüssel.\n":l+="• "+u.message+"\n"}),e.textContent=JSON.stringify({data:o.data,errors:o.errors,info:l},null,2)}else e.textContent=JSON.stringify(o,null,2)}).catch(o=>{e.textContent="Netzwerkfehler: "+o.message+"\n\nStellen Sie sicher, dass:\n• Der GraphQL Endpoint erreichbar ist\n• Sie einen gültigen API-Schlüssel eingegeben haben\n• Die Query syntaktisch korrekt ist"}).finally(()=>{r.disabled=!1,c.disabled=!1})}};rexQL.copyToClipboard=function(t,n){n=n||"In Zwischenablage kopiert",navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(t).then(function(){alert(n)}).catch(function(){rexQL.fallbackCopyToClipboard(t,n)}):rexQL.fallbackCopyToClipboard(t,n)};rexQL.fallbackCopyToClipboard=function(t,n){var e=document.createElement("textarea");e.value=t,e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="2em",e.style.height="2em",e.style.padding="0",e.style.border="none",e.style.outline="none",e.style.boxShadow="none",e.style.background="transparent",document.body.appendChild(e),e.focus(),e.select();try{var r=document.execCommand("copy");r?alert(n):prompt("Bitte manuell kopieren:",t)}catch(c){prompt("Bitte manuell kopieren:",t)}document.body.removeChild(e)};window.copyToClipboard=function(t){t.includes("rexql_")?rexQL.copyToClipboard(t,"API-Schlüssel in Zwischenablage kopiert"):rexQL.copyToClipboard(t,"URL in Zwischenablage kopiert")};rexQL.showNotification=function(t,n){n=n||"info";var e="alert-info";n==="success"&&(e="alert-success"),n==="error"&&(e="alert-danger"),n==="warning"&&(e="alert-warning");var r=document.createElement("div");r.className="alert "+e+" alert-dismissible",r.innerHTML='<button type="button" class="close" data-dismiss="alert">&times;</button><strong>'+t+"</strong>";var c=document.querySelector(".rex-page-header")||document.body;c.insertBefore(r,c.firstChild),setTimeout(function(){r.parentNode&&r.parentNode.removeChild(r)},3e3)};rexQL.formatGraphQL=function(t){return t.replace(/\s+/g," ").replace(/\{\s*/g,"{\n  ").replace(/\s*\}/g,"\n}").replace(/,\s*/g,",\n  ").trim()};rexQL.validateGraphQL=function(t){var n=(t.match(/\{/g)||[]).length,e=(t.match(/\}/g)||[]).length;return n!==e?"Unbalanced braces in GraphQL query":t.trim().length===0?"Empty query":null};rexQL.updateStats=function(){var t=new XMLHttpRequest;t.open("GET",window.location.href+"&ajax=stats",!0),t.onreadystatechange=function(){if(t.readyState===4&&t.status===200)try{var n=JSON.parse(t.responseText);rexQL.displayStats(n)}catch(e){console.error("Error parsing stats:",e)}},t.send()};rexQL.displayStats=function(t){var n={total_queries:document.getElementById("stat-total-queries"),success_rate:document.getElementById("stat-success-rate"),avg_execution_time:document.getElementById("stat-avg-time"),avg_memory_usage:document.getElementById("stat-avg-memory")};for(var e in n)n[e]&&t[e]!==void 0&&(n[e].textContent=t[e])};rexQL.config={init:function(){const t=document.getElementById("select_all_core_tables");t&&t.addEventListener("change",function(){document.querySelectorAll(".table-checkbox.core-table").forEach(i=>{i.checked=this.checked})});const n=document.getElementById("select_all_yform_tables");n&&n.addEventListener("change",function(){document.querySelectorAll(".table-checkbox.yform-table").forEach(i=>{i.checked=this.checked})});const e=(a,i)=>{const d=document.querySelectorAll(a),s=document.getElementById(i);if(!s)return;const o=Array.from(d).every(l=>l.checked);s.checked=o};document.querySelectorAll(".table-checkbox.core-table").forEach(a=>{a.addEventListener("change",function(){e(".table-checkbox.core-table","select_all_core_tables")})}),document.querySelectorAll(".table-checkbox.yform-table").forEach(a=>{a.addEventListener("change",function(){e(".table-checkbox.yform-table","select_all_yform_tables")})}),e(".table-checkbox.core-table","select_all_core_tables"),e(".table-checkbox.yform-table","select_all_yform_tables")}};document.addEventListener("DOMContentLoaded",function(){var t=document.querySelectorAll("pre code");t.forEach(function(e){e.textContent.trim().startsWith("{")&&e.classList.add("language-graphql")}),window.location.href.indexOf("page=rexql/config")!==-1&&setInterval(rexQL.updateStats,3e4);var n=document.querySelectorAll("[data-copy-api-key]");n.forEach(function(e){e.addEventListener("click",function(r){r.preventDefault();var c=this.getAttribute("data-copy-api-key");rexQL.copyToClipboard(c)})}),window.location.href.indexOf("page=rexql/playground")!==-1&&rexQL.playground.init(),window.location.href.indexOf("page=rexql/config")!==-1&&rexQL.config.init()});typeof jQuery!="undefined"&&jQuery(document).ready(function(t){t(document).on("rex:ready",function(){console.log("rexQL: REDAXO backend ready")})});console.log("rexQL version:","0.0.8");document.addEventListener("DOMContentLoaded",function(){typeof rexQL!="undefined"&&rexQL.playground&&rexQL.playground.init(),typeof rexQL!="undefined"&&rexQL.permissions&&rexQL.permissions.init(),typeof copyToClipboard=="undefined"&&(window.copyToClipboard=function(t){if(navigator.clipboard)navigator.clipboard.writeText(t).then(function(){}).catch(function(n){console.error("Failed to copy text: ",n)});else{const n=document.createElement("textarea");n.value=t,document.body.appendChild(n),n.select();try{document.execCommand("copy")}catch(e){console.error("Failed to copy text: ",e)}document.body.removeChild(n)}})});
//# sourceMappingURL=rexql.js.map
