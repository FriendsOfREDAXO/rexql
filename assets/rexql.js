window.rexQL=window.rexQL||{};rexQL.playground={init:function(){console.log("rexQL.playground.init()");const t=document.getElementById("graphql-query"),r=document.getElementById("api-key-input"),e=document.getElementById("execute-query"),o=document.getElementById("clear-result"),i=document.getElementById("introspect"),c=document.getElementById("query-result");!t||!e||(this.initCodemirror(t),e.addEventListener("click",function(){const l=t.value.trim();rexQL.playground.executeQuery(l,r.value.trim(),c,e,i)}),i.addEventListener("click",function(){rexQL.playground.executeQuery("\n{\n  __schema {\n    queryType {\n      name\n      fields {\n        name\n        type {\n          name\n          kind\n        }\n      }\n    }\n  }\n}",r.value.trim(),c,e,i)}),o.addEventListener("click",function(){c.textContent="Führen Sie eine Query aus, um Ergebnisse zu sehen..."}))},executeQuery:function(t,r,e,o,i){var u;if(!t){alert("Bitte geben Sie eine GraphQL Query ein.");return}e.textContent="Führe Query aus...",o.disabled=!0,i.disabled=!0;const c={query:t},l={"Content-Type":"application/json"};r&&(l["X-API-KEY"]=r);const a=((u=document.querySelector("[data-endpoint-url]"))==null?void 0:u.getAttribute("data-endpoint-url"))||window.rexQLEndpointUrl||"/index.php?rex-api-call=rexql_graphql";fetch(a,{method:"POST",headers:l,body:JSON.stringify(c)}).then(async d=>{const s=await d.json();if(d.ok)e.textContent=JSON.stringify(s,null,2);else{let n="HTTP "+d.status+": "+d.statusText+"\n\n";throw s.errors&&s.errors.length>0&&(n+="GraphQL Fehler:\n",s.errors.forEach(f=>{n+="• "+f.message+"\n"})),new Error(n)}}).catch(d=>{e.textContent="Netzwerkfehler: "+d.message+"\n\nTipps: Stellen Sie sicher, dass:\n• Der GraphQL Endpoint erreichbar ist\n• Sie einen gültigen API-Schlüssel eingegeben haben\n• Die Query syntaktisch korrekt ist"}).finally(()=>{o.disabled=!1,i.disabled=!1})},initCodemirror:function(t){var r=rex.customizer_codemirror_defaulttheme+","+rex.customizer_codemirror_defaultdarktheme+",";if(r!=""&&(r=r.substring(0,r.length-1)),typeof CodeMirror!="function"){var e=!1,o=!1,i=document.createElement("link");i.rel="stylesheet",i.href="?codemirror_output=css&buster="+rex.customizer_codemirror_cssbuster+"&themes="+r,document.head.appendChild(i),i.onload=function(){e=!0;var c=document.createElement("script");c.src="?rexql_output=codemirror&buster="+rex.customizer_codemirror_jsbuster,document.head.appendChild(c),c.onload=function(){if(console.log("CodeMirror script loaded"),o=!0,e&&o){var l="graphql",a=rex.customizer_codemirror_defaulttheme;let s=null;window.matchMedia&&(s=window.matchMedia("(prefers-color-scheme: dark)"),s.matches&&(a=rex.customizer_codemirror_defaultdarktheme),document.body.classList.contains("rex-theme-light")?a=rex.customizer_codemirror_defaulttheme:document.body.classList.contains("rex-theme-dark")&&(a=rex.customizer_codemirror_defaultdarktheme),s.addEventListener("change",function(n){s.matches?a=rex.customizer_codemirror_defaultdarktheme:a=rex.customizer_codemirror_defaulttheme,document.body.classList.contains("rex-theme-light")?a=rex.customizer_codemirror_defaulttheme:document.body.classList.contains("rex-theme-dark")&&(a=rex.customizer_codemirror_defaultdarktheme),cm_editor[cm].setOption("theme",a)}));var u=t.dataset.codemirrorTheme;if(typeof u!="undefined"&&(a=u),typeof CodeMirror=="function"){cm_options={mode:l,theme:a,autoRefresh:!0,lineNumbers:!0,lineWrapping:!1,styleActiveLine:!0,matchBrackets:!0,autoCloseBrackets:!0,matchTags:{bothTags:!0},tabSize:4,indentUnit:4,indentWithTabs:!1,smartIndent:!0,enterMode:"keep",tabMode:"shift",gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],foldGutter:!0,extraKeys:{F11:function(n){n.setOption("fullScreen",!n.getOption("fullScreen"))},Esc:function(n){n.setOption("fullScreen",!n.getOption("fullScreen"))},Tab:function(n){if(n.doc.somethingSelected())return CodeMirror.Pass;if(n.getOption("indentWithTabs"))n.replaceSelection("	","end","+input");else{var f=n.getOption("indentUnit"),m=f-n.doc.getCursor("start").ch%f,h=Array(m+1).join(" ");n.replaceSelection(h,"end","+input")}}}};try{rex.customizer_codemirror_options&&(additional_options=jQuery.parseJSON(rex.customizer_codemirror_options),$.extend(cm_options,additional_options))}catch(n){console.log("Error in global Codemirror-Options! \nOptions: "+rex.customizer_codemirror_options),console.log(n)}var d=CodeMirror.fromTextArea(t,cm_options);d&&(d.on("change",function(n){n.save()}),d.on("focus",function(){t.classList.add("active")}),d.on("blur",function(){t.classList.remove("active")}))}}},c.onerror=function(){console.error("CodeMirror script konnte nicht geladen werden.")}}}}};rexQL.copyToClipboard=function(t,r){r=r||"In Zwischenablage kopiert",navigator.clipboard&&navigator.clipboard.writeText?navigator.clipboard.writeText(t).then(function(){alert(r)}).catch(function(){rexQL.fallbackCopyToClipboard(t,r)}):rexQL.fallbackCopyToClipboard(t,r)};rexQL.fallbackCopyToClipboard=function(t,r){var e=document.createElement("textarea");e.value=t,e.style.position="fixed",e.style.top="0",e.style.left="0",e.style.width="2em",e.style.height="2em",e.style.padding="0",e.style.border="none",e.style.outline="none",e.style.boxShadow="none",e.style.background="transparent",document.body.appendChild(e),e.focus(),e.select();try{var o=document.execCommand("copy");o?alert(r):prompt("Bitte manuell kopieren:",t)}catch(i){prompt("Bitte manuell kopieren:",t)}document.body.removeChild(e)};window.copyToClipboard=function(t){t.includes("rexql_")?rexQL.copyToClipboard(t,"API-Schlüssel in Zwischenablage kopiert"):rexQL.copyToClipboard(t,"URL in Zwischenablage kopiert")};rexQL.showNotification=function(t,r){r=r||"info";var e="alert-info";r==="success"&&(e="alert-success"),r==="error"&&(e="alert-danger"),r==="warning"&&(e="alert-warning");var o=document.createElement("div");o.className="alert "+e+" alert-dismissible",o.innerHTML='<button type="button" class="close" data-dismiss="alert">&times;</button><strong>'+t+"</strong>";var i=document.querySelector(".rex-page-header")||document.body;i.insertBefore(o,i.firstChild),setTimeout(function(){o.parentNode&&o.parentNode.removeChild(o)},3e3)};rexQL.formatGraphQL=function(t){return t.replace(/\s+/g," ").replace(/\{\s*/g,"{\n  ").replace(/\s*\}/g,"\n}").replace(/,\s*/g,",\n  ").trim()};rexQL.validateGraphQL=function(t){var r=(t.match(/\{/g)||[]).length,e=(t.match(/\}/g)||[]).length;return r!==e?"Unbalanced braces in GraphQL query":t.trim().length===0?"Empty query":null};rexQL.config={init:function(){const t=document.getElementById("select_all_core_tables");t&&t.addEventListener("change",function(){document.querySelectorAll(".table-checkbox.core-table").forEach(l=>{l.checked=this.checked})});const r=document.getElementById("select_all_yform_tables");r&&r.addEventListener("change",function(){document.querySelectorAll(".table-checkbox.yform-table").forEach(l=>{l.checked=this.checked})});const e=(c,l)=>{const a=document.querySelectorAll(c),u=document.getElementById(l);if(!u)return;const d=Array.from(a).every(s=>s.checked);u.checked=d};document.querySelectorAll(".table-checkbox.core-table").forEach(c=>{c.addEventListener("change",function(){e(".table-checkbox.core-table","select_all_core_tables")})}),document.querySelectorAll(".table-checkbox.yform-table").forEach(c=>{c.addEventListener("change",function(){e(".table-checkbox.yform-table","select_all_yform_tables")})}),e(".table-checkbox.core-table","select_all_core_tables"),e(".table-checkbox.yform-table","select_all_yform_tables")}};$(document).on("rex:ready",function(){if(window.location.href.indexOf("page=rexql")!==-1){console.log("rexQL Addon rex:ready"),typeof copyToClipboard=="undefined"&&(window.copyToClipboard=function(e){if(navigator.clipboard)navigator.clipboard.writeText(e).then(function(){}).catch(function(o){console.error("Failed to copy text: ",o)});else{const o=document.createElement("textarea");o.value=e,document.body.appendChild(o),o.select();try{document.execCommand("copy")}catch(i){console.error("Failed to copy text: ",i)}document.body.removeChild(o)}});var t=document.querySelectorAll("pre code");t.forEach(function(e){e.textContent.trim().startsWith("{")&&e.classList.add("language-graphql")});var r=document.querySelectorAll("[data-copy]");r.forEach(function(e){e.addEventListener("click",function(o){o.preventDefault();var i=this.getAttribute("data-copy");rexQL.copyToClipboard(i)})}),window.location.href.indexOf("page=rexql/playground")!==-1&&rexQL.playground.init(),window.location.href.indexOf("page=rexql/config")!==-1&&rexQL.config.init()}});
//# sourceMappingURL=rexql.js.map
