var u=(h,e)=>()=>(e||h((e={exports:{}}).exports,e),e.exports);var d=u((y,l)=>{class r{constructor(e={}){this.baseUrl=e.baseUrl||"",this.apiKey=e.apiKey,this.publicKey=e.publicKey,this.sessionToken=e.sessionToken,this.useProxy=e.useProxy||!1,this.enableAuth=e.enableAuth||!1}async query(e,s=null,i=null){const o=this.useProxy?"".concat(this.baseUrl,"/index.php?rex-api-call=rexql_proxy"):"".concat(this.baseUrl,"/index.php?rex-api-call=rexql_graphql"),n={"Content-Type":"application/json"};this.useProxy&&this.enableAuth?(this.sessionToken&&(n.Authorization="Bearer ".concat(this.sessionToken)),this.publicKey&&(n["X-Public-Key"]=this.publicKey)):this.apiKey&&(n["X-API-KEY"]=this.apiKey);const c={query:e,variables:s,operationName:i};try{const t=await fetch(o,{method:"POST",headers:n,body:JSON.stringify(c),credentials:this.useProxy&&this.enableAuth?"include":"omit"});if(!t.ok)throw new Error("HTTP ".concat(t.status,": ").concat(t.statusText));const a=await t.json();if(a.errors&&a.errors.length>0)throw new Error(a.errors[0].message);return a}catch(t){throw console.error("RexQL Query Error:",t),t}}setSessionToken(e){this.sessionToken=e}async login(e,s){const i=await fetch("".concat(this.baseUrl,"/index.php?rex-api-call=rexql_auth&action=login"),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({username:e,password:s})});if(!i.ok)throw new Error("HTTP ".concat(i.status,": ").concat(i.statusText));const o=await i.json();if(!o.success)throw new Error(o.error||"Login failed");return this.sessionToken=o.session_token,typeof localStorage!="undefined"&&localStorage.setItem("rexql_session_token",this.sessionToken),o}async validateSession(){if(this.sessionToken||typeof localStorage!="undefined"&&(this.sessionToken=localStorage.getItem("rexql_session_token")),!this.sessionToken)throw new Error("No session token available");const s=await(await fetch("".concat(this.baseUrl,"/index.php?rex-api-call=rexql_auth&action=validate"),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({token:this.sessionToken})})).json();if(!s.success)throw this.sessionToken=null,typeof localStorage!="undefined"&&localStorage.removeItem("rexql_session_token"),new Error(s.error||"Session validation failed");return s}async logout(){if(this.sessionToken)try{await fetch("".concat(this.baseUrl,"/index.php?rex-api-call=rexql_auth&action=logout"),{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({token:this.sessionToken})})}catch(e){console.warn("Logout request failed:",e)}this.sessionToken=null,typeof localStorage!="undefined"&&localStorage.removeItem("rexql_session_token")}async getArticles(e=10,s=1){return this.query("\n            {\n                rexArticleList(limit: ".concat(e,", clang_id: ").concat(s,") {\n                    id\n                    name\n                    createdate\n                    status\n                }\n            }\n        "))}async getArticle(e){return this.query("\n            {\n                rexArticle(id: ".concat(e,") {\n                    id\n                    name\n                    createdate\n                    status\n                    slices: rexArticleSliceList {\n                        id\n                        module_id\n                        value1\n                        value2\n                    }\n                }\n            }\n        "))}async getMedia(e=20){return this.query("\n            {\n                rexMediaList(limit: ".concat(e,") {\n                    id\n                    filename\n                    title\n                    category_id\n                    filesize\n                }\n            }\n        "))}}new r({baseUrl:"https://cms.ihre-domain.de",apiKey:"rexql_abc123...",useProxy:!1,enableAuth:!1});new r({baseUrl:"http://redaxo-graph-ql.test",useProxy:!1,enableAuth:!1});new r({baseUrl:"https://cms.ihre-domain.de",publicKey:"rexql_pub_abc123...",useProxy:!0,enableAuth:!0});typeof l!="undefined"&&l.exports&&(l.exports=r);typeof window!="undefined"&&(window.RexQLClient=r)});export default d();
//# sourceMappingURL=rexql-client.js.map
