"use strict";function sp(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function op(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var n=e.default;if(typeof n=="function"){var r=function o(){var l=!1;try{l=this instanceof o}catch{}return l?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};r.prototype=n.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(o){var l=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(r,o,l.get?l:{enumerable:!0,get:function(){return e[o]}})}),r}var Jr={},Zo={},el={},tl={},Gs={},oc;function lp(){if(oc)return Gs;oc=1;let e=[],n=[];(()=>{let ne="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(te=>te?parseInt(te,36):1);for(let te=0,be=0;te<ne.length;te++)(te%2?n:e).push(be=be+ne[te])})();function r(ne){if(ne<768)return!1;for(let te=0,be=e.length;;){let Ne=te+be>>1;if(ne<e[Ne])be=Ne;else if(ne>=n[Ne])te=Ne+1;else return!0;if(te==be)return!1}}function o(ne){return ne>=127462&&ne<=127487}const l=8205;function h(ne,te,be=!0,Ne=!0){return(be?y:N)(ne,te,Ne)}function y(ne,te,be){if(te==ne.length)return te;te&&R(ne.charCodeAt(te))&&W(ne.charCodeAt(te-1))&&te--;let Ne=D(ne,te);for(te+=z(Ne);te<ne.length;){let Se=D(ne,te);if(Ne==l||Se==l||be&&r(Se))te+=z(Se),Ne=Se;else if(o(Se)){let xe=0,Qe=te-2;for(;Qe>=0&&o(D(ne,Qe));)xe++,Qe-=2;if(xe%2==0)break;te+=2}else break}return te}function N(ne,te,be){for(;te>0;){let Ne=y(ne,te-2,be);if(Ne<te)return Ne;te--}return 0}function D(ne,te){let be=ne.charCodeAt(te);if(!W(be)||te+1==ne.length)return be;let Ne=ne.charCodeAt(te+1);return R(Ne)?(be-55296<<10)+(Ne-56320)+65536:be}function R(ne){return ne>=56320&&ne<57344}function W(ne){return ne>=55296&&ne<56320}function z(ne){return ne<65536?1:2}return Gs.findClusterBreak=h,Gs.isExtendingChar=r,Gs}var lc;function tr(){return lc||(lc=1,function(e){var n=lp();class r{lineAt(f){if(f<0||f>this.length)throw new RangeError(`Invalid position ${f} in document of length ${this.length}`);return this.lineInner(f,!1,1,0)}line(f){if(f<1||f>this.lines)throw new RangeError(`Invalid line number ${f} in ${this.lines}-line document`);return this.lineInner(f,!0,1,0)}replace(f,m,E){[f,m]=ne(this,f,m);let C=[];return this.decompose(0,f,C,2),E.length&&E.decompose(0,E.length,C,3),this.decompose(m,this.length,C,1),l.from(C,this.length-(m-f)+E.length)}append(f){return this.replace(this.length,this.length,f)}slice(f,m=this.length){[f,m]=ne(this,f,m);let E=[];return this.decompose(f,m,E,0),l.from(E,m-f)}eq(f){if(f==this)return!0;if(f.length!=this.length||f.lines!=this.lines)return!1;let m=this.scanIdentical(f,1),E=this.length-this.scanIdentical(f,-1),C=new D(this),B=new D(f);for(let V=m,ee=m;;){if(C.next(V),B.next(V),V=0,C.lineBreak!=B.lineBreak||C.done!=B.done||C.value!=B.value)return!1;if(ee+=C.value.length,C.done||ee>=E)return!0}}iter(f=1){return new D(this,f)}iterRange(f,m=this.length){return new R(this,f,m)}iterLines(f,m){let E;if(f==null)E=this.iter();else{m==null&&(m=this.lines+1);let C=this.line(f).from;E=this.iterRange(C,Math.max(C,m==this.lines+1?this.length:m<=1?0:this.line(m-1).to))}return new W(E)}toString(){return this.sliceString(0)}toJSON(){let f=[];return this.flatten(f),f}constructor(){}static of(f){if(f.length==0)throw new RangeError("A document must have at least one line");return f.length==1&&!f[0]?r.empty:f.length<=32?new o(f):l.from(o.split(f,[]))}}class o extends r{constructor(f,m=h(f)){super(),this.text=f,this.length=m}get lines(){return this.text.length}get children(){return null}lineInner(f,m,E,C){for(let B=0;;B++){let V=this.text[B],ee=C+V.length;if((m?E:ee)>=f)return new z(C,ee,E,V);C=ee+1,E++}}decompose(f,m,E,C){let B=f<=0&&m>=this.length?this:new o(N(this.text,f,m),Math.min(m,this.length)-Math.max(0,f));if(C&1){let V=E.pop(),ee=y(B.text,V.text.slice(),0,B.length);if(ee.length<=32)E.push(new o(ee,V.length+B.length));else{let ce=ee.length>>1;E.push(new o(ee.slice(0,ce)),new o(ee.slice(ce)))}}else E.push(B)}replace(f,m,E){if(!(E instanceof o))return super.replace(f,m,E);[f,m]=ne(this,f,m);let C=y(this.text,y(E.text,N(this.text,0,f)),m),B=this.length+E.length-(m-f);return C.length<=32?new o(C,B):l.from(o.split(C,[]),B)}sliceString(f,m=this.length,E=`
`){[f,m]=ne(this,f,m);let C="";for(let B=0,V=0;B<=m&&V<this.text.length;V++){let ee=this.text[V],ce=B+ee.length;B>f&&V&&(C+=E),f<ce&&m>B&&(C+=ee.slice(Math.max(0,f-B),m-B)),B=ce+1}return C}flatten(f){for(let m of this.text)f.push(m)}scanIdentical(){return 0}static split(f,m){let E=[],C=-1;for(let B of f)E.push(B),C+=B.length+1,E.length==32&&(m.push(new o(E,C)),E=[],C=-1);return C>-1&&m.push(new o(E,C)),m}}class l extends r{constructor(f,m){super(),this.children=f,this.length=m,this.lines=0;for(let E of f)this.lines+=E.lines}lineInner(f,m,E,C){for(let B=0;;B++){let V=this.children[B],ee=C+V.length,ce=E+V.lines-1;if((m?ce:ee)>=f)return V.lineInner(f,m,E,C);C=ee+1,E=ce+1}}decompose(f,m,E,C){for(let B=0,V=0;V<=m&&B<this.children.length;B++){let ee=this.children[B],ce=V+ee.length;if(f<=ce&&m>=V){let Te=C&((V<=f?1:0)|(ce>=m?2:0));V>=f&&ce<=m&&!Te?E.push(ee):ee.decompose(f-V,m-V,E,Te)}V=ce+1}}replace(f,m,E){if([f,m]=ne(this,f,m),E.lines<this.lines)for(let C=0,B=0;C<this.children.length;C++){let V=this.children[C],ee=B+V.length;if(f>=B&&m<=ee){let ce=V.replace(f-B,m-B,E),Te=this.lines-V.lines+ce.lines;if(ce.lines<Te>>4&&ce.lines>Te>>6){let De=this.children.slice();return De[C]=ce,new l(De,this.length-(m-f)+E.length)}return super.replace(B,ee,ce)}B=ee+1}return super.replace(f,m,E)}sliceString(f,m=this.length,E=`
`){[f,m]=ne(this,f,m);let C="";for(let B=0,V=0;B<this.children.length&&V<=m;B++){let ee=this.children[B],ce=V+ee.length;V>f&&B&&(C+=E),f<ce&&m>V&&(C+=ee.sliceString(f-V,m-V,E)),V=ce+1}return C}flatten(f){for(let m of this.children)m.flatten(f)}scanIdentical(f,m){if(!(f instanceof l))return 0;let E=0,[C,B,V,ee]=m>0?[0,0,this.children.length,f.children.length]:[this.children.length-1,f.children.length-1,-1,-1];for(;;C+=m,B+=m){if(C==V||B==ee)return E;let ce=this.children[C],Te=f.children[B];if(ce!=Te)return E+ce.scanIdentical(Te,m);E+=ce.length+1}}static from(f,m=f.reduce((E,C)=>E+C.length+1,-1)){let E=0;for(let it of f)E+=it.lines;if(E<32){let it=[];for(let zt of f)zt.flatten(it);return new o(it,m)}let C=Math.max(32,E>>5),B=C<<1,V=C>>1,ee=[],ce=0,Te=-1,De=[];function je(it){let zt;if(it.lines>B&&it instanceof l)for(let An of it.children)je(An);else it.lines>V&&(ce>V||!ce)?(nt(),ee.push(it)):it instanceof o&&ce&&(zt=De[De.length-1])instanceof o&&it.lines+zt.lines<=32?(ce+=it.lines,Te+=it.length+1,De[De.length-1]=new o(zt.text.concat(it.text),zt.length+1+it.length)):(ce+it.lines>C&&nt(),ce+=it.lines,Te+=it.length+1,De.push(it))}function nt(){ce!=0&&(ee.push(De.length==1?De[0]:l.from(De,Te)),Te=-1,ce=De.length=0)}for(let it of f)je(it);return nt(),ee.length==1?ee[0]:new l(ee,m)}}r.empty=new o([""],0);function h(q){let f=-1;for(let m of q)f+=m.length+1;return f}function y(q,f,m=0,E=1e9){for(let C=0,B=0,V=!0;B<q.length&&C<=E;B++){let ee=q[B],ce=C+ee.length;ce>=m&&(ce>E&&(ee=ee.slice(0,E-C)),C<m&&(ee=ee.slice(m-C)),V?(f[f.length-1]+=ee,V=!1):f.push(ee)),C=ce+1}return f}function N(q,f,m){return y(q,[""],f,m)}class D{constructor(f,m=1){this.dir=m,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[f],this.offsets=[m>0?1:(f instanceof o?f.text.length:f.children.length)<<1]}nextInner(f,m){for(this.done=this.lineBreak=!1;;){let E=this.nodes.length-1,C=this.nodes[E],B=this.offsets[E],V=B>>1,ee=C instanceof o?C.text.length:C.children.length;if(V==(m>0?ee:0)){if(E==0)return this.done=!0,this.value="",this;m>0&&this.offsets[E-1]++,this.nodes.pop(),this.offsets.pop()}else if((B&1)==(m>0?0:1)){if(this.offsets[E]+=m,f==0)return this.lineBreak=!0,this.value=`
`,this;f--}else if(C instanceof o){let ce=C.text[V+(m<0?-1:0)];if(this.offsets[E]+=m,ce.length>Math.max(0,f))return this.value=f==0?ce:m>0?ce.slice(f):ce.slice(0,ce.length-f),this;f-=ce.length}else{let ce=C.children[V+(m<0?-1:0)];f>ce.length?(f-=ce.length,this.offsets[E]+=m):(m<0&&this.offsets[E]--,this.nodes.push(ce),this.offsets.push(m>0?1:(ce instanceof o?ce.text.length:ce.children.length)<<1))}}}next(f=0){return f<0&&(this.nextInner(-f,-this.dir),f=this.value.length),this.nextInner(f,this.dir)}}class R{constructor(f,m,E){this.value="",this.done=!1,this.cursor=new D(f,m>E?-1:1),this.pos=m>E?f.length:0,this.from=Math.min(m,E),this.to=Math.max(m,E)}nextInner(f,m){if(m<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;f+=Math.max(0,m<0?this.pos-this.to:this.from-this.pos);let E=m<0?this.pos-this.from:this.to-this.pos;f>E&&(f=E),E-=f;let{value:C}=this.cursor.next(f);return this.pos+=(C.length+f)*m,this.value=C.length<=E?C:m<0?C.slice(C.length-E):C.slice(0,E),this.done=!this.value,this}next(f=0){return f<0?f=Math.max(f,this.from-this.pos):f>0&&(f=Math.min(f,this.to-this.pos)),this.nextInner(f,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class W{constructor(f){this.inner=f,this.afterBreak=!0,this.value="",this.done=!1}next(f=0){let{done:m,lineBreak:E,value:C}=this.inner.next(f);return m&&this.afterBreak?(this.value="",this.afterBreak=!1):m?(this.done=!0,this.value=""):E?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=C,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(r.prototype[Symbol.iterator]=function(){return this.iter()},D.prototype[Symbol.iterator]=R.prototype[Symbol.iterator]=W.prototype[Symbol.iterator]=function(){return this});class z{constructor(f,m,E,C){this.from=f,this.to=m,this.number=E,this.text=C}get length(){return this.to-this.from}}function ne(q,f,m){return f=Math.max(0,Math.min(q.length,f)),[f,Math.max(f,Math.min(q.length,m))]}function te(q,f,m=!0,E=!0){return n.findClusterBreak(q,f,m,E)}function be(q){return q>=56320&&q<57344}function Ne(q){return q>=55296&&q<56320}function Se(q,f){let m=q.charCodeAt(f);if(!Ne(m)||f+1==q.length)return m;let E=q.charCodeAt(f+1);return be(E)?(m-55296<<10)+(E-56320)+65536:m}function xe(q){return q<=65535?String.fromCharCode(q):(q-=65536,String.fromCharCode((q>>10)+55296,(q&1023)+56320))}function Qe(q){return q<65536?1:2}const Ge=/\r\n?|\n/;e.MapMode=void 0,function(q){q[q.Simple=0]="Simple",q[q.TrackDel=1]="TrackDel",q[q.TrackBefore=2]="TrackBefore",q[q.TrackAfter=3]="TrackAfter"}(e.MapMode||(e.MapMode={}));class We{constructor(f){this.sections=f}get length(){let f=0;for(let m=0;m<this.sections.length;m+=2)f+=this.sections[m];return f}get newLength(){let f=0;for(let m=0;m<this.sections.length;m+=2){let E=this.sections[m+1];f+=E<0?this.sections[m]:E}return f}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(f){for(let m=0,E=0,C=0;m<this.sections.length;){let B=this.sections[m++],V=this.sections[m++];V<0?(f(E,C,B),C+=B):C+=V,E+=B}}iterChangedRanges(f,m=!1){ut(this,f,m)}get invertedDesc(){let f=[];for(let m=0;m<this.sections.length;){let E=this.sections[m++],C=this.sections[m++];C<0?f.push(E,C):f.push(C,E)}return new We(f)}composeDesc(f){return this.empty?f:f.empty?this:Xt(this,f)}mapDesc(f,m=!1){return f.empty?this:rn(this,f,m)}mapPos(f,m=-1,E=e.MapMode.Simple){let C=0,B=0;for(let V=0;V<this.sections.length;){let ee=this.sections[V++],ce=this.sections[V++],Te=C+ee;if(ce<0){if(Te>f)return B+(f-C);B+=ee}else{if(E!=e.MapMode.Simple&&Te>=f&&(E==e.MapMode.TrackDel&&C<f&&Te>f||E==e.MapMode.TrackBefore&&C<f||E==e.MapMode.TrackAfter&&Te>f))return null;if(Te>f||Te==f&&m<0&&!ee)return f==C||m<0?B:B+ce;B+=ce}C=Te}if(f>C)throw new RangeError(`Position ${f} is out of range for changeset of length ${C}`);return B}touchesRange(f,m=f){for(let E=0,C=0;E<this.sections.length&&C<=m;){let B=this.sections[E++],V=this.sections[E++],ee=C+B;if(V>=0&&C<=m&&ee>=f)return C<f&&ee>m?"cover":!0;C=ee}return!1}toString(){let f="";for(let m=0;m<this.sections.length;){let E=this.sections[m++],C=this.sections[m++];f+=(f?" ":"")+E+(C>=0?":"+C:"")}return f}toJSON(){return this.sections}static fromJSON(f){if(!Array.isArray(f)||f.length%2||f.some(m=>typeof m!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new We(f)}static create(f){return new We(f)}}class ot extends We{constructor(f,m){super(f),this.inserted=m}apply(f){if(this.length!=f.length)throw new RangeError("Applying change set to a document with the wrong length");return ut(this,(m,E,C,B,V)=>f=f.replace(C,C+(E-m),V),!1),f}mapDesc(f,m=!1){return rn(this,f,m,!0)}invert(f){let m=this.sections.slice(),E=[];for(let C=0,B=0;C<m.length;C+=2){let V=m[C],ee=m[C+1];if(ee>=0){m[C]=ee,m[C+1]=V;let ce=C>>1;for(;E.length<ce;)E.push(r.empty);E.push(V?f.slice(B,B+V):r.empty)}B+=V}return new ot(m,E)}compose(f){return this.empty?f:f.empty?this:Xt(this,f,!0)}map(f,m=!1){return f.empty?this:rn(this,f,m,!0)}iterChanges(f,m=!1){ut(this,f,m)}get desc(){return We.create(this.sections)}filter(f){let m=[],E=[],C=[],B=new Qt(this);e:for(let V=0,ee=0;;){let ce=V==f.length?1e9:f[V++];for(;ee<ce||ee==ce&&B.len==0;){if(B.done)break e;let De=Math.min(B.len,ce-ee);ft(C,De,-1);let je=B.ins==-1?-1:B.off==0?B.ins:0;ft(m,De,je),je>0&&Et(E,m,B.text),B.forward(De),ee+=De}let Te=f[V++];for(;ee<Te;){if(B.done)break e;let De=Math.min(B.len,Te-ee);ft(m,De,-1),ft(C,De,B.ins==-1?-1:B.off==0?B.ins:0),B.forward(De),ee+=De}}return{changes:new ot(m,E),filtered:We.create(C)}}toJSON(){let f=[];for(let m=0;m<this.sections.length;m+=2){let E=this.sections[m],C=this.sections[m+1];C<0?f.push(E):C==0?f.push([E]):f.push([E].concat(this.inserted[m>>1].toJSON()))}return f}static of(f,m,E){let C=[],B=[],V=0,ee=null;function ce(De=!1){if(!De&&!C.length)return;V<m&&ft(C,m-V,-1);let je=new ot(C,B);ee=ee?ee.compose(je.map(ee)):je,C=[],B=[],V=0}function Te(De){if(Array.isArray(De))for(let je of De)Te(je);else if(De instanceof ot){if(De.length!=m)throw new RangeError(`Mismatched change set length (got ${De.length}, expected ${m})`);ce(),ee=ee?ee.compose(De.map(ee)):De}else{let{from:je,to:nt=je,insert:it}=De;if(je>nt||je<0||nt>m)throw new RangeError(`Invalid change range ${je} to ${nt} (in doc of length ${m})`);let zt=it?typeof it=="string"?r.of(it.split(E||Ge)):it:r.empty,An=zt.length;if(je==nt&&An==0)return;je<V&&ce(),je>V&&ft(C,je-V,-1),ft(C,nt-je,An),Et(B,C,zt),V=nt}}return Te(f),ce(!ee),ee}static empty(f){return new ot(f?[f,-1]:[],[])}static fromJSON(f){if(!Array.isArray(f))throw new RangeError("Invalid JSON representation of ChangeSet");let m=[],E=[];for(let C=0;C<f.length;C++){let B=f[C];if(typeof B=="number")m.push(B,-1);else{if(!Array.isArray(B)||typeof B[0]!="number"||B.some((V,ee)=>ee&&typeof V!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(B.length==1)m.push(B[0],0);else{for(;E.length<C;)E.push(r.empty);E[C]=r.of(B.slice(1)),m.push(B[0],E[C].length)}}}return new ot(m,E)}static createSet(f,m){return new ot(f,m)}}function ft(q,f,m,E=!1){if(f==0&&m<=0)return;let C=q.length-2;C>=0&&m<=0&&m==q[C+1]?q[C]+=f:C>=0&&f==0&&q[C]==0?q[C+1]+=m:E?(q[C]+=f,q[C+1]+=m):q.push(f,m)}function Et(q,f,m){if(m.length==0)return;let E=f.length-2>>1;if(E<q.length)q[q.length-1]=q[q.length-1].append(m);else{for(;q.length<E;)q.push(r.empty);q.push(m)}}function ut(q,f,m){let E=q.inserted;for(let C=0,B=0,V=0;V<q.sections.length;){let ee=q.sections[V++],ce=q.sections[V++];if(ce<0)C+=ee,B+=ee;else{let Te=C,De=B,je=r.empty;for(;Te+=ee,De+=ce,ce&&E&&(je=je.append(E[V-2>>1])),!(m||V==q.sections.length||q.sections[V+1]<0);)ee=q.sections[V++],ce=q.sections[V++];f(C,Te,B,De,je),C=Te,B=De}}}function rn(q,f,m,E=!1){let C=[],B=E?[]:null,V=new Qt(q),ee=new Qt(f);for(let ce=-1;;){if(V.done&&ee.len||ee.done&&V.len)throw new Error("Mismatched change set lengths");if(V.ins==-1&&ee.ins==-1){let Te=Math.min(V.len,ee.len);ft(C,Te,-1),V.forward(Te),ee.forward(Te)}else if(ee.ins>=0&&(V.ins<0||ce==V.i||V.off==0&&(ee.len<V.len||ee.len==V.len&&!m))){let Te=ee.len;for(ft(C,ee.ins,-1);Te;){let De=Math.min(V.len,Te);V.ins>=0&&ce<V.i&&V.len<=De&&(ft(C,0,V.ins),B&&Et(B,C,V.text),ce=V.i),V.forward(De),Te-=De}ee.next()}else if(V.ins>=0){let Te=0,De=V.len;for(;De;)if(ee.ins==-1){let je=Math.min(De,ee.len);Te+=je,De-=je,ee.forward(je)}else if(ee.ins==0&&ee.len<De)De-=ee.len,ee.next();else break;ft(C,Te,ce<V.i?V.ins:0),B&&ce<V.i&&Et(B,C,V.text),ce=V.i,V.forward(V.len-De)}else{if(V.done&&ee.done)return B?ot.createSet(C,B):We.create(C);throw new Error("Mismatched change set lengths")}}}function Xt(q,f,m=!1){let E=[],C=m?[]:null,B=new Qt(q),V=new Qt(f);for(let ee=!1;;){if(B.done&&V.done)return C?ot.createSet(E,C):We.create(E);if(B.ins==0)ft(E,B.len,0,ee),B.next();else if(V.len==0&&!V.done)ft(E,0,V.ins,ee),C&&Et(C,E,V.text),V.next();else{if(B.done||V.done)throw new Error("Mismatched change set lengths");{let ce=Math.min(B.len2,V.len),Te=E.length;if(B.ins==-1){let De=V.ins==-1?-1:V.off?0:V.ins;ft(E,ce,De,ee),C&&De&&Et(C,E,V.text)}else V.ins==-1?(ft(E,B.off?0:B.len,ce,ee),C&&Et(C,E,B.textBit(ce))):(ft(E,B.off?0:B.len,V.off?0:V.ins,ee),C&&!V.off&&Et(C,E,V.text));ee=(B.ins>ce||V.ins>=0&&V.len>ce)&&(ee||E.length>Te),B.forward2(ce),V.forward(ce)}}}}class Qt{constructor(f){this.set=f,this.i=0,this.next()}next(){let{sections:f}=this.set;this.i<f.length?(this.len=f[this.i++],this.ins=f[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:f}=this.set,m=this.i-2>>1;return m>=f.length?r.empty:f[m]}textBit(f){let{inserted:m}=this.set,E=this.i-2>>1;return E>=m.length&&!f?r.empty:m[E].slice(this.off,f==null?void 0:this.off+f)}forward(f){f==this.len?this.next():(this.len-=f,this.off+=f)}forward2(f){this.ins==-1?this.forward(f):f==this.ins?this.next():(this.ins-=f,this.off+=f)}}class Kt{constructor(f,m,E){this.from=f,this.to=m,this.flags=E}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let f=this.flags&7;return f==7?null:f}get goalColumn(){let f=this.flags>>6;return f==16777215?void 0:f}map(f,m=-1){let E,C;return this.empty?E=C=f.mapPos(this.from,m):(E=f.mapPos(this.from,1),C=f.mapPos(this.to,-1)),E==this.from&&C==this.to?this:new Kt(E,C,this.flags)}extend(f,m=f){if(f<=this.anchor&&m>=this.anchor)return pt.range(f,m);let E=Math.abs(f-this.anchor)>Math.abs(m-this.anchor)?f:m;return pt.range(this.anchor,E)}eq(f,m=!1){return this.anchor==f.anchor&&this.head==f.head&&(!m||!this.empty||this.assoc==f.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(f){if(!f||typeof f.anchor!="number"||typeof f.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return pt.range(f.anchor,f.head)}static create(f,m,E){return new Kt(f,m,E)}}class pt{constructor(f,m){this.ranges=f,this.mainIndex=m}map(f,m=-1){return f.empty?this:pt.create(this.ranges.map(E=>E.map(f,m)),this.mainIndex)}eq(f,m=!1){if(this.ranges.length!=f.ranges.length||this.mainIndex!=f.mainIndex)return!1;for(let E=0;E<this.ranges.length;E++)if(!this.ranges[E].eq(f.ranges[E],m))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new pt([this.main],0)}addRange(f,m=!0){return pt.create([f].concat(this.ranges),m?0:this.mainIndex+1)}replaceRange(f,m=this.mainIndex){let E=this.ranges.slice();return E[m]=f,pt.create(E,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(f=>f.toJSON()),main:this.mainIndex}}static fromJSON(f){if(!f||!Array.isArray(f.ranges)||typeof f.main!="number"||f.main>=f.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new pt(f.ranges.map(m=>Kt.fromJSON(m)),f.main)}static single(f,m=f){return new pt([pt.range(f,m)],0)}static create(f,m=0){if(f.length==0)throw new RangeError("A selection needs at least one range");for(let E=0,C=0;C<f.length;C++){let B=f[C];if(B.empty?B.from<=E:B.from<E)return pt.normalized(f.slice(),m);E=B.to}return new pt(f,m)}static cursor(f,m=0,E,C){return Kt.create(f,f,(m==0?0:m<0?8:16)|(E==null?7:Math.min(6,E))|(C??16777215)<<6)}static range(f,m,E,C){let B=(E??16777215)<<6|(C==null?7:Math.min(6,C));return m<f?Kt.create(m,f,48|B):Kt.create(f,m,(m>f?8:0)|B)}static normalized(f,m=0){let E=f[m];f.sort((C,B)=>C.from-B.from),m=f.indexOf(E);for(let C=1;C<f.length;C++){let B=f[C],V=f[C-1];if(B.empty?B.from<=V.to:B.from<V.to){let ee=V.from,ce=Math.max(B.to,V.to);C<=m&&m--,f.splice(--C,2,B.anchor>B.head?pt.range(ce,ee):pt.range(ee,ce))}}return new pt(f,m)}}function Vt(q,f){for(let m of q.ranges)if(m.to>f)throw new RangeError("Selection points outside of document")}let qe=0;class Mt{constructor(f,m,E,C,B){this.combine=f,this.compareInput=m,this.compare=E,this.isStatic=C,this.id=qe++,this.default=f([]),this.extensions=typeof B=="function"?B(this):B}get reader(){return this}static define(f={}){return new Mt(f.combine||(m=>m),f.compareInput||((m,E)=>m===E),f.compare||(f.combine?(m,E)=>m===E:Je),!!f.static,f.enables)}of(f){return new we([],this,0,f)}compute(f,m){if(this.isStatic)throw new Error("Can't compute a static facet");return new we(f,this,1,m)}computeN(f,m){if(this.isStatic)throw new Error("Can't compute a static facet");return new we(f,this,2,m)}from(f,m){return m||(m=E=>E),this.compute([f],E=>m(E.field(f)))}}function Je(q,f){return q==f||q.length==f.length&&q.every((m,E)=>m===f[E])}class we{constructor(f,m,E,C){this.dependencies=f,this.facet=m,this.type=E,this.value=C,this.id=qe++}dynamicSlot(f){var m;let E=this.value,C=this.facet.compareInput,B=this.id,V=f[B]>>1,ee=this.type==2,ce=!1,Te=!1,De=[];for(let je of this.dependencies)je=="doc"?ce=!0:je=="selection"?Te=!0:(((m=f[je.id])!==null&&m!==void 0?m:1)&1)==0&&De.push(f[je.id]);return{create(je){return je.values[V]=E(je),1},update(je,nt){if(ce&&nt.docChanged||Te&&(nt.docChanged||nt.selection)||rt(je,De)){let it=E(je);if(ee?!ze(it,je.values[V],C):!C(it,je.values[V]))return je.values[V]=it,1}return 0},reconfigure:(je,nt)=>{let it,zt=nt.config.address[B];if(zt!=null){let An=oe(nt,zt);if(this.dependencies.every(on=>on instanceof Mt?nt.facet(on)===je.facet(on):on instanceof st?nt.field(on,!1)==je.field(on,!1):!0)||(ee?ze(it=E(je),An,C):C(it=E(je),An)))return je.values[V]=An,0}else it=E(je);return je.values[V]=it,1}}}}function ze(q,f,m){if(q.length!=f.length)return!1;for(let E=0;E<q.length;E++)if(!m(q[E],f[E]))return!1;return!0}function rt(q,f){let m=!1;for(let E of f)sn(q,E)&1&&(m=!0);return m}function tt(q,f,m){let E=m.map(ce=>q[ce.id]),C=m.map(ce=>ce.type),B=E.filter(ce=>!(ce&1)),V=q[f.id]>>1;function ee(ce){let Te=[];for(let De=0;De<E.length;De++){let je=oe(ce,E[De]);if(C[De]==2)for(let nt of je)Te.push(nt);else Te.push(je)}return f.combine(Te)}return{create(ce){for(let Te of E)sn(ce,Te);return ce.values[V]=ee(ce),1},update(ce,Te){if(!rt(ce,B))return 0;let De=ee(ce);return f.compare(De,ce.values[V])?0:(ce.values[V]=De,1)},reconfigure(ce,Te){let De=rt(ce,E),je=Te.config.facets[f.id],nt=Te.facet(f);if(je&&!De&&Je(m,je))return ce.values[V]=nt,0;let it=ee(ce);return f.compare(it,nt)?(ce.values[V]=nt,0):(ce.values[V]=it,1)}}}const Ye=Mt.define({static:!0});class st{constructor(f,m,E,C,B){this.id=f,this.createF=m,this.updateF=E,this.compareF=C,this.spec=B,this.provides=void 0}static define(f){let m=new st(qe++,f.create,f.update,f.compare||((E,C)=>E===C),f);return f.provide&&(m.provides=f.provide(m)),m}create(f){let m=f.facet(Ye).find(E=>E.field==this);return(m?.create||this.createF)(f)}slot(f){let m=f[this.id]>>1;return{create:E=>(E.values[m]=this.create(E),1),update:(E,C)=>{let B=E.values[m],V=this.updateF(B,C);return this.compareF(B,V)?0:(E.values[m]=V,1)},reconfigure:(E,C)=>{let B=E.facet(Ye),V=C.facet(Ye),ee;return(ee=B.find(ce=>ce.field==this))&&ee!=V.find(ce=>ce.field==this)?(E.values[m]=ee.create(E),1):C.config.address[this.id]!=null?(E.values[m]=C.field(this),0):(E.values[m]=this.create(E),1)}}}init(f){return[this,Ye.of({field:this,create:f})]}get extension(){return this}}const Nt={lowest:4,low:3,default:2,high:1,highest:0};function jt(q){return f=>new yt(f,q)}const Ct={highest:jt(Nt.highest),high:jt(Nt.high),default:jt(Nt.default),low:jt(Nt.low),lowest:jt(Nt.lowest)};class yt{constructor(f,m){this.inner=f,this.prec=m}}class wt{of(f){return new Pt(this,f)}reconfigure(f){return wt.reconfigure.of({compartment:this,extension:f})}get(f){return f.config.compartments.get(this)}}class Pt{constructor(f,m){this.compartment=f,this.inner=m}}class It{constructor(f,m,E,C,B,V){for(this.base=f,this.compartments=m,this.dynamicSlots=E,this.address=C,this.staticValues=B,this.facets=V,this.statusTemplate=[];this.statusTemplate.length<E.length;)this.statusTemplate.push(0)}staticFacet(f){let m=this.address[f.id];return m==null?f.default:this.staticValues[m>>1]}static resolve(f,m,E){let C=[],B=Object.create(null),V=new Map;for(let nt of gn(f,m,V))nt instanceof st?C.push(nt):(B[nt.facet.id]||(B[nt.facet.id]=[])).push(nt);let ee=Object.create(null),ce=[],Te=[];for(let nt of C)ee[nt.id]=Te.length<<1,Te.push(it=>nt.slot(it));let De=E?.config.facets;for(let nt in B){let it=B[nt],zt=it[0].facet,An=De&&De[nt]||[];if(it.every(on=>on.type==0))if(ee[zt.id]=ce.length<<1|1,Je(An,it))ce.push(E.facet(zt));else{let on=zt.combine(it.map(Zn=>Zn.value));ce.push(E&&zt.compare(on,E.facet(zt))?E.facet(zt):on)}else{for(let on of it)on.type==0?(ee[on.id]=ce.length<<1|1,ce.push(on.value)):(ee[on.id]=Te.length<<1,Te.push(Zn=>on.dynamicSlot(Zn)));ee[zt.id]=Te.length<<1,Te.push(on=>tt(on,zt,it))}}let je=Te.map(nt=>nt(ee));return new It(f,V,je,ee,ce,B)}}function gn(q,f,m){let E=[[],[],[],[],[]],C=new Map;function B(V,ee){let ce=C.get(V);if(ce!=null){if(ce<=ee)return;let Te=E[ce].indexOf(V);Te>-1&&E[ce].splice(Te,1),V instanceof Pt&&m.delete(V.compartment)}if(C.set(V,ee),Array.isArray(V))for(let Te of V)B(Te,ee);else if(V instanceof Pt){if(m.has(V.compartment))throw new RangeError("Duplicate use of compartment in extensions");let Te=f.get(V.compartment)||V.inner;m.set(V.compartment,Te),B(Te,ee)}else if(V instanceof yt)B(V.inner,V.prec);else if(V instanceof st)E[ee].push(V),V.provides&&B(V.provides,ee);else if(V instanceof we)E[ee].push(V),V.facet.extensions&&B(V.facet.extensions,Nt.default);else{let Te=V.extension;if(!Te)throw new Error(`Unrecognized extension value in extension set (${V}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);B(Te,ee)}}return B(q,Nt.default),E.reduce((V,ee)=>V.concat(ee))}function sn(q,f){if(f&1)return 2;let m=f>>1,E=q.status[m];if(E==4)throw new Error("Cyclic dependency between fields and/or facets");if(E&2)return E;q.status[m]=4;let C=q.computeSlot(q,q.config.dynamicSlots[m]);return q.status[m]=2|C}function oe(q,f){return f&1?q.config.staticValues[f>>1]:q.values[f>>1]}const b=Mt.define(),T=Mt.define({combine:q=>q.some(f=>f),static:!0}),L=Mt.define({combine:q=>q.length?q[0]:void 0,static:!0}),O=Mt.define(),H=Mt.define(),re=Mt.define(),me=Mt.define({combine:q=>q.length?q[0]:!1});class Ee{constructor(f,m){this.type=f,this.value=m}static define(){return new Fe}}class Fe{of(f){return new Ee(this,f)}}class Be{constructor(f){this.map=f}of(f){return new Ue(this,f)}}class Ue{constructor(f,m){this.type=f,this.value=m}map(f){let m=this.type.map(this.value,f);return m===void 0?void 0:m==this.value?this:new Ue(this.type,m)}is(f){return this.type==f}static define(f={}){return new Be(f.map||(m=>m))}static mapEffects(f,m){if(!f.length)return f;let E=[];for(let C of f){let B=C.map(m);B&&E.push(B)}return E}}Ue.reconfigure=Ue.define(),Ue.appendConfig=Ue.define();class He{constructor(f,m,E,C,B,V){this.startState=f,this.changes=m,this.selection=E,this.effects=C,this.annotations=B,this.scrollIntoView=V,this._doc=null,this._state=null,E&&Vt(E,m.newLength),B.some(ee=>ee.type==He.time)||(this.annotations=B.concat(He.time.of(Date.now())))}static create(f,m,E,C,B,V){return new He(f,m,E,C,B,V)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(f){for(let m of this.annotations)if(m.type==f)return m.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(f){let m=this.annotation(He.userEvent);return!!(m&&(m==f||m.length>f.length&&m.slice(0,f.length)==f&&m[f.length]=="."))}}He.time=Ee.define(),He.userEvent=Ee.define(),He.addToHistory=Ee.define(),He.remote=Ee.define();function Ze(q,f){let m=[];for(let E=0,C=0;;){let B,V;if(E<q.length&&(C==f.length||f[C]>=q[E]))B=q[E++],V=q[E++];else if(C<f.length)B=f[C++],V=f[C++];else return m;!m.length||m[m.length-1]<B?m.push(B,V):m[m.length-1]<V&&(m[m.length-1]=V)}}function lt(q,f,m){var E;let C,B,V;return m?(C=f.changes,B=ot.empty(f.changes.length),V=q.changes.compose(f.changes)):(C=f.changes.map(q.changes),B=q.changes.mapDesc(f.changes,!0),V=q.changes.compose(C)),{changes:V,selection:f.selection?f.selection.map(B):(E=q.selection)===null||E===void 0?void 0:E.map(C),effects:Ue.mapEffects(q.effects,C).concat(Ue.mapEffects(f.effects,B)),annotations:q.annotations.length?q.annotations.concat(f.annotations):f.annotations,scrollIntoView:q.scrollIntoView||f.scrollIntoView}}function qt(q,f,m){let E=f.selection,C=en(f.annotations);return f.userEvent&&(C=C.concat(He.userEvent.of(f.userEvent))),{changes:f.changes instanceof ot?f.changes:ot.of(f.changes||[],m,q.facet(L)),selection:E&&(E instanceof pt?E:pt.single(E.anchor,E.head)),effects:en(f.effects),annotations:C,scrollIntoView:!!f.scrollIntoView}}function gt(q,f,m){let E=qt(q,f.length?f[0]:{},q.doc.length);f.length&&f[0].filter===!1&&(m=!1);for(let B=1;B<f.length;B++){f[B].filter===!1&&(m=!1);let V=!!f[B].sequential;E=lt(E,qt(q,f[B],V?E.changes.newLength:q.doc.length),V)}let C=He.create(q,E.changes,E.selection,E.effects,E.annotations,E.scrollIntoView);return ht(m?kt(C):C)}function kt(q){let f=q.startState,m=!0;for(let C of f.facet(O)){let B=C(q);if(B===!1){m=!1;break}Array.isArray(B)&&(m=m===!0?B:Ze(m,B))}if(m!==!0){let C,B;if(m===!1)B=q.changes.invertedDesc,C=ot.empty(f.doc.length);else{let V=q.changes.filter(m);C=V.changes,B=V.filtered.mapDesc(V.changes).invertedDesc}q=He.create(f,C,q.selection&&q.selection.map(B),Ue.mapEffects(q.effects,B),q.annotations,q.scrollIntoView)}let E=f.facet(H);for(let C=E.length-1;C>=0;C--){let B=E[C](q);B instanceof He?q=B:Array.isArray(B)&&B.length==1&&B[0]instanceof He?q=B[0]:q=gt(f,en(B),!1)}return q}function ht(q){let f=q.startState,m=f.facet(re),E=q;for(let C=m.length-1;C>=0;C--){let B=m[C](q);B&&Object.keys(B).length&&(E=lt(E,qt(f,B,q.changes.newLength),!0))}return E==q?q:He.create(f,q.changes,q.selection,E.effects,E.annotations,E.scrollIntoView)}const Ft=[];function en(q){return q==null?Ft:Array.isArray(q)?q:[q]}e.CharCategory=void 0,function(q){q[q.Word=0]="Word",q[q.Space=1]="Space",q[q.Other=2]="Other"}(e.CharCategory||(e.CharCategory={}));const At=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let Lt;try{Lt=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function J(q){if(Lt)return Lt.test(q);for(let f=0;f<q.length;f++){let m=q[f];if(/\w/.test(m)||m>"Â€"&&(m.toUpperCase()!=m.toLowerCase()||At.test(m)))return!0}return!1}function j(q){return f=>{if(!/\S/.test(f))return e.CharCategory.Space;if(J(f))return e.CharCategory.Word;for(let m=0;m<q.length;m++)if(f.indexOf(q[m])>-1)return e.CharCategory.Word;return e.CharCategory.Other}}class G{constructor(f,m,E,C,B,V){this.config=f,this.doc=m,this.selection=E,this.values=C,this.status=f.statusTemplate.slice(),this.computeSlot=B,V&&(V._state=this);for(let ee=0;ee<this.config.dynamicSlots.length;ee++)sn(this,ee<<1);this.computeSlot=null}field(f,m=!0){let E=this.config.address[f.id];if(E==null){if(m)throw new RangeError("Field is not present in this state");return}return sn(this,E),oe(this,E)}update(...f){return gt(this,f,!0)}applyTransaction(f){let m=this.config,{base:E,compartments:C}=m;for(let ee of f.effects)ee.is(wt.reconfigure)?(m&&(C=new Map,m.compartments.forEach((ce,Te)=>C.set(Te,ce)),m=null),C.set(ee.value.compartment,ee.value.extension)):ee.is(Ue.reconfigure)?(m=null,E=ee.value):ee.is(Ue.appendConfig)&&(m=null,E=en(E).concat(ee.value));let B;m?B=f.startState.values.slice():(m=It.resolve(E,C,this),B=new G(m,this.doc,this.selection,m.dynamicSlots.map(()=>null),(ce,Te)=>Te.reconfigure(ce,this),null).values);let V=f.startState.facet(T)?f.newSelection:f.newSelection.asSingle();new G(m,f.newDoc,V,B,(ee,ce)=>ce.update(ee,f),f)}replaceSelection(f){return typeof f=="string"&&(f=this.toText(f)),this.changeByRange(m=>({changes:{from:m.from,to:m.to,insert:f},range:pt.cursor(m.from+f.length)}))}changeByRange(f){let m=this.selection,E=f(m.ranges[0]),C=this.changes(E.changes),B=[E.range],V=en(E.effects);for(let ee=1;ee<m.ranges.length;ee++){let ce=f(m.ranges[ee]),Te=this.changes(ce.changes),De=Te.map(C);for(let nt=0;nt<ee;nt++)B[nt]=B[nt].map(De);let je=C.mapDesc(Te,!0);B.push(ce.range.map(je)),C=C.compose(De),V=Ue.mapEffects(V,De).concat(Ue.mapEffects(en(ce.effects),je))}return{changes:C,selection:pt.create(B,m.mainIndex),effects:V}}changes(f=[]){return f instanceof ot?f:ot.of(f,this.doc.length,this.facet(G.lineSeparator))}toText(f){return r.of(f.split(this.facet(G.lineSeparator)||Ge))}sliceDoc(f=0,m=this.doc.length){return this.doc.sliceString(f,m,this.lineBreak)}facet(f){let m=this.config.address[f.id];return m==null?f.default:(sn(this,m),oe(this,m))}toJSON(f){let m={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(f)for(let E in f){let C=f[E];C instanceof st&&this.config.address[C.id]!=null&&(m[E]=C.spec.toJSON(this.field(f[E]),this))}return m}static fromJSON(f,m={},E){if(!f||typeof f.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let C=[];if(E){for(let B in E)if(Object.prototype.hasOwnProperty.call(f,B)){let V=E[B],ee=f[B];C.push(V.init(ce=>V.spec.fromJSON(ee,ce)))}}return G.create({doc:f.doc,selection:pt.fromJSON(f.selection),extensions:m.extensions?C.concat([m.extensions]):C})}static create(f={}){let m=It.resolve(f.extensions||[],new Map),E=f.doc instanceof r?f.doc:r.of((f.doc||"").split(m.staticFacet(G.lineSeparator)||Ge)),C=f.selection?f.selection instanceof pt?f.selection:pt.single(f.selection.anchor,f.selection.head):pt.single(0);return Vt(C,E.length),m.staticFacet(T)||(C=C.asSingle()),new G(m,E,C,m.dynamicSlots.map(()=>null),(B,V)=>V.create(B),null)}get tabSize(){return this.facet(G.tabSize)}get lineBreak(){return this.facet(G.lineSeparator)||`
`}get readOnly(){return this.facet(me)}phrase(f,...m){for(let E of this.facet(G.phrases))if(Object.prototype.hasOwnProperty.call(E,f)){f=E[f];break}return m.length&&(f=f.replace(/\$(\$|\d*)/g,(E,C)=>{if(C=="$")return"$";let B=+(C||1);return!B||B>m.length?E:m[B-1]})),f}languageDataAt(f,m,E=-1){let C=[];for(let B of this.facet(b))for(let V of B(this,m,E))Object.prototype.hasOwnProperty.call(V,f)&&C.push(V[f]);return C}charCategorizer(f){return j(this.languageDataAt("wordChars",f).join(""))}wordAt(f){let{text:m,from:E,length:C}=this.doc.lineAt(f),B=this.charCategorizer(f),V=f-E,ee=f-E;for(;V>0;){let ce=te(m,V,!1);if(B(m.slice(ce,V))!=e.CharCategory.Word)break;V=ce}for(;ee<C;){let ce=te(m,ee);if(B(m.slice(ee,ce))!=e.CharCategory.Word)break;ee=ce}return V==ee?null:pt.range(V+E,ee+E)}}G.allowMultipleSelections=T,G.tabSize=Mt.define({combine:q=>q.length?q[0]:4}),G.lineSeparator=L,G.readOnly=me,G.phrases=Mt.define({compare(q,f){let m=Object.keys(q),E=Object.keys(f);return m.length==E.length&&m.every(C=>q[C]==f[C])}}),G.languageData=b,G.changeFilter=O,G.transactionFilter=H,G.transactionExtender=re,wt.reconfigure=Ue.define();function se(q,f,m={}){let E={};for(let C of q)for(let B of Object.keys(C)){let V=C[B],ee=E[B];if(ee===void 0)E[B]=V;else if(!(ee===V||V===void 0))if(Object.hasOwnProperty.call(m,B))E[B]=m[B](ee,V);else throw new Error("Config merge conflict for field "+B)}for(let C in f)E[C]===void 0&&(E[C]=f[C]);return E}class le{eq(f){return this==f}range(f,m=f){return fe.create(f,m,this)}}le.prototype.startSide=le.prototype.endSide=0,le.prototype.point=!1,le.prototype.mapMode=e.MapMode.TrackDel;class fe{constructor(f,m,E){this.from=f,this.to=m,this.value=E}static create(f,m,E){return new fe(f,m,E)}}function Ie(q,f){return q.from-f.from||q.value.startSide-f.value.startSide}class _e{constructor(f,m,E,C){this.from=f,this.to=m,this.value=E,this.maxPoint=C}get length(){return this.to[this.to.length-1]}findIndex(f,m,E,C=0){let B=E?this.to:this.from;for(let V=C,ee=B.length;;){if(V==ee)return V;let ce=V+ee>>1,Te=B[ce]-f||(E?this.value[ce].endSide:this.value[ce].startSide)-m;if(ce==V)return Te>=0?V:ee;Te>=0?ee=ce:V=ce+1}}between(f,m,E,C){for(let B=this.findIndex(m,-1e9,!0),V=this.findIndex(E,1e9,!1,B);B<V;B++)if(C(this.from[B]+f,this.to[B]+f,this.value[B])===!1)return!1}map(f,m){let E=[],C=[],B=[],V=-1,ee=-1;for(let ce=0;ce<this.value.length;ce++){let Te=this.value[ce],De=this.from[ce]+f,je=this.to[ce]+f,nt,it;if(De==je){let zt=m.mapPos(De,Te.startSide,Te.mapMode);if(zt==null||(nt=it=zt,Te.startSide!=Te.endSide&&(it=m.mapPos(De,Te.endSide),it<nt)))continue}else if(nt=m.mapPos(De,Te.startSide),it=m.mapPos(je,Te.endSide),nt>it||nt==it&&Te.startSide>0&&Te.endSide<=0)continue;(it-nt||Te.endSide-Te.startSide)<0||(V<0&&(V=nt),Te.point&&(ee=Math.max(ee,it-nt)),E.push(Te),C.push(nt-V),B.push(it-V))}return{mapped:E.length?new _e(C,B,E,ee):null,pos:V}}}class Pe{constructor(f,m,E,C){this.chunkPos=f,this.chunk=m,this.nextLayer=E,this.maxPoint=C}static create(f,m,E,C){return new Pe(f,m,E,C)}get length(){let f=this.chunk.length-1;return f<0?0:Math.max(this.chunkEnd(f),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let f=this.nextLayer.size;for(let m of this.chunk)f+=m.value.length;return f}chunkEnd(f){return this.chunkPos[f]+this.chunk[f].length}update(f){let{add:m=[],sort:E=!1,filterFrom:C=0,filterTo:B=this.length}=f,V=f.filter;if(m.length==0&&!V)return this;if(E&&(m=m.slice().sort(Ie)),this.isEmpty)return m.length?Pe.of(m):this;let ee=new yn(this,null,-1).goto(0),ce=0,Te=[],De=new Ut;for(;ee.value||ce<m.length;)if(ce<m.length&&(ee.from-m[ce].from||ee.startSide-m[ce].value.startSide)>=0){let je=m[ce++];De.addInner(je.from,je.to,je.value)||Te.push(je)}else ee.rangeIndex==1&&ee.chunkIndex<this.chunk.length&&(ce==m.length||this.chunkEnd(ee.chunkIndex)<m[ce].from)&&(!V||C>this.chunkEnd(ee.chunkIndex)||B<this.chunkPos[ee.chunkIndex])&&De.addChunk(this.chunkPos[ee.chunkIndex],this.chunk[ee.chunkIndex])?ee.nextChunk():((!V||C>ee.to||B<ee.from||V(ee.from,ee.to,ee.value))&&(De.addInner(ee.from,ee.to,ee.value)||Te.push(fe.create(ee.from,ee.to,ee.value))),ee.next());return De.finishInner(this.nextLayer.isEmpty&&!Te.length?Pe.empty:this.nextLayer.update({add:Te,filter:V,filterFrom:C,filterTo:B}))}map(f){if(f.empty||this.isEmpty)return this;let m=[],E=[],C=-1;for(let V=0;V<this.chunk.length;V++){let ee=this.chunkPos[V],ce=this.chunk[V],Te=f.touchesRange(ee,ee+ce.length);if(Te===!1)C=Math.max(C,ce.maxPoint),m.push(ce),E.push(f.mapPos(ee));else if(Te===!0){let{mapped:De,pos:je}=ce.map(ee,f);De&&(C=Math.max(C,De.maxPoint),m.push(De),E.push(je))}}let B=this.nextLayer.map(f);return m.length==0?B:new Pe(E,m,B||Pe.empty,C)}between(f,m,E){if(!this.isEmpty){for(let C=0;C<this.chunk.length;C++){let B=this.chunkPos[C],V=this.chunk[C];if(m>=B&&f<=B+V.length&&V.between(B,f-B,m-B,E)===!1)return}this.nextLayer.between(f,m,E)}}iter(f=0){return un.from([this]).goto(f)}get isEmpty(){return this.nextLayer==this}static iter(f,m=0){return un.from(f).goto(m)}static compare(f,m,E,C,B=-1){let V=f.filter(je=>je.maxPoint>0||!je.isEmpty&&je.maxPoint>=B),ee=m.filter(je=>je.maxPoint>0||!je.isEmpty&&je.maxPoint>=B),ce=cn(V,ee,E),Te=new Ht(V,ce,B),De=new Ht(ee,ce,B);E.iterGaps((je,nt,it)=>pn(Te,je,De,nt,it,C)),E.empty&&E.length==0&&pn(Te,0,De,0,0,C)}static eq(f,m,E=0,C){C==null&&(C=999999999);let B=f.filter(De=>!De.isEmpty&&m.indexOf(De)<0),V=m.filter(De=>!De.isEmpty&&f.indexOf(De)<0);if(B.length!=V.length)return!1;if(!B.length)return!0;let ee=cn(B,V),ce=new Ht(B,ee,0).goto(E),Te=new Ht(V,ee,0).goto(E);for(;;){if(ce.to!=Te.to||!dn(ce.active,Te.active)||ce.point&&(!Te.point||!ce.point.eq(Te.point)))return!1;if(ce.to>C)return!0;ce.next(),Te.next()}}static spans(f,m,E,C,B=-1){let V=new Ht(f,null,B).goto(m),ee=m,ce=V.openStart;for(;;){let Te=Math.min(V.to,E);if(V.point){let De=V.activeForPoint(V.to),je=V.pointFrom<m?De.length+1:V.point.startSide<0?De.length:Math.min(De.length,ce);C.point(ee,Te,V.point,De,je,V.pointRank),ce=Math.min(V.openEnd(Te),De.length)}else Te>ee&&(C.span(ee,Te,V.active,ce),ce=V.openEnd(Te));if(V.to>E)return ce+(V.point&&V.to>E?1:0);ee=V.to,V.next()}}static of(f,m=!1){let E=new Ut;for(let C of f instanceof fe?[f]:m?Rt(f):f)E.add(C.from,C.to,C.value);return E.finish()}static join(f){if(!f.length)return Pe.empty;let m=f[f.length-1];for(let E=f.length-2;E>=0;E--)for(let C=f[E];C!=Pe.empty;C=C.nextLayer)m=new Pe(C.chunkPos,C.chunk,m,Math.max(C.maxPoint,m.maxPoint));return m}}Pe.empty=new Pe([],[],null,-1);function Rt(q){if(q.length>1)for(let f=q[0],m=1;m<q.length;m++){let E=q[m];if(Ie(f,E)>0)return q.slice().sort(Ie);f=E}return q}Pe.empty.nextLayer=Pe.empty;class Ut{finishChunk(f){this.chunks.push(new _e(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,f&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(f,m,E){this.addInner(f,m,E)||(this.nextLayer||(this.nextLayer=new Ut)).add(f,m,E)}addInner(f,m,E){let C=f-this.lastTo||E.startSide-this.last.endSide;if(C<=0&&(f-this.lastFrom||E.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return C<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=f),this.from.push(f-this.chunkStart),this.to.push(m-this.chunkStart),this.last=E,this.lastFrom=f,this.lastTo=m,this.value.push(E),E.point&&(this.maxPoint=Math.max(this.maxPoint,m-f)),!0)}addChunk(f,m){if((f-this.lastTo||m.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,m.maxPoint),this.chunks.push(m),this.chunkPos.push(f);let E=m.value.length-1;return this.last=m.value[E],this.lastFrom=m.from[E]+f,this.lastTo=m.to[E]+f,!0}finish(){return this.finishInner(Pe.empty)}finishInner(f){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return f;let m=Pe.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(f):f,this.setMaxPoint);return this.from=null,m}}function cn(q,f,m){let E=new Map;for(let B of q)for(let V=0;V<B.chunk.length;V++)B.chunk[V].maxPoint<=0&&E.set(B.chunk[V],B.chunkPos[V]);let C=new Set;for(let B of f)for(let V=0;V<B.chunk.length;V++){let ee=E.get(B.chunk[V]);ee!=null&&(m?m.mapPos(ee):ee)==B.chunkPos[V]&&!m?.touchesRange(ee,ee+B.chunk[V].length)&&C.add(B.chunk[V])}return C}class yn{constructor(f,m,E,C=0){this.layer=f,this.skip=m,this.minPoint=E,this.rank=C}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(f,m=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(f,m,!1),this}gotoInner(f,m,E){for(;this.chunkIndex<this.layer.chunk.length;){let C=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(C)||this.layer.chunkEnd(this.chunkIndex)<f||C.maxPoint<this.minPoint))break;this.chunkIndex++,E=!1}if(this.chunkIndex<this.layer.chunk.length){let C=this.layer.chunk[this.chunkIndex].findIndex(f-this.layer.chunkPos[this.chunkIndex],m,!0);(!E||this.rangeIndex<C)&&this.setRangeIndex(C)}this.next()}forward(f,m){(this.to-f||this.endSide-m)<0&&this.gotoInner(f,m,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let f=this.layer.chunkPos[this.chunkIndex],m=this.layer.chunk[this.chunkIndex],E=f+m.from[this.rangeIndex];if(this.from=E,this.to=f+m.to[this.rangeIndex],this.value=m.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(f){if(f==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=f}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(f){return this.from-f.from||this.startSide-f.startSide||this.rank-f.rank||this.to-f.to||this.endSide-f.endSide}}class un{constructor(f){this.heap=f}static from(f,m=null,E=-1){let C=[];for(let B=0;B<f.length;B++)for(let V=f[B];!V.isEmpty;V=V.nextLayer)V.maxPoint>=E&&C.push(new yn(V,m,E,B));return C.length==1?C[0]:new un(C)}get startSide(){return this.value?this.value.startSide:0}goto(f,m=-1e9){for(let E of this.heap)E.goto(f,m);for(let E=this.heap.length>>1;E>=0;E--)$t(this.heap,E);return this.next(),this}forward(f,m){for(let E of this.heap)E.forward(f,m);for(let E=this.heap.length>>1;E>=0;E--)$t(this.heap,E);(this.to-f||this.value.endSide-m)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let f=this.heap[0];this.from=f.from,this.to=f.to,this.value=f.value,this.rank=f.rank,f.value&&f.next(),$t(this.heap,0)}}}function $t(q,f){for(let m=q[f];;){let E=(f<<1)+1;if(E>=q.length)break;let C=q[E];if(E+1<q.length&&C.compare(q[E+1])>=0&&(C=q[E+1],E++),m.compare(C)<0)break;q[E]=m,q[f]=C,f=E}}class Ht{constructor(f,m,E){this.minPoint=E,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=un.from(f,m,E)}goto(f,m=-1e9){return this.cursor.goto(f,m),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=f,this.endSide=m,this.openStart=-1,this.next(),this}forward(f,m){for(;this.minActive>-1&&(this.activeTo[this.minActive]-f||this.active[this.minActive].endSide-m)<0;)this.removeActive(this.minActive);this.cursor.forward(f,m)}removeActive(f){On(this.active,f),On(this.activeTo,f),On(this.activeRank,f),this.minActive=Xn(this.active,this.activeTo)}addActive(f){let m=0,{value:E,to:C,rank:B}=this.cursor;for(;m<this.activeRank.length&&(B-this.activeRank[m]||C-this.activeTo[m])>0;)m++;Ot(this.active,m,E),Ot(this.activeTo,m,C),Ot(this.activeRank,m,B),f&&Ot(f,m,this.cursor.from),this.minActive=Xn(this.active,this.activeTo)}next(){let f=this.to,m=this.point;this.point=null;let E=this.openStart<0?[]:null;for(;;){let C=this.minActive;if(C>-1&&(this.activeTo[C]-this.cursor.from||this.active[C].endSide-this.cursor.startSide)<0){if(this.activeTo[C]>f){this.to=this.activeTo[C],this.endSide=this.active[C].endSide;break}this.removeActive(C),E&&On(E,C)}else if(this.cursor.value)if(this.cursor.from>f){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let B=this.cursor.value;if(!B.point)this.addActive(E),this.cursor.next();else if(m&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=B,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=B.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(E){this.openStart=0;for(let C=E.length-1;C>=0&&E[C]<f;C--)this.openStart++}}activeForPoint(f){if(!this.active.length)return this.active;let m=[];for(let E=this.active.length-1;E>=0&&!(this.activeRank[E]<this.pointRank);E--)(this.activeTo[E]>f||this.activeTo[E]==f&&this.active[E].endSide>=this.point.endSide)&&m.push(this.active[E]);return m.reverse()}openEnd(f){let m=0;for(let E=this.activeTo.length-1;E>=0&&this.activeTo[E]>f;E--)m++;return m}}function pn(q,f,m,E,C,B){q.goto(f),m.goto(E);let V=E+C,ee=E,ce=E-f;for(;;){let Te=q.to+ce-m.to,De=Te||q.endSide-m.endSide,je=De<0?q.to+ce:m.to,nt=Math.min(je,V);if(q.point||m.point?q.point&&m.point&&(q.point==m.point||q.point.eq(m.point))&&dn(q.activeForPoint(q.to),m.activeForPoint(m.to))||B.comparePoint(ee,nt,q.point,m.point):nt>ee&&!dn(q.active,m.active)&&B.compareRange(ee,nt,q.active,m.active),je>V)break;(Te||q.openEnd!=m.openEnd)&&B.boundChange&&B.boundChange(je),ee=je,De<=0&&q.next(),De>=0&&m.next()}}function dn(q,f){if(q.length!=f.length)return!1;for(let m=0;m<q.length;m++)if(q[m]!=f[m]&&!q[m].eq(f[m]))return!1;return!0}function On(q,f){for(let m=f,E=q.length-1;m<E;m++)q[m]=q[m+1];q.pop()}function Ot(q,f,m){for(let E=q.length-1;E>=f;E--)q[E+1]=q[E];q[f]=m}function Xn(q,f){let m=-1,E=1e9;for(let C=0;C<f.length;C++)(f[C]-E||q[C].endSide-q[m].endSide)<0&&(m=C,E=f[C]);return m}function Ei(q,f,m=q.length){let E=0;for(let C=0;C<m&&C<q.length;)q.charCodeAt(C)==9?(E+=f-E%f,C++):(E++,C=te(q,C));return E}function Ai(q,f,m,E){for(let C=0,B=0;;){if(B>=f)return C;if(C==q.length)break;B+=q.charCodeAt(C)==9?m-B%m:1,C=te(q,C)}return E===!0?-1:q.length}e.Annotation=Ee,e.AnnotationType=Fe,e.ChangeDesc=We,e.ChangeSet=ot,e.Compartment=wt,e.EditorSelection=pt,e.EditorState=G,e.Facet=Mt,e.Line=z,e.Prec=Ct,e.Range=fe,e.RangeSet=Pe,e.RangeSetBuilder=Ut,e.RangeValue=le,e.SelectionRange=Kt,e.StateEffect=Ue,e.StateEffectType=Be,e.StateField=st,e.Text=r,e.Transaction=He,e.codePointAt=Se,e.codePointSize=Qe,e.combineConfig=se,e.countColumn=Ei,e.findClusterBreak=te,e.findColumn=Ai,e.fromCodePoint=xe}(tl)),tl}var nl={},ac;function Wu(){if(ac)return nl;ac=1;var e="Í¼",n=typeof Symbol>"u"?"__"+e:Symbol.for(e),r=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),o=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{},l=nl.StyleModule=function(D,R){this.rules=[];var W=R||{},z=W.finish;function ne(Ne){return/^@/.test(Ne)?[Ne]:Ne.split(/,\s*/)}function te(Ne,Se,xe,Qe){var Ge=[],We=/^@(\w+)\b/.exec(Ne[0]),ot=We&&We[1]=="keyframes";if(We&&Se==null)return xe.push(Ne[0]+";");for(var ft in Se){var Et=Se[ft];if(/&/.test(ft))te(ft.split(/,\s*/).map(function(ut){return Ne.map(function(rn){return ut.replace(/&/,rn)})}).reduce(function(ut,rn){return ut.concat(rn)}),Et,xe);else if(Et&&typeof Et=="object"){if(!We)throw new RangeError("The value of a property ("+ft+") should be a primitive value.");te(ne(ft),Et,Ge,ot)}else Et!=null&&Ge.push(ft.replace(/_.*/,"").replace(/[A-Z]/g,function(ut){return"-"+ut.toLowerCase()})+": "+Et+";")}(Ge.length||ot)&&xe.push((z&&!We&&!Qe?Ne.map(z):Ne).join(", ")+" {"+Ge.join(" ")+"}")}for(var be in D)te(ne(be),D[be],this.rules)};l.prototype.getRules=function(){return this.rules.join(`
`)},l.newName=function(){var D=o[n]||1;return o[n]=D+1,e+D.toString(36)},l.mount=function(D,R,W){var z=D[r],ne=W&&W.nonce;z?ne&&z.setNonce(ne):z=new y(D,ne),z.mount(Array.isArray(R)?R:[R],D)};var h=new Map,y=function(D,R){var W=D.ownerDocument||D,z=W.defaultView;if(!D.head&&D.adoptedStyleSheets&&z.CSSStyleSheet){var ne=h.get(W);if(ne)return D[r]=ne;this.sheet=new z.CSSStyleSheet,h.set(W,this)}else this.styleTag=W.createElement("style"),R&&this.styleTag.setAttribute("nonce",R);this.modules=[],D[r]=this};return y.prototype.mount=function(D,R){for(var W=this.sheet,z=0,ne=0,te=0;te<D.length;te++){var be=D[te],Ne=this.modules.indexOf(be);if(Ne<ne&&Ne>-1&&(this.modules.splice(Ne,1),ne--,Ne=-1),Ne==-1){if(this.modules.splice(ne++,0,be),W)for(var Se=0;Se<be.rules.length;Se++)W.insertRule(be.rules[Se],z++)}else{for(;ne<Ne;)z+=this.modules[ne++].rules.length;z+=be.rules.length,ne++}}if(W)R.adoptedStyleSheets.indexOf(this.sheet)<0&&(R.adoptedStyleSheets=[this.sheet].concat(R.adoptedStyleSheets));else{for(var xe="",Qe=0;Qe<this.modules.length;Qe++)xe+=this.modules[Qe].getRules()+`
`;this.styleTag.textContent=xe;var Ge=R.head||R;this.styleTag.parentNode!=Ge&&Ge.insertBefore(this.styleTag,Ge.firstChild)}},y.prototype.setNonce=function(D){this.styleTag&&this.styleTag.getAttribute("nonce")!=D&&this.styleTag.setAttribute("nonce",D)},nl}var ur={},cc;function ap(){if(cc)return ur;cc=1,Object.defineProperty(ur,"__esModule",{value:!0});for(var e={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},n={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},r=typeof navigator<"u"&&/Mac/.test(navigator.platform),o=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),l=0;l<10;l++)e[48+l]=e[96+l]=String(l);for(var l=1;l<=24;l++)e[l+111]="F"+l;for(var l=65;l<=90;l++)e[l]=String.fromCharCode(l+32),n[l]=String.fromCharCode(l);for(var h in e)n.hasOwnProperty(h)||(n[h]=e[h]);function y(N){var D=r&&N.metaKey&&N.shiftKey&&!N.ctrlKey&&!N.altKey||o&&N.shiftKey&&N.key&&N.key.length==1||N.key=="Unidentified",R=!D&&N.key||(N.shiftKey?n:e)[N.keyCode]||N.key||"Unidentified";return R=="Esc"&&(R="Escape"),R=="Del"&&(R="Delete"),R=="Left"&&(R="ArrowLeft"),R=="Up"&&(R="ArrowUp"),R=="Right"&&(R="ArrowRight"),R=="Down"&&(R="ArrowDown"),R}return ur.base=e,ur.keyName=y,ur.shift=n,ur}var il,uc;function Vl(){if(uc)return il;uc=1;function e(){var r=arguments[0];typeof r=="string"&&(r=document.createElement(r));var o=1,l=arguments[1];if(l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)){for(var h in l)if(Object.prototype.hasOwnProperty.call(l,h)){var y=l[h];typeof y=="string"?r.setAttribute(h,y):y!=null&&(r[h]=y)}o++}for(;o<arguments.length;o++)n(r,arguments[o]);return r}function n(r,o){if(typeof o=="string")r.appendChild(document.createTextNode(o));else if(o!=null)if(o.nodeType!=null)r.appendChild(o);else if(Array.isArray(o))for(var l=0;l<o.length;l++)n(r,o[l]);else throw new RangeError("Unsupported child node: "+o)}return il=e,il}var hc;function Nr(){return hc||(hc=1,function(e){var n=tr(),r=Wu(),o=ap(),l=Vl();function h(c){let t;return c.nodeType==11?t=c.getSelection?c:c.ownerDocument:t=c,t.getSelection()}function y(c,t){return t?c==t||c.contains(t.nodeType!=1?t.parentNode:t):!1}function N(c,t){if(!t.anchorNode)return!1;try{return y(c,t.anchorNode)}catch{return!1}}function D(c){return c.nodeType==3?Et(c,0,c.nodeValue.length).getClientRects():c.nodeType==1?c.getClientRects():[]}function R(c,t,i,s){return i?ne(c,t,i,s,-1)||ne(c,t,i,s,1):!1}function W(c){for(var t=0;;t++)if(c=c.previousSibling,!c)return t}function z(c){return c.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(c.nodeName)}function ne(c,t,i,s,a){for(;;){if(c==i&&t==s)return!0;if(t==(a<0?0:te(c))){if(c.nodeName=="DIV")return!1;let u=c.parentNode;if(!u||u.nodeType!=1)return!1;t=W(c)+(a<0?0:1),c=u}else if(c.nodeType==1){if(c=c.childNodes[t+(a<0?-1:0)],c.nodeType==1&&c.contentEditable=="false")return!1;t=a<0?te(c):0}else return!1}}function te(c){return c.nodeType==3?c.nodeValue.length:c.childNodes.length}function be(c,t){let i=t?c.left:c.right;return{left:i,right:i,top:c.top,bottom:c.bottom}}function Ne(c){let t=c.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:c.innerWidth,top:0,bottom:c.innerHeight}}function Se(c,t){let i=t.width/c.offsetWidth,s=t.height/c.offsetHeight;return(i>.995&&i<1.005||!isFinite(i)||Math.abs(t.width-c.offsetWidth)<1)&&(i=1),(s>.995&&s<1.005||!isFinite(s)||Math.abs(t.height-c.offsetHeight)<1)&&(s=1),{scaleX:i,scaleY:s}}function xe(c,t,i,s,a,u,p,v){let k=c.ownerDocument,F=k.defaultView||window;for(let I=c,Y=!1;I&&!Y;)if(I.nodeType==1){let ie,de=I==k.body,ve=1,ke=1;if(de)ie=Ne(F);else{if(/^(fixed|sticky)$/.test(getComputedStyle(I).position)&&(Y=!0),I.scrollHeight<=I.clientHeight&&I.scrollWidth<=I.clientWidth){I=I.assignedSlot||I.parentNode;continue}let at=I.getBoundingClientRect();({scaleX:ve,scaleY:ke}=Se(I,at)),ie={left:at.left,right:at.left+I.clientWidth*ve,top:at.top,bottom:at.top+I.clientHeight*ke}}let Ce=0,Ae=0;if(a=="nearest")t.top<ie.top?(Ae=t.top-(ie.top+p),i>0&&t.bottom>ie.bottom+Ae&&(Ae=t.bottom-ie.bottom+p)):t.bottom>ie.bottom&&(Ae=t.bottom-ie.bottom+p,i<0&&t.top-Ae<ie.top&&(Ae=t.top-(ie.top+p)));else{let at=t.bottom-t.top,vt=ie.bottom-ie.top;Ae=(a=="center"&&at<=vt?t.top+at/2-vt/2:a=="start"||a=="center"&&i<0?t.top-p:t.bottom-vt+p)-ie.top}if(s=="nearest"?t.left<ie.left?(Ce=t.left-(ie.left+u),i>0&&t.right>ie.right+Ce&&(Ce=t.right-ie.right+u)):t.right>ie.right&&(Ce=t.right-ie.right+u,i<0&&t.left<ie.left+Ce&&(Ce=t.left-(ie.left+u))):Ce=(s=="center"?t.left+(t.right-t.left)/2-(ie.right-ie.left)/2:s=="start"==v?t.left-u:t.right-(ie.right-ie.left)+u)-ie.left,Ce||Ae)if(de)F.scrollBy(Ce,Ae);else{let at=0,vt=0;if(Ae){let dt=I.scrollTop;I.scrollTop+=Ae/ke,vt=(I.scrollTop-dt)*ke}if(Ce){let dt=I.scrollLeft;I.scrollLeft+=Ce/ve,at=(I.scrollLeft-dt)*ve}t={left:t.left-at,top:t.top-vt,right:t.right-at,bottom:t.bottom-vt},at&&Math.abs(at-Ce)<1&&(s="nearest"),vt&&Math.abs(vt-Ae)<1&&(a="nearest")}if(de)break;(t.top<ie.top||t.bottom>ie.bottom||t.left<ie.left||t.right>ie.right)&&(t={left:Math.max(t.left,ie.left),right:Math.min(t.right,ie.right),top:Math.max(t.top,ie.top),bottom:Math.min(t.bottom,ie.bottom)}),I=I.assignedSlot||I.parentNode}else if(I.nodeType==11)I=I.host;else break}function Qe(c){let t=c.ownerDocument,i,s;for(let a=c.parentNode;a&&!(a==t.body||i&&s);)if(a.nodeType==1)!s&&a.scrollHeight>a.clientHeight&&(s=a),!i&&a.scrollWidth>a.clientWidth&&(i=a),a=a.assignedSlot||a.parentNode;else if(a.nodeType==11)a=a.host;else break;return{x:i,y:s}}class Ge{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(t){return this.anchorNode==t.anchorNode&&this.anchorOffset==t.anchorOffset&&this.focusNode==t.focusNode&&this.focusOffset==t.focusOffset}setRange(t){let{anchorNode:i,focusNode:s}=t;this.set(i,Math.min(t.anchorOffset,i?te(i):0),s,Math.min(t.focusOffset,s?te(s):0))}set(t,i,s,a){this.anchorNode=t,this.anchorOffset=i,this.focusNode=s,this.focusOffset=a}}let We=null;function ot(c){if(c.setActive)return c.setActive();if(We)return c.focus(We);let t=[];for(let i=c;i&&(t.push(i,i.scrollTop,i.scrollLeft),i!=i.ownerDocument);i=i.parentNode);if(c.focus(We==null?{get preventScroll(){return We={preventScroll:!0},!0}}:void 0),!We){We=!1;for(let i=0;i<t.length;){let s=t[i++],a=t[i++],u=t[i++];s.scrollTop!=a&&(s.scrollTop=a),s.scrollLeft!=u&&(s.scrollLeft=u)}}}let ft;function Et(c,t,i=t){let s=ft||(ft=document.createRange());return s.setEnd(c,i),s.setStart(c,t),s}function ut(c,t,i,s){let a={key:t,code:t,keyCode:i,which:i,cancelable:!0};s&&({altKey:a.altKey,ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,metaKey:a.metaKey}=s);let u=new KeyboardEvent("keydown",a);u.synthetic=!0,c.dispatchEvent(u);let p=new KeyboardEvent("keyup",a);return p.synthetic=!0,c.dispatchEvent(p),u.defaultPrevented||p.defaultPrevented}function rn(c){for(;c;){if(c&&(c.nodeType==9||c.nodeType==11&&c.host))return c;c=c.assignedSlot||c.parentNode}return null}function Xt(c){for(;c.attributes.length;)c.removeAttributeNode(c.attributes[0])}function Qt(c,t){let i=t.focusNode,s=t.focusOffset;if(!i||t.anchorNode!=i||t.anchorOffset!=s)return!1;for(s=Math.min(s,te(i));;)if(s){if(i.nodeType!=1)return!1;let a=i.childNodes[s-1];a.contentEditable=="false"?s--:(i=a,s=te(i))}else{if(i==c)return!0;s=W(i),i=i.parentNode}}function Kt(c){return c.scrollTop>Math.max(1,c.scrollHeight-c.clientHeight-4)}function pt(c,t){for(let i=c,s=t;;){if(i.nodeType==3&&s>0)return{node:i,offset:s};if(i.nodeType==1&&s>0){if(i.contentEditable=="false")return null;i=i.childNodes[s-1],s=te(i)}else if(i.parentNode&&!z(i))s=W(i),i=i.parentNode;else return null}}function Vt(c,t){for(let i=c,s=t;;){if(i.nodeType==3&&s<i.nodeValue.length)return{node:i,offset:s};if(i.nodeType==1&&s<i.childNodes.length){if(i.contentEditable=="false")return null;i=i.childNodes[s],s=0}else if(i.parentNode&&!z(i))s=W(i)+1,i=i.parentNode;else return null}}class qe{constructor(t,i,s=!0){this.node=t,this.offset=i,this.precise=s}static before(t,i){return new qe(t.parentNode,W(t),i)}static after(t,i){return new qe(t.parentNode,W(t)+1,i)}}const Mt=[];class Je{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(t){let i=this.posAtStart;for(let s of this.children){if(s==t)return i;i+=s.length+s.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(t){return this.posBefore(t)+t.length}sync(t,i){if(this.flags&2){let s=this.dom,a=null,u;for(let p of this.children){if(p.flags&7){if(!p.dom&&(u=a?a.nextSibling:s.firstChild)){let v=Je.get(u);(!v||!v.parent&&v.canReuseDOM(p))&&p.reuseDOM(u)}p.sync(t,i),p.flags&=-8}if(u=a?a.nextSibling:s.firstChild,i&&!i.written&&i.node==s&&u!=p.dom&&(i.written=!0),p.dom.parentNode==s)for(;u&&u!=p.dom;)u=we(u);else s.insertBefore(p.dom,u);a=p.dom}for(u=a?a.nextSibling:s.firstChild,u&&i&&i.node==s&&(i.written=!0);u;)u=we(u)}else if(this.flags&1)for(let s of this.children)s.flags&7&&(s.sync(t,i),s.flags&=-8)}reuseDOM(t){}localPosFromDOM(t,i){let s;if(t==this.dom)s=this.dom.childNodes[i];else{let a=te(t)==0?0:i==0?-1:1;for(;;){let u=t.parentNode;if(u==this.dom)break;a==0&&u.firstChild!=u.lastChild&&(t==u.firstChild?a=-1:a=1),t=u}a<0?s=t:s=t.nextSibling}if(s==this.dom.firstChild)return 0;for(;s&&!Je.get(s);)s=s.nextSibling;if(!s)return this.length;for(let a=0,u=0;;a++){let p=this.children[a];if(p.dom==s)return u;u+=p.length+p.breakAfter}}domBoundsAround(t,i,s=0){let a=-1,u=-1,p=-1,v=-1;for(let k=0,F=s,I=s;k<this.children.length;k++){let Y=this.children[k],ie=F+Y.length;if(F<t&&ie>i)return Y.domBoundsAround(t,i,F);if(ie>=t&&a==-1&&(a=k,u=F),F>i&&Y.dom.parentNode==this.dom){p=k,v=I;break}I=ie,F=ie+Y.breakAfter}return{from:u,to:v<0?s+this.length:v,startDOM:(a?this.children[a-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:p<this.children.length&&p>=0?this.children[p].dom:null}}markDirty(t=!1){this.flags|=2,this.markParentsDirty(t)}markParentsDirty(t){for(let i=this.parent;i;i=i.parent){if(t&&(i.flags|=2),i.flags&1)return;i.flags|=1,t=!1}}setParent(t){this.parent!=t&&(this.parent=t,this.flags&7&&this.markParentsDirty(!0))}setDOM(t){this.dom!=t&&(this.dom&&(this.dom.cmView=null),this.dom=t,t.cmView=this)}get rootView(){for(let t=this;;){let i=t.parent;if(!i)return t;t=i}}replaceChildren(t,i,s=Mt){this.markDirty();for(let a=t;a<i;a++){let u=this.children[a];u.parent==this&&s.indexOf(u)<0&&u.destroy()}s.length<250?this.children.splice(t,i-t,...s):this.children=[].concat(this.children.slice(0,t),s,this.children.slice(i));for(let a=0;a<s.length;a++)s[a].setParent(this)}ignoreMutation(t){return!1}ignoreEvent(t){return!1}childCursor(t=this.length){return new ze(this.children,t,this.children.length)}childPos(t,i=1){return this.childCursor().findPos(t,i)}toString(){let t=this.constructor.name.replace("View","");return t+(this.children.length?"("+this.children.join()+")":this.length?"["+(t=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(t){return t.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(t,i,s,a,u,p){return!1}become(t){return!1}canReuseDOM(t){return t.constructor==this.constructor&&!((this.flags|t.flags)&8)}getSide(){return 0}destroy(){for(let t of this.children)t.parent==this&&t.destroy();this.parent=null}}Je.prototype.breakAfter=0;function we(c){let t=c.nextSibling;return c.parentNode.removeChild(c),t}class ze{constructor(t,i,s){this.children=t,this.pos=i,this.i=s,this.off=0}findPos(t,i=1){for(;;){if(t>this.pos||t==this.pos&&(i>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=t-this.pos,this;let s=this.children[--this.i];this.pos-=s.length+s.breakAfter}}}function rt(c,t,i,s,a,u,p,v,k){let{children:F}=c,I=F.length?F[t]:null,Y=u.length?u[u.length-1]:null,ie=Y?Y.breakAfter:p;if(!(t==s&&I&&!p&&!ie&&u.length<2&&I.merge(i,a,u.length?Y:null,i==0,v,k))){if(s<F.length){let de=F[s];de&&(a<de.length||de.breakAfter&&Y?.breakAfter)?(t==s&&(de=de.split(a),a=0),!ie&&Y&&de.merge(0,a,Y,!0,0,k)?u[u.length-1]=de:((a||de.children.length&&!de.children[0].length)&&de.merge(0,a,null,!1,0,k),u.push(de))):de?.breakAfter&&(Y?Y.breakAfter=1:p=1),s++}for(I&&(I.breakAfter=p,i>0&&(!p&&u.length&&I.merge(i,I.length,u[0],!1,v,0)?I.breakAfter=u.shift().breakAfter:(i<I.length||I.children.length&&I.children[I.children.length-1].length==0)&&I.merge(i,I.length,null,!1,v,0),t++));t<s&&u.length;)if(F[s-1].become(u[u.length-1]))s--,u.pop(),k=u.length?0:v;else if(F[t].become(u[0]))t++,u.shift(),v=u.length?0:k;else break;!u.length&&t&&s<F.length&&!F[t-1].breakAfter&&F[s].merge(0,0,F[t-1],!1,v,k)&&t--,(t<s||u.length)&&c.replaceChildren(t,s,u)}}function tt(c,t,i,s,a,u){let p=c.childCursor(),{i:v,off:k}=p.findPos(i,1),{i:F,off:I}=p.findPos(t,-1),Y=t-i;for(let ie of s)Y+=ie.length;c.length+=Y,rt(c,F,I,v,k,s,0,a,u)}let Ye=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},st=typeof document<"u"?document:{documentElement:{style:{}}};const Nt=/Edge\/(\d+)/.exec(Ye.userAgent),jt=/MSIE \d/.test(Ye.userAgent),Ct=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ye.userAgent),yt=!!(jt||Ct||Nt),wt=!yt&&/gecko\/(\d+)/i.test(Ye.userAgent),Pt=!yt&&/Chrome\/(\d+)/.exec(Ye.userAgent),It="webkitFontSmoothing"in st.documentElement.style,gn=!yt&&/Apple Computer/.test(Ye.vendor),sn=gn&&(/Mobile\/\w+/.test(Ye.userAgent)||Ye.maxTouchPoints>2);var oe={mac:sn||/Mac/.test(Ye.platform),windows:/Win/.test(Ye.platform),linux:/Linux|X11/.test(Ye.platform),ie:yt,ie_version:jt?st.documentMode||6:Ct?+Ct[1]:Nt?+Nt[1]:0,gecko:wt,gecko_version:wt?+(/Firefox\/(\d+)/.exec(Ye.userAgent)||[0,0])[1]:0,chrome:!!Pt,chrome_version:Pt?+Pt[1]:0,ios:sn,android:/Android\b/.test(Ye.userAgent),safari:gn,webkit_version:It?+(/\bAppleWebKit\/(\d+)/.exec(Ye.userAgent)||[0,0])[1]:0,tabSize:st.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const b=256;class T extends Je{constructor(t){super(),this.text=t}get length(){return this.text.length}createDOM(t){this.setDOM(t||document.createTextNode(this.text))}sync(t,i){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(i&&i.node==this.dom&&(i.written=!0),this.dom.nodeValue=this.text)}reuseDOM(t){t.nodeType==3&&this.createDOM(t)}merge(t,i,s){return this.flags&8||s&&(!(s instanceof T)||this.length-(i-t)+s.length>b||s.flags&8)?!1:(this.text=this.text.slice(0,t)+(s?s.text:"")+this.text.slice(i),this.markDirty(),!0)}split(t){let i=new T(this.text.slice(t));return this.text=this.text.slice(0,t),this.markDirty(),i.flags|=this.flags&8,i}localPosFromDOM(t,i){return t==this.dom?i:i?this.text.length:0}domAtPos(t){return new qe(this.dom,t)}domBoundsAround(t,i,s){return{from:s,to:s+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(t,i){return O(this.dom,t,i)}}class L extends Je{constructor(t,i=[],s=0){super(),this.mark=t,this.children=i,this.length=s;for(let a of i)a.setParent(this)}setAttrs(t){if(Xt(t),this.mark.class&&(t.className=this.mark.class),this.mark.attrs)for(let i in this.mark.attrs)t.setAttribute(i,this.mark.attrs[i]);return t}canReuseDOM(t){return super.canReuseDOM(t)&&!((this.flags|t.flags)&8)}reuseDOM(t){t.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(t),this.flags|=6)}sync(t,i){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(t,i)}merge(t,i,s,a,u,p){return s&&(!(s instanceof L&&s.mark.eq(this.mark))||t&&u<=0||i<this.length&&p<=0)?!1:(tt(this,t,i,s?s.children.slice():[],u-1,p-1),this.markDirty(),!0)}split(t){let i=[],s=0,a=-1,u=0;for(let v of this.children){let k=s+v.length;k>t&&i.push(s<t?v.split(t-s):v),a<0&&s>=t&&(a=u),s=k,u++}let p=this.length-t;return this.length=t,a>-1&&(this.children.length=a,this.markDirty()),new L(this.mark,i,p)}domAtPos(t){return me(this,t)}coordsAt(t,i){return Fe(this,t,i)}}function O(c,t,i){let s=c.nodeValue.length;t>s&&(t=s);let a=t,u=t,p=0;t==0&&i<0||t==s&&i>=0?oe.chrome||oe.gecko||(t?(a--,p=1):u<s&&(u++,p=-1)):i<0?a--:u<s&&u++;let v=Et(c,a,u).getClientRects();if(!v.length)return null;let k=v[(p?p<0:i>=0)?0:v.length-1];return oe.safari&&!p&&k.width==0&&(k=Array.prototype.find.call(v,F=>F.width)||k),p?be(k,p<0):k||null}class H extends Je{static create(t,i,s){return new H(t,i,s)}constructor(t,i,s){super(),this.widget=t,this.length=i,this.side=s,this.prevWidget=null}split(t){let i=H.create(this.widget,this.length-t,this.side);return this.length-=t,i}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(t,i,s,a,u,p){return s&&(!(s instanceof H)||!this.widget.compare(s.widget)||t>0&&u<=0||i<this.length&&p<=0)?!1:(this.length=t+(s?s.length:0)+(this.length-i),!0)}become(t){return t instanceof H&&t.side==this.side&&this.widget.constructor==t.widget.constructor?(this.widget.compare(t.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get overrideDOMText(){if(this.length==0)return n.Text.empty;let t=this;for(;t.parent;)t=t.parent;let{view:i}=t,s=i&&i.state.doc,a=this.posAtStart;return s?s.slice(a,a+this.length):n.Text.empty}domAtPos(t){return(this.length?t==0:this.side>0)?qe.before(this.dom):qe.after(this.dom,t==this.length)}domBoundsAround(){return null}coordsAt(t,i){let s=this.widget.coordsAt(this.dom,t,i);if(s)return s;let a=this.dom.getClientRects(),u=null;if(!a.length)return null;let p=this.side?this.side<0:t>0;for(let v=p?a.length-1:0;u=a[v],!(t>0?v==0:v==a.length-1||u.top<u.bottom);v+=p?-1:1);return be(u,!p)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class re extends Je{constructor(t){super(),this.side=t}get length(){return 0}merge(){return!1}become(t){return t instanceof re&&t.side==this.side}split(){return new re(this.side)}sync(){if(!this.dom){let t=document.createElement("img");t.className="cm-widgetBuffer",t.setAttribute("aria-hidden","true"),this.setDOM(t)}}getSide(){return this.side}domAtPos(t){return this.side>0?qe.before(this.dom):qe.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(t){return this.dom.getBoundingClientRect()}get overrideDOMText(){return n.Text.empty}get isHidden(){return!0}}T.prototype.children=H.prototype.children=re.prototype.children=Mt;function me(c,t){let i=c.dom,{children:s}=c,a=0;for(let u=0;a<s.length;a++){let p=s[a],v=u+p.length;if(!(v==u&&p.getSide()<=0)){if(t>u&&t<v&&p.dom.parentNode==i)return p.domAtPos(t-u);if(t<=u)break;u=v}}for(let u=a;u>0;u--){let p=s[u-1];if(p.dom.parentNode==i)return p.domAtPos(p.length)}for(let u=a;u<s.length;u++){let p=s[u];if(p.dom.parentNode==i)return p.domAtPos(0)}return new qe(i,0)}function Ee(c,t,i){let s,{children:a}=c;i>0&&t instanceof L&&a.length&&(s=a[a.length-1])instanceof L&&s.mark.eq(t.mark)?Ee(s,t.children[0],i-1):(a.push(t),t.setParent(c)),c.length+=t.length}function Fe(c,t,i){let s=null,a=-1,u=null,p=-1;function v(F,I){for(let Y=0,ie=0;Y<F.children.length&&ie<=I;Y++){let de=F.children[Y],ve=ie+de.length;ve>=I&&(de.children.length?v(de,I-ie):(!u||u.isHidden&&(i>0||Ue(u,de)))&&(ve>I||ie==ve&&de.getSide()>0)?(u=de,p=I-ie):(ie<I||ie==ve&&de.getSide()<0&&!de.isHidden)&&(s=de,a=I-ie)),ie=ve}}v(c,t);let k=(i<0?s:u)||s||u;return k?k.coordsAt(Math.max(0,k==s?a:p),i):Be(c)}function Be(c){let t=c.dom.lastChild;if(!t)return c.dom.getBoundingClientRect();let i=D(t);return i[i.length-1]||null}function Ue(c,t){let i=c.coordsAt(0,1),s=t.coordsAt(0,1);return i&&s&&s.top<i.bottom}function He(c,t){for(let i in c)i=="class"&&t.class?t.class+=" "+c.class:i=="style"&&t.style?t.style+=";"+c.style:t[i]=c[i];return t}const Ze=Object.create(null);function lt(c,t,i){if(c==t)return!0;c||(c=Ze),t||(t=Ze);let s=Object.keys(c),a=Object.keys(t);if(s.length-(i&&s.indexOf(i)>-1?1:0)!=a.length-(i&&a.indexOf(i)>-1?1:0))return!1;for(let u of s)if(u!=i&&(a.indexOf(u)==-1||c[u]!==t[u]))return!1;return!0}function qt(c,t,i){let s=!1;if(t)for(let a in t)i&&a in i||(s=!0,a=="style"?c.style.cssText="":c.removeAttribute(a));if(i)for(let a in i)t&&t[a]==i[a]||(s=!0,a=="style"?c.style.cssText=i[a]:c.setAttribute(a,i[a]));return s}function gt(c){let t=Object.create(null);for(let i=0;i<c.attributes.length;i++){let s=c.attributes[i];t[s.name]=s.value}return t}class kt{eq(t){return!1}updateDOM(t,i){return!1}compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(t){return!0}coordsAt(t,i,s){return null}get isHidden(){return!1}get editable(){return!1}destroy(t){}}e.BlockType=void 0,function(c){c[c.Text=0]="Text",c[c.WidgetBefore=1]="WidgetBefore",c[c.WidgetAfter=2]="WidgetAfter",c[c.WidgetRange=3]="WidgetRange"}(e.BlockType||(e.BlockType={}));class ht extends n.RangeValue{constructor(t,i,s,a){super(),this.startSide=t,this.endSide=i,this.widget=s,this.spec=a}get heightRelevant(){return!1}static mark(t){return new Ft(t)}static widget(t){let i=Math.max(-1e4,Math.min(1e4,t.side||0)),s=!!t.block;return i+=s&&!t.inlineOrder?i>0?3e8:-4e8:i>0?1e8:-1e8,new At(t,i,i,s,t.widget||null,!1)}static replace(t){let i=!!t.block,s,a;if(t.isBlockGap)s=-5e8,a=4e8;else{let{start:u,end:p}=Lt(t,i);s=(u?i?-3e8:-1:5e8)-1,a=(p?i?2e8:1:-6e8)+1}return new At(t,s,a,i,t.widget||null,!0)}static line(t){return new en(t)}static set(t,i=!1){return n.RangeSet.of(t,i)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}ht.none=n.RangeSet.empty;class Ft extends ht{constructor(t){let{start:i,end:s}=Lt(t);super(i?-1:5e8,s?1:-6e8,null,t),this.tagName=t.tagName||"span",this.class=t.class||"",this.attrs=t.attributes||null}eq(t){var i,s;return this==t||t instanceof Ft&&this.tagName==t.tagName&&(this.class||((i=this.attrs)===null||i===void 0?void 0:i.class))==(t.class||((s=t.attrs)===null||s===void 0?void 0:s.class))&&lt(this.attrs,t.attrs,"class")}range(t,i=t){if(t>=i)throw new RangeError("Mark decorations may not be empty");return super.range(t,i)}}Ft.prototype.point=!1;class en extends ht{constructor(t){super(-2e8,-2e8,null,t)}eq(t){return t instanceof en&&this.spec.class==t.spec.class&&lt(this.spec.attributes,t.spec.attributes)}range(t,i=t){if(i!=t)throw new RangeError("Line decoration ranges must be zero-length");return super.range(t,i)}}en.prototype.mapMode=n.MapMode.TrackBefore,en.prototype.point=!0;class At extends ht{constructor(t,i,s,a,u,p){super(i,s,u,t),this.block=a,this.isReplace=p,this.mapMode=a?i<=0?n.MapMode.TrackBefore:n.MapMode.TrackAfter:n.MapMode.TrackDel}get type(){return this.startSide!=this.endSide?e.BlockType.WidgetRange:this.startSide<=0?e.BlockType.WidgetBefore:e.BlockType.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(t){return t instanceof At&&J(this.widget,t.widget)&&this.block==t.block&&this.startSide==t.startSide&&this.endSide==t.endSide}range(t,i=t){if(this.isReplace&&(t>i||t==i&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&i!=t)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(t,i)}}At.prototype.point=!0;function Lt(c,t=!1){let{inclusiveStart:i,inclusiveEnd:s}=c;return i==null&&(i=c.inclusive),s==null&&(s=c.inclusive),{start:i??t,end:s??t}}function J(c,t){return c==t||!!(c&&t&&c.compare(t))}function j(c,t,i,s=0){let a=i.length-1;a>=0&&i[a]+s>=c?i[a]=Math.max(i[a],t):i.push(c,t)}class G extends Je{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(t,i,s,a,u,p){if(s){if(!(s instanceof G))return!1;this.dom||s.transferDOM(this)}return a&&this.setDeco(s?s.attrs:null),tt(this,t,i,s?s.children.slice():[],u,p),!0}split(t){let i=new G;if(i.breakAfter=this.breakAfter,this.length==0)return i;let{i:s,off:a}=this.childPos(t);a&&(i.append(this.children[s].split(a),0),this.children[s].merge(a,this.children[s].length,null,!1,0,0),s++);for(let u=s;u<this.children.length;u++)i.append(this.children[u],0);for(;s>0&&this.children[s-1].length==0;)this.children[--s].destroy();return this.children.length=s,this.markDirty(),this.length=t,i}transferDOM(t){this.dom&&(this.markDirty(),t.setDOM(this.dom),t.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(t){lt(this.attrs,t)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=t)}append(t,i){Ee(this,t,i)}addLineDeco(t){let i=t.spec.attributes,s=t.spec.class;i&&(this.attrs=He(i,this.attrs||{})),s&&(this.attrs=He({class:s},this.attrs||{}))}domAtPos(t){return me(this,t)}reuseDOM(t){t.nodeName=="DIV"&&(this.setDOM(t),this.flags|=6)}sync(t,i){var s;this.dom?this.flags&4&&(Xt(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(qt(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(t,i);let a=this.dom.lastChild;for(;a&&Je.get(a)instanceof L;)a=a.lastChild;if(!a||!this.length||a.nodeName!="BR"&&((s=Je.get(a))===null||s===void 0?void 0:s.isEditable)==!1&&(!oe.ios||!this.children.some(u=>u instanceof T))){let u=document.createElement("BR");u.cmIgnore=!0,this.dom.appendChild(u)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let t=0,i;for(let s of this.children){if(!(s instanceof T)||/[^ -~]/.test(s.text))return null;let a=D(s.dom);if(a.length!=1)return null;t+=a[0].width,i=a[0].height}return t?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:t/this.length,textHeight:i}:null}coordsAt(t,i){let s=Fe(this,t,i);if(!this.children.length&&s&&this.parent){let{heightOracle:a}=this.parent.view.viewState,u=s.bottom-s.top;if(Math.abs(u-a.lineHeight)<2&&a.textHeight<u){let p=(u-a.textHeight)/2;return{top:s.top+p,bottom:s.bottom-p,left:s.left,right:s.left}}}return s}become(t){return t instanceof G&&this.children.length==0&&t.children.length==0&&lt(this.attrs,t.attrs)&&this.breakAfter==t.breakAfter}covers(){return!0}static find(t,i){for(let s=0,a=0;s<t.children.length;s++){let u=t.children[s],p=a+u.length;if(p>=i){if(u instanceof G)return u;if(p>i)break}a=p+u.breakAfter}return null}}class se extends Je{constructor(t,i,s){super(),this.widget=t,this.length=i,this.deco=s,this.breakAfter=0,this.prevWidget=null}merge(t,i,s,a,u,p){return s&&(!(s instanceof se)||!this.widget.compare(s.widget)||t>0&&u<=0||i<this.length&&p<=0)?!1:(this.length=t+(s?s.length:0)+(this.length-i),!0)}domAtPos(t){return t==0?qe.before(this.dom):qe.after(this.dom,t==this.length)}split(t){let i=this.length-t;this.length=t;let s=new se(this.widget,i,this.deco);return s.breakAfter=this.breakAfter,s}get children(){return Mt}sync(t){(!this.dom||!this.widget.updateDOM(this.dom,t))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(t)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):n.Text.empty}domBoundsAround(){return null}become(t){return t instanceof se&&t.widget.constructor==this.widget.constructor?(t.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=t.widget,this.length=t.length,this.deco=t.deco,this.breakAfter=t.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(t){return this.widget.ignoreEvent(t)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(t,i){let s=this.widget.coordsAt(this.dom,t,i);return s||(this.widget instanceof le?null:be(this.dom.getBoundingClientRect(),this.length?t==0:i<=0))}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(t){let{startSide:i,endSide:s}=this.deco;return i==s?!1:t<0?i<0:s>0}}class le extends kt{constructor(t){super(),this.height=t}toDOM(){let t=document.createElement("div");return t.className="cm-gap",this.updateDOM(t),t}eq(t){return t.height==this.height}updateDOM(t){return t.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}ignoreEvent(){return!1}}class fe{constructor(t,i,s,a){this.doc=t,this.pos=i,this.end=s,this.disallowBlockEffectsFor=a,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=t.iter(),this.skip=i}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let t=this.content[this.content.length-1];return!(t.breakAfter||t instanceof se&&t.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new G),this.atCursorPos=!0),this.curLine}flushBuffer(t=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Ie(new re(-1),t),t.length),this.pendingBuffer=0)}addBlockWidget(t){this.flushBuffer(),this.curLine=null,this.content.push(t)}finish(t){this.pendingBuffer&&t<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(t&&this.content.length&&this.content[this.content.length-1]instanceof se)&&this.getLine()}buildText(t,i,s){for(;t>0;){if(this.textOff==this.text.length){let{value:u,lineBreak:p,done:v}=this.cursor.next(this.skip);if(this.skip=0,v)throw new Error("Ran out of text content when drawing inline views");if(p){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,t--;continue}else this.text=u,this.textOff=0}let a=Math.min(this.text.length-this.textOff,t,512);this.flushBuffer(i.slice(i.length-s)),this.getLine().append(Ie(new T(this.text.slice(this.textOff,this.textOff+a)),i),s),this.atCursorPos=!0,this.textOff+=a,t-=a,s=0}}span(t,i,s,a){this.buildText(i-t,s,a),this.pos=i,this.openStart<0&&(this.openStart=a)}point(t,i,s,a,u,p){if(this.disallowBlockEffectsFor[p]&&s instanceof At){if(s.block)throw new RangeError("Block decorations may not be specified via plugins");if(i>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let v=i-t;if(s instanceof At)if(s.block)s.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new se(s.widget||_e.block,v,s));else{let k=H.create(s.widget||_e.inline,v,v?0:s.startSide),F=this.atCursorPos&&!k.isEditable&&u<=a.length&&(t<i||s.startSide>0),I=!k.isEditable&&(t<i||u>a.length||s.startSide<=0),Y=this.getLine();this.pendingBuffer==2&&!F&&!k.isEditable&&(this.pendingBuffer=0),this.flushBuffer(a),F&&(Y.append(Ie(new re(1),a),u),u=a.length+Math.max(0,u-a.length)),Y.append(Ie(k,a),u),this.atCursorPos=I,this.pendingBuffer=I?t<i||u>a.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=a.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(s);v&&(this.textOff+v<=this.text.length?this.textOff+=v:(this.skip+=v-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=i),this.openStart<0&&(this.openStart=u)}static build(t,i,s,a,u){let p=new fe(t,i,s,u);return p.openEnd=n.RangeSet.spans(a,i,s,p),p.openStart<0&&(p.openStart=p.openEnd),p.finish(p.openEnd),p}}function Ie(c,t){for(let i of t)c=new L(i,[c],c.length);return c}class _e extends kt{constructor(t){super(),this.tag=t}eq(t){return t.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(t){return t.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}_e.inline=new _e("span"),_e.block=new _e("div"),e.Direction=void 0,function(c){c[c.LTR=0]="LTR",c[c.RTL=1]="RTL"}(e.Direction||(e.Direction={}));const Pe=e.Direction.LTR,Rt=e.Direction.RTL;function Ut(c){let t=[];for(let i=0;i<c.length;i++)t.push(1<<+c[i]);return t}const cn=Ut("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),yn=Ut("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),un=Object.create(null),$t=[];for(let c of["()","[]","{}"]){let t=c.charCodeAt(0),i=c.charCodeAt(1);un[t]=i,un[i]=-t}function Ht(c){return c<=247?cn[c]:1424<=c&&c<=1524?2:1536<=c&&c<=1785?yn[c-1536]:1774<=c&&c<=2220?4:8192<=c&&c<=8204?256:64336<=c&&c<=65023?4:1}const pn=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class dn{get dir(){return this.level%2?Rt:Pe}constructor(t,i,s){this.from=t,this.to=i,this.level=s}side(t,i){return this.dir==i==t?this.to:this.from}forward(t,i){return t==(this.dir==i)}static find(t,i,s,a){let u=-1;for(let p=0;p<t.length;p++){let v=t[p];if(v.from<=i&&v.to>=i){if(v.level==s)return p;(u<0||(a!=0?a<0?v.from<i:v.to>i:t[u].level>v.level))&&(u=p)}}if(u<0)throw new RangeError("Index out of range");return u}}function On(c,t){if(c.length!=t.length)return!1;for(let i=0;i<c.length;i++){let s=c[i],a=t[i];if(s.from!=a.from||s.to!=a.to||s.direction!=a.direction||!On(s.inner,a.inner))return!1}return!0}const Ot=[];function Xn(c,t,i,s,a){for(let u=0;u<=s.length;u++){let p=u?s[u-1].to:t,v=u<s.length?s[u].from:i,k=u?256:a;for(let F=p,I=k,Y=k;F<v;F++){let ie=Ht(c.charCodeAt(F));ie==512?ie=I:ie==8&&Y==4&&(ie=16),Ot[F]=ie==4?2:ie,ie&7&&(Y=ie),I=ie}for(let F=p,I=k,Y=k;F<v;F++){let ie=Ot[F];if(ie==128)F<v-1&&I==Ot[F+1]&&I&24?ie=Ot[F]=I:Ot[F]=256;else if(ie==64){let de=F+1;for(;de<v&&Ot[de]==64;)de++;let ve=F&&I==8||de<i&&Ot[de]==8?Y==1?1:8:256;for(let ke=F;ke<de;ke++)Ot[ke]=ve;F=de-1}else ie==8&&Y==1&&(Ot[F]=1);I=ie,ie&7&&(Y=ie)}}}function Ei(c,t,i,s,a){let u=a==1?2:1;for(let p=0,v=0,k=0;p<=s.length;p++){let F=p?s[p-1].to:t,I=p<s.length?s[p].from:i;for(let Y=F,ie,de,ve;Y<I;Y++)if(de=un[ie=c.charCodeAt(Y)])if(de<0){for(let ke=v-3;ke>=0;ke-=3)if($t[ke+1]==-de){let Ce=$t[ke+2],Ae=Ce&2?a:Ce&4?Ce&1?u:a:0;Ae&&(Ot[Y]=Ot[$t[ke]]=Ae),v=ke;break}}else{if($t.length==189)break;$t[v++]=Y,$t[v++]=ie,$t[v++]=k}else if((ve=Ot[Y])==2||ve==1){let ke=ve==a;k=ke?0:1;for(let Ce=v-3;Ce>=0;Ce-=3){let Ae=$t[Ce+2];if(Ae&2)break;if(ke)$t[Ce+2]|=2;else{if(Ae&4)break;$t[Ce+2]|=4}}}}}function Ai(c,t,i,s){for(let a=0,u=s;a<=i.length;a++){let p=a?i[a-1].to:c,v=a<i.length?i[a].from:t;for(let k=p;k<v;){let F=Ot[k];if(F==256){let I=k+1;for(;;)if(I==v){if(a==i.length)break;I=i[a++].to,v=a<i.length?i[a].from:t}else if(Ot[I]==256)I++;else break;let Y=u==1,ie=(I<t?Ot[I]:s)==1,de=Y==ie?Y?1:2:s;for(let ve=I,ke=a,Ce=ke?i[ke-1].to:c;ve>k;)ve==Ce&&(ve=i[--ke].from,Ce=ke?i[ke-1].to:c),Ot[--ve]=de;k=I}else u=F,k++}}}function q(c,t,i,s,a,u,p){let v=s%2?2:1;if(s%2==a%2)for(let k=t,F=0;k<i;){let I=!0,Y=!1;if(F==u.length||k<u[F].from){let ke=Ot[k];ke!=v&&(I=!1,Y=ke==16)}let ie=!I&&v==1?[]:null,de=I?s:s+1,ve=k;e:for(;;)if(F<u.length&&ve==u[F].from){if(Y)break e;let ke=u[F];if(!I)for(let Ce=ke.to,Ae=F+1;;){if(Ce==i)break e;if(Ae<u.length&&u[Ae].from==Ce)Ce=u[Ae++].to;else{if(Ot[Ce]==v)break e;break}}if(F++,ie)ie.push(ke);else{ke.from>k&&p.push(new dn(k,ke.from,de));let Ce=ke.direction==Pe!=!(de%2);f(c,Ce?s+1:s,a,ke.inner,ke.from,ke.to,p),k=ke.to}ve=ke.to}else{if(ve==i||(I?Ot[ve]!=v:Ot[ve]==v))break;ve++}ie?q(c,k,ve,s+1,a,ie,p):k<ve&&p.push(new dn(k,ve,de)),k=ve}else for(let k=i,F=u.length;k>t;){let I=!0,Y=!1;if(!F||k>u[F-1].to){let ke=Ot[k-1];ke!=v&&(I=!1,Y=ke==16)}let ie=!I&&v==1?[]:null,de=I?s:s+1,ve=k;e:for(;;)if(F&&ve==u[F-1].to){if(Y)break e;let ke=u[--F];if(!I)for(let Ce=ke.from,Ae=F;;){if(Ce==t)break e;if(Ae&&u[Ae-1].to==Ce)Ce=u[--Ae].from;else{if(Ot[Ce-1]==v)break e;break}}if(ie)ie.push(ke);else{ke.to<k&&p.push(new dn(ke.to,k,de));let Ce=ke.direction==Pe!=!(de%2);f(c,Ce?s+1:s,a,ke.inner,ke.from,ke.to,p),k=ke.from}ve=ke.from}else{if(ve==t||(I?Ot[ve-1]!=v:Ot[ve-1]==v))break;ve--}ie?q(c,ve,k,s+1,a,ie,p):ve<k&&p.push(new dn(ve,k,de)),k=ve}}function f(c,t,i,s,a,u,p){let v=t%2?2:1;Xn(c,a,u,s,v),Ei(c,a,u,s,v),Ai(a,u,s,v),q(c,a,u,t,i,s,p)}function m(c,t,i){if(!c)return[new dn(0,0,t==Rt?1:0)];if(t==Pe&&!i.length&&!pn.test(c))return E(c.length);if(i.length)for(;c.length>Ot.length;)Ot[Ot.length]=256;let s=[],a=t==Pe?0:1;return f(c,a,a,i,0,c.length,s),s}function E(c){return[new dn(0,c,0)]}let C="";function B(c,t,i,s,a){var u;let p=s.head-c.from,v=dn.find(t,p,(u=s.bidiLevel)!==null&&u!==void 0?u:-1,s.assoc),k=t[v],F=k.side(a,i);if(p==F){let ie=v+=a?1:-1;if(ie<0||ie>=t.length)return null;k=t[v=ie],p=k.side(!a,i),F=k.side(a,i)}let I=n.findClusterBreak(c.text,p,k.forward(a,i));(I<k.from||I>k.to)&&(I=F),C=c.text.slice(Math.min(p,I),Math.max(p,I));let Y=v==(a?t.length-1:0)?null:t[v+(a?1:-1)];return Y&&I==F&&Y.level+(a?0:1)<k.level?n.EditorSelection.cursor(Y.side(!a,i)+c.from,Y.forward(a,i)?1:-1,Y.level):n.EditorSelection.cursor(I+c.from,k.forward(a,i)?-1:1,k.level)}function V(c,t,i){for(let s=t;s<i;s++){let a=Ht(c.charCodeAt(s));if(a==1)return Pe;if(a==2||a==4)return Rt}return Pe}const ee=n.Facet.define(),ce=n.Facet.define(),Te=n.Facet.define(),De=n.Facet.define(),je=n.Facet.define(),nt=n.Facet.define(),it=n.Facet.define(),zt=n.Facet.define(),An=n.Facet.define(),on=n.Facet.define({combine:c=>c.some(t=>t)}),Zn=n.Facet.define({combine:c=>c.some(t=>t)}),wi=n.Facet.define();class ei{constructor(t,i="nearest",s="nearest",a=5,u=5,p=!1){this.range=t,this.y=i,this.x=s,this.yMargin=a,this.xMargin=u,this.isSnapshot=p}map(t){return t.empty?this:new ei(this.range.map(t),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(t){return this.range.to<=t.doc.length?this:new ei(n.EditorSelection.cursor(t.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const si=n.StateEffect.define({map:(c,t)=>c.map(t)}),ki=n.StateEffect.define();function U(c,t,i){let s=c.facet(De);s.length?s[0](t):window.onerror&&window.onerror(String(t),i,void 0,void 0,t)||(i?console.error(i+":",t):console.error(t))}const x=n.Facet.define({combine:c=>c.length?c[0]:!0});let M=0;const S=n.Facet.define({combine(c){return c.filter((t,i)=>{for(let s=0;s<i;s++)if(c[s].plugin==t.plugin)return!1;return!0})}});class d{constructor(t,i,s,a,u){this.id=t,this.create=i,this.domEventHandlers=s,this.domEventObservers=a,this.baseExtensions=u(this),this.extension=this.baseExtensions.concat(S.of({plugin:this,arg:void 0}))}of(t){return this.baseExtensions.concat(S.of({plugin:this,arg:t}))}static define(t,i){const{eventHandlers:s,eventObservers:a,provide:u,decorations:p}=i||{};return new d(M++,t,s,a,v=>{let k=[];return p&&k.push($.of(F=>{let I=F.plugin(v);return I?p(I):ht.none})),u&&k.push(u(v)),k})}static fromClass(t,i){return d.define((s,a)=>new t(s,a),i)}}class g{constructor(t){this.spec=t,this.mustUpdate=null,this.value=null}get plugin(){return this.spec&&this.spec.plugin}update(t){if(this.value){if(this.mustUpdate){let i=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(i)}catch(s){if(U(i.state,s,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.plugin.create(t,this.spec.arg)}catch(i){U(t.state,i,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(t){var i;if(!((i=this.value)===null||i===void 0)&&i.destroy)try{this.value.destroy()}catch(s){U(t.state,s,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const A=n.Facet.define(),P=n.Facet.define(),$=n.Facet.define(),X=n.Facet.define(),he=n.Facet.define(),ge=n.Facet.define();function Re(c,t){let i=c.state.facet(ge);if(!i.length)return i;let s=i.map(u=>u instanceof Function?u(c):u),a=[];return n.RangeSet.spans(s,t.from,t.to,{point(){},span(u,p,v,k){let F=u-t.from,I=p-t.from,Y=a;for(let ie=v.length-1;ie>=0;ie--,k--){let de=v[ie].spec.bidiIsolate,ve;if(de==null&&(de=V(t.text,F,I)),k>0&&Y.length&&(ve=Y[Y.length-1]).to==F&&ve.direction==de)ve.to=I,Y=ve.inner;else{let ke={from:F,to:I,direction:de,inner:[]};Y.push(ke),Y=ke.inner}}}}),a}const mt=n.Facet.define();function Bt(c){let t=0,i=0,s=0,a=0;for(let u of c.state.facet(mt)){let p=u(c);p&&(p.left!=null&&(t=Math.max(t,p.left)),p.right!=null&&(i=Math.max(i,p.right)),p.top!=null&&(s=Math.max(s,p.top)),p.bottom!=null&&(a=Math.max(a,p.bottom)))}return{left:t,right:i,top:s,bottom:a}}const ln=n.Facet.define();class mn{constructor(t,i,s,a){this.fromA=t,this.toA=i,this.fromB=s,this.toB=a}join(t){return new mn(Math.min(this.fromA,t.fromA),Math.max(this.toA,t.toA),Math.min(this.fromB,t.fromB),Math.max(this.toB,t.toB))}addToSet(t){let i=t.length,s=this;for(;i>0;i--){let a=t[i-1];if(!(a.fromA>s.toA)){if(a.toA<s.fromA)break;s=s.join(a),t.splice(i-1,1)}}return t.splice(i,0,s),t}static extendWithRanges(t,i){if(i.length==0)return t;let s=[];for(let a=0,u=0,p=0,v=0;;a++){let k=a==t.length?null:t[a],F=p-v,I=k?k.fromB:1e9;for(;u<i.length&&i[u]<I;){let Y=i[u],ie=i[u+1],de=Math.max(v,Y),ve=Math.min(I,ie);if(de<=ve&&new mn(de+F,ve+F,de,ve).addToSet(s),ie>I)break;u+=2}if(!k)return s;new mn(k.fromA,k.toA,k.fromB,k.toB).addToSet(s),p=k.toA,v=k.toB}}}class Dn{constructor(t,i,s){this.view=t,this.state=i,this.transactions=s,this.flags=0,this.startState=t.state,this.changes=n.ChangeSet.empty(this.startState.doc.length);for(let u of s)this.changes=this.changes.compose(u.changes);let a=[];this.changes.iterChangedRanges((u,p,v,k)=>a.push(new mn(u,p,v,k))),this.changedRanges=a}static create(t,i,s){return new Dn(t,i,s)}get viewportChanged(){return(this.flags&4)>0}get viewportMoved(){return(this.flags&8)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&18)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(t=>t.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class Zt extends Je{get length(){return this.view.state.doc.length}constructor(t){super(),this.view=t,this.decorations=[],this.dynamicDecorationMap=[!1],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.editContextFormatting=ht.none,this.lastCompositionAfterCursor=!1,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(t.contentDOM),this.children=[new G],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new mn(0,0,0,t.state.doc.length)],0,null)}update(t){var i;let s=t.changedRanges;this.minWidth>0&&s.length&&(s.every(({fromA:F,toA:I})=>I<this.minWidthFrom||F>this.minWidthTo)?(this.minWidthFrom=t.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=t.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0),this.updateEditContextFormatting(t);let a=-1;this.view.inputState.composing>=0&&!this.view.observer.editContext&&(!((i=this.domChanged)===null||i===void 0)&&i.newSel?a=this.domChanged.newSel.head:!ms(t.changes,this.hasComposition)&&!t.selectionSet&&(a=t.state.selection.main.head));let u=a>-1?$n(this.view,t.changes,a):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:F,to:I}=this.hasComposition;s=new mn(F,I,t.changes.mapPos(F,-1),t.changes.mapPos(I,1)).addToSet(s.slice())}this.hasComposition=u?{from:u.range.fromB,to:u.range.toB}:null,(oe.ie||oe.chrome)&&!u&&t&&t.state.doc.lines!=t.startState.doc.lines&&(this.forceSelection=!0);let p=this.decorations,v=this.updateDeco(),k=Or(p,v,t.changes);return s=mn.extendWithRanges(s,k),!(this.flags&7)&&s.length==0?!1:(this.updateInner(s,t.startState.doc.length,u),t.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(t,i,s){this.view.viewState.mustMeasureContent=!0,this.updateChildren(t,i,s);let{observer:a}=this.view;a.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let p=oe.chrome||oe.ios?{node:a.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,p),this.flags&=-8,p&&(p.written||a.selectionRange.focusNode!=p.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(p=>p.flags&=-9);let u=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let p of this.children)p instanceof se&&p.widget instanceof le&&u.push(p.dom);a.updateGaps(u)}updateChildren(t,i,s){let a=s?s.range.addToSet(t.slice()):t,u=this.childCursor(i);for(let p=a.length-1;;p--){let v=p>=0?a[p]:null;if(!v)break;let{fromA:k,toA:F,fromB:I,toB:Y}=v,ie,de,ve,ke;if(s&&s.range.fromB<Y&&s.range.toB>I){let dt=fe.build(this.view.state.doc,I,s.range.fromB,this.decorations,this.dynamicDecorationMap),St=fe.build(this.view.state.doc,s.range.toB,Y,this.decorations,this.dynamicDecorationMap);de=dt.breakAtStart,ve=dt.openStart,ke=St.openEnd;let Tt=this.compositionView(s);St.breakAtStart?Tt.breakAfter=1:St.content.length&&Tt.merge(Tt.length,Tt.length,St.content[0],!1,St.openStart,0)&&(Tt.breakAfter=St.content[0].breakAfter,St.content.shift()),dt.content.length&&Tt.merge(0,0,dt.content[dt.content.length-1],!0,0,dt.openEnd)&&dt.content.pop(),ie=dt.content.concat(Tt).concat(St.content)}else({content:ie,breakAtStart:de,openStart:ve,openEnd:ke}=fe.build(this.view.state.doc,I,Y,this.decorations,this.dynamicDecorationMap));let{i:Ce,off:Ae}=u.findPos(F,1),{i:at,off:vt}=u.findPos(k,-1);rt(this,at,vt,Ce,Ae,ie,de,ve,ke)}s&&this.fixCompositionDOM(s)}updateEditContextFormatting(t){this.editContextFormatting=this.editContextFormatting.map(t.changes);for(let i of t.transactions)for(let s of i.effects)s.is(ki)&&(this.editContextFormatting=s.value)}compositionView(t){let i=new T(t.text.nodeValue);i.flags|=8;for(let{deco:a}of t.marks)i=new L(a,[i],i.length);let s=new G;return s.append(i,0),s}fixCompositionDOM(t){let i=(u,p)=>{p.flags|=8|(p.children.some(k=>k.flags&7)?1:0),this.markedForComposition.add(p);let v=Je.get(u);v&&v!=p&&(v.dom=null),p.setDOM(u)},s=this.childPos(t.range.fromB,1),a=this.children[s.i];i(t.line,a);for(let u=t.marks.length-1;u>=-1;u--)s=a.childPos(s.off,1),a=a.children[s.i],i(u>=0?t.marks[u].node:t.text,a)}updateSelection(t=!1,i=!1){(t||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let s=this.view.root.activeElement,a=s==this.dom,u=!a&&!(this.view.state.facet(x)||this.dom.tabIndex>-1)&&N(this.dom,this.view.observer.selectionRange)&&!(s&&this.dom.contains(s));if(!(a||i||u))return;let p=this.forceSelection;this.forceSelection=!1;let v=this.view.state.selection.main,k=this.moveToLine(this.domAtPos(v.anchor)),F=v.empty?k:this.moveToLine(this.domAtPos(v.head));if(oe.gecko&&v.empty&&!this.hasComposition&&ti(k)){let Y=document.createTextNode("");this.view.observer.ignore(()=>k.node.insertBefore(Y,k.node.childNodes[k.offset]||null)),k=F=new qe(Y,0),p=!0}let I=this.view.observer.selectionRange;(p||!I.focusNode||(!R(k.node,k.offset,I.anchorNode,I.anchorOffset)||!R(F.node,F.offset,I.focusNode,I.focusOffset))&&!this.suppressWidgetCursorChange(I,v))&&(this.view.observer.ignore(()=>{oe.android&&oe.chrome&&this.dom.contains(I.focusNode)&&ps(I.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let Y=h(this.view.root);if(Y)if(v.empty){if(oe.gecko){let ie=xi(k.node,k.offset);if(ie&&ie!=3){let de=(ie==1?pt:Vt)(k.node,k.offset);de&&(k=new qe(de.node,de.offset))}}Y.collapse(k.node,k.offset),v.bidiLevel!=null&&Y.caretBidiLevel!==void 0&&(Y.caretBidiLevel=v.bidiLevel)}else if(Y.extend){Y.collapse(k.node,k.offset);try{Y.extend(F.node,F.offset)}catch{}}else{let ie=document.createRange();v.anchor>v.head&&([k,F]=[F,k]),ie.setEnd(F.node,F.offset),ie.setStart(k.node,k.offset),Y.removeAllRanges(),Y.addRange(ie)}u&&this.view.root.activeElement==this.dom&&(this.dom.blur(),s&&s.focus())}),this.view.observer.setSelectionRange(k,F)),this.impreciseAnchor=k.precise?null:new qe(I.anchorNode,I.anchorOffset),this.impreciseHead=F.precise?null:new qe(I.focusNode,I.focusOffset)}suppressWidgetCursorChange(t,i){return this.hasComposition&&i.empty&&R(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset)&&this.posFromDOM(t.focusNode,t.focusOffset)==i.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:t}=this,i=t.state.selection.main,s=h(t.root),{anchorNode:a,anchorOffset:u}=t.observer.selectionRange;if(!s||!i.empty||!i.assoc||!s.modify)return;let p=G.find(this,i.head);if(!p)return;let v=p.posAtStart;if(i.head==v||i.head==v+p.length)return;let k=this.coordsAt(i.head,-1),F=this.coordsAt(i.head,1);if(!k||!F||k.bottom>F.top)return;let I=this.domAtPos(i.head+i.assoc);s.collapse(I.node,I.offset),s.modify("move",i.assoc<0?"forward":"backward","lineboundary"),t.observer.readSelectionRange();let Y=t.observer.selectionRange;t.docView.posFromDOM(Y.anchorNode,Y.anchorOffset)!=i.from&&s.collapse(a,u)}moveToLine(t){let i=this.dom,s;if(t.node!=i)return t;for(let a=t.offset;!s&&a<i.childNodes.length;a++){let u=Je.get(i.childNodes[a]);u instanceof G&&(s=u.domAtPos(0))}for(let a=t.offset-1;!s&&a>=0;a--){let u=Je.get(i.childNodes[a]);u instanceof G&&(s=u.domAtPos(u.length))}return s?new qe(s.node,s.offset,!0):t}nearest(t){for(let i=t;i;){let s=Je.get(i);if(s&&s.rootView==this)return s;i=i.parentNode}return null}posFromDOM(t,i){let s=this.nearest(t);if(!s)throw new RangeError("Trying to find position for a DOM position outside of the document");return s.localPosFromDOM(t,i)+s.posAtStart}domAtPos(t){let{i,off:s}=this.childCursor().findPos(t,-1);for(;i<this.children.length-1;){let a=this.children[i];if(s<a.length||a instanceof G)break;i++,s=0}return this.children[i].domAtPos(s)}coordsAt(t,i){let s=null,a=0;for(let u=this.length,p=this.children.length-1;p>=0;p--){let v=this.children[p],k=u-v.breakAfter,F=k-v.length;if(k<t)break;if(F<=t&&(F<t||v.covers(-1))&&(k>t||v.covers(1))&&(!s||v instanceof G&&!(s instanceof G&&i>=0)))s=v,a=F;else if(s&&F==t&&k==t&&v instanceof se&&Math.abs(i)<2){if(v.deco.startSide<0)break;p&&(s=null)}u=F}return s?s.coordsAt(t-a,i):null}coordsForChar(t){let{i,off:s}=this.childPos(t,1),a=this.children[i];if(!(a instanceof G))return null;for(;a.children.length;){let{i:v,off:k}=a.childPos(s,1);for(;;v++){if(v==a.children.length)return null;if((a=a.children[v]).length)break}s=k}if(!(a instanceof T))return null;let u=n.findClusterBreak(a.text,s);if(u==s)return null;let p=Et(a.dom,s,u).getClientRects();for(let v=0;v<p.length;v++){let k=p[v];if(v==p.length-1||k.top<k.bottom&&k.left<k.right)return k}return null}measureVisibleLineHeights(t){let i=[],{from:s,to:a}=t,u=this.view.contentDOM.clientWidth,p=u>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,v=-1,k=this.view.textDirection==e.Direction.LTR;for(let F=0,I=0;I<this.children.length;I++){let Y=this.children[I],ie=F+Y.length;if(ie>a)break;if(F>=s){let de=Y.dom.getBoundingClientRect();if(i.push(de.height),p){let ve=Y.dom.lastChild,ke=ve?D(ve):[];if(ke.length){let Ce=ke[ke.length-1],Ae=k?Ce.right-de.left:de.right-Ce.left;Ae>v&&(v=Ae,this.minWidth=u,this.minWidthFrom=F,this.minWidthTo=ie)}}}F=ie+Y.breakAfter}return i}textDirectionAt(t){let{i}=this.childPos(t,1);return getComputedStyle(this.children[i].dom).direction=="rtl"?e.Direction.RTL:e.Direction.LTR}measureTextSize(){for(let u of this.children)if(u instanceof G){let p=u.measureTextSize();if(p)return p}let t=document.createElement("div"),i,s,a;return t.className="cm-line",t.style.width="99999px",t.style.position="absolute",t.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(t);let u=D(t.firstChild)[0];i=t.getBoundingClientRect().height,s=u?u.width/27:7,a=u?u.height:i,t.remove()}),{lineHeight:i,charWidth:s,textHeight:a}}childCursor(t=this.length){let i=this.children.length;return i&&(t-=this.children[--i].length),new ze(this.children,t,i)}computeBlockGapDeco(){let t=[],i=this.view.viewState;for(let s=0,a=0;;a++){let u=a==i.viewports.length?null:i.viewports[a],p=u?u.from-1:this.length;if(p>s){let v=(i.lineBlockAt(p).bottom-i.lineBlockAt(s).top)/this.view.scaleY;t.push(ht.replace({widget:new le(v),block:!0,inclusive:!0,isBlockGap:!0}).range(s,p))}if(!u)break;s=u.to+1}return ht.set(t)}updateDeco(){let t=1,i=this.view.state.facet($).map(u=>(this.dynamicDecorationMap[t++]=typeof u=="function")?u(this.view):u),s=!1,a=this.view.state.facet(X).map((u,p)=>{let v=typeof u=="function";return v&&(s=!0),v?u(this.view):u});for(a.length&&(this.dynamicDecorationMap[t++]=s,i.push(n.RangeSet.join(a))),this.decorations=[this.editContextFormatting,...i,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco];t<this.decorations.length;)this.dynamicDecorationMap[t++]=!1;return this.decorations}scrollIntoView(t){if(t.isSnapshot){let F=this.view.viewState.lineBlockAt(t.range.head);this.view.scrollDOM.scrollTop=F.top-t.yMargin,this.view.scrollDOM.scrollLeft=t.xMargin;return}for(let F of this.view.state.facet(wi))try{if(F(this.view,t.range,t))return!0}catch(I){U(this.view.state,I,"scroll handler")}let{range:i}=t,s=this.coordsAt(i.head,i.empty?i.assoc:i.head>i.anchor?-1:1),a;if(!s)return;!i.empty&&(a=this.coordsAt(i.anchor,i.anchor>i.head?-1:1))&&(s={left:Math.min(s.left,a.left),top:Math.min(s.top,a.top),right:Math.max(s.right,a.right),bottom:Math.max(s.bottom,a.bottom)});let u=Bt(this.view),p={left:s.left-u.left,top:s.top-u.top,right:s.right+u.right,bottom:s.bottom+u.bottom},{offsetWidth:v,offsetHeight:k}=this.view.scrollDOM;xe(this.view.scrollDOM,p,i.head<i.anchor?-1:1,t.x,t.y,Math.max(Math.min(t.xMargin,v),-v),Math.max(Math.min(t.yMargin,k),-k),this.view.textDirection==e.Direction.LTR)}}function ti(c){return c.node.nodeType==1&&c.node.firstChild&&(c.offset==0||c.node.childNodes[c.offset-1].contentEditable=="false")&&(c.offset==c.node.childNodes.length||c.node.childNodes[c.offset].contentEditable=="false")}function Mn(c,t){let i=c.observer.selectionRange;if(!i.focusNode)return null;let s=pt(i.focusNode,i.focusOffset),a=Vt(i.focusNode,i.focusOffset),u=s||a;if(a&&s&&a.node!=s.node){let v=Je.get(a.node);if(!v||v instanceof T&&v.text!=a.node.nodeValue)u=a;else if(c.docView.lastCompositionAfterCursor){let k=Je.get(s.node);!k||k instanceof T&&k.text!=s.node.nodeValue||(u=a)}}if(c.docView.lastCompositionAfterCursor=u!=s,!u)return null;let p=t-u.offset;return{from:p,to:p+u.node.nodeValue.length,node:u.node}}function $n(c,t,i){let s=Mn(c,i);if(!s)return null;let{node:a,from:u,to:p}=s,v=a.nodeValue;if(/[\n\r]/.test(v)||c.state.doc.sliceString(s.from,s.to)!=v)return null;let k=t.invertedDesc,F=new mn(k.mapPos(u),k.mapPos(p),u,p),I=[];for(let Y=a.parentNode;;Y=Y.parentNode){let ie=Je.get(Y);if(ie instanceof L)I.push({node:Y,deco:ie.mark});else{if(ie instanceof G||Y.nodeName=="DIV"&&Y.parentNode==c.contentDOM)return{range:F,text:a,marks:I,line:Y};if(Y!=c.contentDOM)I.push({node:Y,deco:new Ft({inclusive:!0,attributes:gt(Y),tagName:Y.tagName.toLowerCase()})});else return null}}}function xi(c,t){return c.nodeType!=1?0:(t&&c.childNodes[t-1].contentEditable=="false"?1:0)|(t<c.childNodes.length&&c.childNodes[t].contentEditable=="false"?2:0)}let _i=class{constructor(){this.changes=[]}compareRange(t,i){j(t,i,this.changes)}comparePoint(t,i){j(t,i,this.changes)}boundChange(t){j(t,t,this.changes)}};function Or(c,t,i){let s=new _i;return n.RangeSet.compare(c,t,i,s),s.changes}function ps(c,t){for(let i=c;i&&i!=t;i=i.assignedSlot||i.parentNode)if(i.nodeType==1&&i.contentEditable=="false")return!0;return!1}function ms(c,t){let i=!1;return t&&c.iterChangedRanges((s,a)=>{s<t.to&&a>t.from&&(i=!0)}),i}function No(c,t,i=1){let s=c.charCategorizer(t),a=c.doc.lineAt(t),u=t-a.from;if(a.length==0)return n.EditorSelection.cursor(t);u==0?i=1:u==a.length&&(i=-1);let p=u,v=u;i<0?p=n.findClusterBreak(a.text,u,!1):v=n.findClusterBreak(a.text,u);let k=s(a.text.slice(p,v));for(;p>0;){let F=n.findClusterBreak(a.text,p,!1);if(s(a.text.slice(F,p))!=k)break;p=F}for(;v<a.length;){let F=n.findClusterBreak(a.text,v);if(s(a.text.slice(v,F))!=k)break;v=F}return n.EditorSelection.range(p+a.from,v+a.from)}function gs(c,t){return t.left>c?t.left-c:Math.max(0,c-t.right)}function ys(c,t){return t.top>c?t.top-c:Math.max(0,c-t.bottom)}function Mr(c,t){return c.top<t.bottom-1&&c.bottom>t.top+1}function Lr(c,t){return t<c.top?{top:t,left:c.left,right:c.right,bottom:c.bottom}:c}function _r(c,t){return t>c.bottom?{top:c.top,left:c.left,right:c.right,bottom:t}:c}function Ri(c,t,i){let s,a,u,p,v=!1,k,F,I,Y;for(let ve=c.firstChild;ve;ve=ve.nextSibling){let ke=D(ve);for(let Ce=0;Ce<ke.length;Ce++){let Ae=ke[Ce];a&&Mr(a,Ae)&&(Ae=Lr(_r(Ae,a.bottom),a.top));let at=gs(t,Ae),vt=ys(i,Ae);if(at==0&&vt==0)return ve.nodeType==3?Rr(ve,t,i):Ri(ve,t,i);(!s||p>vt||p==vt&&u>at)&&(s=ve,a=Ae,u=at,p=vt,v=at?t<Ae.left?Ce>0:Ce<ke.length-1:!0),at==0?i>Ae.bottom&&(!I||I.bottom<Ae.bottom)?(k=ve,I=Ae):i<Ae.top&&(!Y||Y.top>Ae.top)&&(F=ve,Y=Ae):I&&Mr(I,Ae)?I=_r(I,Ae.bottom):Y&&Mr(Y,Ae)&&(Y=Lr(Y,Ae.top))}}if(I&&I.bottom>=i?(s=k,a=I):Y&&Y.top<=i&&(s=F,a=Y),!s)return{node:c,offset:0};let ie=Math.max(a.left,Math.min(a.right,t));if(s.nodeType==3)return Rr(s,ie,i);if(v&&s.contentEditable!="false")return Ri(s,ie,i);let de=Array.prototype.indexOf.call(c.childNodes,s)+(t>=(a.left+a.right)/2?1:0);return{node:c,offset:de}}function Rr(c,t,i){let s=c.nodeValue.length,a=-1,u=1e9,p=0;for(let v=0;v<s;v++){let k=Et(c,v,v+1).getClientRects();for(let F=0;F<k.length;F++){let I=k[F];if(I.top==I.bottom)continue;p||(p=t-I.left);let Y=(I.top>i?I.top-i:i-I.bottom)-1;if(I.left-1<=t&&I.right+1>=t&&Y<u){let ie=t>=(I.left+I.right)/2,de=ie;if((oe.chrome||oe.gecko)&&Et(c,v).getBoundingClientRect().left==I.right&&(de=!ie),Y<=0)return{node:c,offset:v+(de?1:0)};a=v+(de?1:0),u=Y}}}return{node:c,offset:a>-1?a:p>0?c.nodeValue.length:0}}function Fr(c,t,i,s=-1){var a,u;let p=c.contentDOM.getBoundingClientRect(),v=p.top+c.viewState.paddingTop,k,{docHeight:F}=c.viewState,{x:I,y:Y}=t,ie=Y-v;if(ie<0)return 0;if(ie>F)return c.state.doc.length;for(let dt=c.viewState.heightOracle.textHeight/2,St=!1;k=c.elementAtHeight(ie),k.type!=e.BlockType.Text;)for(;ie=s>0?k.bottom+dt:k.top-dt,!(ie>=0&&ie<=F);){if(St)return i?null:0;St=!0,s=-s}Y=v+ie;let de=k.from;if(de<c.viewport.from)return c.viewport.from==0?0:i?null:Pr(c,p,k,I,Y);if(de>c.viewport.to)return c.viewport.to==c.state.doc.length?c.state.doc.length:i?null:Pr(c,p,k,I,Y);let ve=c.dom.ownerDocument,ke=c.root.elementFromPoint?c.root:ve,Ce=ke.elementFromPoint(I,Y);Ce&&!c.contentDOM.contains(Ce)&&(Ce=null),Ce||(I=Math.max(p.left+1,Math.min(p.right-1,I)),Ce=ke.elementFromPoint(I,Y),Ce&&!c.contentDOM.contains(Ce)&&(Ce=null));let Ae,at=-1;if(Ce&&((a=c.docView.nearest(Ce))===null||a===void 0?void 0:a.isEditable)!=!1){if(ve.caretPositionFromPoint){let dt=ve.caretPositionFromPoint(I,Y);dt&&({offsetNode:Ae,offset:at}=dt)}else if(ve.caretRangeFromPoint){let dt=ve.caretRangeFromPoint(I,Y);dt&&({startContainer:Ae,startOffset:at}=dt,(!c.contentDOM.contains(Ae)||oe.safari&&vs(Ae,at,I)||oe.chrome&&bs(Ae,at,I))&&(Ae=void 0))}Ae&&(at=Math.min(te(Ae),at))}if(!Ae||!c.docView.dom.contains(Ae)){let dt=G.find(c.docView,de);if(!dt)return ie>k.top+k.height/2?k.to:k.from;({node:Ae,offset:at}=Ri(dt.dom,I,Y))}let vt=c.docView.nearest(Ae);if(!vt)return null;if(vt.isWidget&&((u=vt.dom)===null||u===void 0?void 0:u.nodeType)==1){let dt=vt.dom.getBoundingClientRect();return t.y<dt.top||t.y<=dt.bottom&&t.x<=(dt.left+dt.right)/2?vt.posAtStart:vt.posAtEnd}else return vt.localPosFromDOM(Ae,at)+vt.posAtStart}function Pr(c,t,i,s,a){let u=Math.round((s-t.left)*c.defaultCharacterWidth);if(c.lineWrapping&&i.height>c.defaultLineHeight*1.5){let v=c.viewState.heightOracle.textHeight,k=Math.floor((a-i.top-(c.defaultLineHeight-v)*.5)/v);u+=k*c.viewState.heightOracle.lineLength}let p=c.state.sliceDoc(i.from,i.to);return i.from+n.findColumn(p,u,c.state.tabSize)}function vs(c,t,i){let s,a=c;if(c.nodeType!=3||t!=(s=c.nodeValue.length))return!1;for(;;){let u=a.nextSibling;if(u){if(u.nodeName=="BR")break;return!1}else{let p=a.parentNode;if(!p||p.nodeName=="DIV")break;a=p}}return Et(c,s-1,s).getBoundingClientRect().right>i}function bs(c,t,i){if(t!=0)return!1;for(let a=c;;){let u=a.parentNode;if(!u||u.nodeType!=1||u.firstChild!=a)return!1;if(u.classList.contains("cm-line"))break;a=u}let s=c.nodeType==1?c.getBoundingClientRect():Et(c,0,Math.max(c.nodeValue.length,1)).getBoundingClientRect();return i-s.left>5}function rr(c,t,i){let s=c.lineBlockAt(t);if(Array.isArray(s.type)){let a;for(let u of s.type){if(u.from>t)break;if(!(u.to<t)){if(u.from<t&&u.to>t)return u;(!a||u.type==e.BlockType.Text&&(a.type!=u.type||(i<0?u.from<t:u.to>t)))&&(a=u)}}return a||s}return s}function Ss(c,t,i,s){let a=rr(c,t.head,t.assoc||-1),u=!s||a.type!=e.BlockType.Text||!(c.lineWrapping||a.widgetLineBreaks)?null:c.coordsAtPos(t.assoc<0&&t.head>a.from?t.head-1:t.head);if(u){let p=c.dom.getBoundingClientRect(),v=c.textDirectionAt(a.from),k=c.posAtCoords({x:i==(v==e.Direction.LTR)?p.right-1:p.left+1,y:(u.top+u.bottom)/2});if(k!=null)return n.EditorSelection.cursor(k,i?-1:1)}return n.EditorSelection.cursor(i?a.to:a.from,i?-1:1)}function Ts(c,t,i,s){let a=c.state.doc.lineAt(t.head),u=c.bidiSpans(a),p=c.textDirectionAt(a.from);for(let v=t,k=null;;){let F=B(a,u,p,v,i),I=C;if(!F){if(a.number==(i?c.state.doc.lines:1))return v;I=`
`,a=c.state.doc.line(a.number+(i?1:-1)),u=c.bidiSpans(a),F=c.visualLineSide(a,!i)}if(k){if(!k(I))return v}else{if(!s)return F;k=s(I)}v=F}}function Co(c,t,i){let s=c.state.charCategorizer(t),a=s(i);return u=>{let p=s(u);return a==n.CharCategory.Space&&(a=p),a==p}}function Ao(c,t,i,s){let a=t.head,u=i?1:-1;if(a==(i?c.state.doc.length:0))return n.EditorSelection.cursor(a,t.assoc);let p=t.goalColumn,v,k=c.contentDOM.getBoundingClientRect(),F=c.coordsAtPos(a,t.assoc||-1),I=c.documentTop;if(F)p==null&&(p=F.left-k.left),v=u<0?F.top:F.bottom;else{let de=c.viewState.lineBlockAt(a);p==null&&(p=Math.min(k.right-k.left,c.defaultCharacterWidth*(a-de.from))),v=(u<0?de.top:de.bottom)+I}let Y=k.left+p,ie=s??c.viewState.heightOracle.textHeight>>1;for(let de=0;;de+=10){let ve=v+(ie+de)*u,ke=Fr(c,{x:Y,y:ve},!1,u);if(ve<k.top||ve>k.bottom||(u<0?ke<a:ke>a)){let Ce=c.docView.coordsForChar(ke),Ae=!Ce||ve<Ce.top?-1:1;return n.EditorSelection.cursor(ke,Ae,void 0,p)}}}function Fi(c,t,i){for(;;){let s=0;for(let a of c)a.between(t-1,t+1,(u,p,v)=>{if(t>u&&t<p){let k=s||i||(t-u<p-t?-1:1);t=k<0?u:p,s=k}});if(!s)return t}}function sr(c,t,i){let s=Fi(c.state.facet(he).map(a=>a(c)),i.from,t.head>i.from?-1:1);return s==i.from?i:n.EditorSelection.cursor(s,s<i.from?1:-1)}const Pi="ï¿¿";class Br{constructor(t,i){this.points=t,this.text="",this.lineSeparator=i.facet(n.EditorState.lineSeparator)}append(t){this.text+=t}lineBreak(){this.text+=Pi}readRange(t,i){if(!t)return this;let s=t.parentNode;for(let a=t;;){this.findPointBefore(s,a);let u=this.text.length;this.readNode(a);let p=a.nextSibling;if(p==i)break;let v=Je.get(a),k=Je.get(p);(v&&k?v.breakAfter:(v?v.breakAfter:z(a))||z(p)&&(a.nodeName!="BR"||a.cmIgnore)&&this.text.length>u)&&this.lineBreak(),a=p}return this.findPointBefore(s,i),this}readTextNode(t){let i=t.nodeValue;for(let s of this.points)s.node==t&&(s.pos=this.text.length+Math.min(s.offset,i.length));for(let s=0,a=this.lineSeparator?null:/\r\n?|\n/g;;){let u=-1,p=1,v;if(this.lineSeparator?(u=i.indexOf(this.lineSeparator,s),p=this.lineSeparator.length):(v=a.exec(i))&&(u=v.index,p=v[0].length),this.append(i.slice(s,u<0?i.length:u)),u<0)break;if(this.lineBreak(),p>1)for(let k of this.points)k.node==t&&k.pos>this.text.length&&(k.pos-=p-1);s=u+p}}readNode(t){if(t.cmIgnore)return;let i=Je.get(t),s=i&&i.overrideDOMText;if(s!=null){this.findPointInside(t,s.length);for(let a=s.iter();!a.next().done;)a.lineBreak?this.lineBreak():this.append(a.value)}else t.nodeType==3?this.readTextNode(t):t.nodeName=="BR"?t.nextSibling&&this.lineBreak():t.nodeType==1&&this.readRange(t.firstChild,null)}findPointBefore(t,i){for(let s of this.points)s.node==t&&t.childNodes[s.offset]==i&&(s.pos=this.text.length)}findPointInside(t,i){for(let s of this.points)(t.nodeType==3?s.node==t:t.contains(s.node))&&(s.pos=this.text.length+(Es(t,s.node,s.offset)?i:0))}}function Es(c,t,i){for(;;){if(!t||i<te(t))return!1;if(t==c)return!0;i=W(t)+1,t=t.parentNode}}class Hi{constructor(t,i){this.node=t,this.offset=i,this.pos=-1}}class Vr{constructor(t,i,s,a){this.typeOver=a,this.bounds=null,this.text="",this.domChanged=i>-1;let{impreciseHead:u,impreciseAnchor:p}=t.docView;if(t.state.readOnly&&i>-1)this.newSel=null;else if(i>-1&&(this.bounds=t.docView.domBoundsAround(i,s,0))){let v=u||p?[]:ks(t),k=new Br(v,t.state);k.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=k.text,this.newSel=Io(v,this.bounds.from)}else{let v=t.observer.selectionRange,k=u&&u.node==v.focusNode&&u.offset==v.focusOffset||!y(t.contentDOM,v.focusNode)?t.state.selection.main.head:t.docView.posFromDOM(v.focusNode,v.focusOffset),F=p&&p.node==v.anchorNode&&p.offset==v.anchorOffset||!y(t.contentDOM,v.anchorNode)?t.state.selection.main.anchor:t.docView.posFromDOM(v.anchorNode,v.anchorOffset),I=t.viewport;if((oe.ios||oe.chrome)&&t.state.selection.main.empty&&k!=F&&(I.from>0||I.to<t.state.doc.length)){let Y=Math.min(k,F),ie=Math.max(k,F),de=I.from-Y,ve=I.to-ie;(de==0||de==1||Y==0)&&(ve==0||ve==-1||ie==t.state.doc.length)&&(k=0,F=t.state.doc.length)}this.newSel=n.EditorSelection.single(F,k)}}}function jr(c,t){let i,{newSel:s}=t,a=c.state.selection.main,u=c.inputState.lastKeyTime>Date.now()-100?c.inputState.lastKeyCode:-1;if(t.bounds){let{from:p,to:v}=t.bounds,k=a.from,F=null;(u===8||oe.android&&t.text.length<v-p)&&(k=a.to,F="end");let I=ws(c.state.doc.sliceString(p,v,Pi),t.text,k-p,F);I&&(oe.chrome&&u==13&&I.toB==I.from+2&&t.text.slice(I.from,I.toB)==Pi+Pi&&I.toB--,i={from:p+I.from,to:p+I.toA,insert:n.Text.of(t.text.slice(I.from,I.toB).split(Pi))})}else s&&(!c.hasFocus&&c.state.facet(x)||s.main.eq(a))&&(s=null);if(!i&&!s)return!1;if(!i&&t.typeOver&&!a.empty&&s&&s.main.empty?i={from:a.from,to:a.to,insert:c.state.doc.slice(a.from,a.to)}:(oe.mac||oe.android)&&i&&i.from==i.to&&i.from==a.head-1&&/^\. ?$/.test(i.insert.toString())&&c.contentDOM.getAttribute("autocorrect")=="off"?(s&&i.insert.length==2&&(s=n.EditorSelection.single(s.main.anchor-1,s.main.head-1)),i={from:i.from,to:i.to,insert:n.Text.of([i.insert.toString().replace("."," ")])}):i&&i.from>=a.from&&i.to<=a.to&&(i.from!=a.from||i.to!=a.to)&&a.to-a.from-(i.to-i.from)<=4?i={from:a.from,to:a.to,insert:c.state.doc.slice(a.from,i.from).append(i.insert).append(c.state.doc.slice(i.to,a.to))}:oe.chrome&&i&&i.from==i.to&&i.from==a.head&&i.insert.toString()==`
 `&&c.lineWrapping&&(s&&(s=n.EditorSelection.single(s.main.anchor-1,s.main.head-1)),i={from:a.from,to:a.to,insert:n.Text.of([" "])}),i)return Ur(c,i,s,u);if(s&&!s.main.eq(a)){let p=!1,v="select";return c.inputState.lastSelectionTime>Date.now()-50&&(c.inputState.lastSelectionOrigin=="select"&&(p=!0),v=c.inputState.lastSelectionOrigin),c.dispatch({selection:s,scrollIntoView:p,userEvent:v}),!0}else return!1}function Ur(c,t,i,s=-1){if(oe.ios&&c.inputState.flushIOSKey(t))return!0;let a=c.state.selection.main;if(oe.android&&(t.to==a.to&&(t.from==a.from||t.from==a.from-1&&c.state.sliceDoc(t.from,a.from)==" ")&&t.insert.length==1&&t.insert.lines==2&&ut(c.contentDOM,"Enter",13)||(t.from==a.from-1&&t.to==a.to&&t.insert.length==0||s==8&&t.insert.length<t.to-t.from&&t.to>a.head)&&ut(c.contentDOM,"Backspace",8)||t.from==a.from&&t.to==a.to+1&&t.insert.length==0&&ut(c.contentDOM,"Delete",46)))return!0;let u=t.insert.toString();c.inputState.composing>=0&&c.inputState.composing++;let p,v=()=>p||(p=Do(c,t,i));return c.state.facet(nt).some(k=>k(c,t.from,t.to,u,v))||c.dispatch(v()),!0}function Do(c,t,i){let s,a=c.state,u=a.selection.main;if(t.from>=u.from&&t.to<=u.to&&t.to-t.from>=(u.to-u.from)/3&&(!i||i.main.empty&&i.main.from==t.from+t.insert.length)&&c.inputState.composing<0){let v=u.from<t.from?a.sliceDoc(u.from,t.from):"",k=u.to>t.to?a.sliceDoc(t.to,u.to):"";s=a.replaceSelection(c.state.toText(v+t.insert.sliceString(0,void 0,c.state.lineBreak)+k))}else{let v=a.changes(t),k=i&&i.main.to<=v.newLength?i.main:void 0;if(a.selection.ranges.length>1&&c.inputState.composing>=0&&t.to<=u.to&&t.to>=u.to-10){let F=c.state.sliceDoc(t.from,t.to),I,Y=i&&Mn(c,i.main.head);if(Y){let ve=t.insert.length-(t.to-t.from);I={from:Y.from,to:Y.to-ve}}else I=c.state.doc.lineAt(u.head);let ie=u.to-t.to,de=u.to-u.from;s=a.changeByRange(ve=>{if(ve.from==u.from&&ve.to==u.to)return{changes:v,range:k||ve.map(v)};let ke=ve.to-ie,Ce=ke-F.length;if(ve.to-ve.from!=de||c.state.sliceDoc(Ce,ke)!=F||ve.to>=I.from&&ve.from<=I.to)return{range:ve};let Ae=a.changes({from:Ce,to:ke,insert:t.insert}),at=ve.to-u.to;return{changes:Ae,range:k?n.EditorSelection.range(Math.max(0,k.anchor+at),Math.max(0,k.head+at)):ve.map(Ae)}})}else s={changes:v,selection:k&&a.selection.replaceRange(k)}}let p="input.type";return(c.composing||c.inputState.compositionPendingChange&&c.inputState.compositionEndedAt>Date.now()-50)&&(c.inputState.compositionPendingChange=!1,p+=".compose",c.inputState.compositionFirstChange&&(p+=".start",c.inputState.compositionFirstChange=!1)),a.update(s,{userEvent:p,scrollIntoView:!0})}function ws(c,t,i,s){let a=Math.min(c.length,t.length),u=0;for(;u<a&&c.charCodeAt(u)==t.charCodeAt(u);)u++;if(u==a&&c.length==t.length)return null;let p=c.length,v=t.length;for(;p>0&&v>0&&c.charCodeAt(p-1)==t.charCodeAt(v-1);)p--,v--;if(s=="end"){let k=Math.max(0,u-Math.min(p,v));i-=p+k-u}if(p<u&&c.length<t.length){let k=i<=u&&i>=p?u-i:0;u-=k,v=u+(v-p),p=u}else if(v<u){let k=i<=u&&i>=v?u-i:0;u-=k,p=u+(p-v),v=u}return{from:u,toA:p,toB:v}}function ks(c){let t=[];if(c.root.activeElement!=c.contentDOM)return t;let{anchorNode:i,anchorOffset:s,focusNode:a,focusOffset:u}=c.observer.selectionRange;return i&&(t.push(new Hi(i,s)),(a!=i||u!=s)&&t.push(new Hi(a,u))),t}function Io(c,t){if(c.length==0)return null;let i=c[0].pos,s=c.length==2?c[1].pos:i;return i>-1&&s>-1?n.EditorSelection.single(i+t,s+t):null}class Oo{setSelectionOrigin(t){this.lastSelectionOrigin=t,this.lastSelectionTime=Date.now()}constructor(t){this.view=t,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.tabFocusMode=-1,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=t.hasFocus,oe.safari&&t.contentDOM.addEventListener("input",()=>null),oe.gecko&&wf(t.contentDOM.ownerDocument)}handleEvent(t){!vn(this.view,t)||this.ignoreDuringComposition(t)||t.type=="keydown"&&this.keydown(t)||(this.view.updateState!=0?Promise.resolve().then(()=>this.runHandlers(t.type,t)):this.runHandlers(t.type,t))}runHandlers(t,i){let s=this.handlers[t];if(s){for(let a of s.observers)a(this.view,i);for(let a of s.handlers){if(i.defaultPrevented)break;if(a(this.view,i)){i.preventDefault();break}}}}ensureHandlers(t){let i=_(t),s=this.handlers,a=this.view.contentDOM;for(let u in i)if(u!="scroll"){let p=!i[u].handlers.length,v=s[u];v&&p!=!v.handlers.length&&(a.removeEventListener(u,this.handleEvent),v=null),v||a.addEventListener(u,this.handleEvent,{passive:p})}for(let u in s)u!="scroll"&&!i[u]&&a.removeEventListener(u,this.handleEvent);this.handlers=i}keydown(t){if(this.lastKeyCode=t.keyCode,this.lastKeyTime=Date.now(),t.keyCode==9&&this.tabFocusMode>-1&&(!this.tabFocusMode||Date.now()<=this.tabFocusMode))return!0;if(this.tabFocusMode>0&&t.keyCode!=27&&ue.indexOf(t.keyCode)<0&&(this.tabFocusMode=-1),oe.android&&oe.chrome&&!t.synthetic&&(t.keyCode==13||t.keyCode==8))return this.view.observer.delayAndroidKey(t.key,t.keyCode),!0;let i;return oe.ios&&!t.synthetic&&!t.altKey&&!t.metaKey&&((i=K.find(s=>s.keyCode==t.keyCode))&&!t.ctrlKey||Q.indexOf(t.key)>-1&&t.ctrlKey&&!t.shiftKey)?(this.pendingIOSKey=i||t,setTimeout(()=>this.flushIOSKey(),250),!0):(t.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(t){let i=this.pendingIOSKey;return!i||i.key=="Enter"&&t&&t.from<t.to&&/^\S+$/.test(t.insert.toString())?!1:(this.pendingIOSKey=void 0,ut(this.view.contentDOM,i.key,i.keyCode,i instanceof KeyboardEvent?i:void 0))}ignoreDuringComposition(t){return/^key/.test(t.type)?this.composing>0?!0:oe.safari&&!oe.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(t){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=t}update(t){this.view.observer.update(t),this.mouseSelection&&this.mouseSelection.update(t),this.draggedContent&&t.docChanged&&(this.draggedContent=this.draggedContent.map(t.changes)),t.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function w(c,t){return(i,s)=>{try{return t.call(c,s,i)}catch(a){U(i.state,a)}}}function _(c){let t=Object.create(null);function i(s){return t[s]||(t[s]={observers:[],handlers:[]})}for(let s of c){let a=s.spec,u=a&&a.plugin.domEventHandlers,p=a&&a.plugin.domEventObservers;if(u)for(let v in u){let k=u[v];k&&i(v).handlers.push(w(s.value,k))}if(p)for(let v in p){let k=p[v];k&&i(v).observers.push(w(s.value,k))}}for(let s in Cn)i(s).handlers.push(Cn[s]);for(let s in bn)i(s).observers.push(bn[s]);return t}const K=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],Q="dthko",ue=[16,17,18,20,91,92,224,225],ae=6;function pe(c){return Math.max(0,c)*.7+8}function Oe(c,t){return Math.max(Math.abs(c.clientX-t.clientX),Math.abs(c.clientY-t.clientY))}class Xe{constructor(t,i,s,a){this.view=t,this.startEvent=i,this.style=s,this.mustSelect=a,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=i,this.scrollParents=Qe(t.contentDOM),this.atoms=t.state.facet(he).map(p=>p(t));let u=t.contentDOM.ownerDocument;u.addEventListener("mousemove",this.move=this.move.bind(this)),u.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=i.shiftKey,this.multiple=t.state.facet(n.EditorState.allowMultipleSelections)&&Dt(t,i),this.dragging=tn(t,i)&&ca(i)==1?null:!1}start(t){this.dragging===!1&&this.select(t)}move(t){if(t.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&Oe(this.startEvent,t)<10)return;this.select(this.lastEvent=t);let i=0,s=0,a=0,u=0,p=this.view.win.innerWidth,v=this.view.win.innerHeight;this.scrollParents.x&&({left:a,right:p}=this.scrollParents.x.getBoundingClientRect()),this.scrollParents.y&&({top:u,bottom:v}=this.scrollParents.y.getBoundingClientRect());let k=Bt(this.view);t.clientX-k.left<=a+ae?i=-pe(a-t.clientX):t.clientX+k.right>=p-ae&&(i=pe(t.clientX-p)),t.clientY-k.top<=u+ae?s=-pe(u-t.clientY):t.clientY+k.bottom>=v-ae&&(s=pe(t.clientY-v)),this.setScrollSpeed(i,s)}up(t){this.dragging==null&&this.select(this.lastEvent),this.dragging||t.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let t=this.view.contentDOM.ownerDocument;t.removeEventListener("mousemove",this.move),t.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(t,i){this.scrollSpeed={x:t,y:i},t||i?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){let{x:t,y:i}=this.scrollSpeed;t&&this.scrollParents.x&&(this.scrollParents.x.scrollLeft+=t,t=0),i&&this.scrollParents.y&&(this.scrollParents.y.scrollTop+=i,i=0),(t||i)&&this.view.win.scrollBy(t,i),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(t){let i=null;for(let s=0;s<t.ranges.length;s++){let a=t.ranges[s],u=null;if(a.empty){let p=Fi(this.atoms,a.from,0);p!=a.from&&(u=n.EditorSelection.cursor(p,-1))}else{let p=Fi(this.atoms,a.from,-1),v=Fi(this.atoms,a.to,1);(p!=a.from||v!=a.to)&&(u=n.EditorSelection.range(a.from==a.anchor?p:v,a.from==a.head?p:v))}u&&(i||(i=t.ranges.slice()),i[s]=u)}return i?n.EditorSelection.create(i,t.mainIndex):t}select(t){let{view:i}=this,s=this.skipAtoms(this.style.get(t,this.extend,this.multiple));(this.mustSelect||!s.eq(i.state.selection,this.dragging===!1))&&this.view.dispatch({selection:s,userEvent:"select.pointer"}),this.mustSelect=!1}update(t){t.transactions.some(i=>i.isUserEvent("input.type"))?this.destroy():this.style.update(t)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Dt(c,t){let i=c.state.facet(ee);return i.length?i[0](t):oe.mac?t.metaKey:t.ctrlKey}function bt(c,t){let i=c.state.facet(ce);return i.length?i[0](t):oe.mac?!t.altKey:!t.ctrlKey}function tn(c,t){let{main:i}=c.state.selection;if(i.empty)return!1;let s=h(c.root);if(!s||s.rangeCount==0)return!0;let a=s.getRangeAt(0).getClientRects();for(let u=0;u<a.length;u++){let p=a[u];if(p.left<=t.clientX&&p.right>=t.clientX&&p.top<=t.clientY&&p.bottom>=t.clientY)return!0}return!1}function vn(c,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let i=t.target,s;i!=c.contentDOM;i=i.parentNode)if(!i||i.nodeType==11||(s=Je.get(i))&&s.ignoreEvent(t))return!1;return!0}const Cn=Object.create(null),bn=Object.create(null),Wi=oe.ie&&oe.ie_version<15||oe.ios&&oe.webkit_version<604;function gf(c){let t=c.dom.parentNode;if(!t)return;let i=t.appendChild(document.createElement("textarea"));i.style.cssText="position: fixed; left: -10000px; top: 10px",i.focus(),setTimeout(()=>{c.focus(),i.remove(),na(c,i.value)},50)}function xs(c,t,i){for(let s of c.facet(t))i=s(i,c);return i}function na(c,t){t=xs(c.state,zt,t);let{state:i}=c,s,a=1,u=i.toText(t),p=u.lines==i.selection.ranges.length;if(Mo!=null&&i.selection.ranges.every(k=>k.empty)&&Mo==u.toString()){let k=-1;s=i.changeByRange(F=>{let I=i.doc.lineAt(F.from);if(I.from==k)return{range:F};k=I.from;let Y=i.toText((p?u.line(a++).text:t)+i.lineBreak);return{changes:{from:I.from,insert:Y},range:n.EditorSelection.cursor(F.from+Y.length)}})}else p?s=i.changeByRange(k=>{let F=u.line(a++);return{changes:{from:k.from,to:k.to,insert:F.text},range:n.EditorSelection.cursor(k.from+F.length)}}):s=i.replaceSelection(u);c.dispatch(s,{userEvent:"input.paste",scrollIntoView:!0})}bn.scroll=c=>{c.inputState.lastScrollTop=c.scrollDOM.scrollTop,c.inputState.lastScrollLeft=c.scrollDOM.scrollLeft},Cn.keydown=(c,t)=>(c.inputState.setSelectionOrigin("select"),t.keyCode==27&&c.inputState.tabFocusMode!=0&&(c.inputState.tabFocusMode=Date.now()+2e3),!1),bn.touchstart=(c,t)=>{c.inputState.lastTouchTime=Date.now(),c.inputState.setSelectionOrigin("select.pointer")},bn.touchmove=c=>{c.inputState.setSelectionOrigin("select.pointer")},Cn.mousedown=(c,t)=>{if(c.observer.flush(),c.inputState.lastTouchTime>Date.now()-2e3)return!1;let i=null;for(let s of c.state.facet(Te))if(i=s(c,t),i)break;if(!i&&t.button==0&&(i=bf(c,t)),i){let s=!c.hasFocus;c.inputState.startMouseSelection(new Xe(c,t,i,s)),s&&c.observer.ignore(()=>{ot(c.contentDOM);let u=c.root.activeElement;u&&!u.contains(c.contentDOM)&&u.blur()});let a=c.inputState.mouseSelection;if(a)return a.start(t),a.dragging===!1}return!1};function ia(c,t,i,s){if(s==1)return n.EditorSelection.cursor(t,i);if(s==2)return No(c.state,t,i);{let a=G.find(c.docView,t),u=c.state.doc.lineAt(a?a.posAtEnd:t),p=a?a.posAtStart:u.from,v=a?a.posAtEnd:u.to;return v<c.state.doc.length&&v==u.to&&v++,n.EditorSelection.range(p,v)}}let ra=(c,t,i)=>t>=i.top&&t<=i.bottom&&c>=i.left&&c<=i.right;function yf(c,t,i,s){let a=G.find(c.docView,t);if(!a)return 1;let u=t-a.posAtStart;if(u==0)return 1;if(u==a.length)return-1;let p=a.coordsAt(u,-1);if(p&&ra(i,s,p))return-1;let v=a.coordsAt(u,1);return v&&ra(i,s,v)?1:p&&p.bottom>=s?-1:1}function sa(c,t){let i=c.posAtCoords({x:t.clientX,y:t.clientY},!1);return{pos:i,bias:yf(c,i,t.clientX,t.clientY)}}const vf=oe.ie&&oe.ie_version<=11;let oa=null,la=0,aa=0;function ca(c){if(!vf)return c.detail;let t=oa,i=aa;return oa=c,aa=Date.now(),la=!t||i>Date.now()-400&&Math.abs(t.clientX-c.clientX)<2&&Math.abs(t.clientY-c.clientY)<2?(la+1)%3:1}function bf(c,t){let i=sa(c,t),s=ca(t),a=c.state.selection;return{update(u){u.docChanged&&(i.pos=u.changes.mapPos(i.pos),a=a.map(u.changes))},get(u,p,v){let k=sa(c,u),F,I=ia(c,k.pos,k.bias,s);if(i.pos!=k.pos&&!p){let Y=ia(c,i.pos,i.bias,s),ie=Math.min(Y.from,I.from),de=Math.max(Y.to,I.to);I=ie<I.from?n.EditorSelection.range(ie,de):n.EditorSelection.range(de,ie)}return p?a.replaceRange(a.main.extend(I.from,I.to)):v&&s==1&&a.ranges.length>1&&(F=Sf(a,k.pos))?F:v?a.addRange(I):n.EditorSelection.create([I])}}}function Sf(c,t){for(let i=0;i<c.ranges.length;i++){let{from:s,to:a}=c.ranges[i];if(s<=t&&a>=t)return n.EditorSelection.create(c.ranges.slice(0,i).concat(c.ranges.slice(i+1)),c.mainIndex==i?0:c.mainIndex-(c.mainIndex>i?1:0))}return null}Cn.dragstart=(c,t)=>{let{selection:{main:i}}=c.state;if(t.target.draggable){let a=c.docView.nearest(t.target);if(a&&a.isWidget){let u=a.posAtStart,p=u+a.length;(u>=i.to||p<=i.from)&&(i=n.EditorSelection.range(u,p))}}let{inputState:s}=c;return s.mouseSelection&&(s.mouseSelection.dragging=!0),s.draggedContent=i,t.dataTransfer&&(t.dataTransfer.setData("Text",xs(c.state,An,c.state.sliceDoc(i.from,i.to))),t.dataTransfer.effectAllowed="copyMove"),!1},Cn.dragend=c=>(c.inputState.draggedContent=null,!1);function ua(c,t,i,s){if(i=xs(c.state,zt,i),!i)return;let a=c.posAtCoords({x:t.clientX,y:t.clientY},!1),{draggedContent:u}=c.inputState,p=s&&u&&bt(c,t)?{from:u.from,to:u.to}:null,v={from:a,insert:i},k=c.state.changes(p?[p,v]:v);c.focus(),c.dispatch({changes:k,selection:{anchor:k.mapPos(a,-1),head:k.mapPos(a,1)},userEvent:p?"move.drop":"input.drop"}),c.inputState.draggedContent=null}Cn.drop=(c,t)=>{if(!t.dataTransfer)return!1;if(c.state.readOnly)return!0;let i=t.dataTransfer.files;if(i&&i.length){let s=Array(i.length),a=0,u=()=>{++a==i.length&&ua(c,t,s.filter(p=>p!=null).join(c.state.lineBreak),!1)};for(let p=0;p<i.length;p++){let v=new FileReader;v.onerror=u,v.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(v.result)||(s[p]=v.result),u()},v.readAsText(i[p])}return!0}else{let s=t.dataTransfer.getData("Text");if(s)return ua(c,t,s,!0),!0}return!1},Cn.paste=(c,t)=>{if(c.state.readOnly)return!0;c.observer.flush();let i=Wi?null:t.clipboardData;return i?(na(c,i.getData("text/plain")||i.getData("text/uri-list")),!0):(gf(c),!1)};function Tf(c,t){let i=c.dom.parentNode;if(!i)return;let s=i.appendChild(document.createElement("textarea"));s.style.cssText="position: fixed; left: -10000px; top: 10px",s.value=t,s.focus(),s.selectionEnd=t.length,s.selectionStart=0,setTimeout(()=>{s.remove(),c.focus()},50)}function Ef(c){let t=[],i=[],s=!1;for(let a of c.selection.ranges)a.empty||(t.push(c.sliceDoc(a.from,a.to)),i.push(a));if(!t.length){let a=-1;for(let{from:u}of c.selection.ranges){let p=c.doc.lineAt(u);p.number>a&&(t.push(p.text),i.push({from:p.from,to:Math.min(c.doc.length,p.to+1)})),a=p.number}s=!0}return{text:xs(c,An,t.join(c.lineBreak)),ranges:i,linewise:s}}let Mo=null;Cn.copy=Cn.cut=(c,t)=>{let{text:i,ranges:s,linewise:a}=Ef(c.state);if(!i&&!a)return!1;Mo=a?i:null,t.type=="cut"&&!c.state.readOnly&&c.dispatch({changes:s,scrollIntoView:!0,userEvent:"delete.cut"});let u=Wi?null:t.clipboardData;return u?(u.clearData(),u.setData("text/plain",i),!0):(Tf(c,i),!1)};const ha=n.Annotation.define();function fa(c,t){let i=[];for(let s of c.facet(it)){let a=s(c,t);a&&i.push(a)}return i.length?c.update({effects:i,annotations:ha.of(!0)}):null}function da(c){setTimeout(()=>{let t=c.hasFocus;if(t!=c.inputState.notifiedFocused){let i=fa(c.state,t);i?c.dispatch(i):c.update([])}},10)}bn.focus=c=>{c.inputState.lastFocusTime=Date.now(),!c.scrollDOM.scrollTop&&(c.inputState.lastScrollTop||c.inputState.lastScrollLeft)&&(c.scrollDOM.scrollTop=c.inputState.lastScrollTop,c.scrollDOM.scrollLeft=c.inputState.lastScrollLeft),da(c)},bn.blur=c=>{c.observer.clearSelectionRange(),da(c)},bn.compositionstart=bn.compositionupdate=c=>{c.observer.editContext||(c.inputState.compositionFirstChange==null&&(c.inputState.compositionFirstChange=!0),c.inputState.composing<0&&(c.inputState.composing=0))},bn.compositionend=c=>{c.observer.editContext||(c.inputState.composing=-1,c.inputState.compositionEndedAt=Date.now(),c.inputState.compositionPendingKey=!0,c.inputState.compositionPendingChange=c.observer.pendingRecords().length>0,c.inputState.compositionFirstChange=null,oe.chrome&&oe.android?c.observer.flushSoon():c.inputState.compositionPendingChange?Promise.resolve().then(()=>c.observer.flush()):setTimeout(()=>{c.inputState.composing<0&&c.docView.hasComposition&&c.update([])},50))},bn.contextmenu=c=>{c.inputState.lastContextMenu=Date.now()},Cn.beforeinput=(c,t)=>{var i,s;if(t.inputType=="insertReplacementText"&&c.observer.editContext){let u=(i=t.dataTransfer)===null||i===void 0?void 0:i.getData("text/plain"),p=t.getTargetRanges();if(u&&p.length){let v=p[0],k=c.posAtDOM(v.startContainer,v.startOffset),F=c.posAtDOM(v.endContainer,v.endOffset);return Ur(c,{from:k,to:F,insert:c.state.toText(u)},null),!0}}let a;if(oe.chrome&&oe.android&&(a=K.find(u=>u.inputType==t.inputType))&&(c.observer.delayAndroidKey(a.key,a.keyCode),a.key=="Backspace"||a.key=="Delete")){let u=((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0;setTimeout(()=>{var p;(((p=window.visualViewport)===null||p===void 0?void 0:p.height)||0)>u+10&&c.hasFocus&&(c.contentDOM.blur(),c.focus())},100)}return oe.ios&&t.inputType=="deleteContentForward"&&c.observer.flushSoon(),oe.safari&&t.inputType=="insertText"&&c.inputState.composing>=0&&setTimeout(()=>bn.compositionend(c,t),20),!1};const pa=new Set;function wf(c){pa.has(c)||(pa.add(c),c.addEventListener("copy",()=>{}),c.addEventListener("cut",()=>{}))}const ma=["pre-wrap","normal","pre-line","break-spaces"];let qi=!1;function Lo(){qi=!1}class ga{constructor(t){this.lineWrapping=t,this.doc=n.Text.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30}heightForGap(t,i){let s=this.doc.lineAt(i).number-this.doc.lineAt(t).number+1;return this.lineWrapping&&(s+=Math.max(0,Math.ceil((i-t-s*this.lineLength*.5)/this.lineLength))),this.lineHeight*s}heightForLine(t){return this.lineWrapping?(1+Math.max(0,Math.ceil((t-this.lineLength)/Math.max(1,this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(t){return this.doc=t,this}mustRefreshForWrapping(t){return ma.indexOf(t)>-1!=this.lineWrapping}mustRefreshForHeights(t){let i=!1;for(let s=0;s<t.length;s++){let a=t[s];a<0?s++:this.heightSamples[Math.floor(a*10)]||(i=!0,this.heightSamples[Math.floor(a*10)]=!0)}return i}refresh(t,i,s,a,u,p){let v=ma.indexOf(t)>-1,k=Math.round(i)!=Math.round(this.lineHeight)||this.lineWrapping!=v;if(this.lineWrapping=v,this.lineHeight=i,this.charWidth=s,this.textHeight=a,this.lineLength=u,k){this.heightSamples={};for(let F=0;F<p.length;F++){let I=p[F];I<0?F++:this.heightSamples[Math.floor(I*10)]=!0}}return k}}class ya{constructor(t,i){this.from=t,this.heights=i,this.index=0}get more(){return this.index<this.heights.length}}class di{constructor(t,i,s,a,u){this.from=t,this.length=i,this.top=s,this.height=a,this._content=u}get type(){return typeof this._content=="number"?e.BlockType.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof At?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(t){let i=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(t._content)?t._content:[t]);return new di(this.from,this.length+t.length,this.top,this.height+t.height,i)}}var Sn;(function(c){c[c.ByPos=0]="ByPos",c[c.ByHeight=1]="ByHeight",c[c.ByPosNoHeight=2]="ByPosNoHeight"})(Sn||(Sn={}));const Ns=.001;class Jn{constructor(t,i,s=2){this.length=t,this.height=i,this.flags=s}get outdated(){return(this.flags&2)>0}set outdated(t){this.flags=(t?2:0)|this.flags&-3}setHeight(t){this.height!=t&&(Math.abs(this.height-t)>Ns&&(qi=!0),this.height=t)}replace(t,i,s){return Jn.of(s)}decomposeLeft(t,i){i.push(this)}decomposeRight(t,i){i.push(this)}applyChanges(t,i,s,a){let u=this,p=s.doc;for(let v=a.length-1;v>=0;v--){let{fromA:k,toA:F,fromB:I,toB:Y}=a[v],ie=u.lineAt(k,Sn.ByPosNoHeight,s.setDoc(i),0,0),de=ie.to>=F?ie:u.lineAt(F,Sn.ByPosNoHeight,s,0,0);for(Y+=de.to-F,F=de.to;v>0&&ie.from<=a[v-1].toA;)k=a[v-1].fromA,I=a[v-1].fromB,v--,k<ie.from&&(ie=u.lineAt(k,Sn.ByPosNoHeight,s,0,0));I+=ie.from-k,k=ie.from;let ve=_o.build(s.setDoc(p),t,I,Y);u=Cs(u,u.replace(k,F,ve))}return u.updateHeight(s,0)}static empty(){return new oi(0,0)}static of(t){if(t.length==1)return t[0];let i=0,s=t.length,a=0,u=0;for(;;)if(i==s)if(a>u*2){let v=t[i-1];v.break?t.splice(--i,1,v.left,null,v.right):t.splice(--i,1,v.left,v.right),s+=1+v.break,a-=v.size}else if(u>a*2){let v=t[s];v.break?t.splice(s,1,v.left,null,v.right):t.splice(s,1,v.left,v.right),s+=2+v.break,u-=v.size}else break;else if(a<u){let v=t[i++];v&&(a+=v.size)}else{let v=t[--s];v&&(u+=v.size)}let p=0;return t[i-1]==null?(p=1,i--):t[i]==null&&(p=1,s++),new kf(Jn.of(t.slice(0,i)),p,Jn.of(t.slice(s)))}}function Cs(c,t){return c==t?c:(c.constructor!=t.constructor&&(qi=!0),t)}Jn.prototype.size=1;class va extends Jn{constructor(t,i,s){super(t,i),this.deco=s}blockAt(t,i,s,a){return new di(a,this.length,s,this.height,this.deco||0)}lineAt(t,i,s,a,u){return this.blockAt(0,s,a,u)}forEachLine(t,i,s,a,u,p){t<=u+this.length&&i>=u&&p(this.blockAt(0,s,a,u))}updateHeight(t,i=0,s=!1,a){return a&&a.from<=i&&a.more&&this.setHeight(a.heights[a.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class oi extends va{constructor(t,i){super(t,i,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(t,i,s,a){return new di(a,this.length,s,this.height,this.breaks)}replace(t,i,s){let a=s[0];return s.length==1&&(a instanceof oi||a instanceof zn&&a.flags&4)&&Math.abs(this.length-a.length)<10?(a instanceof zn?a=new oi(a.length,this.height):a.height=this.height,this.outdated||(a.outdated=!1),a):Jn.of(s)}updateHeight(t,i=0,s=!1,a){return a&&a.from<=i&&a.more?this.setHeight(a.heights[a.index++]):(s||this.outdated)&&this.setHeight(Math.max(this.widgetHeight,t.heightForLine(this.length-this.collapsed))+this.breaks*t.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class zn extends Jn{constructor(t){super(t,0)}heightMetrics(t,i){let s=t.doc.lineAt(i).number,a=t.doc.lineAt(i+this.length).number,u=a-s+1,p,v=0;if(t.lineWrapping){let k=Math.min(this.height,t.lineHeight*u);p=k/u,this.length>u+1&&(v=(this.height-k)/(this.length-u-1))}else p=this.height/u;return{firstLine:s,lastLine:a,perLine:p,perChar:v}}blockAt(t,i,s,a){let{firstLine:u,lastLine:p,perLine:v,perChar:k}=this.heightMetrics(i,a);if(i.lineWrapping){let F=a+(t<i.lineHeight?0:Math.round(Math.max(0,Math.min(1,(t-s)/this.height))*this.length)),I=i.doc.lineAt(F),Y=v+I.length*k,ie=Math.max(s,t-Y/2);return new di(I.from,I.length,ie,Y,0)}else{let F=Math.max(0,Math.min(p-u,Math.floor((t-s)/v))),{from:I,length:Y}=i.doc.line(u+F);return new di(I,Y,s+v*F,v,0)}}lineAt(t,i,s,a,u){if(i==Sn.ByHeight)return this.blockAt(t,s,a,u);if(i==Sn.ByPosNoHeight){let{from:de,to:ve}=s.doc.lineAt(t);return new di(de,ve-de,0,0,0)}let{firstLine:p,perLine:v,perChar:k}=this.heightMetrics(s,u),F=s.doc.lineAt(t),I=v+F.length*k,Y=F.number-p,ie=a+v*Y+k*(F.from-u-Y);return new di(F.from,F.length,Math.max(a,Math.min(ie,a+this.height-I)),I,0)}forEachLine(t,i,s,a,u,p){t=Math.max(t,u),i=Math.min(i,u+this.length);let{firstLine:v,perLine:k,perChar:F}=this.heightMetrics(s,u);for(let I=t,Y=a;I<=i;){let ie=s.doc.lineAt(I);if(I==t){let ve=ie.number-v;Y+=k*ve+F*(t-u-ve)}let de=k+F*ie.length;p(new di(ie.from,ie.length,Y,de,0)),Y+=de,I=ie.to+1}}replace(t,i,s){let a=this.length-i;if(a>0){let u=s[s.length-1];u instanceof zn?s[s.length-1]=new zn(u.length+a):s.push(null,new zn(a-1))}if(t>0){let u=s[0];u instanceof zn?s[0]=new zn(t+u.length):s.unshift(new zn(t-1),null)}return Jn.of(s)}decomposeLeft(t,i){i.push(new zn(t-1),null)}decomposeRight(t,i){i.push(null,new zn(this.length-t-1))}updateHeight(t,i=0,s=!1,a){let u=i+this.length;if(a&&a.from<=i+this.length&&a.more){let p=[],v=Math.max(i,a.from),k=-1;for(a.from>i&&p.push(new zn(a.from-i-1).updateHeight(t,i));v<=u&&a.more;){let I=t.doc.lineAt(v).length;p.length&&p.push(null);let Y=a.heights[a.index++];k==-1?k=Y:Math.abs(Y-k)>=Ns&&(k=-2);let ie=new oi(I,Y);ie.outdated=!1,p.push(ie),v+=I+1}v<=u&&p.push(null,new zn(u-v).updateHeight(t,v));let F=Jn.of(p);return(k<0||Math.abs(F.height-this.height)>=Ns||Math.abs(k-this.heightMetrics(t,i).perLine)>=Ns)&&(qi=!0),Cs(this,F)}else(s||this.outdated)&&(this.setHeight(t.heightForGap(i,i+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class kf extends Jn{constructor(t,i,s){super(t.length+i+s.length,t.height+s.height,i|(t.outdated||s.outdated?2:0)),this.left=t,this.right=s,this.size=t.size+s.size}get break(){return this.flags&1}blockAt(t,i,s,a){let u=s+this.left.height;return t<u?this.left.blockAt(t,i,s,a):this.right.blockAt(t,i,u,a+this.left.length+this.break)}lineAt(t,i,s,a,u){let p=a+this.left.height,v=u+this.left.length+this.break,k=i==Sn.ByHeight?t<p:t<v,F=k?this.left.lineAt(t,i,s,a,u):this.right.lineAt(t,i,s,p,v);if(this.break||(k?F.to<v:F.from>v))return F;let I=i==Sn.ByPosNoHeight?Sn.ByPosNoHeight:Sn.ByPos;return k?F.join(this.right.lineAt(v,I,s,p,v)):this.left.lineAt(v,I,s,a,u).join(F)}forEachLine(t,i,s,a,u,p){let v=a+this.left.height,k=u+this.left.length+this.break;if(this.break)t<k&&this.left.forEachLine(t,i,s,a,u,p),i>=k&&this.right.forEachLine(t,i,s,v,k,p);else{let F=this.lineAt(k,Sn.ByPos,s,a,u);t<F.from&&this.left.forEachLine(t,F.from-1,s,a,u,p),F.to>=t&&F.from<=i&&p(F),i>F.to&&this.right.forEachLine(F.to+1,i,s,v,k,p)}}replace(t,i,s){let a=this.left.length+this.break;if(i<a)return this.balanced(this.left.replace(t,i,s),this.right);if(t>this.left.length)return this.balanced(this.left,this.right.replace(t-a,i-a,s));let u=[];t>0&&this.decomposeLeft(t,u);let p=u.length;for(let v of s)u.push(v);if(t>0&&ba(u,p-1),i<this.length){let v=u.length;this.decomposeRight(i,u),ba(u,v)}return Jn.of(u)}decomposeLeft(t,i){let s=this.left.length;if(t<=s)return this.left.decomposeLeft(t,i);i.push(this.left),this.break&&(s++,t>=s&&i.push(null)),t>s&&this.right.decomposeLeft(t-s,i)}decomposeRight(t,i){let s=this.left.length,a=s+this.break;if(t>=a)return this.right.decomposeRight(t-a,i);t<s&&this.left.decomposeRight(t,i),this.break&&t<a&&i.push(null),i.push(this.right)}balanced(t,i){return t.size>2*i.size||i.size>2*t.size?Jn.of(this.break?[t,null,i]:[t,i]):(this.left=Cs(this.left,t),this.right=Cs(this.right,i),this.setHeight(t.height+i.height),this.outdated=t.outdated||i.outdated,this.size=t.size+i.size,this.length=t.length+this.break+i.length,this)}updateHeight(t,i=0,s=!1,a){let{left:u,right:p}=this,v=i+u.length+this.break,k=null;return a&&a.from<=i+u.length&&a.more?k=u=u.updateHeight(t,i,s,a):u.updateHeight(t,i,s),a&&a.from<=v+p.length&&a.more?k=p=p.updateHeight(t,v,s,a):p.updateHeight(t,v,s),k?this.balanced(u,p):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function ba(c,t){let i,s;c[t]==null&&(i=c[t-1])instanceof zn&&(s=c[t+1])instanceof zn&&c.splice(t-1,3,new zn(i.length+1+s.length))}const xf=5;class _o{constructor(t,i){this.pos=t,this.oracle=i,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=t}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(t,i){if(this.lineStart>-1){let s=Math.min(i,this.lineEnd),a=this.nodes[this.nodes.length-1];a instanceof oi?a.length+=s-this.pos:(s>this.pos||!this.isCovered)&&this.nodes.push(new oi(s-this.pos,-1)),this.writtenTo=s,i>s&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=i}point(t,i,s){if(t<i||s.heightRelevant){let a=s.widget?s.widget.estimatedHeight:0,u=s.widget?s.widget.lineBreaks:0;a<0&&(a=this.oracle.lineHeight);let p=i-t;s.block?this.addBlock(new va(p,a,s)):(p||u||a>=xf)&&this.addLineDeco(a,u,p)}else i>t&&this.span(t,i);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:t,to:i}=this.oracle.doc.lineAt(this.pos);this.lineStart=t,this.lineEnd=i,this.writtenTo<t&&((this.writtenTo<t-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,t-1)),this.nodes.push(null)),this.pos>t&&this.nodes.push(new oi(this.pos-t,-1)),this.writtenTo=this.pos}blankContent(t,i){let s=new zn(i-t);return this.oracle.doc.lineAt(t).to==i&&(s.flags|=4),s}ensureLine(){this.enterLine();let t=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(t instanceof oi)return t;let i=new oi(0,-1);return this.nodes.push(i),i}addBlock(t){this.enterLine();let i=t.deco;i&&i.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(t),this.writtenTo=this.pos=this.pos+t.length,i&&i.endSide>0&&(this.covering=t)}addLineDeco(t,i,s){let a=this.ensureLine();a.length+=s,a.collapsed+=s,a.widgetHeight=Math.max(a.widgetHeight,t),a.breaks+=i,this.writtenTo=this.pos=this.pos+s}finish(t){let i=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(i instanceof oi)&&!this.isCovered?this.nodes.push(new oi(0,-1)):(this.writtenTo<this.pos||i==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let s=t;for(let a of this.nodes)a instanceof oi&&a.updateHeight(this.oracle,s),s+=a?a.length:1;return this.nodes}static build(t,i,s,a){let u=new _o(s,t);return n.RangeSet.spans(i,s,a,u,0),u.finish(s)}}function Nf(c,t,i){let s=new Cf;return n.RangeSet.compare(c,t,i,s,0),s.changes}class Cf{constructor(){this.changes=[]}compareRange(){}comparePoint(t,i,s,a){(t<i||s&&s.heightRelevant||a&&a.heightRelevant)&&j(t,i,this.changes,5)}}function Af(c,t){let i=c.getBoundingClientRect(),s=c.ownerDocument,a=s.defaultView||window,u=Math.max(0,i.left),p=Math.min(a.innerWidth,i.right),v=Math.max(0,i.top),k=Math.min(a.innerHeight,i.bottom);for(let F=c.parentNode;F&&F!=s.body;)if(F.nodeType==1){let I=F,Y=window.getComputedStyle(I);if((I.scrollHeight>I.clientHeight||I.scrollWidth>I.clientWidth)&&Y.overflow!="visible"){let ie=I.getBoundingClientRect();u=Math.max(u,ie.left),p=Math.min(p,ie.right),v=Math.max(v,ie.top),k=Math.min(F==c.parentNode?a.innerHeight:k,ie.bottom)}F=Y.position=="absolute"||Y.position=="fixed"?I.offsetParent:I.parentNode}else if(F.nodeType==11)F=F.host;else break;return{left:u-i.left,right:Math.max(u,p)-i.left,top:v-(i.top+t),bottom:Math.max(v,k)-(i.top+t)}}function Df(c){let t=c.getBoundingClientRect(),i=c.ownerDocument.defaultView||window;return t.left<i.innerWidth&&t.right>0&&t.top<i.innerHeight&&t.bottom>0}function If(c,t){let i=c.getBoundingClientRect();return{left:0,right:i.right-i.left,top:t,bottom:i.bottom-(i.top+t)}}class Ro{constructor(t,i,s,a){this.from=t,this.to=i,this.size=s,this.displaySize=a}static same(t,i){if(t.length!=i.length)return!1;for(let s=0;s<t.length;s++){let a=t[s],u=i[s];if(a.from!=u.from||a.to!=u.to||a.size!=u.size)return!1}return!0}draw(t,i){return ht.replace({widget:new Of(this.displaySize*(i?t.scaleY:t.scaleX),i)}).range(this.from,this.to)}}class Of extends kt{constructor(t,i){super(),this.size=t,this.vertical=i}eq(t){return t.size==this.size&&t.vertical==this.vertical}toDOM(){let t=document.createElement("div");return this.vertical?t.style.height=this.size+"px":(t.style.width=this.size+"px",t.style.height="2px",t.style.display="inline-block"),t}get estimatedHeight(){return this.vertical?this.size:-1}}class Sa{constructor(t){this.state=t,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!1,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Ta,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=e.Direction.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let i=t.facet(P).some(s=>typeof s!="function"&&s.class=="cm-lineWrapping");this.heightOracle=new ga(i),this.stateDeco=t.facet($).filter(s=>typeof s!="function"),this.heightMap=Jn.empty().applyChanges(this.stateDeco,n.Text.empty,this.heightOracle.setDoc(t.doc),[new mn(0,0,0,t.doc.length)]);for(let s=0;s<2&&(this.viewport=this.getViewport(0,null),!!this.updateForViewport());s++);this.updateViewportLines(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=ht.set(this.lineGaps.map(s=>s.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let t=[this.viewport],{main:i}=this.state.selection;for(let s=0;s<=1;s++){let a=s?i.head:i.anchor;if(!t.some(({from:u,to:p})=>a>=u&&a<=p)){let{from:u,to:p}=this.lineBlockAt(a);t.push(new As(u,p))}}return this.viewports=t.sort((s,a)=>s.from-a.from),this.updateScaler()}updateScaler(){let t=this.scaler;return this.scaler=this.heightMap.height<=7e6?Ta:new Fo(this.heightOracle,this.heightMap,this.viewports),t.eq(this.scaler)?0:2}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,t=>{this.viewportLines.push($r(t,this.scaler))})}update(t,i=null){this.state=t.state;let s=this.stateDeco;this.stateDeco=this.state.facet($).filter(I=>typeof I!="function");let a=t.changedRanges,u=mn.extendWithRanges(a,Nf(s,this.stateDeco,t?t.changes:n.ChangeSet.empty(this.state.doc.length))),p=this.heightMap.height,v=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);Lo(),this.heightMap=this.heightMap.applyChanges(this.stateDeco,t.startState.doc,this.heightOracle.setDoc(this.state.doc),u),(this.heightMap.height!=p||qi)&&(t.flags|=2),v?(this.scrollAnchorPos=t.changes.mapPos(v.from,-1),this.scrollAnchorHeight=v.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=p);let k=u.length?this.mapViewport(this.viewport,t.changes):this.viewport;(i&&(i.range.head<k.from||i.range.head>k.to)||!this.viewportIsAppropriate(k))&&(k=this.getViewport(0,i));let F=k.from!=this.viewport.from||k.to!=this.viewport.to;this.viewport=k,t.flags|=this.updateForViewport(),(F||!t.changes.empty||t.flags&2)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,t.changes))),t.flags|=this.computeVisibleRanges(t.changes),i&&(this.scrollTarget=i),!this.mustEnforceCursorAssoc&&t.selectionSet&&t.view.lineWrapping&&t.state.selection.main.empty&&t.state.selection.main.assoc&&!t.state.facet(Zn)&&(this.mustEnforceCursorAssoc=!0)}measure(t){let i=t.contentDOM,s=window.getComputedStyle(i),a=this.heightOracle,u=s.whiteSpace;this.defaultTextDirection=s.direction=="rtl"?e.Direction.RTL:e.Direction.LTR;let p=this.heightOracle.mustRefreshForWrapping(u),v=i.getBoundingClientRect(),k=p||this.mustMeasureContent||this.contentDOMHeight!=v.height;this.contentDOMHeight=v.height,this.mustMeasureContent=!1;let F=0,I=0;if(v.width&&v.height){let{scaleX:dt,scaleY:St}=Se(i,v);(dt>.005&&Math.abs(this.scaleX-dt)>.005||St>.005&&Math.abs(this.scaleY-St)>.005)&&(this.scaleX=dt,this.scaleY=St,F|=16,p=k=!0)}let Y=(parseInt(s.paddingTop)||0)*this.scaleY,ie=(parseInt(s.paddingBottom)||0)*this.scaleY;(this.paddingTop!=Y||this.paddingBottom!=ie)&&(this.paddingTop=Y,this.paddingBottom=ie,F|=18),this.editorWidth!=t.scrollDOM.clientWidth&&(a.lineWrapping&&(k=!0),this.editorWidth=t.scrollDOM.clientWidth,F|=16);let de=t.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=de&&(this.scrollAnchorHeight=-1,this.scrollTop=de),this.scrolledToBottom=Kt(t.scrollDOM);let ve=(this.printing?If:Af)(i,this.paddingTop),ke=ve.top-this.pixelViewport.top,Ce=ve.bottom-this.pixelViewport.bottom;this.pixelViewport=ve;let Ae=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(Ae!=this.inView&&(this.inView=Ae,Ae&&(k=!0)),!this.inView&&!this.scrollTarget&&!Df(t.dom))return 0;let at=v.width;if((this.contentDOMWidth!=at||this.editorHeight!=t.scrollDOM.clientHeight)&&(this.contentDOMWidth=v.width,this.editorHeight=t.scrollDOM.clientHeight,F|=16),k){let dt=t.docView.measureVisibleLineHeights(this.viewport);if(a.mustRefreshForHeights(dt)&&(p=!0),p||a.lineWrapping&&Math.abs(at-this.contentDOMWidth)>a.charWidth){let{lineHeight:St,charWidth:Tt,textHeight:xn}=t.docView.measureTextSize();p=St>0&&a.refresh(u,St,Tt,xn,Math.max(5,at/Tt),dt),p&&(t.docView.minWidth=0,F|=16)}ke>0&&Ce>0?I=Math.max(ke,Ce):ke<0&&Ce<0&&(I=Math.min(ke,Ce)),Lo();for(let St of this.viewports){let Tt=St.from==this.viewport.from?dt:t.docView.measureVisibleLineHeights(St);this.heightMap=(p?Jn.empty().applyChanges(this.stateDeco,n.Text.empty,this.heightOracle,[new mn(0,0,0,t.state.doc.length)]):this.heightMap).updateHeight(a,0,p,new ya(St.from,Tt))}qi&&(F|=2)}let vt=!this.viewportIsAppropriate(this.viewport,I)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return vt&&(F&2&&(F|=this.updateScaler()),this.viewport=this.getViewport(I,this.scrollTarget),F|=this.updateForViewport()),(F&2||vt)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(p?[]:this.lineGaps,t)),F|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,t.docView.enforceCursorAssoc()),F}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(t,i){let s=.5-Math.max(-.5,Math.min(.5,t/1e3/2)),a=this.heightMap,u=this.heightOracle,{visibleTop:p,visibleBottom:v}=this,k=new As(a.lineAt(p-s*1e3,Sn.ByHeight,u,0,0).from,a.lineAt(v+(1-s)*1e3,Sn.ByHeight,u,0,0).to);if(i){let{head:F}=i.range;if(F<k.from||F>k.to){let I=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),Y=a.lineAt(F,Sn.ByPos,u,0,0),ie;i.y=="center"?ie=(Y.top+Y.bottom)/2-I/2:i.y=="start"||i.y=="nearest"&&F<k.from?ie=Y.top:ie=Y.bottom-I,k=new As(a.lineAt(ie-1e3/2,Sn.ByHeight,u,0,0).from,a.lineAt(ie+I+1e3/2,Sn.ByHeight,u,0,0).to)}}return k}mapViewport(t,i){let s=i.mapPos(t.from,-1),a=i.mapPos(t.to,1);return new As(this.heightMap.lineAt(s,Sn.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(a,Sn.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:t,to:i},s=0){if(!this.inView)return!0;let{top:a}=this.heightMap.lineAt(t,Sn.ByPos,this.heightOracle,0,0),{bottom:u}=this.heightMap.lineAt(i,Sn.ByPos,this.heightOracle,0,0),{visibleTop:p,visibleBottom:v}=this;return(t==0||a<=p-Math.max(10,Math.min(-s,250)))&&(i==this.state.doc.length||u>=v+Math.max(10,Math.min(s,250)))&&a>p-2*1e3&&u<v+2*1e3}mapLineGaps(t,i){if(!t.length||i.empty)return t;let s=[];for(let a of t)i.touchesRange(a.from,a.to)||s.push(new Ro(i.mapPos(a.from),i.mapPos(a.to),a.size,a.displaySize));return s}ensureLineGaps(t,i){let s=this.heightOracle.lineWrapping,a=s?1e4:2e3,u=a>>1,p=a<<1;if(this.defaultTextDirection!=e.Direction.LTR&&!s)return[];let v=[],k=(I,Y,ie,de)=>{if(Y-I<u)return;let ve=this.state.selection.main,ke=[ve.from];ve.empty||ke.push(ve.to);for(let Ae of ke)if(Ae>I&&Ae<Y){k(I,Ae-10,ie,de),k(Ae+10,Y,ie,de);return}let Ce=Lf(t,Ae=>Ae.from>=ie.from&&Ae.to<=ie.to&&Math.abs(Ae.from-I)<u&&Math.abs(Ae.to-Y)<u&&!ke.some(at=>Ae.from<at&&Ae.to>at));if(!Ce){if(Y<ie.to&&i&&s&&i.visibleRanges.some(vt=>vt.from<=Y&&vt.to>=Y)){let vt=i.moveToLineBoundary(n.EditorSelection.cursor(Y),!1,!0).head;vt>I&&(Y=vt)}let Ae=this.gapSize(ie,I,Y,de),at=s||Ae<2e6?Ae:2e6;Ce=new Ro(I,Y,Ae,at)}v.push(Ce)},F=I=>{if(I.length<p||I.type!=e.BlockType.Text)return;let Y=Mf(I.from,I.to,this.stateDeco);if(Y.total<p)return;let ie=this.scrollTarget?this.scrollTarget.range.head:null,de,ve;if(s){let ke=a/this.heightOracle.lineLength*this.heightOracle.lineHeight,Ce,Ae;if(ie!=null){let at=Is(Y,ie),vt=((this.visibleBottom-this.visibleTop)/2+ke)/I.height;Ce=at-vt,Ae=at+vt}else Ce=(this.visibleTop-I.top-ke)/I.height,Ae=(this.visibleBottom-I.top+ke)/I.height;de=Ds(Y,Ce),ve=Ds(Y,Ae)}else{let ke=Y.total*this.heightOracle.charWidth,Ce=a*this.heightOracle.charWidth,Ae=0;if(ke>2e6)for(let Tt of t)Tt.from>=I.from&&Tt.from<I.to&&Tt.size!=Tt.displaySize&&Tt.from*this.heightOracle.charWidth+Ae<this.pixelViewport.left&&(Ae=Tt.size-Tt.displaySize);let at=this.pixelViewport.left+Ae,vt=this.pixelViewport.right+Ae,dt,St;if(ie!=null){let Tt=Is(Y,ie),xn=((vt-at)/2+Ce)/ke;dt=Tt-xn,St=Tt+xn}else dt=(at-Ce)/ke,St=(vt+Ce)/ke;de=Ds(Y,dt),ve=Ds(Y,St)}de>I.from&&k(I.from,de,I,Y),ve<I.to&&k(ve,I.to,I,Y)};for(let I of this.viewportLines)Array.isArray(I.type)?I.type.forEach(F):F(I);return v}gapSize(t,i,s,a){let u=Is(a,s)-Is(a,i);return this.heightOracle.lineWrapping?t.height*u:a.total*this.heightOracle.charWidth*u}updateLineGaps(t){Ro.same(t,this.lineGaps)||(this.lineGaps=t,this.lineGapDeco=ht.set(t.map(i=>i.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(t){let i=this.stateDeco;this.lineGaps.length&&(i=i.concat(this.lineGapDeco));let s=[];n.RangeSet.spans(i,this.viewport.from,this.viewport.to,{span(u,p){s.push({from:u,to:p})},point(){}},20);let a=0;if(s.length!=this.visibleRanges.length)a=12;else for(let u=0;u<s.length&&!(a&8);u++){let p=this.visibleRanges[u],v=s[u];(p.from!=v.from||p.to!=v.to)&&(a|=4,t&&t.mapPos(p.from,-1)==v.from&&t.mapPos(p.to,1)==v.to||(a|=8))}return this.visibleRanges=s,a}lineBlockAt(t){return t>=this.viewport.from&&t<=this.viewport.to&&this.viewportLines.find(i=>i.from<=t&&i.to>=t)||$r(this.heightMap.lineAt(t,Sn.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(t){return t>=this.viewportLines[0].top&&t<=this.viewportLines[this.viewportLines.length-1].bottom&&this.viewportLines.find(i=>i.top<=t&&i.bottom>=t)||$r(this.heightMap.lineAt(this.scaler.fromDOM(t),Sn.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(t){let i=this.lineBlockAtHeight(t+8);return i.from>=this.viewport.from||this.viewportLines[0].top-t>200?i:this.viewportLines[0]}elementAtHeight(t){return $r(this.heightMap.blockAt(this.scaler.fromDOM(t),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class As{constructor(t,i){this.from=t,this.to=i}}function Mf(c,t,i){let s=[],a=c,u=0;return n.RangeSet.spans(i,c,t,{span(){},point(p,v){p>a&&(s.push({from:a,to:p}),u+=p-a),a=v}},20),a<t&&(s.push({from:a,to:t}),u+=t-a),{total:u,ranges:s}}function Ds({total:c,ranges:t},i){if(i<=0)return t[0].from;if(i>=1)return t[t.length-1].to;let s=Math.floor(c*i);for(let a=0;;a++){let{from:u,to:p}=t[a],v=p-u;if(s<=v)return u+s;s-=v}}function Is(c,t){let i=0;for(let{from:s,to:a}of c.ranges){if(t<=a){i+=t-s;break}i+=a-s}return i/c.total}function Lf(c,t){for(let i of c)if(t(i))return i}const Ta={toDOM(c){return c},fromDOM(c){return c},scale:1,eq(c){return c==this}};class Fo{constructor(t,i,s){let a=0,u=0,p=0;this.viewports=s.map(({from:v,to:k})=>{let F=i.lineAt(v,Sn.ByPos,t,0,0).top,I=i.lineAt(k,Sn.ByPos,t,0,0).bottom;return a+=I-F,{from:v,to:k,top:F,bottom:I,domTop:0,domBottom:0}}),this.scale=(7e6-a)/(i.height-a);for(let v of this.viewports)v.domTop=p+(v.top-u)*this.scale,p=v.domBottom=v.domTop+(v.bottom-v.top),u=v.bottom}toDOM(t){for(let i=0,s=0,a=0;;i++){let u=i<this.viewports.length?this.viewports[i]:null;if(!u||t<u.top)return a+(t-s)*this.scale;if(t<=u.bottom)return u.domTop+(t-u.top);s=u.bottom,a=u.domBottom}}fromDOM(t){for(let i=0,s=0,a=0;;i++){let u=i<this.viewports.length?this.viewports[i]:null;if(!u||t<u.domTop)return s+(t-a)/this.scale;if(t<=u.domBottom)return u.top+(t-u.domTop);s=u.bottom,a=u.domBottom}}eq(t){return t instanceof Fo?this.scale==t.scale&&this.viewports.length==t.viewports.length&&this.viewports.every((i,s)=>i.from==t.viewports[s].from&&i.to==t.viewports[s].to):!1}}function $r(c,t){if(t.scale==1)return c;let i=t.toDOM(c.top),s=t.toDOM(c.bottom);return new di(c.from,c.length,i,s-i,Array.isArray(c._content)?c._content.map(a=>$r(a,t)):c._content)}const Os=n.Facet.define({combine:c=>c.join(" ")}),Po=n.Facet.define({combine:c=>c.indexOf(!0)>-1}),Bo=r.StyleModule.newName(),Ea=r.StyleModule.newName(),wa=r.StyleModule.newName(),ka={"&light":"."+Ea,"&dark":"."+wa};function Vo(c,t,i){return new r.StyleModule(t,{finish(s){return/&/.test(s)?s.replace(/&\w*/,a=>{if(a=="&")return c;if(!i||!i[a])throw new RangeError(`Unsupported selector: ${a}`);return i[a]}):c+" "+s}})}const _f=Vo("."+Bo,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0,overflowAnchor:"none"},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#ddd"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",zIndex:200},".cm-gutters-before":{insetInlineStart:0},".cm-gutters-after":{insetInlineEnd:0},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",border:"0px solid #ddd","&.cm-gutters-before":{borderRightWidth:"1px"},"&.cm-gutters-after":{borderLeftWidth:"1px"}},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0,zIndex:300},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-dialog":{padding:"2px 19px 4px 6px",position:"relative","& label":{fontSize:"80%"}},".cm-dialog-close":{position:"absolute",top:"3px",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",fontSize:"14px",padding:"0"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top",userSelect:"none"},".cm-highlightSpace":{backgroundImage:"radial-gradient(circle at 50% 55%, #aaa 20%, transparent 5%)",backgroundPosition:"center"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},ka),Rf={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},jo=oe.ie&&oe.ie_version<=11;class Ff{constructor(t){this.view=t,this.active=!1,this.editContext=null,this.selectionRange=new Ge,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.printQuery=null,this.parentCheck=-1,this.dom=t.contentDOM,this.observer=new MutationObserver(i=>{for(let s of i)this.queue.push(s);(oe.ie&&oe.ie_version<=11||oe.ios&&t.composing)&&i.some(s=>s.type=="childList"&&s.removedNodes.length||s.type=="characterData"&&s.oldValue.length>s.target.nodeValue.length)?this.flushSoon():this.flush()}),window.EditContext&&oe.android&&t.constructor.EDIT_CONTEXT!==!1&&!(oe.chrome&&oe.chrome_version<126)&&(this.editContext=new Bf(t),t.state.facet(x)&&(t.contentDOM.editContext=this.editContext.editContext)),jo&&(this.onCharData=i=>{this.queue.push({target:i.target,type:"characterData",oldValue:i.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),window.matchMedia&&(this.printQuery=window.matchMedia("print")),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var i;((i=this.view.docView)===null||i===void 0?void 0:i.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(t.scrollDOM)),this.addWindowListeners(this.win=t.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(i=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),i.length>0&&i[i.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(i=>{i.length>0&&i[i.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(t){this.view.inputState.runHandlers("scroll",t),this.intersecting&&this.view.measure()}onScroll(t){this.intersecting&&this.flush(!1),this.editContext&&this.view.requestMeasure(this.editContext.measureReq),this.onScrollChanged(t)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(t){(t.type=="change"||!t.type)&&!t.matches||(this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500))}updateGaps(t){if(this.gapIntersection&&(t.length!=this.gaps.length||this.gaps.some((i,s)=>i!=t[s]))){this.gapIntersection.disconnect();for(let i of t)this.gapIntersection.observe(i);this.gaps=t}}onSelectionChange(t){let i=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:s}=this,a=this.selectionRange;if(s.state.facet(x)?s.root.activeElement!=this.dom:!N(this.dom,a))return;let u=a.anchorNode&&s.docView.nearest(a.anchorNode);if(u&&u.ignoreEvent(t)){i||(this.selectionChanged=!1);return}(oe.ie&&oe.ie_version<=11||oe.android&&oe.chrome)&&!s.state.selection.main.empty&&a.focusNode&&R(a.focusNode,a.focusOffset,a.anchorNode,a.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:t}=this,i=h(t.root);if(!i)return!1;let s=oe.safari&&t.root.nodeType==11&&t.root.activeElement==this.dom&&Pf(this.view,i)||i;if(!s||this.selectionRange.eq(s))return!1;let a=N(this.dom,s);return a&&!this.selectionChanged&&t.inputState.lastFocusTime>Date.now()-200&&t.inputState.lastTouchTime<Date.now()-300&&Qt(this.dom,s)?(this.view.inputState.lastFocusTime=0,t.docView.updateSelection(),!1):(this.selectionRange.setRange(s),a&&(this.selectionChanged=!0),!0)}setSelectionRange(t,i){this.selectionRange.set(t.node,t.offset,i.node,i.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let t=0,i=null;for(let s=this.dom;s;)if(s.nodeType==1)!i&&t<this.scrollTargets.length&&this.scrollTargets[t]==s?t++:i||(i=this.scrollTargets.slice(0,t)),i&&i.push(s),s=s.assignedSlot||s.parentNode;else if(s.nodeType==11)s=s.host;else break;if(t<this.scrollTargets.length&&!i&&(i=this.scrollTargets.slice(0,t)),i){for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);for(let s of this.scrollTargets=i)s.addEventListener("scroll",this.onScroll)}}ignore(t){if(!this.active)return t();try{return this.stop(),t()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Rf),jo&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),jo&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(t,i){var s;if(!this.delayedAndroidKey){let a=()=>{let u=this.delayedAndroidKey;u&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=u.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&u.force&&ut(this.dom,u.key,u.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(a)}(!this.delayedAndroidKey||t=="Enter")&&(this.delayedAndroidKey={key:t,keyCode:i,force:this.lastChange<Date.now()-50||!!(!((s=this.delayedAndroidKey)===null||s===void 0)&&s.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let t of this.observer.takeRecords())this.queue.push(t);return this.queue}processRecords(){let t=this.pendingRecords();t.length&&(this.queue=[]);let i=-1,s=-1,a=!1;for(let u of t){let p=this.readMutation(u);p&&(p.typeOver&&(a=!0),i==-1?{from:i,to:s}=p:(i=Math.min(p.from,i),s=Math.max(p.to,s)))}return{from:i,to:s,typeOver:a}}readChange(){let{from:t,to:i,typeOver:s}=this.processRecords(),a=this.selectionChanged&&N(this.dom,this.selectionRange);if(t<0&&!a)return null;t>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let u=new Vr(this.view,t,i,s);return this.view.docView.domChanged={newSel:u.newSel?u.newSel.main:null},u}flush(t=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;t&&this.readSelectionRange();let i=this.readChange();if(!i)return this.view.requestMeasure(),!1;let s=this.view.state,a=jr(this.view,i);return this.view.state==s&&(i.domChanged||i.newSel&&!i.newSel.main.eq(this.view.state.selection.main))&&this.view.update([]),a}readMutation(t){let i=this.view.docView.nearest(t.target);if(!i||i.ignoreMutation(t))return null;if(i.markDirty(t.type=="attributes"),t.type=="attributes"&&(i.flags|=4),t.type=="childList"){let s=xa(i,t.previousSibling||t.target.previousSibling,-1),a=xa(i,t.nextSibling||t.target.nextSibling,1);return{from:s?i.posAfter(s):i.posAtStart,to:a?i.posBefore(a):i.posAtEnd,typeOver:!1}}else return t.type=="characterData"?{from:i.posAtStart,to:i.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}:null}setWindow(t){t!=this.win&&(this.removeWindowListeners(this.win),this.win=t,this.addWindowListeners(this.win))}addWindowListeners(t){t.addEventListener("resize",this.onResize),this.printQuery?this.printQuery.addEventListener?this.printQuery.addEventListener("change",this.onPrint):this.printQuery.addListener(this.onPrint):t.addEventListener("beforeprint",this.onPrint),t.addEventListener("scroll",this.onScroll),t.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(t){t.removeEventListener("scroll",this.onScroll),t.removeEventListener("resize",this.onResize),this.printQuery?this.printQuery.removeEventListener?this.printQuery.removeEventListener("change",this.onPrint):this.printQuery.removeListener(this.onPrint):t.removeEventListener("beforeprint",this.onPrint),t.document.removeEventListener("selectionchange",this.onSelectionChange)}update(t){this.editContext&&(this.editContext.update(t),t.startState.facet(x)!=t.state.facet(x)&&(t.view.contentDOM.editContext=t.state.facet(x)?this.editContext.editContext:null))}destroy(){var t,i,s;this.stop(),(t=this.intersection)===null||t===void 0||t.disconnect(),(i=this.gapIntersection)===null||i===void 0||i.disconnect(),(s=this.resizeScroll)===null||s===void 0||s.disconnect();for(let a of this.scrollTargets)a.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey),this.editContext&&(this.view.contentDOM.editContext=null,this.editContext.destroy())}}function xa(c,t,i){for(;t;){let s=Je.get(t);if(s&&s.parent==c)return s;let a=t.parentNode;t=a!=c.dom?a:i>0?t.nextSibling:t.previousSibling}return null}function Na(c,t){let i=t.startContainer,s=t.startOffset,a=t.endContainer,u=t.endOffset,p=c.docView.domAtPos(c.state.selection.main.anchor);return R(p.node,p.offset,a,u)&&([i,s,a,u]=[a,u,i,s]),{anchorNode:i,anchorOffset:s,focusNode:a,focusOffset:u}}function Pf(c,t){if(t.getComposedRanges){let a=t.getComposedRanges(c.root)[0];if(a)return Na(c,a)}let i=null;function s(a){a.preventDefault(),a.stopImmediatePropagation(),i=a.getTargetRanges()[0]}return c.contentDOM.addEventListener("beforeinput",s,!0),c.dom.ownerDocument.execCommand("indent"),c.contentDOM.removeEventListener("beforeinput",s,!0),i?Na(c,i):null}class Bf{constructor(t){this.from=0,this.to=0,this.pendingContextChange=null,this.handlers=Object.create(null),this.composing=null,this.resetRange(t.state);let i=this.editContext=new window.EditContext({text:t.state.doc.sliceString(this.from,this.to),selectionStart:this.toContextPos(Math.max(this.from,Math.min(this.to,t.state.selection.main.anchor))),selectionEnd:this.toContextPos(t.state.selection.main.head)});this.handlers.textupdate=s=>{let a=t.state.selection.main,{anchor:u,head:p}=a,v=this.toEditorPos(s.updateRangeStart),k=this.toEditorPos(s.updateRangeEnd);t.inputState.composing>=0&&!this.composing&&(this.composing={contextBase:s.updateRangeStart,editorBase:v,drifted:!1});let F={from:v,to:k,insert:n.Text.of(s.text.split(`
`))};if(F.from==this.from&&u<this.from?F.from=u:F.to==this.to&&u>this.to&&(F.to=u),F.from==F.to&&!F.insert.length){let I=n.EditorSelection.single(this.toEditorPos(s.selectionStart),this.toEditorPos(s.selectionEnd));I.main.eq(a)||t.dispatch({selection:I,userEvent:"select"});return}if((oe.mac||oe.android)&&F.from==p-1&&/^\. ?$/.test(s.text)&&t.contentDOM.getAttribute("autocorrect")=="off"&&(F={from:v,to:k,insert:n.Text.of([s.text.replace("."," ")])}),this.pendingContextChange=F,!t.state.readOnly){let I=this.to-this.from+(F.to-F.from+F.insert.length);Ur(t,F,n.EditorSelection.single(this.toEditorPos(s.selectionStart,I),this.toEditorPos(s.selectionEnd,I)))}this.pendingContextChange&&(this.revertPending(t.state),this.setSelection(t.state))},this.handlers.characterboundsupdate=s=>{let a=[],u=null;for(let p=this.toEditorPos(s.rangeStart),v=this.toEditorPos(s.rangeEnd);p<v;p++){let k=t.coordsForChar(p);u=k&&new DOMRect(k.left,k.top,k.right-k.left,k.bottom-k.top)||u||new DOMRect,a.push(u)}i.updateCharacterBounds(s.rangeStart,a)},this.handlers.textformatupdate=s=>{let a=[];for(let u of s.getTextFormats()){let p=u.underlineStyle,v=u.underlineThickness;if(p!="None"&&v!="None"){let k=this.toEditorPos(u.rangeStart),F=this.toEditorPos(u.rangeEnd);if(k<F){let I=`text-decoration: underline ${p=="Dashed"?"dashed ":p=="Squiggle"?"wavy ":""}${v=="Thin"?1:2}px`;a.push(ht.mark({attributes:{style:I}}).range(k,F))}}}t.dispatch({effects:ki.of(ht.set(a))})},this.handlers.compositionstart=()=>{t.inputState.composing<0&&(t.inputState.composing=0,t.inputState.compositionFirstChange=!0)},this.handlers.compositionend=()=>{if(t.inputState.composing=-1,t.inputState.compositionFirstChange=null,this.composing){let{drifted:s}=this.composing;this.composing=null,s&&this.reset(t.state)}};for(let s in this.handlers)i.addEventListener(s,this.handlers[s]);this.measureReq={read:s=>{this.editContext.updateControlBounds(s.contentDOM.getBoundingClientRect());let a=h(s.root);a&&a.rangeCount&&this.editContext.updateSelectionBounds(a.getRangeAt(0).getBoundingClientRect())}}}applyEdits(t){let i=0,s=!1,a=this.pendingContextChange;return t.changes.iterChanges((u,p,v,k,F)=>{if(s)return;let I=F.length-(p-u);if(a&&p>=a.to)if(a.from==u&&a.to==p&&a.insert.eq(F)){a=this.pendingContextChange=null,i+=I,this.to+=I;return}else a=null,this.revertPending(t.state);if(u+=i,p+=i,p<=this.from)this.from+=I,this.to+=I;else if(u<this.to){if(u<this.from||p>this.to||this.to-this.from+F.length>3e4){s=!0;return}this.editContext.updateText(this.toContextPos(u),this.toContextPos(p),F.toString()),this.to+=I}i+=I}),a&&!s&&this.revertPending(t.state),!s}update(t){let i=this.pendingContextChange,s=t.startState.selection.main;this.composing&&(this.composing.drifted||!t.changes.touchesRange(s.from,s.to)&&t.transactions.some(a=>!a.isUserEvent("input.type")&&a.changes.touchesRange(this.from,this.to)))?(this.composing.drifted=!0,this.composing.editorBase=t.changes.mapPos(this.composing.editorBase)):!this.applyEdits(t)||!this.rangeIsValid(t.state)?(this.pendingContextChange=null,this.reset(t.state)):(t.docChanged||t.selectionSet||i)&&this.setSelection(t.state),(t.geometryChanged||t.docChanged||t.selectionSet)&&t.view.requestMeasure(this.measureReq)}resetRange(t){let{head:i}=t.selection.main;this.from=Math.max(0,i-1e4),this.to=Math.min(t.doc.length,i+1e4)}reset(t){this.resetRange(t),this.editContext.updateText(0,this.editContext.text.length,t.doc.sliceString(this.from,this.to)),this.setSelection(t)}revertPending(t){let i=this.pendingContextChange;this.pendingContextChange=null,this.editContext.updateText(this.toContextPos(i.from),this.toContextPos(i.from+i.insert.length),t.doc.sliceString(i.from,i.to))}setSelection(t){let{main:i}=t.selection,s=this.toContextPos(Math.max(this.from,Math.min(this.to,i.anchor))),a=this.toContextPos(i.head);(this.editContext.selectionStart!=s||this.editContext.selectionEnd!=a)&&this.editContext.updateSelection(s,a)}rangeIsValid(t){let{head:i}=t.selection.main;return!(this.from>0&&i-this.from<500||this.to<t.doc.length&&this.to-i<500||this.to-this.from>1e4*3)}toEditorPos(t,i=this.to-this.from){t=Math.min(t,i);let s=this.composing;return s&&s.drifted?s.editorBase+(t-s.contextBase):t+this.from}toContextPos(t){let i=this.composing;return i&&i.drifted?i.contextBase+(t-i.editorBase):t-this.from}destroy(){for(let t in this.handlers)this.editContext.removeEventListener(t,this.handlers[t])}}class Gt{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return!!this.inputState&&this.inputState.composing>0}get compositionStarted(){return!!this.inputState&&this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(t={}){var i;this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),t.parent&&t.parent.appendChild(this.dom);let{dispatch:s}=t;this.dispatchTransactions=t.dispatchTransactions||s&&(a=>a.forEach(u=>s(u,this)))||(a=>this.update(a)),this.dispatch=this.dispatch.bind(this),this._root=t.root||rn(t.parent)||document,this.viewState=new Sa(t.state||n.EditorState.create(t)),t.scrollTo&&t.scrollTo.is(si)&&(this.viewState.scrollTarget=t.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(S).map(a=>new g(a));for(let a of this.plugins)a.update(this);this.observer=new Ff(this),this.inputState=new Oo(this),this.inputState.ensureHandlers(this.plugins),this.docView=new Zt(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure(),!((i=document.fonts)===null||i===void 0)&&i.ready&&document.fonts.ready.then(()=>this.requestMeasure())}dispatch(...t){let i=t.length==1&&t[0]instanceof n.Transaction?t:t.length==1&&Array.isArray(t[0])?t[0]:[this.state.update(...t)];this.dispatchTransactions(i,this)}update(t){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let i=!1,s=!1,a,u=this.state;for(let ie of t){if(ie.startState!=u)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");u=ie.state}if(this.destroyed){this.viewState.state=u;return}let p=this.hasFocus,v=0,k=null;t.some(ie=>ie.annotation(ha))?(this.inputState.notifiedFocused=p,v=1):p!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=p,k=fa(u,p),k||(v=1));let F=this.observer.delayedAndroidKey,I=null;if(F?(this.observer.clearDelayedAndroidKey(),I=this.observer.readChange(),(I&&!this.state.doc.eq(u.doc)||!this.state.selection.eq(u.selection))&&(I=null)):this.observer.clear(),u.facet(n.EditorState.phrases)!=this.state.facet(n.EditorState.phrases))return this.setState(u);a=Dn.create(this,u,t),a.flags|=v;let Y=this.viewState.scrollTarget;try{this.updateState=2;for(let ie of t){if(Y&&(Y=Y.map(ie.changes)),ie.scrollIntoView){let{main:de}=ie.state.selection;Y=new ei(de.empty?de:n.EditorSelection.cursor(de.head,de.head>de.anchor?-1:1))}for(let de of ie.effects)de.is(si)&&(Y=de.value.clip(this.state))}this.viewState.update(a,Y),this.bidiCache=Ms.update(this.bidiCache,a.changes),a.empty||(this.updatePlugins(a),this.inputState.update(a)),i=this.docView.update(a),this.state.facet(ln)!=this.styleModules&&this.mountStyles(),s=this.updateAttrs(),this.showAnnouncements(t),this.docView.updateSelection(i,t.some(ie=>ie.isUserEvent("select.pointer")))}finally{this.updateState=0}if(a.startState.facet(Os)!=a.state.facet(Os)&&(this.viewState.mustMeasureContent=!0),(i||s||Y||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),i&&this.docViewUpdate(),!a.empty)for(let ie of this.state.facet(je))try{ie(a)}catch(de){U(this.state,de,"update listener")}(k||I)&&Promise.resolve().then(()=>{k&&this.state==k.startState&&this.dispatch(k),I&&!jr(this,I)&&F.force&&ut(this.contentDOM,F.key,F.keyCode)})}setState(t){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=t;return}this.updateState=2;let i=this.hasFocus;try{for(let s of this.plugins)s.destroy(this);this.viewState=new Sa(t),this.plugins=t.facet(S).map(s=>new g(s)),this.pluginMap.clear();for(let s of this.plugins)s.update(this);this.docView.destroy(),this.docView=new Zt(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}i&&this.focus(),this.requestMeasure()}updatePlugins(t){let i=t.startState.facet(S),s=t.state.facet(S);if(i!=s){let a=[];for(let u of s){let p=i.indexOf(u);if(p<0)a.push(new g(u));else{let v=this.plugins[p];v.mustUpdate=t,a.push(v)}}for(let u of this.plugins)u.mustUpdate!=t&&u.destroy(this);this.plugins=a,this.pluginMap.clear()}else for(let a of this.plugins)a.mustUpdate=t;for(let a=0;a<this.plugins.length;a++)this.plugins[a].update(this);i!=s&&this.inputState.ensureHandlers(this.plugins)}docViewUpdate(){for(let t of this.plugins){let i=t.value;if(i&&i.docViewUpdate)try{i.docViewUpdate(this)}catch(s){U(this.state,s,"doc view update listener")}}}measure(t=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,t&&this.observer.forceFlush();let i=null,s=this.scrollDOM,a=s.scrollTop*this.scaleY,{scrollAnchorPos:u,scrollAnchorHeight:p}=this.viewState;Math.abs(a-this.viewState.scrollTop)>1&&(p=-1),this.viewState.scrollAnchorHeight=-1;try{for(let v=0;;v++){if(p<0)if(Kt(s))u=-1,p=this.viewState.heightMap.height;else{let de=this.viewState.scrollAnchorAt(a);u=de.from,p=de.top}this.updateState=1;let k=this.viewState.measure(this);if(!k&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(v>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let F=[];k&4||([this.measureRequests,F]=[F,this.measureRequests]);let I=F.map(de=>{try{return de.read(this)}catch(ve){return U(this.state,ve),Ca}}),Y=Dn.create(this,this.state,[]),ie=!1;Y.flags|=k,i?i.flags|=k:i=Y,this.updateState=2,Y.empty||(this.updatePlugins(Y),this.inputState.update(Y),this.updateAttrs(),ie=this.docView.update(Y),ie&&this.docViewUpdate());for(let de=0;de<F.length;de++)if(I[de]!=Ca)try{let ve=F[de];ve.write&&ve.write(I[de],this)}catch(ve){U(this.state,ve)}if(ie&&this.docView.updateSelection(!0),!Y.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,p=-1;continue}else{let ve=(u<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(u).top)-p;if(ve>1||ve<-1){a=a+ve,s.scrollTop=a/this.scaleY,p=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(i&&!i.empty)for(let v of this.state.facet(je))v(i)}get themeClasses(){return Bo+" "+(this.state.facet(Po)?wa:Ea)+" "+this.state.facet(Os)}updateAttrs(){let t=Aa(this,A,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),i={spellcheck:"false",autocorrect:"off",autocapitalize:"off",writingsuggestions:"false",translate:"no",contenteditable:this.state.facet(x)?"true":"false",class:"cm-content",style:`${oe.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(i["aria-readonly"]="true"),Aa(this,P,i);let s=this.observer.ignore(()=>{let a=qt(this.contentDOM,this.contentAttrs,i),u=qt(this.dom,this.editorAttrs,t);return a||u});return this.editorAttrs=t,this.contentAttrs=i,s}showAnnouncements(t){let i=!0;for(let s of t)for(let a of s.effects)if(a.is(Gt.announce)){i&&(this.announceDOM.textContent=""),i=!1;let u=this.announceDOM.appendChild(document.createElement("div"));u.textContent=a.value}}mountStyles(){this.styleModules=this.state.facet(ln);let t=this.state.facet(Gt.cspNonce);r.StyleModule.mount(this.root,this.styleModules.concat(_f).reverse(),t?{nonce:t}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(t){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),t){if(this.measureRequests.indexOf(t)>-1)return;if(t.key!=null){for(let i=0;i<this.measureRequests.length;i++)if(this.measureRequests[i].key===t.key){this.measureRequests[i]=t;return}}this.measureRequests.push(t)}}plugin(t){let i=this.pluginMap.get(t);return(i===void 0||i&&i.plugin!=t)&&this.pluginMap.set(t,i=this.plugins.find(s=>s.plugin==t)||null),i&&i.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(t){return this.readMeasured(),this.viewState.elementAtHeight(t)}lineBlockAtHeight(t){return this.readMeasured(),this.viewState.lineBlockAtHeight(t)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(t){return this.viewState.lineBlockAt(t)}get contentHeight(){return this.viewState.contentHeight}moveByChar(t,i,s){return sr(this,t,Ts(this,t,i,s))}moveByGroup(t,i){return sr(this,t,Ts(this,t,i,s=>Co(this,t.head,s)))}visualLineSide(t,i){let s=this.bidiSpans(t),a=this.textDirectionAt(t.from),u=s[i?s.length-1:0];return n.EditorSelection.cursor(u.side(i,a)+t.from,u.forward(!i,a)?1:-1)}moveToLineBoundary(t,i,s=!0){return Ss(this,t,i,s)}moveVertically(t,i,s){return sr(this,t,Ao(this,t,i,s))}domAtPos(t){return this.docView.domAtPos(t)}posAtDOM(t,i=0){return this.docView.posFromDOM(t,i)}posAtCoords(t,i=!0){return this.readMeasured(),Fr(this,t,i)}coordsAtPos(t,i=1){this.readMeasured();let s=this.docView.coordsAt(t,i);if(!s||s.left==s.right)return s;let a=this.state.doc.lineAt(t),u=this.bidiSpans(a),p=u[dn.find(u,t-a.from,-1,i)];return be(s,p.dir==e.Direction.LTR==i>0)}coordsForChar(t){return this.readMeasured(),this.docView.coordsForChar(t)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(t){return!this.state.facet(on)||t<this.viewport.from||t>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(t))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(t){if(t.length>Vf)return E(t.length);let i=this.textDirectionAt(t.from),s;for(let u of this.bidiCache)if(u.from==t.from&&u.dir==i&&(u.fresh||On(u.isolates,s=Re(this,t))))return u.order;s||(s=Re(this,t));let a=m(t.text,i,s);return this.bidiCache.push(new Ms(t.from,t.to,i,s,!0,a)),a}get hasFocus(){var t;return(this.dom.ownerDocument.hasFocus()||oe.safari&&((t=this.inputState)===null||t===void 0?void 0:t.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{ot(this.contentDOM),this.docView.updateSelection()})}setRoot(t){this._root!=t&&(this._root=t,this.observer.setWindow((t.nodeType==9?t:t.ownerDocument).defaultView||window),this.mountStyles())}destroy(){this.root.activeElement==this.contentDOM&&this.contentDOM.blur();for(let t of this.plugins)t.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(t,i={}){return si.of(new ei(typeof t=="number"?n.EditorSelection.cursor(t):t,i.y,i.x,i.yMargin,i.xMargin))}scrollSnapshot(){let{scrollTop:t,scrollLeft:i}=this.scrollDOM,s=this.viewState.scrollAnchorAt(t);return si.of(new ei(n.EditorSelection.cursor(s.from),"start","start",s.top-t,i,!0))}setTabFocusMode(t){t==null?this.inputState.tabFocusMode=this.inputState.tabFocusMode<0?0:-1:typeof t=="boolean"?this.inputState.tabFocusMode=t?0:-1:this.inputState.tabFocusMode!=0&&(this.inputState.tabFocusMode=Date.now()+t)}static domEventHandlers(t){return d.define(()=>({}),{eventHandlers:t})}static domEventObservers(t){return d.define(()=>({}),{eventObservers:t})}static theme(t,i){let s=r.StyleModule.newName(),a=[Os.of(s),ln.of(Vo(`.${s}`,t))];return i&&i.dark&&a.push(Po.of(!0)),a}static baseTheme(t){return n.Prec.lowest(ln.of(Vo("."+Bo,t,ka)))}static findFromDOM(t){var i;let s=t.querySelector(".cm-content"),a=s&&Je.get(s)||Je.get(t);return((i=a?.rootView)===null||i===void 0?void 0:i.view)||null}}Gt.styleModule=ln,Gt.inputHandler=nt,Gt.clipboardInputFilter=zt,Gt.clipboardOutputFilter=An,Gt.scrollHandler=wi,Gt.focusChangeEffect=it,Gt.perLineTextDirection=on,Gt.exceptionSink=De,Gt.updateListener=je,Gt.editable=x,Gt.mouseSelectionStyle=Te,Gt.dragMovesSelection=ce,Gt.clickAddsSelectionRange=ee,Gt.decorations=$,Gt.outerDecorations=X,Gt.atomicRanges=he,Gt.bidiIsolatedRanges=ge,Gt.scrollMargins=mt,Gt.darkTheme=Po,Gt.cspNonce=n.Facet.define({combine:c=>c.length?c[0]:""}),Gt.contentAttributes=P,Gt.editorAttributes=A,Gt.lineWrapping=Gt.contentAttributes.of({class:"cm-lineWrapping"}),Gt.announce=n.StateEffect.define();const Vf=4096,Ca={};class Ms{constructor(t,i,s,a,u,p){this.from=t,this.to=i,this.dir=s,this.isolates=a,this.fresh=u,this.order=p}static update(t,i){if(i.empty&&!t.some(u=>u.fresh))return t;let s=[],a=t.length?t[t.length-1].dir:e.Direction.LTR;for(let u=Math.max(0,t.length-10);u<t.length;u++){let p=t[u];p.dir==a&&!i.touchesRange(p.from,p.to)&&s.push(new Ms(i.mapPos(p.from,1),i.mapPos(p.to,-1),p.dir,p.isolates,!1,p.order))}return s}}function Aa(c,t,i){for(let s=c.state.facet(t),a=s.length-1;a>=0;a--){let u=s[a],p=typeof u=="function"?u(c):u;p&&He(p,i)}return i}const jf=oe.mac?"mac":oe.windows?"win":oe.linux?"linux":"key";function Uf(c,t){const i=c.split(/-(?!$)/);let s=i[i.length-1];s=="Space"&&(s=" ");let a,u,p,v;for(let k=0;k<i.length-1;++k){const F=i[k];if(/^(cmd|meta|m)$/i.test(F))v=!0;else if(/^a(lt)?$/i.test(F))a=!0;else if(/^(c|ctrl|control)$/i.test(F))u=!0;else if(/^s(hift)?$/i.test(F))p=!0;else if(/^mod$/i.test(F))t=="mac"?v=!0:u=!0;else throw new Error("Unrecognized modifier name: "+F)}return a&&(s="Alt-"+s),u&&(s="Ctrl-"+s),v&&(s="Meta-"+s),p&&(s="Shift-"+s),s}function Ls(c,t,i){return t.altKey&&(c="Alt-"+c),t.ctrlKey&&(c="Ctrl-"+c),t.metaKey&&(c="Meta-"+c),i!==!1&&t.shiftKey&&(c="Shift-"+c),c}const $f=n.Prec.default(Gt.domEventHandlers({keydown(c,t){return Ma(Oa(t.state),c,t,"editor")}})),Da=n.Facet.define({enables:$f}),Ia=new WeakMap;function Oa(c){let t=c.facet(Da),i=Ia.get(t);return i||Ia.set(t,i=qf(t.reduce((s,a)=>s.concat(a),[]))),i}function Hf(c,t,i){return Ma(Oa(c.state),t,c,i)}let Bi=null;const Wf=4e3;function qf(c,t=jf){let i=Object.create(null),s=Object.create(null),a=(p,v)=>{let k=s[p];if(k==null)s[p]=v;else if(k!=v)throw new Error("Key binding "+p+" is used both as a regular binding and as a multi-stroke prefix")},u=(p,v,k,F,I)=>{var Y,ie;let de=i[p]||(i[p]=Object.create(null)),ve=v.split(/ (?!$)/).map(Ae=>Uf(Ae,t));for(let Ae=1;Ae<ve.length;Ae++){let at=ve.slice(0,Ae).join(" ");a(at,!0),de[at]||(de[at]={preventDefault:!0,stopPropagation:!1,run:[vt=>{let dt=Bi={view:vt,prefix:at,scope:p};return setTimeout(()=>{Bi==dt&&(Bi=null)},Wf),!0}]})}let ke=ve.join(" ");a(ke,!1);let Ce=de[ke]||(de[ke]={preventDefault:!1,stopPropagation:!1,run:((ie=(Y=de._any)===null||Y===void 0?void 0:Y.run)===null||ie===void 0?void 0:ie.slice())||[]});k&&Ce.run.push(k),F&&(Ce.preventDefault=!0),I&&(Ce.stopPropagation=!0)};for(let p of c){let v=p.scope?p.scope.split(" "):["editor"];if(p.any)for(let F of v){let I=i[F]||(i[F]=Object.create(null));I._any||(I._any={preventDefault:!1,stopPropagation:!1,run:[]});let{any:Y}=p;for(let ie in I)I[ie].run.push(de=>Y(de,Uo))}let k=p[t]||p.key;if(k)for(let F of v)u(F,k,p.run,p.preventDefault,p.stopPropagation),p.shift&&u(F,"Shift-"+k,p.shift,p.preventDefault,p.stopPropagation)}return i}let Uo=null;function Ma(c,t,i,s){Uo=t;let a=o.keyName(t),u=n.codePointAt(a,0),p=n.codePointSize(u)==a.length&&a!=" ",v="",k=!1,F=!1,I=!1;Bi&&Bi.view==i&&Bi.scope==s&&(v=Bi.prefix+" ",ue.indexOf(t.keyCode)<0&&(F=!0,Bi=null));let Y=new Set,ie=Ce=>{if(Ce){for(let Ae of Ce.run)if(!Y.has(Ae)&&(Y.add(Ae),Ae(i)))return Ce.stopPropagation&&(I=!0),!0;Ce.preventDefault&&(Ce.stopPropagation&&(I=!0),F=!0)}return!1},de=c[s],ve,ke;return de&&(ie(de[v+Ls(a,t,!p)])?k=!0:p&&(t.altKey||t.metaKey||t.ctrlKey)&&!(oe.windows&&t.ctrlKey&&t.altKey)&&!(oe.mac&&t.altKey&&!t.ctrlKey)&&(ve=o.base[t.keyCode])&&ve!=a?(ie(de[v+Ls(ve,t,!0)])||t.shiftKey&&(ke=o.shift[t.keyCode])!=a&&ke!=ve&&ie(de[v+Ls(ke,t,!1)]))&&(k=!0):p&&t.shiftKey&&ie(de[v+Ls(a,t,!0)])&&(k=!0),!k&&ie(de._any)&&(k=!0)),F&&(k=!0),k&&I&&t.stopPropagation(),Uo=null,k}class or{constructor(t,i,s,a,u){this.className=t,this.left=i,this.top=s,this.width=a,this.height=u}draw(){let t=document.createElement("div");return t.className=this.className,this.adjust(t),t}update(t,i){return i.className!=this.className?!1:(this.adjust(t),!0)}adjust(t){t.style.left=this.left+"px",t.style.top=this.top+"px",this.width!=null&&(t.style.width=this.width+"px"),t.style.height=this.height+"px"}eq(t){return this.left==t.left&&this.top==t.top&&this.width==t.width&&this.height==t.height&&this.className==t.className}static forRange(t,i,s){if(s.empty){let a=t.coordsAtPos(s.head,s.assoc||1);if(!a)return[];let u=La(t);return[new or(i,a.left-u.left,a.top-u.top,null,a.bottom-a.top)]}else return zf(t,i,s)}}function La(c){let t=c.scrollDOM.getBoundingClientRect();return{left:(c.textDirection==e.Direction.LTR?t.left:t.right-c.scrollDOM.clientWidth*c.scaleX)-c.scrollDOM.scrollLeft*c.scaleX,top:t.top-c.scrollDOM.scrollTop*c.scaleY}}function _a(c,t,i,s){let a=c.coordsAtPos(t,i*2);if(!a)return s;let u=c.dom.getBoundingClientRect(),p=(a.top+a.bottom)/2,v=c.posAtCoords({x:u.left+1,y:p}),k=c.posAtCoords({x:u.right-1,y:p});return v==null||k==null?s:{from:Math.max(s.from,Math.min(v,k)),to:Math.min(s.to,Math.max(v,k))}}function zf(c,t,i){if(i.to<=c.viewport.from||i.from>=c.viewport.to)return[];let s=Math.max(i.from,c.viewport.from),a=Math.min(i.to,c.viewport.to),u=c.textDirection==e.Direction.LTR,p=c.contentDOM,v=p.getBoundingClientRect(),k=La(c),F=p.querySelector(".cm-line"),I=F&&window.getComputedStyle(F),Y=v.left+(I?parseInt(I.paddingLeft)+Math.min(0,parseInt(I.textIndent)):0),ie=v.right-(I?parseInt(I.paddingRight):0),de=rr(c,s,1),ve=rr(c,a,-1),ke=de.type==e.BlockType.Text?de:null,Ce=ve.type==e.BlockType.Text?ve:null;if(ke&&(c.lineWrapping||de.widgetLineBreaks)&&(ke=_a(c,s,1,ke)),Ce&&(c.lineWrapping||ve.widgetLineBreaks)&&(Ce=_a(c,a,-1,Ce)),ke&&Ce&&ke.from==Ce.from&&ke.to==Ce.to)return at(vt(i.from,i.to,ke));{let St=ke?vt(i.from,null,ke):dt(de,!1),Tt=Ce?vt(null,i.to,Ce):dt(ve,!0),xn=[];return(ke||de).to<(Ce||ve).from-(ke&&Ce?1:0)||de.widgetLineBreaks>1&&St.bottom+c.defaultLineHeight/2<Tt.top?xn.push(Ae(Y,St.bottom,ie,Tt.top)):St.bottom<Tt.top&&c.elementAtHeight((St.bottom+Tt.top)/2).type==e.BlockType.Text&&(St.bottom=Tt.top=(St.bottom+Tt.top)/2),at(St).concat(xn).concat(at(Tt))}function Ae(St,Tt,xn,Gn){return new or(t,St-k.left,Tt-k.top,xn-St,Gn-Tt)}function at({top:St,bottom:Tt,horizontal:xn}){let Gn=[];for(let Vi=0;Vi<xn.length;Vi+=2)Gn.push(Ae(xn[Vi],St,xn[Vi+1],Tt));return Gn}function vt(St,Tt,xn){let Gn=1e9,Vi=-1e9,Ws=[];function sc(zi,ji,cr,Gi,Yr){let Ii=c.coordsAtPos(zi,zi==xn.to?-2:2),Oi=c.coordsAtPos(cr,cr==xn.from?2:-2);!Ii||!Oi||(Gn=Math.min(Ii.top,Oi.top,Gn),Vi=Math.max(Ii.bottom,Oi.bottom,Vi),Yr==e.Direction.LTR?Ws.push(u&&ji?Y:Ii.left,u&&Gi?ie:Oi.right):Ws.push(!u&&Gi?Y:Oi.left,!u&&ji?ie:Ii.right))}let qs=St??xn.from,zs=Tt??xn.to;for(let zi of c.visibleRanges)if(zi.to>qs&&zi.from<zs)for(let ji=Math.max(zi.from,qs),cr=Math.min(zi.to,zs);;){let Gi=c.state.doc.lineAt(ji);for(let Yr of c.bidiSpans(Gi)){let Ii=Yr.from+Gi.from,Oi=Yr.to+Gi.from;if(Ii>=cr)break;Oi>ji&&sc(Math.max(Ii,ji),St==null&&Ii<=qs,Math.min(Oi,cr),Tt==null&&Oi>=zs,Yr.dir)}if(ji=Gi.to+1,ji>=cr)break}return Ws.length==0&&sc(qs,St==null,zs,Tt==null,c.textDirection),{top:Gn,bottom:Vi,horizontal:Ws}}function dt(St,Tt){let xn=v.top+(Tt?St.top:St.bottom);return{top:xn,bottom:xn,horizontal:[]}}}function Gf(c,t){return c.constructor==t.constructor&&c.eq(t)}class Yf{constructor(t,i){this.view=t,this.layer=i,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=t.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),i.above&&this.dom.classList.add("cm-layer-above"),i.class&&this.dom.classList.add(i.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(t.state),t.requestMeasure(this.measureReq),i.mount&&i.mount(this.dom,t)}update(t){t.startState.facet(_s)!=t.state.facet(_s)&&this.setOrder(t.state),(this.layer.update(t,this.dom)||t.geometryChanged)&&(this.scale(),t.view.requestMeasure(this.measureReq))}docViewUpdate(t){this.layer.updateOnDocViewUpdate!==!1&&t.requestMeasure(this.measureReq)}setOrder(t){let i=0,s=t.facet(_s);for(;i<s.length&&s[i]!=this.layer;)i++;this.dom.style.zIndex=String((this.layer.above?150:-1)-i)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:t,scaleY:i}=this.view;(t!=this.scaleX||i!=this.scaleY)&&(this.scaleX=t,this.scaleY=i,this.dom.style.transform=`scale(${1/t}, ${1/i})`)}draw(t){if(t.length!=this.drawn.length||t.some((i,s)=>!Gf(i,this.drawn[s]))){let i=this.dom.firstChild,s=0;for(let a of t)a.update&&i&&a.constructor&&this.drawn[s].constructor&&a.update(i,this.drawn[s])?(i=i.nextSibling,s++):this.dom.insertBefore(a.draw(),i);for(;i;){let a=i.nextSibling;i.remove(),i=a}this.drawn=t}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const _s=n.Facet.define();function $o(c){return[d.define(t=>new Yf(t,c)),_s.of(c)]}const lr=n.Facet.define({combine(c){return n.combineConfig(c,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(t,i)=>Math.min(t,i),drawRangeCursor:(t,i)=>t||i})}});function Jf(c={}){return[lr.of(c),Qf,Kf,Zf,Zn.of(!0)]}function Xf(c){return c.facet(lr)}function Ra(c){return c.startState.facet(lr)!=c.state.facet(lr)}const Qf=$o({above:!0,markers(c){let{state:t}=c,i=t.facet(lr),s=[];for(let a of t.selection.ranges){let u=a==t.selection.main;if(a.empty||i.drawRangeCursor){let p=u?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",v=a.empty?a:n.EditorSelection.cursor(a.head,a.head>a.anchor?-1:1);for(let k of or.forRange(c,p,v))s.push(k)}}return s},update(c,t){c.transactions.some(s=>s.selection)&&(t.style.animationName=t.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let i=Ra(c);return i&&Fa(c.state,t),c.docChanged||c.selectionSet||i},mount(c,t){Fa(t.state,c)},class:"cm-cursorLayer"});function Fa(c,t){t.style.animationDuration=c.facet(lr).cursorBlinkRate+"ms"}const Kf=$o({above:!1,markers(c){return c.state.selection.ranges.map(t=>t.empty?[]:or.forRange(c,"cm-selectionBackground",t)).reduce((t,i)=>t.concat(i))},update(c,t){return c.docChanged||c.selectionSet||c.viewportChanged||Ra(c)},class:"cm-selectionLayer"}),Zf=n.Prec.highest(Gt.theme({".cm-line":{"& ::selection, &::selection":{backgroundColor:"transparent !important"},caretColor:"transparent !important"},".cm-content":{caretColor:"transparent !important","& :focus":{caretColor:"initial !important","&::selection, & ::selection":{backgroundColor:"Highlight !important"}}}})),Pa=n.StateEffect.define({map(c,t){return c==null?null:t.mapPos(c)}}),Hr=n.StateField.define({create(){return null},update(c,t){return c!=null&&(c=t.changes.mapPos(c)),t.effects.reduce((i,s)=>s.is(Pa)?s.value:i,c)}}),ed=d.fromClass(class{constructor(c){this.view=c,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(c){var t;let i=c.state.field(Hr);i==null?this.cursor!=null&&((t=this.cursor)===null||t===void 0||t.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(c.startState.field(Hr)!=i||c.docChanged||c.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:c}=this,t=c.state.field(Hr),i=t!=null&&c.coordsAtPos(t);if(!i)return null;let s=c.scrollDOM.getBoundingClientRect();return{left:i.left-s.left+c.scrollDOM.scrollLeft*c.scaleX,top:i.top-s.top+c.scrollDOM.scrollTop*c.scaleY,height:i.bottom-i.top}}drawCursor(c){if(this.cursor){let{scaleX:t,scaleY:i}=this.view;c?(this.cursor.style.left=c.left/t+"px",this.cursor.style.top=c.top/i+"px",this.cursor.style.height=c.height/i+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(c){this.view.state.field(Hr)!=c&&this.view.dispatch({effects:Pa.of(c)})}},{eventObservers:{dragover(c){this.setDropPos(this.view.posAtCoords({x:c.clientX,y:c.clientY}))},dragleave(c){(c.target==this.view.contentDOM||!this.view.contentDOM.contains(c.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function td(){return[Hr,ed]}function Ba(c,t,i,s,a){t.lastIndex=0;for(let u=c.iterRange(i,s),p=i,v;!u.next().done;p+=u.value.length)if(!u.lineBreak)for(;v=t.exec(u.value);)a(p+v.index,v)}function nd(c,t){let i=c.visibleRanges;if(i.length==1&&i[0].from==c.viewport.from&&i[0].to==c.viewport.to)return i;let s=[];for(let{from:a,to:u}of i)a=Math.max(c.state.doc.lineAt(a).from,a-t),u=Math.min(c.state.doc.lineAt(u).to,u+t),s.length&&s[s.length-1].to>=a?s[s.length-1].to=u:s.push({from:a,to:u});return s}class Rs{constructor(t){const{regexp:i,decoration:s,decorate:a,boundary:u,maxLength:p=1e3}=t;if(!i.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=i,a)this.addMatch=(v,k,F,I)=>a(I,F,F+v[0].length,v,k);else if(typeof s=="function")this.addMatch=(v,k,F,I)=>{let Y=s(v,k,F);Y&&I(F,F+v[0].length,Y)};else if(s)this.addMatch=(v,k,F,I)=>I(F,F+v[0].length,s);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=u,this.maxLength=p}createDeco(t){let i=new n.RangeSetBuilder,s=i.add.bind(i);for(let{from:a,to:u}of nd(t,this.maxLength))Ba(t.state.doc,this.regexp,a,u,(p,v)=>this.addMatch(v,t,p,s));return i.finish()}updateDeco(t,i){let s=1e9,a=-1;return t.docChanged&&t.changes.iterChanges((u,p,v,k)=>{k>=t.view.viewport.from&&v<=t.view.viewport.to&&(s=Math.min(v,s),a=Math.max(k,a))}),t.viewportMoved||a-s>1e3?this.createDeco(t.view):a>-1?this.updateRange(t.view,i.map(t.changes),s,a):i}updateRange(t,i,s,a){for(let u of t.visibleRanges){let p=Math.max(u.from,s),v=Math.min(u.to,a);if(v>=p){let k=t.state.doc.lineAt(p),F=k.to<v?t.state.doc.lineAt(v):k,I=Math.max(u.from,k.from),Y=Math.min(u.to,F.to);if(this.boundary){for(;p>k.from;p--)if(this.boundary.test(k.text[p-1-k.from])){I=p;break}for(;v<F.to;v++)if(this.boundary.test(F.text[v-F.from])){Y=v;break}}let ie=[],de,ve=(ke,Ce,Ae)=>ie.push(Ae.range(ke,Ce));if(k==F)for(this.regexp.lastIndex=I-k.from;(de=this.regexp.exec(k.text))&&de.index<Y-k.from;)this.addMatch(de,t,de.index+k.from,ve);else Ba(t.state.doc,this.regexp,I,Y,(ke,Ce)=>this.addMatch(Ce,t,ke,ve));i=i.update({filterFrom:I,filterTo:Y,filter:(ke,Ce)=>ke<I||Ce>Y,add:ie})}}return i}}const Ho=/x/.unicode!=null?"gu":"g",id=new RegExp(`[\0-\b
--ÂŸÂ­Øœâ€‹â€Žâ€\u2028\u2029â€­â€®â¦â§â©\uFEFFï¿¹-ï¿¼]`,Ho),rd={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let Wo=null;function sd(){var c;if(Wo==null&&typeof document<"u"&&document.body){let t=document.body.style;Wo=((c=t.tabSize)!==null&&c!==void 0?c:t.MozTabSize)!=null}return Wo||!1}const Fs=n.Facet.define({combine(c){let t=n.combineConfig(c,{render:null,specialChars:id,addSpecialChars:null});return(t.replaceTabs=!sd())&&(t.specialChars=new RegExp("	|"+t.specialChars.source,Ho)),t.addSpecialChars&&(t.specialChars=new RegExp(t.specialChars.source+"|"+t.addSpecialChars.source,Ho)),t}});function od(c={}){return[Fs.of(c),ld()]}let Va=null;function ld(){return Va||(Va=d.fromClass(class{constructor(c){this.view=c,this.decorations=ht.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(c.state.facet(Fs)),this.decorations=this.decorator.createDeco(c)}makeDecorator(c){return new Rs({regexp:c.specialChars,decoration:(t,i,s)=>{let{doc:a}=i.state,u=n.codePointAt(t[0],0);if(u==9){let p=a.lineAt(s),v=i.state.tabSize,k=n.countColumn(p.text,v,s-p.from);return ht.replace({widget:new hd((v-k%v)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[u]||(this.decorationCache[u]=ht.replace({widget:new ud(c,u)}))},boundary:c.replaceTabs?void 0:/[^]/})}update(c){let t=c.state.facet(Fs);c.startState.facet(Fs)!=t?(this.decorator=this.makeDecorator(t),this.decorations=this.decorator.createDeco(c.view)):this.decorations=this.decorator.updateDeco(c,this.decorations)}},{decorations:c=>c.decorations}))}const ad="â€¢";function cd(c){return c>=32?ad:c==10?"â¤":String.fromCharCode(9216+c)}class ud extends kt{constructor(t,i){super(),this.options=t,this.code=i}eq(t){return t.code==this.code}toDOM(t){let i=cd(this.code),s=t.state.phrase("Control character")+" "+(rd[this.code]||"0x"+this.code.toString(16)),a=this.options.render&&this.options.render(this.code,s,i);if(a)return a;let u=document.createElement("span");return u.textContent=i,u.title=s,u.setAttribute("aria-label",s),u.className="cm-specialChar",u}ignoreEvent(){return!1}}class hd extends kt{constructor(t){super(),this.width=t}eq(t){return t.width==this.width}toDOM(){let t=document.createElement("span");return t.textContent="	",t.className="cm-tab",t.style.width=this.width+"px",t}ignoreEvent(){return!1}}const ja=d.fromClass(class{constructor(){this.height=1e3,this.attrs={style:"padding-bottom: 1000px"}}update(c){let{view:t}=c,i=t.viewState.editorHeight-t.defaultLineHeight-t.documentPadding.top-.5;i>=0&&i!=this.height&&(this.height=i,this.attrs={style:`padding-bottom: ${i}px`})}});function fd(){return[ja,P.of(c=>{var t;return((t=c.plugin(ja))===null||t===void 0?void 0:t.attrs)||null})]}function dd(){return md}const pd=ht.line({class:"cm-activeLine"}),md=d.fromClass(class{constructor(c){this.decorations=this.getDeco(c)}update(c){(c.docChanged||c.selectionSet)&&(this.decorations=this.getDeco(c.view))}getDeco(c){let t=-1,i=[];for(let s of c.state.selection.ranges){let a=c.lineBlockAt(s.head);a.from>t&&(i.push(pd.range(a.from)),t=a.from)}return ht.set(i)}},{decorations:c=>c.decorations});class gd extends kt{constructor(t){super(),this.content=t}toDOM(t){let i=document.createElement("span");return i.className="cm-placeholder",i.style.pointerEvents="none",i.appendChild(typeof this.content=="string"?document.createTextNode(this.content):typeof this.content=="function"?this.content(t):this.content.cloneNode(!0)),i.setAttribute("aria-hidden","true"),i}coordsAt(t){let i=t.firstChild?D(t.firstChild):[];if(!i.length)return null;let s=window.getComputedStyle(t.parentNode),a=be(i[0],s.direction!="rtl"),u=parseInt(s.lineHeight);return a.bottom-a.top>u*1.5?{left:a.left,right:a.right,top:a.top,bottom:a.top+u}:a}ignoreEvent(){return!1}}function yd(c){let t=d.fromClass(class{constructor(i){this.view=i,this.placeholder=c?ht.set([ht.widget({widget:new gd(c),side:1}).range(0)]):ht.none}get decorations(){return this.view.state.doc.length?ht.none:this.placeholder}},{decorations:i=>i.decorations});return typeof c=="string"?[t,Gt.contentAttributes.of({"aria-placeholder":c})]:t}const qo=2e3;function vd(c,t,i){let s=Math.min(t.line,i.line),a=Math.max(t.line,i.line),u=[];if(t.off>qo||i.off>qo||t.col<0||i.col<0){let p=Math.min(t.off,i.off),v=Math.max(t.off,i.off);for(let k=s;k<=a;k++){let F=c.doc.line(k);F.length<=v&&u.push(n.EditorSelection.range(F.from+p,F.to+v))}}else{let p=Math.min(t.col,i.col),v=Math.max(t.col,i.col);for(let k=s;k<=a;k++){let F=c.doc.line(k),I=n.findColumn(F.text,p,c.tabSize,!0);if(I<0)u.push(n.EditorSelection.cursor(F.to));else{let Y=n.findColumn(F.text,v,c.tabSize);u.push(n.EditorSelection.range(F.from+I,F.from+Y))}}}return u}function bd(c,t){let i=c.coordsAtPos(c.viewport.from);return i?Math.round(Math.abs((i.left-t)/c.defaultCharacterWidth)):-1}function Ua(c,t){let i=c.posAtCoords({x:t.clientX,y:t.clientY},!1),s=c.state.doc.lineAt(i),a=i-s.from,u=a>qo?-1:a==s.length?bd(c,t.clientX):n.countColumn(s.text,c.state.tabSize,i-s.from);return{line:s.number,col:u,off:a}}function Sd(c,t){let i=Ua(c,t),s=c.state.selection;return i?{update(a){if(a.docChanged){let u=a.changes.mapPos(a.startState.doc.line(i.line).from),p=a.state.doc.lineAt(u);i={line:p.number,col:i.col,off:Math.min(i.off,p.length)},s=s.map(a.changes)}},get(a,u,p){let v=Ua(c,a);if(!v)return s;let k=vd(c.state,i,v);return k.length?p?n.EditorSelection.create(k.concat(s.ranges)):n.EditorSelection.create(k):s}}:null}function Td(c){let t=c?.eventFilter||(i=>i.altKey&&i.button==0);return Gt.mouseSelectionStyle.of((i,s)=>t(s)?Sd(i,s):null)}const Ed={Alt:[18,c=>!!c.altKey],Control:[17,c=>!!c.ctrlKey],Shift:[16,c=>!!c.shiftKey],Meta:[91,c=>!!c.metaKey]},wd={style:"cursor: crosshair"};function kd(c={}){let[t,i]=Ed[c.key||"Alt"],s=d.fromClass(class{constructor(a){this.view=a,this.isDown=!1}set(a){this.isDown!=a&&(this.isDown=a,this.view.update([]))}},{eventObservers:{keydown(a){this.set(a.keyCode==t||i(a))},keyup(a){(a.keyCode==t||!i(a))&&this.set(!1)},mousemove(a){this.set(i(a))}}});return[s,Gt.contentAttributes.of(a=>{var u;return!((u=a.plugin(s))===null||u===void 0)&&u.isDown?wd:null})]}const Wr="-10000px";class $a{constructor(t,i,s,a){this.facet=i,this.createTooltipView=s,this.removeTooltipView=a,this.input=t.state.facet(i),this.tooltips=this.input.filter(p=>p);let u=null;this.tooltipViews=this.tooltips.map(p=>u=s(p,u))}update(t,i){var s;let a=t.state.facet(this.facet),u=a.filter(k=>k);if(a===this.input){for(let k of this.tooltipViews)k.update&&k.update(t);return!1}let p=[],v=i?[]:null;for(let k=0;k<u.length;k++){let F=u[k],I=-1;if(F){for(let Y=0;Y<this.tooltips.length;Y++){let ie=this.tooltips[Y];ie&&ie.create==F.create&&(I=Y)}if(I<0)p[k]=this.createTooltipView(F,k?p[k-1]:null),v&&(v[k]=!!F.above);else{let Y=p[k]=this.tooltipViews[I];v&&(v[k]=i[I]),Y.update&&Y.update(t)}}}for(let k of this.tooltipViews)p.indexOf(k)<0&&(this.removeTooltipView(k),(s=k.destroy)===null||s===void 0||s.call(k));return i&&(v.forEach((k,F)=>i[F]=k),i.length=v.length),this.input=a,this.tooltips=u,this.tooltipViews=p,!0}}function xd(c={}){return Ps.of(c)}function Nd(c){let t=c.dom.ownerDocument.documentElement;return{top:0,left:0,bottom:t.clientHeight,right:t.clientWidth}}const Ps=n.Facet.define({combine:c=>{var t,i,s;return{position:oe.ios?"absolute":((t=c.find(a=>a.position))===null||t===void 0?void 0:t.position)||"fixed",parent:((i=c.find(a=>a.parent))===null||i===void 0?void 0:i.parent)||null,tooltipSpace:((s=c.find(a=>a.tooltipSpace))===null||s===void 0?void 0:s.tooltipSpace)||Nd}}}),Ha=new WeakMap,Bs=d.fromClass(class{constructor(c){this.view=c,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let t=c.state.facet(Ps);this.position=t.position,this.parent=t.parent,this.classes=c.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.resizeObserver=typeof ResizeObserver=="function"?new ResizeObserver(()=>this.measureSoon()):null,this.manager=new $a(c,zo,(i,s)=>this.createTooltip(i,s),i=>{this.resizeObserver&&this.resizeObserver.unobserve(i.dom),i.dom.remove()}),this.above=this.manager.tooltips.map(i=>!!i.above),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(i=>{Date.now()>this.lastTransaction-50&&i.length>0&&i[i.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),c.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let c of this.manager.tooltipViews)this.intersectionObserver.observe(c.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(c){c.transactions.length&&(this.lastTransaction=Date.now());let t=this.manager.update(c,this.above);t&&this.observeIntersection();let i=t||c.geometryChanged,s=c.state.facet(Ps);if(s.position!=this.position&&!this.madeAbsolute){this.position=s.position;for(let a of this.manager.tooltipViews)a.dom.style.position=this.position;i=!0}if(s.parent!=this.parent){this.parent&&this.container.remove(),this.parent=s.parent,this.createContainer();for(let a of this.manager.tooltipViews)this.container.appendChild(a.dom);i=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);i&&this.maybeMeasure()}createTooltip(c,t){let i=c.create(this.view),s=t?t.dom:null;if(i.dom.classList.add("cm-tooltip"),c.arrow&&!i.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let a=document.createElement("div");a.className="cm-tooltip-arrow",i.dom.appendChild(a)}return i.dom.style.position=this.position,i.dom.style.top=Wr,i.dom.style.left="0px",this.container.insertBefore(i.dom,s),i.mount&&i.mount(this.view),this.resizeObserver&&this.resizeObserver.observe(i.dom),i}destroy(){var c,t,i;this.view.win.removeEventListener("resize",this.measureSoon);for(let s of this.manager.tooltipViews)s.dom.remove(),(c=s.destroy)===null||c===void 0||c.call(s);this.parent&&this.container.remove(),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),(i=this.intersectionObserver)===null||i===void 0||i.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let c=1,t=1,i=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:u}=this.manager.tooltipViews[0];if(oe.gecko)i=u.offsetParent!=this.container.ownerDocument.body;else if(u.style.top==Wr&&u.style.left=="0px"){let p=u.getBoundingClientRect();i=Math.abs(p.top+1e4)>1||Math.abs(p.left)>1}}if(i||this.position=="absolute")if(this.parent){let u=this.parent.getBoundingClientRect();u.width&&u.height&&(c=u.width/this.parent.offsetWidth,t=u.height/this.parent.offsetHeight)}else({scaleX:c,scaleY:t}=this.view.viewState);let s=this.view.scrollDOM.getBoundingClientRect(),a=Bt(this.view);return{visible:{left:s.left+a.left,top:s.top+a.top,right:s.right-a.right,bottom:s.bottom-a.bottom},parent:this.parent?this.container.getBoundingClientRect():this.view.dom.getBoundingClientRect(),pos:this.manager.tooltips.map((u,p)=>{let v=this.manager.tooltipViews[p];return v.getCoords?v.getCoords(u.pos):this.view.coordsAtPos(u.pos)}),size:this.manager.tooltipViews.map(({dom:u})=>u.getBoundingClientRect()),space:this.view.state.facet(Ps).tooltipSpace(this.view),scaleX:c,scaleY:t,makeAbsolute:i}}writeMeasure(c){var t;if(c.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let v of this.manager.tooltipViews)v.dom.style.position="absolute"}let{visible:i,space:s,scaleX:a,scaleY:u}=c,p=[];for(let v=0;v<this.manager.tooltips.length;v++){let k=this.manager.tooltips[v],F=this.manager.tooltipViews[v],{dom:I}=F,Y=c.pos[v],ie=c.size[v];if(!Y||k.clip!==!1&&(Y.bottom<=Math.max(i.top,s.top)||Y.top>=Math.min(i.bottom,s.bottom)||Y.right<Math.max(i.left,s.left)-.1||Y.left>Math.min(i.right,s.right)+.1)){I.style.top=Wr;continue}let de=k.arrow?F.dom.querySelector(".cm-tooltip-arrow"):null,ve=de?7:0,ke=ie.right-ie.left,Ce=(t=Ha.get(F))!==null&&t!==void 0?t:ie.bottom-ie.top,Ae=F.offset||Ad,at=this.view.textDirection==e.Direction.LTR,vt=ie.width>s.right-s.left?at?s.left:s.right-ie.width:at?Math.max(s.left,Math.min(Y.left-(de?14:0)+Ae.x,s.right-ke)):Math.min(Math.max(s.left,Y.left-ke+(de?14:0)-Ae.x),s.right-ke),dt=this.above[v];!k.strictSide&&(dt?Y.top-Ce-ve-Ae.y<s.top:Y.bottom+Ce+ve+Ae.y>s.bottom)&&dt==s.bottom-Y.bottom>Y.top-s.top&&(dt=this.above[v]=!dt);let St=(dt?Y.top-s.top:s.bottom-Y.bottom)-ve;if(St<Ce&&F.resize!==!1){if(St<this.view.defaultLineHeight){I.style.top=Wr;continue}Ha.set(F,Ce),I.style.height=(Ce=St)/u+"px"}else I.style.height&&(I.style.height="");let Tt=dt?Y.top-Ce-ve-Ae.y:Y.bottom+ve+Ae.y,xn=vt+ke;if(F.overlap!==!0)for(let Gn of p)Gn.left<xn&&Gn.right>vt&&Gn.top<Tt+Ce&&Gn.bottom>Tt&&(Tt=dt?Gn.top-Ce-2-ve:Gn.bottom+ve+2);if(this.position=="absolute"?(I.style.top=(Tt-c.parent.top)/u+"px",Wa(I,(vt-c.parent.left)/a)):(I.style.top=Tt/u+"px",Wa(I,vt/a)),de){let Gn=Y.left+(at?Ae.x:-Ae.x)-(vt+14-7);de.style.left=Gn/a+"px"}F.overlap!==!0&&p.push({left:vt,top:Tt,right:xn,bottom:Tt+Ce}),I.classList.toggle("cm-tooltip-above",dt),I.classList.toggle("cm-tooltip-below",!dt),F.positioned&&F.positioned(c.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let c of this.manager.tooltipViews)c.dom.style.top=Wr}},{eventObservers:{scroll(){this.maybeMeasure()}}});function Wa(c,t){let i=parseInt(c.style.left,10);(isNaN(i)||Math.abs(t-i)>1)&&(c.style.left=t+"px")}const Cd=Gt.baseTheme({".cm-tooltip":{zIndex:500,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:"7px",width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:"7px solid transparent",borderRight:"7px solid transparent"},".cm-tooltip-above &":{bottom:"-7px","&:before":{borderTop:"7px solid #bbb"},"&:after":{borderTop:"7px solid #f5f5f5",bottom:"1px"}},".cm-tooltip-below &":{top:"-7px","&:before":{borderBottom:"7px solid #bbb"},"&:after":{borderBottom:"7px solid #f5f5f5",top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),Ad={x:0,y:0},zo=n.Facet.define({enables:[Bs,Cd]}),qr=n.Facet.define({combine:c=>c.reduce((t,i)=>t.concat(i),[])});class Vs{static create(t){return new Vs(t)}constructor(t){this.view=t,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new $a(t,qr,(i,s)=>this.createHostedView(i,s),i=>i.dom.remove())}createHostedView(t,i){let s=t.create(this.view);return s.dom.classList.add("cm-tooltip-section"),this.dom.insertBefore(s.dom,i?i.dom.nextSibling:this.dom.firstChild),this.mounted&&s.mount&&s.mount(this.view),s}mount(t){for(let i of this.manager.tooltipViews)i.mount&&i.mount(t);this.mounted=!0}positioned(t){for(let i of this.manager.tooltipViews)i.positioned&&i.positioned(t)}update(t){this.manager.update(t)}destroy(){var t;for(let i of this.manager.tooltipViews)(t=i.destroy)===null||t===void 0||t.call(i)}passProp(t){let i;for(let s of this.manager.tooltipViews){let a=s[t];if(a!==void 0){if(i===void 0)i=a;else if(i!==a)return}}return i}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const Dd=zo.compute([qr],c=>{let t=c.facet(qr);return t.length===0?null:{pos:Math.min(...t.map(i=>i.pos)),end:Math.max(...t.map(i=>{var s;return(s=i.end)!==null&&s!==void 0?s:i.pos})),create:Vs.create,above:t[0].above,arrow:t.some(i=>i.arrow)}});class Id{constructor(t,i,s,a,u){this.view=t,this.source=i,this.field=s,this.setHover=a,this.hoverTime=u,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:t.dom,time:0},this.checkHover=this.checkHover.bind(this),t.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),t.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active.length)return;let t=Date.now()-this.lastMove.time;t<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-t):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:t,lastMove:i}=this,s=t.docView.nearest(i.target);if(!s)return;let a,u=1;if(s instanceof H)a=s.posAtStart;else{if(a=t.posAtCoords(i),a==null)return;let v=t.coordsAtPos(a);if(!v||i.y<v.top||i.y>v.bottom||i.x<v.left-t.defaultCharacterWidth||i.x>v.right+t.defaultCharacterWidth)return;let k=t.bidiSpans(t.state.doc.lineAt(a)).find(I=>I.from<=a&&I.to>=a),F=k&&k.dir==e.Direction.RTL?-1:1;u=i.x<v.left?-F:F}let p=this.source(t,a,u);if(p?.then){let v=this.pending={pos:a};p.then(k=>{this.pending==v&&(this.pending=null,k&&!(Array.isArray(k)&&!k.length)&&t.dispatch({effects:this.setHover.of(Array.isArray(k)?k:[k])}))},k=>U(t.state,k,"hover tooltip"))}else p&&!(Array.isArray(p)&&!p.length)&&t.dispatch({effects:this.setHover.of(Array.isArray(p)?p:[p])})}get tooltip(){let t=this.view.plugin(Bs),i=t?t.manager.tooltips.findIndex(s=>s.create==Vs.create):-1;return i>-1?t.manager.tooltipViews[i]:null}mousemove(t){var i,s;this.lastMove={x:t.clientX,y:t.clientY,target:t.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:a,tooltip:u}=this;if(a.length&&u&&!Od(u.dom,t)||this.pending){let{pos:p}=a[0]||this.pending,v=(s=(i=a[0])===null||i===void 0?void 0:i.end)!==null&&s!==void 0?s:p;(p==v?this.view.posAtCoords(this.lastMove)!=p:!Md(this.view,p,v,t.clientX,t.clientY))&&(this.view.dispatch({effects:this.setHover.of([])}),this.pending=null)}}mouseleave(t){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:i}=this;if(i.length){let{tooltip:s}=this;s&&s.dom.contains(t.relatedTarget)?this.watchTooltipLeave(s.dom):this.view.dispatch({effects:this.setHover.of([])})}}watchTooltipLeave(t){let i=s=>{t.removeEventListener("mouseleave",i),this.active.length&&!this.view.dom.contains(s.relatedTarget)&&this.view.dispatch({effects:this.setHover.of([])})};t.addEventListener("mouseleave",i)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const js=4;function Od(c,t){let{left:i,right:s,top:a,bottom:u}=c.getBoundingClientRect(),p;if(p=c.querySelector(".cm-tooltip-arrow")){let v=p.getBoundingClientRect();a=Math.min(v.top,a),u=Math.max(v.bottom,u)}return t.clientX>=i-js&&t.clientX<=s+js&&t.clientY>=a-js&&t.clientY<=u+js}function Md(c,t,i,s,a,u){let p=c.scrollDOM.getBoundingClientRect(),v=c.documentTop+c.documentPadding.top+c.contentHeight;if(p.left>s||p.right<s||p.top>a||Math.min(p.bottom,v)<a)return!1;let k=c.posAtCoords({x:s,y:a},!1);return k>=t&&k<=i}function Ld(c,t={}){let i=n.StateEffect.define(),s=n.StateField.define({create(){return[]},update(a,u){if(a.length&&(t.hideOnChange&&(u.docChanged||u.selection)?a=[]:t.hideOn&&(a=a.filter(p=>!t.hideOn(u,p))),u.docChanged)){let p=[];for(let v of a){let k=u.changes.mapPos(v.pos,-1,n.MapMode.TrackDel);if(k!=null){let F=Object.assign(Object.create(null),v);F.pos=k,F.end!=null&&(F.end=u.changes.mapPos(F.end)),p.push(F)}}a=p}for(let p of u.effects)p.is(i)&&(a=p.value),p.is(qa)&&(a=[]);return a},provide:a=>qr.from(a)});return{active:s,extension:[s,d.define(a=>new Id(a,c,s,i,t.hoverTime||300)),Dd]}}function _d(c,t){let i=c.plugin(Bs);if(!i)return null;let s=i.manager.tooltips.indexOf(t);return s<0?null:i.manager.tooltipViews[s]}function Rd(c){return c.facet(qr).some(t=>t)}const qa=n.StateEffect.define(),Fd=qa.of(null);function Pd(c){let t=c.plugin(Bs);t&&t.maybeMeasure()}const Go=n.Facet.define({combine(c){let t,i;for(let s of c)t=t||s.topContainer,i=i||s.bottomContainer;return{topContainer:t,bottomContainer:i}}});function Bd(c){return c?[Go.of(c)]:[]}function za(c,t){let i=c.plugin(Ga),s=i?i.specs.indexOf(t):-1;return s>-1?i.panels[s]:null}const Ga=d.fromClass(class{constructor(c){this.input=c.state.facet($s),this.specs=this.input.filter(i=>i),this.panels=this.specs.map(i=>i(c));let t=c.state.facet(Go);this.top=new Us(c,!0,t.topContainer),this.bottom=new Us(c,!1,t.bottomContainer),this.top.sync(this.panels.filter(i=>i.top)),this.bottom.sync(this.panels.filter(i=>!i.top));for(let i of this.panels)i.dom.classList.add("cm-panel"),i.mount&&i.mount()}update(c){let t=c.state.facet(Go);this.top.container!=t.topContainer&&(this.top.sync([]),this.top=new Us(c.view,!0,t.topContainer)),this.bottom.container!=t.bottomContainer&&(this.bottom.sync([]),this.bottom=new Us(c.view,!1,t.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let i=c.state.facet($s);if(i!=this.input){let s=i.filter(k=>k),a=[],u=[],p=[],v=[];for(let k of s){let F=this.specs.indexOf(k),I;F<0?(I=k(c.view),v.push(I)):(I=this.panels[F],I.update&&I.update(c)),a.push(I),(I.top?u:p).push(I)}this.specs=s,this.panels=a,this.top.sync(u),this.bottom.sync(p);for(let k of v)k.dom.classList.add("cm-panel"),k.mount&&k.mount()}else for(let s of this.panels)s.update&&s.update(c)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:c=>Gt.scrollMargins.of(t=>{let i=t.plugin(c);return i&&{top:i.top.scrollMargin(),bottom:i.bottom.scrollMargin()}})});class Us{constructor(t,i,s){this.view=t,this.top=i,this.container=s,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(t){for(let i of this.panels)i.destroy&&t.indexOf(i)<0&&i.destroy();this.panels=t,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let i=this.container||this.view.dom;i.insertBefore(this.dom,this.top?i.firstChild:null)}let t=this.dom.firstChild;for(let i of this.panels)if(i.dom.parentNode==this.dom){for(;t!=i.dom;)t=Ya(t);t=t.nextSibling}else this.dom.insertBefore(i.dom,t);for(;t;)t=Ya(t)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let t of this.classes.split(" "))t&&this.container.classList.remove(t);for(let t of(this.classes=this.view.themeClasses).split(" "))t&&this.container.classList.add(t)}}}function Ya(c){let t=c.nextSibling;return c.remove(),t}const $s=n.Facet.define({enables:Ga});function Vd(c,t){let i,s=new Promise(p=>i=p),a=p=>Ud(p,t,i);c.state.field(Hs,!1)?c.dispatch({effects:Ja.of(a)}):c.dispatch({effects:n.StateEffect.appendConfig.of(Hs.init(()=>[a]))});let u=Xa.of(a);return{close:u,result:s.then(p=>((c.win.queueMicrotask||(k=>c.win.setTimeout(k,10)))(()=>{c.state.field(Hs).indexOf(a)>-1&&c.dispatch({effects:u})}),p))}}function jd(c,t){let i=c.state.field(Hs,!1)||[];for(let s of i){let a=za(c,s);if(a&&a.dom.classList.contains(t))return a}return null}const Hs=n.StateField.define({create(){return[]},update(c,t){for(let i of t.effects)i.is(Ja)?c=[i.value].concat(c):i.is(Xa)&&(c=c.filter(s=>s!=i.value));return c},provide:c=>$s.computeN([c],t=>t.field(c))}),Ja=n.StateEffect.define(),Xa=n.StateEffect.define();function Ud(c,t,i){let s=t.content?t.content(c,()=>p(null)):null;if(!s){if(s=l("form"),t.input){let v=l("input",t.input);/^(text|password|number|email|tel|url)$/.test(v.type)&&v.classList.add("cm-textfield"),v.name||(v.name="input"),s.appendChild(l("label",(t.label||"")+": ",v))}else s.appendChild(document.createTextNode(t.label||""));s.appendChild(document.createTextNode(" ")),s.appendChild(l("button",{class:"cm-button",type:"submit"},t.submitLabel||"OK"))}let a=s.nodeName=="FORM"?[s]:s.querySelectorAll("form");for(let v=0;v<a.length;v++){let k=a[v];k.addEventListener("keydown",F=>{F.keyCode==27?(F.preventDefault(),p(null)):F.keyCode==13&&(F.preventDefault(),p(k))}),k.addEventListener("submit",F=>{F.preventDefault(),p(k)})}let u=l("div",s,l("button",{onclick:()=>p(null),"aria-label":c.state.phrase("close"),class:"cm-dialog-close",type:"button"},["Ã—"]));t.class&&(u.className=t.class),u.classList.add("cm-dialog");function p(v){u.contains(u.ownerDocument.activeElement)&&c.focus(),i(v)}return{dom:u,top:t.top,mount:()=>{if(t.focus){let v;typeof t.focus=="string"?v=s.querySelector(t.focus):v=s.querySelector("input")||s.querySelector("button"),v&&"select"in v?v.select():v&&"focus"in v&&v.focus()}}}}class Di extends n.RangeValue{compare(t){return this==t||this.constructor==t.constructor&&this.eq(t)}eq(t){return!1}destroy(t){}}Di.prototype.elementClass="",Di.prototype.toDOM=void 0,Di.prototype.mapMode=n.MapMode.TrackBefore,Di.prototype.startSide=Di.prototype.endSide=-1,Di.prototype.point=!0;const zr=n.Facet.define(),Qa=n.Facet.define(),$d={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>n.RangeSet.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{},side:"before"},Gr=n.Facet.define();function Hd(c){return[Jo(),Gr.of({...$d,...c})]}const Yo=n.Facet.define({combine:c=>c.some(t=>t)});function Jo(c){let t=[Wd];return c&&c.fixed===!1&&t.push(Yo.of(!0)),t}const Wd=d.fromClass(class{constructor(c){this.view=c,this.domAfter=null,this.prevViewport=c.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters cm-gutters-before",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=c.state.facet(Gr).map(t=>new Za(c,t)),this.fixed=!c.state.facet(Yo);for(let t of this.gutters)t.config.side=="after"?this.getDOMAfter().appendChild(t.dom):this.dom.appendChild(t.dom);this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),c.scrollDOM.insertBefore(this.dom,c.contentDOM)}getDOMAfter(){return this.domAfter||(this.domAfter=document.createElement("div"),this.domAfter.className="cm-gutters cm-gutters-after",this.domAfter.setAttribute("aria-hidden","true"),this.domAfter.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.domAfter.style.position=this.fixed?"sticky":"",this.view.scrollDOM.appendChild(this.domAfter)),this.domAfter}update(c){if(this.updateGutters(c)){let t=this.prevViewport,i=c.view.viewport,s=Math.min(t.to,i.to)-Math.max(t.from,i.from);this.syncGutters(s<(i.to-i.from)*.8)}if(c.geometryChanged){let t=this.view.contentHeight/this.view.scaleY+"px";this.dom.style.minHeight=t,this.domAfter&&(this.domAfter.style.minHeight=t)}this.view.state.facet(Yo)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":"",this.domAfter&&(this.domAfter.style.position=this.fixed?"sticky":"")),this.prevViewport=c.view.viewport}syncGutters(c){let t=this.dom.nextSibling;c&&(this.dom.remove(),this.domAfter&&this.domAfter.remove());let i=n.RangeSet.iter(this.view.state.facet(zr),this.view.viewport.from),s=[],a=this.gutters.map(u=>new qd(u,this.view.viewport,-this.view.documentPadding.top));for(let u of this.view.viewportLineBlocks)if(s.length&&(s=[]),Array.isArray(u.type)){let p=!0;for(let v of u.type)if(v.type==e.BlockType.Text&&p){Xo(i,s,v.from);for(let k of a)k.line(this.view,v,s);p=!1}else if(v.widget)for(let k of a)k.widget(this.view,v)}else if(u.type==e.BlockType.Text){Xo(i,s,u.from);for(let p of a)p.line(this.view,u,s)}else if(u.widget)for(let p of a)p.widget(this.view,u);for(let u of a)u.finish();c&&(this.view.scrollDOM.insertBefore(this.dom,t),this.domAfter&&this.view.scrollDOM.appendChild(this.domAfter))}updateGutters(c){let t=c.startState.facet(Gr),i=c.state.facet(Gr),s=c.docChanged||c.heightChanged||c.viewportChanged||!n.RangeSet.eq(c.startState.facet(zr),c.state.facet(zr),c.view.viewport.from,c.view.viewport.to);if(t==i)for(let a of this.gutters)a.update(c)&&(s=!0);else{s=!0;let a=[];for(let u of i){let p=t.indexOf(u);p<0?a.push(new Za(this.view,u)):(this.gutters[p].update(c),a.push(this.gutters[p]))}for(let u of this.gutters)u.dom.remove(),a.indexOf(u)<0&&u.destroy();for(let u of a)u.config.side=="after"?this.getDOMAfter().appendChild(u.dom):this.dom.appendChild(u.dom);this.gutters=a}return s}destroy(){for(let c of this.gutters)c.destroy();this.dom.remove(),this.domAfter&&this.domAfter.remove()}},{provide:c=>Gt.scrollMargins.of(t=>{let i=t.plugin(c);if(!i||i.gutters.length==0||!i.fixed)return null;let s=i.dom.offsetWidth*t.scaleX,a=i.domAfter?i.domAfter.offsetWidth*t.scaleX:0;return t.textDirection==e.Direction.LTR?{left:s,right:a}:{right:s,left:a}})});function Ka(c){return Array.isArray(c)?c:[c]}function Xo(c,t,i){for(;c.value&&c.from<=i;)c.from==i&&t.push(c.value),c.next()}class qd{constructor(t,i,s){this.gutter=t,this.height=s,this.i=0,this.cursor=n.RangeSet.iter(t.markers,i.from)}addElement(t,i,s){let{gutter:a}=this,u=(i.top-this.height)/t.scaleY,p=i.height/t.scaleY;if(this.i==a.elements.length){let v=new ec(t,p,u,s);a.elements.push(v),a.dom.appendChild(v.dom)}else a.elements[this.i].update(t,p,u,s);this.height=i.bottom,this.i++}line(t,i,s){let a=[];Xo(this.cursor,a,i.from),s.length&&(a=a.concat(s));let u=this.gutter.config.lineMarker(t,i,a);u&&a.unshift(u);let p=this.gutter;a.length==0&&!p.config.renderEmptyElements||this.addElement(t,i,a)}widget(t,i){let s=this.gutter.config.widgetMarker(t,i.widget,i),a=s?[s]:null;for(let u of t.state.facet(Qa)){let p=u(t,i.widget,i);p&&(a||(a=[])).push(p)}a&&this.addElement(t,i,a)}finish(){let t=this.gutter;for(;t.elements.length>this.i;){let i=t.elements.pop();t.dom.removeChild(i.dom),i.destroy()}}}class Za{constructor(t,i){this.view=t,this.config=i,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let s in i.domEventHandlers)this.dom.addEventListener(s,a=>{let u=a.target,p;if(u!=this.dom&&this.dom.contains(u)){for(;u.parentNode!=this.dom;)u=u.parentNode;let k=u.getBoundingClientRect();p=(k.top+k.bottom)/2}else p=a.clientY;let v=t.lineBlockAtHeight(p-t.documentTop);i.domEventHandlers[s](t,v,a)&&a.preventDefault()});this.markers=Ka(i.markers(t)),i.initialSpacer&&(this.spacer=new ec(t,0,0,[i.initialSpacer(t)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(t){let i=this.markers;if(this.markers=Ka(this.config.markers(t.view)),this.spacer&&this.config.updateSpacer){let a=this.config.updateSpacer(this.spacer.markers[0],t);a!=this.spacer.markers[0]&&this.spacer.update(t.view,0,0,[a])}let s=t.view.viewport;return!n.RangeSet.eq(this.markers,i,s.from,s.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(t):!1)}destroy(){for(let t of this.elements)t.destroy()}}class ec{constructor(t,i,s,a){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(t,i,s,a)}update(t,i,s,a){this.height!=i&&(this.height=i,this.dom.style.height=i+"px"),this.above!=s&&(this.dom.style.marginTop=(this.above=s)?s+"px":""),zd(this.markers,a)||this.setMarkers(t,a)}setMarkers(t,i){let s="cm-gutterElement",a=this.dom.firstChild;for(let u=0,p=0;;){let v=p,k=u<i.length?i[u++]:null,F=!1;if(k){let I=k.elementClass;I&&(s+=" "+I);for(let Y=p;Y<this.markers.length;Y++)if(this.markers[Y].compare(k)){v=Y,F=!0;break}}else v=this.markers.length;for(;p<v;){let I=this.markers[p++];if(I.toDOM){I.destroy(a);let Y=a.nextSibling;a.remove(),a=Y}}if(!k)break;k.toDOM&&(F?a=a.nextSibling:this.dom.insertBefore(k.toDOM(t),a)),F&&p++}this.dom.className=s,this.markers=i}destroy(){this.setMarkers(null,[])}}function zd(c,t){if(c.length!=t.length)return!1;for(let i=0;i<c.length;i++)if(!c[i].compare(t[i]))return!1;return!0}const tc=n.Facet.define(),nc=n.Facet.define(),ar=n.Facet.define({combine(c){return n.combineConfig(c,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(t,i){let s=Object.assign({},t);for(let a in i){let u=s[a],p=i[a];s[a]=u?(v,k,F)=>u(v,k,F)||p(v,k,F):p}return s}})}});class Qo extends Di{constructor(t){super(),this.number=t}eq(t){return this.number==t.number}toDOM(){return document.createTextNode(this.number)}}function Ko(c,t){return c.state.facet(ar).formatNumber(t,c.state)}const Gd=Gr.compute([ar],c=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(t){return t.state.facet(tc)},lineMarker(t,i,s){return s.some(a=>a.toDOM)?null:new Qo(Ko(t,t.state.doc.lineAt(i.from).number))},widgetMarker:(t,i,s)=>{for(let a of t.state.facet(nc)){let u=a(t,i,s);if(u)return u}return null},lineMarkerChange:t=>t.startState.facet(ar)!=t.state.facet(ar),initialSpacer(t){return new Qo(Ko(t,ic(t.state.doc.lines)))},updateSpacer(t,i){let s=Ko(i.view,ic(i.view.state.doc.lines));return s==t.number?t:new Qo(s)},domEventHandlers:c.facet(ar).domEventHandlers,side:"before"}));function Yd(c={}){return[ar.of(c),Jo(),Gd]}function ic(c){let t=9;for(;t<c;)t=t*10+9;return t}const Jd=new class extends Di{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},Xd=zr.compute(["selection"],c=>{let t=[],i=-1;for(let s of c.selection.ranges){let a=c.doc.lineAt(s.head).from;a>i&&(i=a,t.push(Jd.range(a)))}return n.RangeSet.of(t)});function Qd(){return Xd}function rc(c){return d.define(t=>({decorations:c.createDeco(t),update(i){this.decorations=c.updateDeco(i,this.decorations)}}),{decorations:t=>t.decorations})}const Kd=ht.mark({class:"cm-highlightTab"}),Zd=ht.mark({class:"cm-highlightSpace"}),ep=rc(new Rs({regexp:/\t| /g,decoration:c=>c[0]=="	"?Kd:Zd,boundary:/\S/}));function tp(){return ep}const np=rc(new Rs({regexp:/\s+$/g,decoration:ht.mark({class:"cm-trailingSpace"})}));function ip(){return np}const rp={HeightMap:Jn,HeightOracle:ga,MeasuredHeights:ya,QueryType:Sn,ChangedRange:mn,computeOrder:m,moveVisually:B,clearHeightChangeFlag:Lo,getHeightChangeFlag:()=>qi};e.BidiSpan=dn,e.BlockInfo=di,e.Decoration=ht,e.EditorView=Gt,e.GutterMarker=Di,e.MatchDecorator=Rs,e.RectangleMarker=or,e.ViewPlugin=d,e.ViewUpdate=Dn,e.WidgetType=kt,e.__test=rp,e.closeHoverTooltips=Fd,e.crosshairCursor=kd,e.drawSelection=Jf,e.dropCursor=td,e.getDialog=jd,e.getDrawSelectionConfig=Xf,e.getPanel=za,e.getTooltip=_d,e.gutter=Hd,e.gutterLineClass=zr,e.gutterWidgetClass=Qa,e.gutters=Jo,e.hasHoverTooltips=Rd,e.highlightActiveLine=dd,e.highlightActiveLineGutter=Qd,e.highlightSpecialChars=od,e.highlightTrailingWhitespace=ip,e.highlightWhitespace=tp,e.hoverTooltip=Ld,e.keymap=Da,e.layer=$o,e.lineNumberMarkers=tc,e.lineNumberWidgetMarker=nc,e.lineNumbers=Yd,e.logException=U,e.panels=Bd,e.placeholder=yd,e.rectangularSelection=Td,e.repositionTooltips=Pd,e.runScopeHandlers=Hf,e.scrollPastEnd=fd,e.showDialog=Vd,e.showPanel=$s,e.showTooltip=zo,e.tooltips=xd}(el)),el}var xt={},rl={},fc;function jl(){return fc||(fc=1,function(e){let r=0;class o{constructor(b,T){this.from=b,this.to=T}}class l{constructor(b={}){this.id=r++,this.perNode=!!b.perNode,this.deserialize=b.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(b){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof b!="function"&&(b=N.match(b)),T=>{let L=b(T);return L===void 0?null:[this,L]}}}l.closedBy=new l({deserialize:oe=>oe.split(" ")}),l.openedBy=new l({deserialize:oe=>oe.split(" ")}),l.group=new l({deserialize:oe=>oe.split(" ")}),l.isolate=new l({deserialize:oe=>{if(oe&&oe!="rtl"&&oe!="ltr"&&oe!="auto")throw new RangeError("Invalid value for isolate: "+oe);return oe||"auto"}}),l.contextHash=new l({perNode:!0}),l.lookAhead=new l({perNode:!0}),l.mounted=new l({perNode:!0});class h{constructor(b,T,L){this.tree=b,this.overlay=T,this.parser=L}static get(b){return b&&b.props&&b.props[l.mounted.id]}}const y=Object.create(null);class N{constructor(b,T,L,O=0){this.name=b,this.props=T,this.id=L,this.flags=O}static define(b){let T=b.props&&b.props.length?Object.create(null):y,L=(b.top?1:0)|(b.skipped?2:0)|(b.error?4:0)|(b.name==null?8:0),O=new N(b.name||"",T,b.id,L);if(b.props){for(let H of b.props)if(Array.isArray(H)||(H=H(O)),H){if(H[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");T[H[0].id]=H[1]}}return O}prop(b){return this.props[b.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(b){if(typeof b=="string"){if(this.name==b)return!0;let T=this.prop(l.group);return T?T.indexOf(b)>-1:!1}return this.id==b}static match(b){let T=Object.create(null);for(let L in b)for(let O of L.split(" "))T[O]=b[L];return L=>{for(let O=L.prop(l.group),H=-1;H<(O?O.length:0);H++){let re=T[H<0?L.name:O[H]];if(re)return re}}}}N.none=new N("",Object.create(null),0,8);class D{constructor(b){this.types=b;for(let T=0;T<b.length;T++)if(b[T].id!=T)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...b){let T=[];for(let L of this.types){let O=null;for(let H of b){let re=H(L);re&&(O||(O=Object.assign({},L.props)),O[re[0].id]=re[1])}T.push(O?new N(L.name,O,L.id,L.flags):L)}return new D(T)}}const R=new WeakMap,W=new WeakMap;e.IterMode=void 0,function(oe){oe[oe.ExcludeBuffers=1]="ExcludeBuffers",oe[oe.IncludeAnonymous=2]="IncludeAnonymous",oe[oe.IgnoreMounts=4]="IgnoreMounts",oe[oe.IgnoreOverlays=8]="IgnoreOverlays"}(e.IterMode||(e.IterMode={}));class z{constructor(b,T,L,O,H){if(this.type=b,this.children=T,this.positions=L,this.length=O,this.props=null,H&&H.length){this.props=Object.create(null);for(let[re,me]of H)this.props[typeof re=="number"?re:re.id]=me}}toString(){let b=h.get(this);if(b&&!b.overlay)return b.tree.toString();let T="";for(let L of this.children){let O=L.toString();O&&(T&&(T+=","),T+=O)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(T.length?"("+T+")":""):T}cursor(b=0){return new rn(this.topNode,b)}cursorAt(b,T=0,L=0){let O=R.get(this)||this.topNode,H=new rn(O);return H.moveTo(b,T),R.set(this,H._tree),H}get topNode(){return new xe(this,0,0,null)}resolve(b,T=0){let L=Ne(R.get(this)||this.topNode,b,T,!1);return R.set(this,L),L}resolveInner(b,T=0){let L=Ne(W.get(this)||this.topNode,b,T,!0);return W.set(this,L),L}resolveStack(b,T=0){return ut(this,b,T)}iterate(b){let{enter:T,leave:L,from:O=0,to:H=this.length}=b,re=b.mode||0,me=(re&e.IterMode.IncludeAnonymous)>0;for(let Ee=this.cursor(re|e.IterMode.IncludeAnonymous);;){let Fe=!1;if(Ee.from<=H&&Ee.to>=O&&(!me&&Ee.type.isAnonymous||T(Ee)!==!1)){if(Ee.firstChild())continue;Fe=!0}for(;Fe&&L&&(me||!Ee.type.isAnonymous)&&L(Ee),!Ee.nextSibling();){if(!Ee.parent())return;Fe=!0}}}prop(b){return b.perNode?this.props?this.props[b.id]:void 0:this.type.prop(b)}get propValues(){let b=[];if(this.props)for(let T in this.props)b.push([+T,this.props[T]]);return b}balance(b={}){return this.children.length<=8?this:Vt(N.none,this.children,this.positions,0,this.children.length,0,this.length,(T,L,O)=>new z(this.type,T,L,O,this.propValues),b.makeTree||((T,L,O)=>new z(N.none,T,L,O)))}static build(b){return Qt(b)}}z.empty=new z(N.none,[],[],0);class ne{constructor(b,T){this.buffer=b,this.index=T}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new ne(this.buffer,this.index)}}class te{constructor(b,T,L){this.buffer=b,this.length=T,this.set=L}get type(){return N.none}toString(){let b=[];for(let T=0;T<this.buffer.length;)b.push(this.childString(T)),T=this.buffer[T+3];return b.join(",")}childString(b){let T=this.buffer[b],L=this.buffer[b+3],O=this.set.types[T],H=O.name;if(/\W/.test(H)&&!O.isError&&(H=JSON.stringify(H)),b+=4,L==b)return H;let re=[];for(;b<L;)re.push(this.childString(b)),b=this.buffer[b+3];return H+"("+re.join(",")+")"}findChild(b,T,L,O,H){let{buffer:re}=this,me=-1;for(let Ee=b;Ee!=T&&!(be(H,O,re[Ee+1],re[Ee+2])&&(me=Ee,L>0));Ee=re[Ee+3]);return me}slice(b,T,L){let O=this.buffer,H=new Uint16Array(T-b),re=0;for(let me=b,Ee=0;me<T;){H[Ee++]=O[me++],H[Ee++]=O[me++]-L;let Fe=H[Ee++]=O[me++]-L;H[Ee++]=O[me++]-b,re=Math.max(re,Fe)}return new te(H,re,this.set)}}function be(oe,b,T,L){switch(oe){case-2:return T<b;case-1:return L>=b&&T<b;case 0:return T<b&&L>b;case 1:return T<=b&&L>b;case 2:return L>b;case 4:return!0}}function Ne(oe,b,T,L){for(var O;oe.from==oe.to||(T<1?oe.from>=b:oe.from>b)||(T>-1?oe.to<=b:oe.to<b);){let re=!L&&oe instanceof xe&&oe.index<0?null:oe.parent;if(!re)return oe;oe=re}let H=L?0:e.IterMode.IgnoreOverlays;if(L)for(let re=oe,me=re.parent;me;re=me,me=re.parent)re instanceof xe&&re.index<0&&((O=me.enter(b,T,H))===null||O===void 0?void 0:O.from)!=re.from&&(oe=me);for(;;){let re=oe.enter(b,T,H);if(!re)return oe;oe=re}}class Se{cursor(b=0){return new rn(this,b)}getChild(b,T=null,L=null){let O=Qe(this,b,T,L);return O.length?O[0]:null}getChildren(b,T=null,L=null){return Qe(this,b,T,L)}resolve(b,T=0){return Ne(this,b,T,!1)}resolveInner(b,T=0){return Ne(this,b,T,!0)}matchContext(b){return Ge(this.parent,b)}enterUnfinishedNodesBefore(b){let T=this.childBefore(b),L=this;for(;T;){let O=T.lastChild;if(!O||O.to!=T.to)break;O.type.isError&&O.from==O.to?(L=T,T=O.prevSibling):T=O}return L}get node(){return this}get next(){return this.parent}}class xe extends Se{constructor(b,T,L,O){super(),this._tree=b,this.from=T,this.index=L,this._parent=O}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(b,T,L,O,H=0){for(let re=this;;){for(let{children:me,positions:Ee}=re._tree,Fe=T>0?me.length:-1;b!=Fe;b+=T){let Be=me[b],Ue=Ee[b]+re.from;if(be(O,L,Ue,Ue+Be.length)){if(Be instanceof te){if(H&e.IterMode.ExcludeBuffers)continue;let He=Be.findChild(0,Be.buffer.length,T,L-Ue,O);if(He>-1)return new ot(new We(re,Be,b,Ue),null,He)}else if(H&e.IterMode.IncludeAnonymous||!Be.type.isAnonymous||Xt(Be)){let He;if(!(H&e.IterMode.IgnoreMounts)&&(He=h.get(Be))&&!He.overlay)return new xe(He.tree,Ue,b,re);let Ze=new xe(Be,Ue,b,re);return H&e.IterMode.IncludeAnonymous||!Ze.type.isAnonymous?Ze:Ze.nextChild(T<0?Be.children.length-1:0,T,L,O)}}}if(H&e.IterMode.IncludeAnonymous||!re.type.isAnonymous||(re.index>=0?b=re.index+T:b=T<0?-1:re._parent._tree.children.length,re=re._parent,!re))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(b){return this.nextChild(0,1,b,2)}childBefore(b){return this.nextChild(this._tree.children.length-1,-1,b,-2)}enter(b,T,L=0){let O;if(!(L&e.IterMode.IgnoreOverlays)&&(O=h.get(this._tree))&&O.overlay){let H=b-this.from;for(let{from:re,to:me}of O.overlay)if((T>0?re<=H:re<H)&&(T<0?me>=H:me>H))return new xe(O.tree,O.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,b,T,L)}nextSignificantParent(){let b=this;for(;b.type.isAnonymous&&b._parent;)b=b._parent;return b}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Qe(oe,b,T,L){let O=oe.cursor(),H=[];if(!O.firstChild())return H;if(T!=null){for(let re=!1;!re;)if(re=O.type.is(T),!O.nextSibling())return H}for(;;){if(L!=null&&O.type.is(L))return H;if(O.type.is(b)&&H.push(O.node),!O.nextSibling())return L==null?H:[]}}function Ge(oe,b,T=b.length-1){for(let L=oe;T>=0;L=L.parent){if(!L)return!1;if(!L.type.isAnonymous){if(b[T]&&b[T]!=L.name)return!1;T--}}return!0}class We{constructor(b,T,L,O){this.parent=b,this.buffer=T,this.index=L,this.start=O}}class ot extends Se{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(b,T,L){super(),this.context=b,this._parent=T,this.index=L,this.type=b.buffer.set.types[b.buffer.buffer[L]]}child(b,T,L){let{buffer:O}=this.context,H=O.findChild(this.index+4,O.buffer[this.index+3],b,T-this.context.start,L);return H<0?null:new ot(this.context,this,H)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(b){return this.child(1,b,2)}childBefore(b){return this.child(-1,b,-2)}enter(b,T,L=0){if(L&e.IterMode.ExcludeBuffers)return null;let{buffer:O}=this.context,H=O.findChild(this.index+4,O.buffer[this.index+3],T>0?1:-1,b-this.context.start,T);return H<0?null:new ot(this.context,this,H)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(b){return this._parent?null:this.context.parent.nextChild(this.context.index+b,b,0,4)}get nextSibling(){let{buffer:b}=this.context,T=b.buffer[this.index+3];return T<(this._parent?b.buffer[this._parent.index+3]:b.buffer.length)?new ot(this.context,this._parent,T):this.externalSibling(1)}get prevSibling(){let{buffer:b}=this.context,T=this._parent?this._parent.index+4:0;return this.index==T?this.externalSibling(-1):new ot(this.context,this._parent,b.findChild(T,this.index,-1,0,4))}get tree(){return null}toTree(){let b=[],T=[],{buffer:L}=this.context,O=this.index+4,H=L.buffer[this.index+3];if(H>O){let re=L.buffer[this.index+1];b.push(L.slice(O,H,re)),T.push(0)}return new z(this.type,b,T,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function ft(oe){if(!oe.length)return null;let b=0,T=oe[0];for(let H=1;H<oe.length;H++){let re=oe[H];(re.from>T.from||re.to<T.to)&&(T=re,b=H)}let L=T instanceof xe&&T.index<0?null:T.parent,O=oe.slice();return L?O[b]=L:O.splice(b,1),new Et(O,T)}class Et{constructor(b,T){this.heads=b,this.node=T}get next(){return ft(this.heads)}}function ut(oe,b,T){let L=oe.resolveInner(b,T),O=null;for(let H=L instanceof xe?L:L.context.parent;H;H=H.parent)if(H.index<0){let re=H.parent;(O||(O=[L])).push(re.resolve(b,T)),H=re}else{let re=h.get(H.tree);if(re&&re.overlay&&re.overlay[0].from<=b&&re.overlay[re.overlay.length-1].to>=b){let me=new xe(re.tree,re.overlay[0].from+H.from,-1,H);(O||(O=[L])).push(Ne(me,b,T,!1))}}return O?ft(O):L}class rn{get name(){return this.type.name}constructor(b,T=0){if(this.mode=T,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,b instanceof xe)this.yieldNode(b);else{this._tree=b.context.parent,this.buffer=b.context;for(let L=b._parent;L;L=L._parent)this.stack.unshift(L.index);this.bufferNode=b,this.yieldBuf(b.index)}}yieldNode(b){return b?(this._tree=b,this.type=b.type,this.from=b.from,this.to=b.to,!0):!1}yieldBuf(b,T){this.index=b;let{start:L,buffer:O}=this.buffer;return this.type=T||O.set.types[O.buffer[b]],this.from=L+O.buffer[b+1],this.to=L+O.buffer[b+2],!0}yield(b){return b?b instanceof xe?(this.buffer=null,this.yieldNode(b)):(this.buffer=b.context,this.yieldBuf(b.index,b.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(b,T,L){if(!this.buffer)return this.yield(this._tree.nextChild(b<0?this._tree._tree.children.length-1:0,b,T,L,this.mode));let{buffer:O}=this.buffer,H=O.findChild(this.index+4,O.buffer[this.index+3],b,T-this.buffer.start,L);return H<0?!1:(this.stack.push(this.index),this.yieldBuf(H))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(b){return this.enterChild(1,b,2)}childBefore(b){return this.enterChild(-1,b,-2)}enter(b,T,L=this.mode){return this.buffer?L&e.IterMode.ExcludeBuffers?!1:this.enterChild(1,b,T):this.yield(this._tree.enter(b,T,L))}parent(){if(!this.buffer)return this.yieldNode(this.mode&e.IterMode.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let b=this.mode&e.IterMode.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(b)}sibling(b){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+b,b,0,4,this.mode)):!1;let{buffer:T}=this.buffer,L=this.stack.length-1;if(b<0){let O=L<0?0:this.stack[L]+4;if(this.index!=O)return this.yieldBuf(T.findChild(O,this.index,-1,0,4))}else{let O=T.buffer[this.index+3];if(O<(L<0?T.buffer.length:T.buffer[this.stack[L]+3]))return this.yieldBuf(O)}return L<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+b,b,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(b){let T,L,{buffer:O}=this;if(O){if(b>0){if(this.index<O.buffer.buffer.length)return!1}else for(let H=0;H<this.index;H++)if(O.buffer.buffer[H+3]<this.index)return!1;({index:T,parent:L}=O)}else({index:T,_parent:L}=this._tree);for(;L;{index:T,_parent:L}=L)if(T>-1)for(let H=T+b,re=b<0?-1:L._tree.children.length;H!=re;H+=b){let me=L._tree.children[H];if(this.mode&e.IterMode.IncludeAnonymous||me instanceof te||!me.type.isAnonymous||Xt(me))return!1}return!0}move(b,T){if(T&&this.enterChild(b,0,4))return!0;for(;;){if(this.sibling(b))return!0;if(this.atLastNode(b)||!this.parent())return!1}}next(b=!0){return this.move(1,b)}prev(b=!0){return this.move(-1,b)}moveTo(b,T=0){for(;(this.from==this.to||(T<1?this.from>=b:this.from>b)||(T>-1?this.to<=b:this.to<b))&&this.parent(););for(;this.enterChild(1,b,T););return this}get node(){if(!this.buffer)return this._tree;let b=this.bufferNode,T=null,L=0;if(b&&b.context==this.buffer)e:for(let O=this.index,H=this.stack.length;H>=0;){for(let re=b;re;re=re._parent)if(re.index==O){if(O==this.index)return re;T=re,L=H+1;break e}O=this.stack[--H]}for(let O=L;O<this.stack.length;O++)T=new ot(this.buffer,T,this.stack[O]);return this.bufferNode=new ot(this.buffer,T,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(b,T){for(let L=0;;){let O=!1;if(this.type.isAnonymous||b(this)!==!1){if(this.firstChild()){L++;continue}this.type.isAnonymous||(O=!0)}for(;;){if(O&&T&&T(this),O=this.type.isAnonymous,!L)return;if(this.nextSibling())break;this.parent(),L--,O=!0}}}matchContext(b){if(!this.buffer)return Ge(this.node.parent,b);let{buffer:T}=this.buffer,{types:L}=T.set;for(let O=b.length-1,H=this.stack.length-1;O>=0;H--){if(H<0)return Ge(this._tree,b,O);let re=L[T.buffer[this.stack[H]]];if(!re.isAnonymous){if(b[O]&&b[O]!=re.name)return!1;O--}}return!0}}function Xt(oe){return oe.children.some(b=>b instanceof te||!b.type.isAnonymous||Xt(b))}function Qt(oe){var b;let{buffer:T,nodeSet:L,maxBufferLength:O=1024,reused:H=[],minRepeatType:re=L.types.length}=oe,me=Array.isArray(T)?new ne(T,T.length):T,Ee=L.types,Fe=0,Be=0;function Ue(At,Lt,J,j,G,se){let{id:le,start:fe,end:Ie,size:_e}=me,Pe=Be,Rt=Fe;for(;_e<0;)if(me.next(),_e==-1){let $t=H[le];J.push($t),j.push(fe-At);return}else if(_e==-3){Fe=le;return}else if(_e==-4){Be=le;return}else throw new RangeError(`Unrecognized record size: ${_e}`);let Ut=Ee[le],cn,yn,un=fe-At;if(Ie-fe<=O&&(yn=gt(me.pos-Lt,G))){let $t=new Uint16Array(yn.size-yn.skip),Ht=me.pos-yn.size,pn=$t.length;for(;me.pos>Ht;)pn=kt(yn.start,$t,pn);cn=new te($t,Ie-yn.start,L),un=yn.start-At}else{let $t=me.pos-_e;me.next();let Ht=[],pn=[],dn=le>=re?le:-1,On=0,Ot=Ie;for(;me.pos>$t;)dn>=0&&me.id==dn&&me.size>=0?(me.end<=Ot-O&&(lt(Ht,pn,fe,On,me.end,Ot,dn,Pe,Rt),On=Ht.length,Ot=me.end),me.next()):se>2500?He(fe,$t,Ht,pn):Ue(fe,$t,Ht,pn,dn,se+1);if(dn>=0&&On>0&&On<Ht.length&&lt(Ht,pn,fe,On,fe,Ot,dn,Pe,Rt),Ht.reverse(),pn.reverse(),dn>-1&&On>0){let Xn=Ze(Ut,Rt);cn=Vt(Ut,Ht,pn,0,Ht.length,0,Ie-fe,Xn,Xn)}else cn=qt(Ut,Ht,pn,Ie-fe,Pe-Ie,Rt)}J.push(cn),j.push(un)}function He(At,Lt,J,j){let G=[],se=0,le=-1;for(;me.pos>Lt;){let{id:fe,start:Ie,end:_e,size:Pe}=me;if(Pe>4)me.next();else{if(le>-1&&Ie<le)break;le<0&&(le=_e-O),G.push(fe,Ie,_e),se++,me.next()}}if(se){let fe=new Uint16Array(se*4),Ie=G[G.length-2];for(let _e=G.length-3,Pe=0;_e>=0;_e-=3)fe[Pe++]=G[_e],fe[Pe++]=G[_e+1]-Ie,fe[Pe++]=G[_e+2]-Ie,fe[Pe++]=Pe;J.push(new te(fe,G[2]-Ie,L)),j.push(Ie-At)}}function Ze(At,Lt){return(J,j,G)=>{let se=0,le=J.length-1,fe,Ie;if(le>=0&&(fe=J[le])instanceof z){if(!le&&fe.type==At&&fe.length==G)return fe;(Ie=fe.prop(l.lookAhead))&&(se=j[le]+fe.length+Ie)}return qt(At,J,j,G,se,Lt)}}function lt(At,Lt,J,j,G,se,le,fe,Ie){let _e=[],Pe=[];for(;At.length>j;)_e.push(At.pop()),Pe.push(Lt.pop()+J-G);At.push(qt(L.types[le],_e,Pe,se-G,fe-se,Ie)),Lt.push(G-J)}function qt(At,Lt,J,j,G,se,le){if(se){let fe=[l.contextHash,se];le=le?[fe].concat(le):[fe]}if(G>25){let fe=[l.lookAhead,G];le=le?[fe].concat(le):[fe]}return new z(At,Lt,J,j,le)}function gt(At,Lt){let J=me.fork(),j=0,G=0,se=0,le=J.end-O,fe={size:0,start:0,skip:0};e:for(let Ie=J.pos-At;J.pos>Ie;){let _e=J.size;if(J.id==Lt&&_e>=0){fe.size=j,fe.start=G,fe.skip=se,se+=4,j+=4,J.next();continue}let Pe=J.pos-_e;if(_e<0||Pe<Ie||J.start<le)break;let Rt=J.id>=re?4:0,Ut=J.start;for(J.next();J.pos>Pe;){if(J.size<0)if(J.size==-3)Rt+=4;else break e;else J.id>=re&&(Rt+=4);J.next()}G=Ut,j+=_e,se+=Rt}return(Lt<0||j==At)&&(fe.size=j,fe.start=G,fe.skip=se),fe.size>4?fe:void 0}function kt(At,Lt,J){let{id:j,start:G,end:se,size:le}=me;if(me.next(),le>=0&&j<re){let fe=J;if(le>4){let Ie=me.pos-(le-4);for(;me.pos>Ie;)J=kt(At,Lt,J)}Lt[--J]=fe,Lt[--J]=se-At,Lt[--J]=G-At,Lt[--J]=j}else le==-3?Fe=j:le==-4&&(Be=j);return J}let ht=[],Ft=[];for(;me.pos>0;)Ue(oe.start||0,oe.bufferStart||0,ht,Ft,-1,0);let en=(b=oe.length)!==null&&b!==void 0?b:ht.length?Ft[0]+ht[0].length:0;return new z(Ee[oe.topID],ht.reverse(),Ft.reverse(),en)}const Kt=new WeakMap;function pt(oe,b){if(!oe.isAnonymous||b instanceof te||b.type!=oe)return 1;let T=Kt.get(b);if(T==null){T=1;for(let L of b.children){if(L.type!=oe||!(L instanceof z)){T=1;break}T+=pt(oe,L)}Kt.set(b,T)}return T}function Vt(oe,b,T,L,O,H,re,me,Ee){let Fe=0;for(let lt=L;lt<O;lt++)Fe+=pt(oe,b[lt]);let Be=Math.ceil(Fe*1.5/8),Ue=[],He=[];function Ze(lt,qt,gt,kt,ht){for(let Ft=gt;Ft<kt;){let en=Ft,At=qt[Ft],Lt=pt(oe,lt[Ft]);for(Ft++;Ft<kt;Ft++){let J=pt(oe,lt[Ft]);if(Lt+J>=Be)break;Lt+=J}if(Ft==en+1){if(Lt>Be){let J=lt[en];Ze(J.children,J.positions,0,J.children.length,qt[en]+ht);continue}Ue.push(lt[en])}else{let J=qt[Ft-1]+lt[Ft-1].length-At;Ue.push(Vt(oe,lt,qt,en,Ft,At,J,null,Ee))}He.push(At+ht-H)}}return Ze(b,T,L,O,0),(me||Ee)(Ue,He,re)}class qe{constructor(){this.map=new WeakMap}setBuffer(b,T,L){let O=this.map.get(b);O||this.map.set(b,O=new Map),O.set(T,L)}getBuffer(b,T){let L=this.map.get(b);return L&&L.get(T)}set(b,T){b instanceof ot?this.setBuffer(b.context.buffer,b.index,T):b instanceof xe&&this.map.set(b.tree,T)}get(b){return b instanceof ot?this.getBuffer(b.context.buffer,b.index):b instanceof xe?this.map.get(b.tree):void 0}cursorSet(b,T){b.buffer?this.setBuffer(b.buffer.buffer,b.index,T):this.map.set(b.tree,T)}cursorGet(b){return b.buffer?this.getBuffer(b.buffer.buffer,b.index):this.map.get(b.tree)}}class Mt{constructor(b,T,L,O,H=!1,re=!1){this.from=b,this.to=T,this.tree=L,this.offset=O,this.open=(H?1:0)|(re?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(b,T=[],L=!1){let O=[new Mt(0,b.length,b,0,!1,L)];for(let H of T)H.to>b.length&&O.push(H);return O}static applyChanges(b,T,L=128){if(!T.length)return b;let O=[],H=1,re=b.length?b[0]:null;for(let me=0,Ee=0,Fe=0;;me++){let Be=me<T.length?T[me]:null,Ue=Be?Be.fromA:1e9;if(Ue-Ee>=L)for(;re&&re.from<Ue;){let He=re;if(Ee>=He.from||Ue<=He.to||Fe){let Ze=Math.max(He.from,Ee)-Fe,lt=Math.min(He.to,Ue)-Fe;He=Ze>=lt?null:new Mt(Ze,lt,He.tree,He.offset+Fe,me>0,!!Be)}if(He&&O.push(He),re.to>Ue)break;re=H<b.length?b[H++]:null}if(!Be)break;Ee=Be.toA,Fe=Be.toA-Be.toB}return O}}class Je{startParse(b,T,L){return typeof b=="string"&&(b=new we(b)),L=L?L.length?L.map(O=>new o(O.from,O.to)):[new o(0,0)]:[new o(0,b.length)],this.createParse(b,T||[],L)}parse(b,T,L){let O=this.startParse(b,T,L);for(;;){let H=O.advance();if(H)return H}}}class we{constructor(b){this.string=b}get length(){return this.string.length}chunk(b){return this.string.slice(b)}get lineChunks(){return!1}read(b,T){return this.string.slice(b,T)}}function ze(oe){return(b,T,L,O)=>new Nt(b,oe,T,L,O)}class rt{constructor(b,T,L,O,H){this.parser=b,this.parse=T,this.overlay=L,this.target=O,this.from=H}}function tt(oe){if(!oe.length||oe.some(b=>b.from>=b.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(oe))}class Ye{constructor(b,T,L,O,H,re,me){this.parser=b,this.predicate=T,this.mounts=L,this.index=O,this.start=H,this.target=re,this.prev=me,this.depth=0,this.ranges=[]}}const st=new l({perNode:!0});class Nt{constructor(b,T,L,O,H){this.nest=T,this.input=L,this.fragments=O,this.ranges=H,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=b}advance(){if(this.baseParse){let L=this.baseParse.advance();if(!L)return null;if(this.baseParse=null,this.baseTree=L,this.startInner(),this.stoppedAt!=null)for(let O of this.inner)O.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let L=this.baseTree;return this.stoppedAt!=null&&(L=new z(L.type,L.children,L.positions,L.length,L.propValues.concat([[st,this.stoppedAt]]))),L}let b=this.inner[this.innerDone],T=b.parse.advance();if(T){this.innerDone++;let L=Object.assign(Object.create(null),b.target.props);L[l.mounted.id]=new h(T,b.overlay,b.parser),b.target.props=L}return null}get parsedPos(){if(this.baseParse)return 0;let b=this.input.length;for(let T=this.innerDone;T<this.inner.length;T++)this.inner[T].from<b&&(b=Math.min(b,this.inner[T].parse.parsedPos));return b}stopAt(b){if(this.stoppedAt=b,this.baseParse)this.baseParse.stopAt(b);else for(let T=this.innerDone;T<this.inner.length;T++)this.inner[T].parse.stopAt(b)}startInner(){let b=new Pt(this.fragments),T=null,L=null,O=new rn(new xe(this.baseTree,this.ranges[0].from,0,null),e.IterMode.IncludeAnonymous|e.IterMode.IgnoreMounts);e:for(let H,re;;){let me=!0,Ee;if(this.stoppedAt!=null&&O.from>=this.stoppedAt)me=!1;else if(b.hasNode(O)){if(T){let Fe=T.mounts.find(Be=>Be.frag.from<=O.from&&Be.frag.to>=O.to&&Be.mount.overlay);if(Fe)for(let Be of Fe.mount.overlay){let Ue=Be.from+Fe.pos,He=Be.to+Fe.pos;Ue>=O.from&&He<=O.to&&!T.ranges.some(Ze=>Ze.from<He&&Ze.to>Ue)&&T.ranges.push({from:Ue,to:He})}}me=!1}else if(L&&(re=jt(L.ranges,O.from,O.to)))me=re!=2;else if(!O.type.isAnonymous&&(H=this.nest(O,this.input))&&(O.from<O.to||!H.overlay)){O.tree||yt(O);let Fe=b.findMounts(O.from,H.parser);if(typeof H.overlay=="function")T=new Ye(H.parser,H.overlay,Fe,this.inner.length,O.from,O.tree,T);else{let Be=It(this.ranges,H.overlay||(O.from<O.to?[new o(O.from,O.to)]:[]));Be.length&&tt(Be),(Be.length||!H.overlay)&&this.inner.push(new rt(H.parser,Be.length?H.parser.startParse(this.input,sn(Fe,Be),Be):H.parser.startParse(""),H.overlay?H.overlay.map(Ue=>new o(Ue.from-O.from,Ue.to-O.from)):null,O.tree,Be.length?Be[0].from:O.from)),H.overlay?Be.length&&(L={ranges:Be,depth:0,prev:L}):me=!1}}else if(T&&(Ee=T.predicate(O))&&(Ee===!0&&(Ee=new o(O.from,O.to)),Ee.from<Ee.to)){let Fe=T.ranges.length-1;Fe>=0&&T.ranges[Fe].to==Ee.from?T.ranges[Fe]={from:T.ranges[Fe].from,to:Ee.to}:T.ranges.push(Ee)}if(me&&O.firstChild())T&&T.depth++,L&&L.depth++;else for(;!O.nextSibling();){if(!O.parent())break e;if(T&&!--T.depth){let Fe=It(this.ranges,T.ranges);Fe.length&&(tt(Fe),this.inner.splice(T.index,0,new rt(T.parser,T.parser.startParse(this.input,sn(T.mounts,Fe),Fe),T.ranges.map(Be=>new o(Be.from-T.start,Be.to-T.start)),T.target,Fe[0].from))),T=T.prev}L&&!--L.depth&&(L=L.prev)}}}}function jt(oe,b,T){for(let L of oe){if(L.from>=T)break;if(L.to>b)return L.from<=b&&L.to>=T?2:1}return 0}function Ct(oe,b,T,L,O,H){if(b<T){let re=oe.buffer[b+1];L.push(oe.slice(b,T,re)),O.push(re-H)}}function yt(oe){let{node:b}=oe,T=[],L=b.context.buffer;do T.push(oe.index),oe.parent();while(!oe.tree);let O=oe.tree,H=O.children.indexOf(L),re=O.children[H],me=re.buffer,Ee=[H];function Fe(Be,Ue,He,Ze,lt,qt){let gt=T[qt],kt=[],ht=[];Ct(re,Be,gt,kt,ht,Ze);let Ft=me[gt+1],en=me[gt+2];Ee.push(kt.length);let At=qt?Fe(gt+4,me[gt+3],re.set.types[me[gt]],Ft,en-Ft,qt-1):b.toTree();return kt.push(At),ht.push(Ft-Ze),Ct(re,me[gt+3],Ue,kt,ht,Ze),new z(He,kt,ht,lt)}O.children[H]=Fe(0,me.length,N.none,0,re.length,T.length-1);for(let Be of Ee){let Ue=oe.tree.children[Be],He=oe.tree.positions[Be];oe.yield(new xe(Ue,He+oe.from,Be,oe._tree))}}class wt{constructor(b,T){this.offset=T,this.done=!1,this.cursor=b.cursor(e.IterMode.IncludeAnonymous|e.IterMode.IgnoreMounts)}moveTo(b){let{cursor:T}=this,L=b-this.offset;for(;!this.done&&T.from<L;)T.to>=b&&T.enter(L,1,e.IterMode.IgnoreOverlays|e.IterMode.ExcludeBuffers)||T.next(!1)||(this.done=!0)}hasNode(b){if(this.moveTo(b.from),!this.done&&this.cursor.from+this.offset==b.from&&this.cursor.tree)for(let T=this.cursor.tree;;){if(T==b.tree)return!0;if(T.children.length&&T.positions[0]==0&&T.children[0]instanceof z)T=T.children[0];else break}return!1}}class Pt{constructor(b){var T;if(this.fragments=b,this.curTo=0,this.fragI=0,b.length){let L=this.curFrag=b[0];this.curTo=(T=L.tree.prop(st))!==null&&T!==void 0?T:L.to,this.inner=new wt(L.tree,-L.offset)}else this.curFrag=this.inner=null}hasNode(b){for(;this.curFrag&&b.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=b.from&&this.curTo>=b.to&&this.inner.hasNode(b)}nextFrag(){var b;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let T=this.curFrag=this.fragments[this.fragI];this.curTo=(b=T.tree.prop(st))!==null&&b!==void 0?b:T.to,this.inner=new wt(T.tree,-T.offset)}}findMounts(b,T){var L;let O=[];if(this.inner){this.inner.cursor.moveTo(b,1);for(let H=this.inner.cursor.node;H;H=H.parent){let re=(L=H.tree)===null||L===void 0?void 0:L.prop(l.mounted);if(re&&re.parser==T)for(let me=this.fragI;me<this.fragments.length;me++){let Ee=this.fragments[me];if(Ee.from>=H.to)break;Ee.tree==this.curFrag.tree&&O.push({frag:Ee,pos:H.from-Ee.offset,mount:re})}}}return O}}function It(oe,b){let T=null,L=b;for(let O=1,H=0;O<oe.length;O++){let re=oe[O-1].to,me=oe[O].from;for(;H<L.length;H++){let Ee=L[H];if(Ee.from>=me)break;Ee.to<=re||(T||(L=T=b.slice()),Ee.from<re?(T[H]=new o(Ee.from,re),Ee.to>me&&T.splice(H+1,0,new o(me,Ee.to))):Ee.to>me?T[H--]=new o(me,Ee.to):T.splice(H--,1))}}return L}function gn(oe,b,T,L){let O=0,H=0,re=!1,me=!1,Ee=-1e9,Fe=[];for(;;){let Be=O==oe.length?1e9:re?oe[O].to:oe[O].from,Ue=H==b.length?1e9:me?b[H].to:b[H].from;if(re!=me){let He=Math.max(Ee,T),Ze=Math.min(Be,Ue,L);He<Ze&&Fe.push(new o(He,Ze))}if(Ee=Math.min(Be,Ue),Ee==1e9)break;Be==Ee&&(re?(re=!1,O++):re=!0),Ue==Ee&&(me?(me=!1,H++):me=!0)}return Fe}function sn(oe,b){let T=[];for(let{pos:L,mount:O,frag:H}of oe){let re=L+(O.overlay?O.overlay[0].from:0),me=re+O.tree.length,Ee=Math.max(H.from,re),Fe=Math.min(H.to,me);if(O.overlay){let Be=O.overlay.map(He=>new o(He.from+L,He.to+L)),Ue=gn(b,Be,Ee,Fe);for(let He=0,Ze=Ee;;He++){let lt=He==Ue.length,qt=lt?Fe:Ue[He].from;if(qt>Ze&&T.push(new Mt(Ze,qt,O.tree,-re,H.from>=Ze||H.openStart,H.to<=qt||H.openEnd)),lt)break;Ze=Ue[He].to}}else T.push(new Mt(Ee,Fe,O.tree,-re,H.from>=re||H.openStart,H.to<=me||H.openEnd))}return T}e.DefaultBufferLength=1024,e.MountedTree=h,e.NodeProp=l,e.NodeSet=D,e.NodeType=N,e.NodeWeakMap=qe,e.Parser=Je,e.Tree=z,e.TreeBuffer=te,e.TreeCursor=rn,e.TreeFragment=Mt,e.parseMixed=ze}(rl)),rl}var pi={},dc;function cp(){if(dc)return pi;dc=1,Object.defineProperty(pi,"__esModule",{value:!0});var e=jl();let n=0;class r{constructor(we,ze,rt,tt){this.name=we,this.set=ze,this.base=rt,this.modified=tt,this.id=n++}toString(){let{name:we}=this;for(let ze of this.modified)ze.name&&(we=`${ze.name}(${we})`);return we}static define(we,ze){let rt=typeof we=="string"?we:"?";if(we instanceof r&&(ze=we),ze?.base)throw new Error("Can not derive from a modified tag");let tt=new r(rt,[],null,[]);if(tt.set.push(tt),ze)for(let Ye of ze.set)tt.set.push(Ye);return tt}static defineModifier(we){let ze=new l(we);return rt=>rt.modified.indexOf(ze)>-1?rt:l.get(rt.base||rt,rt.modified.concat(ze).sort((tt,Ye)=>tt.id-Ye.id))}}let o=0;class l{constructor(we){this.name=we,this.instances=[],this.id=o++}static get(we,ze){if(!ze.length)return we;let rt=ze[0].instances.find(Nt=>Nt.base==we&&h(ze,Nt.modified));if(rt)return rt;let tt=[],Ye=new r(we.name,tt,we,ze);for(let Nt of ze)Nt.instances.push(Ye);let st=y(ze);for(let Nt of we.set)if(!Nt.modified.length)for(let jt of st)tt.push(l.get(Nt,jt));return Ye}}function h(Je,we){return Je.length==we.length&&Je.every((ze,rt)=>ze==we[rt])}function y(Je){let we=[[]];for(let ze=0;ze<Je.length;ze++)for(let rt=0,tt=we.length;rt<tt;rt++)we.push(we[rt].concat(Je[ze]));return we.sort((ze,rt)=>rt.length-ze.length)}function N(Je){let we=Object.create(null);for(let ze in Je){let rt=Je[ze];Array.isArray(rt)||(rt=[rt]);for(let tt of ze.split(" "))if(tt){let Ye=[],st=2,Nt=tt;for(let wt=0;;){if(Nt=="..."&&wt>0&&wt+3==tt.length){st=1;break}let Pt=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(Nt);if(!Pt)throw new RangeError("Invalid path: "+tt);if(Ye.push(Pt[0]=="*"?"":Pt[0][0]=='"'?JSON.parse(Pt[0]):Pt[0]),wt+=Pt[0].length,wt==tt.length)break;let It=tt[wt++];if(wt==tt.length&&It=="!"){st=0;break}if(It!="/")throw new RangeError("Invalid path: "+tt);Nt=tt.slice(wt)}let jt=Ye.length-1,Ct=Ye[jt];if(!Ct)throw new RangeError("Invalid path: "+tt);let yt=new R(rt,st,jt>0?Ye.slice(0,jt):null);we[Ct]=yt.sort(we[Ct])}}return D.add(we)}const D=new e.NodeProp;class R{constructor(we,ze,rt,tt){this.tags=we,this.mode=ze,this.context=rt,this.next=tt}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(we){return!we||we.depth<this.depth?(this.next=we,this):(we.next=this.sort(we.next),we)}get depth(){return this.context?this.context.length:0}}R.empty=new R([],2,null);function W(Je,we){let ze=Object.create(null);for(let Ye of Je)if(!Array.isArray(Ye.tag))ze[Ye.tag.id]=Ye.class;else for(let st of Ye.tag)ze[st.id]=Ye.class;let{scope:rt,all:tt=null}=we||{};return{style:Ye=>{let st=tt;for(let Nt of Ye)for(let jt of Nt.set){let Ct=ze[jt.id];if(Ct){st=st?st+" "+Ct:Ct;break}}return st},scope:rt}}function z(Je,we){let ze=null;for(let rt of Je){let tt=rt.style(we);tt&&(ze=ze?ze+" "+tt:tt)}return ze}function ne(Je,we,ze,rt=0,tt=Je.length){let Ye=new be(rt,Array.isArray(we)?we:[we],ze);Ye.highlightRange(Je.cursor(),rt,tt,"",Ye.highlighters),Ye.flush(tt)}function te(Je,we,ze,rt,tt,Ye=0,st=Je.length){let Nt=Ye;function jt(Ct,yt){if(!(Ct<=Nt)){for(let wt=Je.slice(Nt,Ct),Pt=0;;){let It=wt.indexOf(`
`,Pt),gn=It<0?wt.length:It;if(gn>Pt&&rt(wt.slice(Pt,gn),yt),It<0)break;tt(),Pt=It+1}Nt=Ct}}ne(we,ze,(Ct,yt,wt)=>{jt(Ct,""),jt(yt,wt)},Ye,st),jt(st,"")}class be{constructor(we,ze,rt){this.at=we,this.highlighters=ze,this.span=rt,this.class=""}startSpan(we,ze){ze!=this.class&&(this.flush(we),we>this.at&&(this.at=we),this.class=ze)}flush(we){we>this.at&&this.class&&this.span(this.at,we,this.class)}highlightRange(we,ze,rt,tt,Ye){let{type:st,from:Nt,to:jt}=we;if(Nt>=rt||jt<=ze)return;st.isTop&&(Ye=this.highlighters.filter(It=>!It.scope||It.scope(st)));let Ct=tt,yt=Ne(we)||R.empty,wt=z(Ye,yt.tags);if(wt&&(Ct&&(Ct+=" "),Ct+=wt,yt.mode==1&&(tt+=(tt?" ":"")+wt)),this.startSpan(Math.max(ze,Nt),Ct),yt.opaque)return;let Pt=we.tree&&we.tree.prop(e.NodeProp.mounted);if(Pt&&Pt.overlay){let It=we.node.enter(Pt.overlay[0].from+Nt,1),gn=this.highlighters.filter(oe=>!oe.scope||oe.scope(Pt.tree.type)),sn=we.firstChild();for(let oe=0,b=Nt;;oe++){let T=oe<Pt.overlay.length?Pt.overlay[oe]:null,L=T?T.from+Nt:jt,O=Math.max(ze,b),H=Math.min(rt,L);if(O<H&&sn)for(;we.from<H&&(this.highlightRange(we,O,H,tt,Ye),this.startSpan(Math.min(H,we.to),Ct),!(we.to>=L||!we.nextSibling())););if(!T||L>rt)break;b=T.to+Nt,b>ze&&(this.highlightRange(It.cursor(),Math.max(ze,T.from+Nt),Math.min(rt,b),"",gn),this.startSpan(Math.min(rt,b),Ct))}sn&&we.parent()}else if(we.firstChild()){Pt&&(tt="");do if(!(we.to<=ze)){if(we.from>=rt)break;this.highlightRange(we,ze,rt,tt,Ye),this.startSpan(Math.min(rt,we.to),Ct)}while(we.nextSibling());we.parent()}}}function Ne(Je){let we=Je.type.prop(D);for(;we&&we.context&&!Je.matchContext(we.context);)we=we.next;return we||null}const Se=r.define,xe=Se(),Qe=Se(),Ge=Se(Qe),We=Se(Qe),ot=Se(),ft=Se(ot),Et=Se(ot),ut=Se(),rn=Se(ut),Xt=Se(),Qt=Se(),Kt=Se(),pt=Se(Kt),Vt=Se(),qe={comment:xe,lineComment:Se(xe),blockComment:Se(xe),docComment:Se(xe),name:Qe,variableName:Se(Qe),typeName:Ge,tagName:Se(Ge),propertyName:We,attributeName:Se(We),className:Se(Qe),labelName:Se(Qe),namespace:Se(Qe),macroName:Se(Qe),literal:ot,string:ft,docString:Se(ft),character:Se(ft),attributeValue:Se(ft),number:Et,integer:Se(Et),float:Se(Et),bool:Se(ot),regexp:Se(ot),escape:Se(ot),color:Se(ot),url:Se(ot),keyword:Xt,self:Se(Xt),null:Se(Xt),atom:Se(Xt),unit:Se(Xt),modifier:Se(Xt),operatorKeyword:Se(Xt),controlKeyword:Se(Xt),definitionKeyword:Se(Xt),moduleKeyword:Se(Xt),operator:Qt,derefOperator:Se(Qt),arithmeticOperator:Se(Qt),logicOperator:Se(Qt),bitwiseOperator:Se(Qt),compareOperator:Se(Qt),updateOperator:Se(Qt),definitionOperator:Se(Qt),typeOperator:Se(Qt),controlOperator:Se(Qt),punctuation:Kt,separator:Se(Kt),bracket:pt,angleBracket:Se(pt),squareBracket:Se(pt),paren:Se(pt),brace:Se(pt),content:ut,heading:rn,heading1:Se(rn),heading2:Se(rn),heading3:Se(rn),heading4:Se(rn),heading5:Se(rn),heading6:Se(rn),contentSeparator:Se(ut),list:Se(ut),quote:Se(ut),emphasis:Se(ut),strong:Se(ut),link:Se(ut),monospace:Se(ut),strikethrough:Se(ut),inserted:Se(),deleted:Se(),changed:Se(),invalid:Se(),meta:Vt,documentMeta:Se(Vt),annotation:Se(Vt),processingInstruction:Se(Vt),definition:r.defineModifier("definition"),constant:r.defineModifier("constant"),function:r.defineModifier("function"),standard:r.defineModifier("standard"),local:r.defineModifier("local"),special:r.defineModifier("special")};for(let Je in qe){let we=qe[Je];we instanceof r&&(we.name=Je)}const Mt=W([{tag:qe.link,class:"tok-link"},{tag:qe.heading,class:"tok-heading"},{tag:qe.emphasis,class:"tok-emphasis"},{tag:qe.strong,class:"tok-strong"},{tag:qe.keyword,class:"tok-keyword"},{tag:qe.atom,class:"tok-atom"},{tag:qe.bool,class:"tok-bool"},{tag:qe.url,class:"tok-url"},{tag:qe.labelName,class:"tok-labelName"},{tag:qe.inserted,class:"tok-inserted"},{tag:qe.deleted,class:"tok-deleted"},{tag:qe.literal,class:"tok-literal"},{tag:qe.string,class:"tok-string"},{tag:qe.number,class:"tok-number"},{tag:[qe.regexp,qe.escape,qe.special(qe.string)],class:"tok-string2"},{tag:qe.variableName,class:"tok-variableName"},{tag:qe.local(qe.variableName),class:"tok-variableName tok-local"},{tag:qe.definition(qe.variableName),class:"tok-variableName tok-definition"},{tag:qe.special(qe.variableName),class:"tok-variableName2"},{tag:qe.definition(qe.propertyName),class:"tok-propertyName tok-definition"},{tag:qe.typeName,class:"tok-typeName"},{tag:qe.namespace,class:"tok-namespace"},{tag:qe.className,class:"tok-className"},{tag:qe.macroName,class:"tok-macroName"},{tag:qe.propertyName,class:"tok-propertyName"},{tag:qe.operator,class:"tok-operator"},{tag:qe.comment,class:"tok-comment"},{tag:qe.meta,class:"tok-meta"},{tag:qe.invalid,class:"tok-invalid"},{tag:qe.punctuation,class:"tok-punctuation"}]);return pi.Tag=r,pi.classHighlighter=Mt,pi.getStyleTags=Ne,pi.highlightCode=te,pi.highlightTree=ne,pi.styleTags=N,pi.tagHighlighter=W,pi.tags=qe,pi}var pc;function Ul(){if(pc)return xt;pc=1,Object.defineProperty(xt,"__esModule",{value:!0});var e=jl(),n=tr(),r=Nr(),o=cp(),l=Wu(),h;const y=new e.NodeProp;function N(S){return n.Facet.define({combine:S?d=>d.concat(S):void 0})}class D{constructor(d,g,A=[]){this.data=d,n.EditorState.prototype.hasOwnProperty("tree")||Object.defineProperty(n.EditorState.prototype,"tree",{get(){return z(this)}}),this.parser=g,this.extension=[ut.of(this),n.EditorState.languageData.of((P,$,X)=>P.facet(R(P,$,X)))].concat(A)}isActiveAt(d,g,A=-1){return R(d,g,A)==this.data}findRegions(d){let g=d.facet(ut);if(g?.data==this.data)return[{from:0,to:d.doc.length}];if(!g||!g.allowsNesting)return[];let A=[],P=($,X)=>{if($.prop(y)==this.data){A.push({from:X,to:X+$.length});return}let he=$.prop(e.NodeProp.mounted);if(he){if(he.tree.prop(y)==this.data){if(he.overlay)for(let ge of he.overlay)A.push({from:ge.from+X,to:ge.to+X});else A.push({from:X,to:X+$.length});return}else if(he.overlay){let ge=A.length;if(P(he.tree,he.overlay[0].from+X),A.length>ge)return}}for(let ge=0;ge<$.children.length;ge++){let Re=$.children[ge];Re instanceof e.Tree&&P(Re,$.positions[ge]+X)}};return P(z(d),0),A}get allowsNesting(){return!0}}D.setState=n.StateEffect.define();function R(S,d,g){let A=S.facet(ut);if(!A)return null;let P=A.data;if(A.allowsNesting)for(let $=z(S).topNode;$;$=$.enter(d,g,e.IterMode.ExcludeBuffers))P=$.type.prop(y)||P;return P}class W extends D{constructor(d,g){super(d,g),this.parser=g}static define(d){let g=N(d.languageData);return new W(g,d.parser.configure({props:[y.add(A=>A.isTop?g:void 0)]}))}configure(d){return new W(this.data,this.parser.configure(d))}get allowsNesting(){return this.parser.hasWrappers()}}function z(S){let d=S.field(D.state,!1);return d?d.tree:e.Tree.empty}function ne(S,d,g=50){var A;let P=(A=S.field(D.state,!1))===null||A===void 0?void 0:A.context;return P&&(P.isDone(d)||P.work(g,d))?P.tree:null}function te(S,d=S.doc.length){var g;return((g=S.field(D.state,!1))===null||g===void 0?void 0:g.context.isDone(d))||!1}function be(S,d=S.viewport.to,g=100){let A=ne(S.state,d,g);return A!=z(S.state)&&S.dispatch({}),!!A}function Ne(S){var d;return((d=S.plugin(Et))===null||d===void 0?void 0:d.isWorking())||!1}class Se{constructor(d,g=d.length){this.doc=d,this.length=g,this.cursorPos=0,this.string="",this.cursor=d.iter()}syncTo(d){return this.string=this.cursor.next(d-this.cursorPos).value,this.cursorPos=d+this.string.length,this.cursorPos-this.string.length}chunk(d){return this.syncTo(d),this.string}get lineChunks(){return!0}read(d,g){let A=this.cursorPos-this.string.length;return d<A||g>=this.cursorPos?this.doc.sliceString(d,g):this.string.slice(d-A,g-A)}}let xe=null;class Qe{constructor(d,g,A=[],P,$,X,he,ge){this.parser=d,this.state=g,this.fragments=A,this.tree=P,this.treeLen=$,this.viewport=X,this.skipped=he,this.scheduleOn=ge,this.parse=null,this.tempSkipped=[]}static create(d,g,A){return new Qe(d,g,[],e.Tree.empty,0,A,[],null)}startParse(){return this.parser.startParse(new Se(this.state.doc),this.fragments)}work(d,g){return g!=null&&g>=this.state.doc.length&&(g=void 0),this.tree!=e.Tree.empty&&this.isDone(g??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var A;if(typeof d=="number"){let P=Date.now()+d;d=()=>Date.now()>P}for(this.parse||(this.parse=this.startParse()),g!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>g)&&g<this.state.doc.length&&this.parse.stopAt(g);;){let P=this.parse.advance();if(P)if(this.fragments=this.withoutTempSkipped(e.TreeFragment.addTree(P,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(A=this.parse.stoppedAt)!==null&&A!==void 0?A:this.state.doc.length,this.tree=P,this.parse=null,this.treeLen<(g??this.state.doc.length))this.parse=this.startParse();else return!0;if(d())return!1}})}takeTree(){let d,g;this.parse&&(d=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>d)&&this.parse.stopAt(d),this.withContext(()=>{for(;!(g=this.parse.advance()););}),this.treeLen=d,this.tree=g,this.fragments=this.withoutTempSkipped(e.TreeFragment.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(d){let g=xe;xe=this;try{return d()}finally{xe=g}}withoutTempSkipped(d){for(let g;g=this.tempSkipped.pop();)d=Ge(d,g.from,g.to);return d}changes(d,g){let{fragments:A,tree:P,treeLen:$,viewport:X,skipped:he}=this;if(this.takeTree(),!d.empty){let ge=[];if(d.iterChangedRanges((Re,mt,Bt,ln)=>ge.push({fromA:Re,toA:mt,fromB:Bt,toB:ln})),A=e.TreeFragment.applyChanges(A,ge),P=e.Tree.empty,$=0,X={from:d.mapPos(X.from,-1),to:d.mapPos(X.to,1)},this.skipped.length){he=[];for(let Re of this.skipped){let mt=d.mapPos(Re.from,1),Bt=d.mapPos(Re.to,-1);mt<Bt&&he.push({from:mt,to:Bt})}}}return new Qe(this.parser,g,A,P,$,X,he,this.scheduleOn)}updateViewport(d){if(this.viewport.from==d.from&&this.viewport.to==d.to)return!1;this.viewport=d;let g=this.skipped.length;for(let A=0;A<this.skipped.length;A++){let{from:P,to:$}=this.skipped[A];P<d.to&&$>d.from&&(this.fragments=Ge(this.fragments,P,$),this.skipped.splice(A--,1))}return this.skipped.length>=g?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(d,g){this.skipped.push({from:d,to:g})}static getSkippingParser(d){return new class extends e.Parser{createParse(g,A,P){let $=P[0].from,X=P[P.length-1].to;return{parsedPos:$,advance(){let ge=xe;if(ge){for(let Re of P)ge.tempSkipped.push(Re);d&&(ge.scheduleOn=ge.scheduleOn?Promise.all([ge.scheduleOn,d]):d)}return this.parsedPos=X,new e.Tree(e.NodeType.none,[],[],X-$)},stoppedAt:null,stopAt(){}}}}}isDone(d){d=Math.min(d,this.state.doc.length);let g=this.fragments;return this.treeLen>=d&&g.length&&g[0].from==0&&g[0].to>=d}static get(){return xe}}function Ge(S,d,g){return e.TreeFragment.applyChanges(S,[{fromA:d,toA:g,fromB:d,toB:g}])}class We{constructor(d){this.context=d,this.tree=d.tree}apply(d){if(!d.docChanged&&this.tree==this.context.tree)return this;let g=this.context.changes(d.changes,d.state),A=this.context.treeLen==d.startState.doc.length?void 0:Math.max(d.changes.mapPos(this.context.treeLen),g.viewport.to);return g.work(20,A)||g.takeTree(),new We(g)}static init(d){let g=Math.min(3e3,d.doc.length),A=Qe.create(d.facet(ut).parser,d,{from:0,to:g});return A.work(20,g)||A.takeTree(),new We(A)}}D.state=n.StateField.define({create:We.init,update(S,d){for(let g of d.effects)if(g.is(D.setState))return g.value;return d.startState.facet(ut)!=d.state.facet(ut)?We.init(d.state):S.apply(d)}});let ot=S=>{let d=setTimeout(()=>S(),500);return()=>clearTimeout(d)};typeof requestIdleCallback<"u"&&(ot=S=>{let d=-1,g=setTimeout(()=>{d=requestIdleCallback(S,{timeout:400})},100);return()=>d<0?clearTimeout(g):cancelIdleCallback(d)});const ft=typeof navigator<"u"&&(!((h=navigator.scheduling)===null||h===void 0)&&h.isInputPending)?()=>navigator.scheduling.isInputPending():null,Et=r.ViewPlugin.fromClass(class{constructor(d){this.view=d,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(d){let g=this.view.state.field(D.state).context;(g.updateViewport(d.view.viewport)||this.view.viewport.to>g.treeLen)&&this.scheduleWork(),d.docChanged&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(g)}scheduleWork(){if(this.working)return;let{state:d}=this.view,g=d.field(D.state);(g.tree!=g.context.tree||!g.context.isDone(d.doc.length))&&(this.working=ot(this.work))}work(d){this.working=null;let g=Date.now();if(this.chunkEnd<g&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=g+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:A,viewport:{to:P}}=this.view,$=A.field(D.state);if($.tree==$.context.tree&&$.context.isDone(P+1e5))return;let X=Date.now()+Math.min(this.chunkBudget,100,d&&!ft?Math.max(25,d.timeRemaining()-5):1e9),he=$.context.treeLen<P&&A.doc.length>P+1e3,ge=$.context.work(()=>ft&&ft()||Date.now()>X,P+(he?0:1e5));this.chunkBudget-=Date.now()-g,(ge||this.chunkBudget<=0)&&($.context.takeTree(),this.view.dispatch({effects:D.setState.of(new We($.context))})),this.chunkBudget>0&&!(ge&&!he)&&this.scheduleWork(),this.checkAsyncSchedule($.context)}checkAsyncSchedule(d){d.scheduleOn&&(this.workScheduled++,d.scheduleOn.then(()=>this.scheduleWork()).catch(g=>r.logException(this.view.state,g)).then(()=>this.workScheduled--),d.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),ut=n.Facet.define({combine(S){return S.length?S[0]:null},enables:[D.state,Et]});class rn{constructor(d,g=[]){this.language=d,this.support=g,this.extension=[d,g]}}class Xt{constructor(d,g,A,P,$,X=void 0){this.name=d,this.alias=g,this.extensions=A,this.filename=P,this.loadFunc=$,this.support=X,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(d=>this.support=d,d=>{throw this.loading=null,d}))}static of(d){let{load:g,support:A}=d;if(!g){if(!A)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");g=()=>Promise.resolve(A)}return new Xt(d.name,(d.alias||[]).concat(d.name).map(P=>P.toLowerCase()),d.extensions||[],d.filename,g,A)}static matchFilename(d,g){for(let P of d)if(P.filename&&P.filename.test(g))return P;let A=/\.([^.]+)$/.exec(g);if(A){for(let P of d)if(P.extensions.indexOf(A[1])>-1)return P}return null}static matchLanguageName(d,g,A=!0){g=g.toLowerCase();for(let P of d)if(P.alias.some($=>$==g))return P;if(A)for(let P of d)for(let $ of P.alias){let X=g.indexOf($);if(X>-1&&($.length>2||!/\w/.test(g[X-1])&&!/\w/.test(g[X+$.length])))return P}return null}}const Qt=n.Facet.define(),Kt=n.Facet.define({combine:S=>{if(!S.length)return"  ";if(!/^(?: +|\t+)$/.test(S[0]))throw new Error("Invalid indent unit: "+JSON.stringify(S[0]));return S[0]}});function pt(S){let d=S.facet(Kt);return d.charCodeAt(0)==9?S.tabSize*d.length:d.length}function Vt(S,d){let g="",A=S.tabSize;if(S.facet(Kt).charCodeAt(0)==9)for(;d>=A;)g+="	",d-=A;for(let P=0;P<d;P++)g+=" ";return g}function qe(S,d){S instanceof n.EditorState&&(S=new Mt(S));for(let A of S.state.facet(Qt)){let P=A(S,d);if(P!=null)return P}let g=z(S.state);return g?we(S,g,d):null}class Mt{constructor(d,g={}){this.state=d,this.options=g,this.unit=pt(d)}lineAt(d,g=1){let A=this.state.doc.lineAt(d),{simulateBreak:P,simulateDoubleBreak:$}=this.options;return P!=null&&P>=A.from&&P<=A.to?$&&P==d?{text:"",from:d}:(g<0?P<d:P<=d)?{text:A.text.slice(P-A.from),from:P}:{text:A.text.slice(0,P-A.from),from:A.from}:A}textAfterPos(d,g=1){if(this.options.simulateDoubleBreak&&d==this.options.simulateBreak)return"";let{text:A,from:P}=this.lineAt(d,g);return A.slice(d-P,Math.min(A.length,d+100-P))}column(d,g=1){let{text:A,from:P}=this.lineAt(d,g),$=this.countColumn(A,d-P),X=this.options.overrideIndentation?this.options.overrideIndentation(P):-1;return X>-1&&($+=X-this.countColumn(A,A.search(/\S|$/))),$}countColumn(d,g=d.length){return n.countColumn(d,this.state.tabSize,g)}lineIndent(d,g=1){let{text:A,from:P}=this.lineAt(d,g),$=this.options.overrideIndentation;if($){let X=$(P);if(X>-1)return X}return this.countColumn(A,A.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const Je=new e.NodeProp;function we(S,d,g){return tt(d.resolveInner(g).enterUnfinishedNodesBefore(g),g,S)}function ze(S){return S.pos==S.options.simulateBreak&&S.options.simulateDoubleBreak}function rt(S){let d=S.type.prop(Je);if(d)return d;let g=S.firstChild,A;if(g&&(A=g.type.prop(e.NodeProp.closedBy))){let P=S.lastChild,$=P&&A.indexOf(P.name)>-1;return X=>yt(X,!0,1,void 0,$&&!ze(X)?P.from:void 0)}return S.parent==null?Ye:null}function tt(S,d,g){for(;S;S=S.parent){let A=rt(S);if(A)return A(st.create(g,d,S))}return null}function Ye(){return 0}class st extends Mt{constructor(d,g,A){super(d.state,d.options),this.base=d,this.pos=g,this.node=A}static create(d,g,A){return new st(d,g,A)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){let d=this.state.doc.lineAt(this.node.from);for(;;){let g=this.node.resolve(d.from);for(;g.parent&&g.parent.from==g.from;)g=g.parent;if(Nt(g,this.node))break;d=this.state.doc.lineAt(g.from)}return this.lineIndent(d.from)}continue(){let d=this.node.parent;return d?tt(d,this.pos,this.base):0}}function Nt(S,d){for(let g=d;g;g=g.parent)if(S==g)return!0;return!1}function jt(S){let d=S.node,g=d.childAfter(d.from),A=d.lastChild;if(!g)return null;let P=S.options.simulateBreak,$=S.state.doc.lineAt(g.from),X=P==null||P<=$.from?$.to:Math.min($.to,P);for(let he=g.to;;){let ge=d.childAfter(he);if(!ge||ge==A)return null;if(!ge.type.isSkipped)return ge.from<X?g:null;he=ge.to}}function Ct({closing:S,align:d=!0,units:g=1}){return A=>yt(A,d,g,S)}function yt(S,d,g,A,P){let $=S.textAfter,X=$.match(/^\s*/)[0].length,he=A&&$.slice(X,X+A.length)==A||P==S.pos+X,ge=d?jt(S):null;return ge?he?S.column(ge.from):S.column(ge.to):S.baseIndent+(he?0:S.unit*g)}const wt=S=>S.baseIndent;function Pt({except:S,units:d=1}={}){return g=>{let A=S&&S.test(g.textAfter);return g.baseIndent+(A?0:d*g.unit)}}const It=200;function gn(){return n.EditorState.transactionFilter.of(S=>{if(!S.docChanged||!S.isUserEvent("input.type")&&!S.isUserEvent("input.complete"))return S;let d=S.startState.languageDataAt("indentOnInput",S.startState.selection.main.head);if(!d.length)return S;let g=S.newDoc,{head:A}=S.newSelection.main,P=g.lineAt(A);if(A>P.from+It)return S;let $=g.sliceString(P.from,A);if(!d.some(Re=>Re.test($)))return S;let{state:X}=S,he=-1,ge=[];for(let{head:Re}of X.selection.ranges){let mt=X.doc.lineAt(Re);if(mt.from==he)continue;he=mt.from;let Bt=qe(X,mt.from);if(Bt==null)continue;let ln=/^\s*/.exec(mt.text)[0],mn=Vt(X,Bt);ln!=mn&&ge.push({from:mt.from,to:mt.from+ln.length,insert:mn})}return ge.length?[S,{changes:ge,sequential:!0}]:S})}const sn=n.Facet.define(),oe=new e.NodeProp;function b(S){let d=S.firstChild,g=S.lastChild;return d&&d.to<g.from?{from:d.to,to:g.type.isError?S.to:g.from}:null}function T(S,d,g){let A=z(S);if(A.length<g)return null;let P=A.resolveInner(g),$=null;for(let X=P;X;X=X.parent){if(X.to<=g||X.from>g)continue;if($&&X.from<d)break;let he=X.type.prop(oe);if(he&&(X.to<A.length-50||A.length==S.doc.length||!L(X))){let ge=he(X,S);ge&&ge.from<=g&&ge.from>=d&&ge.to>g&&($=ge)}}return $}function L(S){let d=S.lastChild;return d&&d.to==S.to&&d.type.isError}function O(S,d,g){for(let A of S.facet(sn)){let P=A(S,d,g);if(P)return P}return T(S,d,g)}function H(S,d){let g=d.mapPos(S.from,1),A=d.mapPos(S.to,-1);return g>=A?void 0:{from:g,to:A}}const re=n.StateEffect.define({map:H}),me=n.StateEffect.define({map:H});function Ee(S){let d=[];for(let{head:g}of S.state.selection.ranges)d.some(A=>A.from<=g&&A.to>=g)||d.push(S.lineBlockAt(g));return d}const Fe=n.StateField.define({create(){return r.Decoration.none},update(S,d){S=S.map(d.changes);for(let g of d.effects)g.is(re)&&!He(S,g.value.from,g.value.to)?S=S.update({add:[J.range(g.value.from,g.value.to)]}):g.is(me)&&(S=S.update({filter:(A,P)=>g.value.from!=A||g.value.to!=P,filterFrom:g.value.from,filterTo:g.value.to}));if(d.selection){let g=!1,{head:A}=d.selection.main;S.between(A,A,(P,$)=>{P<A&&$>A&&(g=!0)}),g&&(S=S.update({filterFrom:A,filterTo:A,filter:(P,$)=>$<=A||P>=A}))}return S},provide:S=>r.EditorView.decorations.from(S)});function Be(S){return S.field(Fe,!1)||n.RangeSet.empty}function Ue(S,d,g){var A;let P=null;return(A=S.field(Fe,!1))===null||A===void 0||A.between(d,g,($,X)=>{(!P||P.from>$)&&(P={from:$,to:X})}),P}function He(S,d,g){let A=!1;return S.between(d,d,(P,$)=>{P==d&&$==g&&(A=!0)}),A}function Ze(S,d){return S.field(Fe,!1)?d:d.concat(n.StateEffect.appendConfig.of(Lt()))}const lt=S=>{for(let d of Ee(S)){let g=O(S.state,d.from,d.to);if(g)return S.dispatch({effects:Ze(S.state,[re.of(g),gt(S,g)])}),!0}return!1},qt=S=>{if(!S.state.field(Fe,!1))return!1;let d=[];for(let g of Ee(S)){let A=Ue(S.state,g.from,g.to);A&&d.push(me.of(A),gt(S,A,!1))}return d.length&&S.dispatch({effects:d}),d.length>0};function gt(S,d,g=!0){let A=S.state.doc.lineAt(d.from).number,P=S.state.doc.lineAt(d.to).number;return r.EditorView.announce.of(`${S.state.phrase(g?"Folded lines":"Unfolded lines")} ${A} ${S.state.phrase("to")} ${P}.`)}const kt=S=>{let{state:d}=S,g=[];for(let A=0;A<d.doc.length;){let P=S.lineBlockAt(A),$=O(d,P.from,P.to);$&&g.push(re.of($)),A=($?S.lineBlockAt($.to):P).to+1}return g.length&&S.dispatch({effects:Ze(S.state,g)}),!!g.length},ht=S=>{let d=S.state.field(Fe,!1);if(!d||!d.size)return!1;let g=[];return d.between(0,S.state.doc.length,(A,P)=>{g.push(me.of({from:A,to:P}))}),S.dispatch({effects:g}),!0},Ft=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:lt},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:qt},{key:"Ctrl-Alt-[",run:kt},{key:"Ctrl-Alt-]",run:ht}],en={placeholderDOM:null,placeholderText:"â€¦"},At=n.Facet.define({combine(S){return n.combineConfig(S,en)}});function Lt(S){let d=[Fe,le];return S&&d.push(At.of(S)),d}const J=r.Decoration.replace({widget:new class extends r.WidgetType{toDOM(S){let{state:d}=S,g=d.facet(At),A=$=>{let X=S.lineBlockAt(S.posAtDOM($.target)),he=Ue(S.state,X.from,X.to);he&&S.dispatch({effects:me.of(he)}),$.preventDefault()};if(g.placeholderDOM)return g.placeholderDOM(S,A);let P=document.createElement("span");return P.textContent=g.placeholderText,P.setAttribute("aria-label",d.phrase("folded code")),P.title=d.phrase("unfold"),P.className="cm-foldPlaceholder",P.onclick=A,P}}}),j={openText:"âŒ„",closedText:"â€º",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class G extends r.GutterMarker{constructor(d,g){super(),this.config=d,this.open=g}eq(d){return this.config==d.config&&this.open==d.open}toDOM(d){if(this.config.markerDOM)return this.config.markerDOM(this.open);let g=document.createElement("span");return g.textContent=this.open?this.config.openText:this.config.closedText,g.title=d.state.phrase(this.open?"Fold line":"Unfold line"),g}}function se(S={}){let d=Object.assign(Object.assign({},j),S),g=new G(d,!0),A=new G(d,!1),P=r.ViewPlugin.fromClass(class{constructor(X){this.from=X.viewport.from,this.markers=this.buildMarkers(X)}update(X){(X.docChanged||X.viewportChanged||X.startState.facet(ut)!=X.state.facet(ut)||X.startState.field(Fe,!1)!=X.state.field(Fe,!1)||z(X.startState)!=z(X.state)||d.foldingChanged(X))&&(this.markers=this.buildMarkers(X.view))}buildMarkers(X){let he=new n.RangeSetBuilder;for(let ge of X.viewportLineBlocks){let Re=Ue(X.state,ge.from,ge.to)?A:O(X.state,ge.from,ge.to)?g:null;Re&&he.add(ge.from,ge.from,Re)}return he.finish()}}),{domEventHandlers:$}=d;return[P,r.gutter({class:"cm-foldGutter",markers(X){var he;return((he=X.plugin(P))===null||he===void 0?void 0:he.markers)||n.RangeSet.empty},initialSpacer(){return new G(d,!1)},domEventHandlers:Object.assign(Object.assign({},$),{click:(X,he,ge)=>{if($.click&&$.click(X,he,ge))return!0;let Re=Ue(X.state,he.from,he.to);if(Re)return X.dispatch({effects:me.of(Re)}),!0;let mt=O(X.state,he.from,he.to);return mt?(X.dispatch({effects:re.of(mt)}),!0):!1}})}),Lt()]}const le=r.EditorView.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class fe{constructor(d,g){let A;function P(he){let ge=l.StyleModule.newName();return(A||(A=Object.create(null)))["."+ge]=he,ge}const $=typeof g.all=="string"?g.all:g.all?P(g.all):void 0,X=g.scope;this.scope=X instanceof D?he=>he.prop(y)==X.data:X?he=>he==X:void 0,this.style=o.tagHighlighter(d.map(he=>({tag:he.tag,class:he.class||P(Object.assign({},he,{tag:null}))})),{all:$}).style,this.module=A?new l.StyleModule(A):null,this.themeType=g.themeType}static define(d,g){return new fe(d,g||{})}}const Ie=n.Facet.define(),_e=n.Facet.define({combine(S){return S.length?[S[0]]:null}});function Pe(S){let d=S.facet(Ie);return d.length?d:S.facet(_e)}function Rt(S,d){let g=[yn],A;return S instanceof fe&&(S.module&&g.push(r.EditorView.styleModule.of(S.module)),A=S.themeType),d?.fallback?g.push(_e.of(S)):A?g.push(Ie.computeN([r.EditorView.darkTheme],P=>P.facet(r.EditorView.darkTheme)==(A=="dark")?[S]:[])):g.push(Ie.of(S)),g}function Ut(S,d,g){let A=Pe(S),P=null;if(A){for(let $ of A)if(!$.scope||g&&$.scope(g)){let X=$.style(d);X&&(P=P?P+" "+X:X)}}return P}class cn{constructor(d){this.markCache=Object.create(null),this.tree=z(d.state),this.decorations=this.buildDeco(d,Pe(d.state))}update(d){let g=z(d.state),A=Pe(d.state),P=A!=Pe(d.startState);g.length<d.view.viewport.to&&!P&&g.type==this.tree.type?this.decorations=this.decorations.map(d.changes):(g!=this.tree||d.viewportChanged||P)&&(this.tree=g,this.decorations=this.buildDeco(d.view,A))}buildDeco(d,g){if(!g||!this.tree.length)return r.Decoration.none;let A=new n.RangeSetBuilder;for(let{from:P,to:$}of d.visibleRanges)o.highlightTree(this.tree,g,(X,he,ge)=>{A.add(X,he,this.markCache[ge]||(this.markCache[ge]=r.Decoration.mark({class:ge})))},P,$);return A.finish()}}const yn=n.Prec.high(r.ViewPlugin.fromClass(cn,{decorations:S=>S.decorations})),un=fe.define([{tag:o.tags.meta,color:"#7a757a"},{tag:o.tags.link,textDecoration:"underline"},{tag:o.tags.heading,textDecoration:"underline",fontWeight:"bold"},{tag:o.tags.emphasis,fontStyle:"italic"},{tag:o.tags.strong,fontWeight:"bold"},{tag:o.tags.strikethrough,textDecoration:"line-through"},{tag:o.tags.keyword,color:"#708"},{tag:[o.tags.atom,o.tags.bool,o.tags.url,o.tags.contentSeparator,o.tags.labelName],color:"#219"},{tag:[o.tags.literal,o.tags.inserted],color:"#164"},{tag:[o.tags.string,o.tags.deleted],color:"#a11"},{tag:[o.tags.regexp,o.tags.escape,o.tags.special(o.tags.string)],color:"#e40"},{tag:o.tags.definition(o.tags.variableName),color:"#00f"},{tag:o.tags.local(o.tags.variableName),color:"#30a"},{tag:[o.tags.typeName,o.tags.namespace],color:"#085"},{tag:o.tags.className,color:"#167"},{tag:[o.tags.special(o.tags.variableName),o.tags.macroName],color:"#256"},{tag:o.tags.definition(o.tags.propertyName),color:"#00c"},{tag:o.tags.comment,color:"#940"},{tag:o.tags.invalid,color:"#f00"}]),$t=r.EditorView.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Ht=1e4,pn="()[]{}",dn=n.Facet.define({combine(S){return n.combineConfig(S,{afterCursor:!0,brackets:pn,maxScanDistance:Ht,renderMatch:Xn})}}),On=r.Decoration.mark({class:"cm-matchingBracket"}),Ot=r.Decoration.mark({class:"cm-nonmatchingBracket"});function Xn(S){let d=[],g=S.matched?On:Ot;return d.push(g.range(S.start.from,S.start.to)),S.end&&d.push(g.range(S.end.from,S.end.to)),d}const Ai=[n.StateField.define({create(){return r.Decoration.none},update(S,d){if(!d.docChanged&&!d.selection)return S;let g=[],A=d.state.facet(dn);for(let P of d.state.selection.ranges){if(!P.empty)continue;let $=m(d.state,P.head,-1,A)||P.head>0&&m(d.state,P.head-1,1,A)||A.afterCursor&&(m(d.state,P.head,1,A)||P.head<d.state.doc.length&&m(d.state,P.head+1,-1,A));$&&(g=g.concat(A.renderMatch($,d.state)))}return r.Decoration.set(g,!0)},provide:S=>r.EditorView.decorations.from(S)}),$t];function q(S={}){return[dn.of(S),Ai]}function f(S,d,g){let A=S.prop(d<0?e.NodeProp.openedBy:e.NodeProp.closedBy);if(A)return A;if(S.name.length==1){let P=g.indexOf(S.name);if(P>-1&&P%2==(d<0?1:0))return[g[P+d]]}return null}function m(S,d,g,A={}){let P=A.maxScanDistance||Ht,$=A.brackets||pn,X=z(S),he=X.resolveInner(d,g);for(let ge=he;ge;ge=ge.parent){let Re=f(ge.type,g,$);if(Re&&ge.from<ge.to)return E(S,d,g,ge,Re,$)}return C(S,d,g,X,he.type,P,$)}function E(S,d,g,A,P,$){let X=A.parent,he={from:A.from,to:A.to},ge=0,Re=X?.cursor();if(Re&&(g<0?Re.childBefore(A.from):Re.childAfter(A.to)))do if(g<0?Re.to<=A.from:Re.from>=A.to){if(ge==0&&P.indexOf(Re.type.name)>-1&&Re.from<Re.to)return{start:he,end:{from:Re.from,to:Re.to},matched:!0};if(f(Re.type,g,$))ge++;else if(f(Re.type,-g,$)&&(ge--,ge==0))return{start:he,end:Re.from==Re.to?void 0:{from:Re.from,to:Re.to},matched:!1}}while(g<0?Re.prevSibling():Re.nextSibling());return{start:he,matched:!1}}function C(S,d,g,A,P,$,X){let he=g<0?S.sliceDoc(d-1,d):S.sliceDoc(d,d+1),ge=X.indexOf(he);if(ge<0||ge%2==0!=g>0)return null;let Re={from:g<0?d-1:d,to:g>0?d+1:d},mt=S.doc.iterRange(d,g>0?S.doc.length:0),Bt=0;for(let ln=0;!mt.next().done&&ln<=$;){let mn=mt.value;g<0&&(ln+=mn.length);let Dn=d+ln*g;for(let Zt=g>0?0:mn.length-1,ti=g>0?mn.length:-1;Zt!=ti;Zt+=g){let Mn=X.indexOf(mn[Zt]);if(!(Mn<0||A.resolve(Dn+Zt,1).type!=P))if(Mn%2==0==g>0)Bt++;else{if(Bt==1)return{start:Re,end:{from:Dn+Zt,to:Dn+Zt+1},matched:Mn>>1==ge>>1};Bt--}}g>0&&(ln+=mn.length)}return mt.done?{start:Re,matched:!1}:null}function B(S,d,g,A=0,P=0){d==null&&(d=S.search(/[^\s\u00a0]/),d==-1&&(d=S.length));let $=P;for(let X=A;X<d;X++)S.charCodeAt(X)==9?$+=g-$%g:$++;return $}class V{constructor(d,g,A){this.string=d,this.tabSize=g,this.indentUnit=A,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(d){let g=this.string.charAt(this.pos),A;if(typeof d=="string"?A=g==d:A=g&&(d instanceof RegExp?d.test(g):d(g)),A)return++this.pos,g}eatWhile(d){let g=this.pos;for(;this.eat(d););return this.pos>g}eatSpace(){let d=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>d}skipToEnd(){this.pos=this.string.length}skipTo(d){let g=this.string.indexOf(d,this.pos);if(g>-1)return this.pos=g,!0}backUp(d){this.pos-=d}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=B(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){return B(this.string,null,this.tabSize)}match(d,g,A){if(typeof d=="string"){let P=X=>A?X.toLowerCase():X,$=this.string.substr(this.pos,d.length);return P($)==P(d)?(g!==!1&&(this.pos+=d.length),!0):null}else{let P=this.string.slice(this.pos).match(d);return P&&P.index>0?null:(P&&g!==!1&&(this.pos+=P[0].length),P)}}current(){return this.string.slice(this.start,this.pos)}}function ee(S){return{token:S.token,blankLine:S.blankLine||(()=>{}),startState:S.startState||(()=>!0),copyState:S.copyState||ce,indent:S.indent||(()=>null),languageData:S.languageData||{},tokenTable:S.tokenTable||An}}function ce(S){if(typeof S!="object")return S;let d={};for(let g in S){let A=S[g];d[g]=A instanceof Array?A.slice():A}return d}class Te extends D{constructor(d){let g=N(d.languageData),A=ee(d),P,$=new class extends e.Parser{createParse(X,he,ge){return new it(P,X,he,ge)}};super(g,$,[Qt.of((X,he)=>this.getIndent(X,he))]),this.topNode=M(g),P=this,this.streamParser=A,this.stateAfter=new e.NodeProp({perNode:!0}),this.tokenTable=d.tokenTable?new si(A.tokenTable):ki}static define(d){return new Te(d)}getIndent(d,g){let A=z(d.state),P=A.resolve(g);for(;P&&P.type!=this.topNode;)P=P.parent;if(!P)return null;let $=De(this,A,0,P.from,g),X,he;if($?(he=$.state,X=$.pos+1):(he=this.streamParser.startState(d.unit),X=0),g-X>1e4)return null;for(;X<g;){let Re=d.state.doc.lineAt(X),mt=Math.min(g,Re.to);if(Re.length){let Bt=new V(Re.text,d.state.tabSize,d.unit);for(;Bt.pos<mt-Re.from;)zt(this.streamParser.token,Bt,he)}else this.streamParser.blankLine(he,d.unit);if(mt==g)break;X=Re.to+1}let{text:ge}=d.lineAt(g);return this.streamParser.indent(he,/^\s*(.*)/.exec(ge)[1],d)}get allowsNesting(){return!1}}function De(S,d,g,A,P){let $=g>=A&&g+d.length<=P&&d.prop(S.stateAfter);if($)return{state:S.streamParser.copyState($),pos:g+d.length};for(let X=d.children.length-1;X>=0;X--){let he=d.children[X],ge=g+d.positions[X],Re=he instanceof e.Tree&&ge<P&&De(S,he,ge,A,P);if(Re)return Re}return null}function je(S,d,g,A,P){if(P&&g<=0&&A>=d.length)return d;!P&&d.type==S.topNode&&(P=!0);for(let $=d.children.length-1;$>=0;$--){let X=d.positions[$],he=d.children[$],ge;if(X<A&&he instanceof e.Tree){if(!(ge=je(S,he,g-X,A-X,P)))break;return P?new e.Tree(d.type,d.children.slice(0,$).concat(ge),d.positions.slice(0,$+1),X+ge.length):ge}}return null}function nt(S,d,g,A){for(let P of d){let $=P.from+(P.openStart?25:0),X=P.to-(P.openEnd?25:0),he=$<=g&&X>g&&De(S,P.tree,0-P.offset,g,X),ge;if(he&&(ge=je(S,P.tree,g+P.offset,he.pos+P.offset,!1)))return{state:he.state,tree:ge}}return{state:S.streamParser.startState(A?pt(A):4),tree:e.Tree.empty}}class it{constructor(d,g,A,P){this.lang=d,this.input=g,this.fragments=A,this.ranges=P,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=P[P.length-1].to;let $=Qe.get(),X=P[0].from,{state:he,tree:ge}=nt(d,A,X,$?.state);this.state=he,this.parsedPos=this.chunkStart=X+ge.length;for(let Re=0;Re<ge.children.length;Re++)this.chunks.push(ge.children[Re]),this.chunkPos.push(ge.positions[Re]);$&&this.parsedPos<$.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(pt($.state)),$.skipUntilInView(this.parsedPos,$.viewport.from),this.parsedPos=$.viewport.from),this.moveRangeIndex()}advance(){let d=Qe.get(),g=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),A=Math.min(g,this.chunkStart+2048);for(d&&(A=Math.min(A,d.viewport.to));this.parsedPos<A;)this.parseLine(d);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=g?this.finish():d&&this.parsedPos>=d.viewport.to?(d.skipUntilInView(this.parsedPos,g),this.finish()):null}stopAt(d){this.stoppedAt=d}lineAfter(d){let g=this.input.chunk(d);if(this.input.lineChunks)g==`
`&&(g="");else{let A=g.indexOf(`
`);A>-1&&(g=g.slice(0,A))}return d+g.length<=this.to?g:g.slice(0,this.to-d)}nextLine(){let d=this.parsedPos,g=this.lineAfter(d),A=d+g.length;for(let P=this.rangeIndex;;){let $=this.ranges[P].to;if($>=A||(g=g.slice(0,$-(A-g.length)),P++,P==this.ranges.length))break;let X=this.ranges[P].from,he=this.lineAfter(X);g+=he,A=X+he.length}return{line:g,end:A}}skipGapsTo(d,g,A){for(;;){let P=this.ranges[this.rangeIndex].to,$=d+g;if(A>0?P>$:P>=$)break;let X=this.ranges[++this.rangeIndex].from;g+=X-P}return g}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(d,g,A,P,$){if(this.ranges.length>1){$=this.skipGapsTo(g,$,1),g+=$;let X=this.chunk.length;$=this.skipGapsTo(A,$,-1),A+=$,P+=this.chunk.length-X}return this.chunk.push(d,g,A,P),$}parseLine(d){let{line:g,end:A}=this.nextLine(),P=0,{streamParser:$}=this.lang,X=new V(g,d?d.state.tabSize:4,d?pt(d.state):2);if(X.eol())$.blankLine(this.state,X.indentUnit);else for(;!X.eol();){let he=zt($.token,X,this.state);if(he&&(P=this.emitToken(this.lang.tokenTable.resolve(he),this.parsedPos+X.start,this.parsedPos+X.pos,4,P)),X.start>1e4)break}this.parsedPos=A,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let d=e.Tree.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:Zn,topID:0,maxBufferLength:2048,reused:this.chunkReused});d=new e.Tree(d.type,d.children,d.positions,d.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(d),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new e.Tree(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function zt(S,d,g){d.start=d.pos;for(let A=0;A<10;A++){let P=S(d,g);if(d.pos>d.start)return P}throw new Error("Stream parser failed to advance stream.")}const An=Object.create(null),on=[e.NodeType.none],Zn=new e.NodeSet(on),wi=[],ei=Object.create(null);for(let[S,d]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","typeName"],["attribute","propertyName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])ei[S]=x(An,d);class si{constructor(d){this.extra=d,this.table=Object.assign(Object.create(null),ei)}resolve(d){return d?this.table[d]||(this.table[d]=x(this.extra,d)):0}}const ki=new si(An);function U(S,d){wi.indexOf(S)>-1||(wi.push(S),console.warn(d))}function x(S,d){let g=null;for(let $ of d.split(".")){let X=S[$]||o.tags[$];X?typeof X=="function"?g?g=X(g):U($,`Modifier ${$} used at start of tag`):g?U($,`Tag ${$} used as modifier`):g=X:U($,`Unknown highlighting tag ${$}`)}if(!g)return 0;let A=d.replace(/ /g,"_"),P=e.NodeType.define({id:on.length,name:A,props:[o.styleTags({[A]:g})]});return on.push(P),P.id}function M(S){let d=e.NodeType.define({id:on.length,name:"Document",props:[y.add(()=>S)]});return on.push(d),d}return xt.HighlightStyle=fe,xt.IndentContext=Mt,xt.LRLanguage=W,xt.Language=D,xt.LanguageDescription=Xt,xt.LanguageSupport=rn,xt.ParseContext=Qe,xt.StreamLanguage=Te,xt.StringStream=V,xt.TreeIndentContext=st,xt.bracketMatching=q,xt.codeFolding=Lt,xt.continuedIndent=Pt,xt.defaultHighlightStyle=un,xt.defineLanguageFacet=N,xt.delimitedIndent=Ct,xt.ensureSyntaxTree=ne,xt.flatIndent=wt,xt.foldAll=kt,xt.foldCode=lt,xt.foldEffect=re,xt.foldGutter=se,xt.foldInside=b,xt.foldKeymap=Ft,xt.foldNodeProp=oe,xt.foldService=sn,xt.foldable=O,xt.foldedRanges=Be,xt.forceParsing=be,xt.getIndentUnit=pt,xt.getIndentation=qe,xt.highlightingFor=Ut,xt.indentNodeProp=Je,xt.indentOnInput=gn,xt.indentService=Qt,xt.indentString=Vt,xt.indentUnit=Kt,xt.language=ut,xt.languageDataProp=y,xt.matchBrackets=m,xt.syntaxHighlighting=Rt,xt.syntaxParserRunning=Ne,xt.syntaxTree=z,xt.syntaxTreeAvailable=te,xt.unfoldAll=ht,xt.unfoldCode=qt,xt.unfoldEffect=me,xt}var Me={},mc;function up(){if(mc)return Me;mc=1;var e=tr(),n=Nr(),r=Ul(),o=jl();const l=w=>{let{state:_}=w,K=_.doc.lineAt(_.selection.main.from),Q=te(w.state,K.from);return Q.line?y(w):Q.block?ne(w):!1};function h(w,_){return({state:K,dispatch:Q})=>{if(K.readOnly)return!1;let ue=w(_,K);return ue?(Q(K.update(ue)),!0):!1}}const y=h(Qe,0),N=h(Qe,1),D=h(Qe,2),R=h(xe,0),W=h(xe,1),z=h(xe,2),ne=h((w,_)=>xe(w,_,Se(_)),0);function te(w,_){let K=w.languageDataAt("commentTokens",_,1);return K.length?K[0]:{}}const be=50;function Ne(w,{open:_,close:K},Q,ue){let ae=w.sliceDoc(Q-be,Q),pe=w.sliceDoc(ue,ue+be),Oe=/\s*$/.exec(ae)[0].length,Xe=/^\s*/.exec(pe)[0].length,Dt=ae.length-Oe;if(ae.slice(Dt-_.length,Dt)==_&&pe.slice(Xe,Xe+K.length)==K)return{open:{pos:Q-Oe,margin:Oe&&1},close:{pos:ue+Xe,margin:Xe&&1}};let bt,tn;ue-Q<=2*be?bt=tn=w.sliceDoc(Q,ue):(bt=w.sliceDoc(Q,Q+be),tn=w.sliceDoc(ue-be,ue));let vn=/^\s*/.exec(bt)[0].length,Cn=/\s*$/.exec(tn)[0].length,bn=tn.length-Cn-K.length;return bt.slice(vn,vn+_.length)==_&&tn.slice(bn,bn+K.length)==K?{open:{pos:Q+vn+_.length,margin:/\s/.test(bt.charAt(vn+_.length))?1:0},close:{pos:ue-Cn-K.length,margin:/\s/.test(tn.charAt(bn-1))?1:0}}:null}function Se(w){let _=[];for(let K of w.selection.ranges){let Q=w.doc.lineAt(K.from),ue=K.to<=Q.to?Q:w.doc.lineAt(K.to);ue.from>Q.from&&ue.from==K.to&&(ue=K.to==Q.to+1?Q:w.doc.lineAt(K.to-1));let ae=_.length-1;ae>=0&&_[ae].to>Q.from?_[ae].to=ue.to:_.push({from:Q.from+/^\s*/.exec(Q.text)[0].length,to:ue.to})}return _}function xe(w,_,K=_.selection.ranges){let Q=K.map(ae=>te(_,ae.from).block);if(!Q.every(ae=>ae))return null;let ue=K.map((ae,pe)=>Ne(_,Q[pe],ae.from,ae.to));if(w!=2&&!ue.every(ae=>ae))return{changes:_.changes(K.map((ae,pe)=>ue[pe]?[]:[{from:ae.from,insert:Q[pe].open+" "},{from:ae.to,insert:" "+Q[pe].close}]))};if(w!=1&&ue.some(ae=>ae)){let ae=[];for(let pe=0,Oe;pe<ue.length;pe++)if(Oe=ue[pe]){let Xe=Q[pe],{open:Dt,close:bt}=Oe;ae.push({from:Dt.pos-Xe.open.length,to:Dt.pos+Dt.margin},{from:bt.pos-bt.margin,to:bt.pos+Xe.close.length})}return{changes:ae}}return null}function Qe(w,_,K=_.selection.ranges){let Q=[],ue=-1;for(let{from:ae,to:pe}of K){let Oe=Q.length,Xe=1e9,Dt=te(_,ae).line;if(Dt){for(let bt=ae;bt<=pe;){let tn=_.doc.lineAt(bt);if(tn.from>ue&&(ae==pe||pe>tn.from)){ue=tn.from;let vn=/^\s*/.exec(tn.text)[0].length,Cn=vn==tn.length,bn=tn.text.slice(vn,vn+Dt.length)==Dt?vn:-1;vn<tn.text.length&&vn<Xe&&(Xe=vn),Q.push({line:tn,comment:bn,token:Dt,indent:vn,empty:Cn,single:!1})}bt=tn.to+1}if(Xe<1e9)for(let bt=Oe;bt<Q.length;bt++)Q[bt].indent<Q[bt].line.text.length&&(Q[bt].indent=Xe);Q.length==Oe+1&&(Q[Oe].single=!0)}}if(w!=2&&Q.some(ae=>ae.comment<0&&(!ae.empty||ae.single))){let ae=[];for(let{line:Oe,token:Xe,indent:Dt,empty:bt,single:tn}of Q)(tn||!bt)&&ae.push({from:Oe.from+Dt,insert:Xe+" "});let pe=_.changes(ae);return{changes:pe,selection:_.selection.map(pe,1)}}else if(w!=1&&Q.some(ae=>ae.comment>=0)){let ae=[];for(let{line:pe,comment:Oe,token:Xe}of Q)if(Oe>=0){let Dt=pe.from+Oe,bt=Dt+Xe.length;pe.text[bt-pe.from]==" "&&bt++,ae.push({from:Dt,to:bt})}return{changes:ae}}return null}const Ge=e.Annotation.define(),We=e.Annotation.define(),ot=e.Facet.define(),ft=e.Facet.define({combine(w){return e.combineConfig(w,{minDepth:100,newGroupDelay:500,joinToEvent:(_,K)=>K},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(_,K)=>(Q,ue)=>_(Q,ue)||K(Q,ue)})}}),Et=e.StateField.define({create(){return It.empty},update(w,_){let K=_.state.facet(ft),Q=_.annotation(Ge);if(Q){let Xe=we.fromTransaction(_,Q.selection),Dt=Q.side,bt=Dt==0?w.undone:w.done;return Xe?bt=ze(bt,bt.length,K.minDepth,Xe):bt=jt(bt,_.startState.selection),new It(Dt==0?Q.rest:bt,Dt==0?bt:Q.rest)}let ue=_.annotation(We);if((ue=="full"||ue=="before")&&(w=w.isolate()),_.annotation(e.Transaction.addToHistory)===!1)return _.changes.empty?w:w.addMapping(_.changes.desc);let ae=we.fromTransaction(_),pe=_.annotation(e.Transaction.time),Oe=_.annotation(e.Transaction.userEvent);return ae?w=w.addChanges(ae,pe,Oe,K,_):_.selection&&(w=w.addSelection(_.startState.selection,pe,Oe,K.newGroupDelay)),(ue=="full"||ue=="after")&&(w=w.isolate()),w},toJSON(w){return{done:w.done.map(_=>_.toJSON()),undone:w.undone.map(_=>_.toJSON())}},fromJSON(w){return new It(w.done.map(we.fromJSON),w.undone.map(we.fromJSON))}});function ut(w={}){return[Et,ft.of(w),n.EditorView.domEventHandlers({beforeinput(_,K){let Q=_.inputType=="historyUndo"?Qt:_.inputType=="historyRedo"?Kt:null;return Q?(_.preventDefault(),Q(K)):!1}})]}const rn=Et;function Xt(w,_){return function({state:K,dispatch:Q}){if(!_&&K.readOnly)return!1;let ue=K.field(Et,!1);if(!ue)return!1;let ae=ue.pop(w,K,_);return ae?(Q(ae),!0):!1}}const Qt=Xt(0,!1),Kt=Xt(1,!1),pt=Xt(0,!0),Vt=Xt(1,!0);function qe(w){return function(_){let K=_.field(Et,!1);if(!K)return 0;let Q=w==0?K.done:K.undone;return Q.length-(Q.length&&!Q[0].changes?1:0)}}const Mt=qe(0),Je=qe(1);class we{constructor(_,K,Q,ue,ae){this.changes=_,this.effects=K,this.mapped=Q,this.startSelection=ue,this.selectionsAfter=ae}setSelAfter(_){return new we(this.changes,this.effects,this.mapped,this.startSelection,_)}toJSON(){var _,K,Q;return{changes:(_=this.changes)===null||_===void 0?void 0:_.toJSON(),mapped:(K=this.mapped)===null||K===void 0?void 0:K.toJSON(),startSelection:(Q=this.startSelection)===null||Q===void 0?void 0:Q.toJSON(),selectionsAfter:this.selectionsAfter.map(ue=>ue.toJSON())}}static fromJSON(_){return new we(_.changes&&e.ChangeSet.fromJSON(_.changes),[],_.mapped&&e.ChangeDesc.fromJSON(_.mapped),_.startSelection&&e.EditorSelection.fromJSON(_.startSelection),_.selectionsAfter.map(e.EditorSelection.fromJSON))}static fromTransaction(_,K){let Q=st;for(let ue of _.startState.facet(ot)){let ae=ue(_);ae.length&&(Q=Q.concat(ae))}return!Q.length&&_.changes.empty?null:new we(_.changes.invert(_.startState.doc),Q,void 0,K||_.startState.selection,st)}static selection(_){return new we(void 0,st,void 0,void 0,_)}}function ze(w,_,K,Q){let ue=_+1>K+20?_-K-1:0,ae=w.slice(ue,_);return ae.push(Q),ae}function rt(w,_){let K=[],Q=!1;return w.iterChangedRanges((ue,ae)=>K.push(ue,ae)),_.iterChangedRanges((ue,ae,pe,Oe)=>{for(let Xe=0;Xe<K.length;){let Dt=K[Xe++],bt=K[Xe++];Oe>=Dt&&pe<=bt&&(Q=!0)}}),Q}function tt(w,_){return w.ranges.length==_.ranges.length&&w.ranges.filter((K,Q)=>K.empty!=_.ranges[Q].empty).length===0}function Ye(w,_){return w.length?_.length?w.concat(_):w:_}const st=[],Nt=200;function jt(w,_){if(w.length){let K=w[w.length-1],Q=K.selectionsAfter.slice(Math.max(0,K.selectionsAfter.length-Nt));return Q.length&&Q[Q.length-1].eq(_)?w:(Q.push(_),ze(w,w.length-1,1e9,K.setSelAfter(Q)))}else return[we.selection([_])]}function Ct(w){let _=w[w.length-1],K=w.slice();return K[w.length-1]=_.setSelAfter(_.selectionsAfter.slice(0,_.selectionsAfter.length-1)),K}function yt(w,_){if(!w.length)return w;let K=w.length,Q=st;for(;K;){let ue=wt(w[K-1],_,Q);if(ue.changes&&!ue.changes.empty||ue.effects.length){let ae=w.slice(0,K);return ae[K-1]=ue,ae}else _=ue.mapped,K--,Q=ue.selectionsAfter}return Q.length?[we.selection(Q)]:st}function wt(w,_,K){let Q=Ye(w.selectionsAfter.length?w.selectionsAfter.map(Oe=>Oe.map(_)):st,K);if(!w.changes)return we.selection(Q);let ue=w.changes.map(_),ae=_.mapDesc(w.changes,!0),pe=w.mapped?w.mapped.composeDesc(ae):ae;return new we(ue,e.StateEffect.mapEffects(w.effects,_),pe,w.startSelection.map(ae),Q)}const Pt=/^(input\.type|delete)($|\.)/;class It{constructor(_,K,Q=0,ue=void 0){this.done=_,this.undone=K,this.prevTime=Q,this.prevUserEvent=ue}isolate(){return this.prevTime?new It(this.done,this.undone):this}addChanges(_,K,Q,ue,ae){let pe=this.done,Oe=pe[pe.length-1];return Oe&&Oe.changes&&!Oe.changes.empty&&_.changes&&(!Q||Pt.test(Q))&&(!Oe.selectionsAfter.length&&K-this.prevTime<ue.newGroupDelay&&ue.joinToEvent(ae,rt(Oe.changes,_.changes))||Q=="input.type.compose")?pe=ze(pe,pe.length-1,ue.minDepth,new we(_.changes.compose(Oe.changes),Ye(e.StateEffect.mapEffects(_.effects,Oe.changes),Oe.effects),Oe.mapped,Oe.startSelection,st)):pe=ze(pe,pe.length,ue.minDepth,_),new It(pe,st,K,Q)}addSelection(_,K,Q,ue){let ae=this.done.length?this.done[this.done.length-1].selectionsAfter:st;return ae.length>0&&K-this.prevTime<ue&&Q==this.prevUserEvent&&Q&&/^select($|\.)/.test(Q)&&tt(ae[ae.length-1],_)?this:new It(jt(this.done,_),this.undone,K,Q)}addMapping(_){return new It(yt(this.done,_),yt(this.undone,_),this.prevTime,this.prevUserEvent)}pop(_,K,Q){let ue=_==0?this.done:this.undone;if(ue.length==0)return null;let ae=ue[ue.length-1],pe=ae.selectionsAfter[0]||K.selection;if(Q&&ae.selectionsAfter.length)return K.update({selection:ae.selectionsAfter[ae.selectionsAfter.length-1],annotations:Ge.of({side:_,rest:Ct(ue),selection:pe}),userEvent:_==0?"select.undo":"select.redo",scrollIntoView:!0});if(ae.changes){let Oe=ue.length==1?st:ue.slice(0,ue.length-1);return ae.mapped&&(Oe=yt(Oe,ae.mapped)),K.update({changes:ae.changes,selection:ae.startSelection,effects:ae.effects,annotations:Ge.of({side:_,rest:Oe,selection:pe}),filter:!1,userEvent:_==0?"undo":"redo",scrollIntoView:!0})}else return null}}It.empty=new It(st,st);const gn=[{key:"Mod-z",run:Qt,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Kt,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Kt,preventDefault:!0},{key:"Mod-u",run:pt,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Vt,preventDefault:!0}];function sn(w,_){return e.EditorSelection.create(w.ranges.map(_),w.mainIndex)}function oe(w,_){return w.update({selection:_,scrollIntoView:!0,userEvent:"select"})}function b({state:w,dispatch:_},K){let Q=sn(w.selection,K);return Q.eq(w.selection,!0)?!1:(_(oe(w,Q)),!0)}function T(w,_){return e.EditorSelection.cursor(_?w.to:w.from)}function L(w,_){return b(w,K=>K.empty?w.moveByChar(K,_):T(K,_))}function O(w){return w.textDirectionAt(w.state.selection.main.head)==n.Direction.LTR}const H=w=>L(w,!O(w)),re=w=>L(w,O(w)),me=w=>L(w,!0),Ee=w=>L(w,!1);function Fe(w,_,K){let Q=_.head,ue=w.doc.lineAt(Q);return Q==(K?ue.to:ue.from)?Q=K?Math.min(w.doc.length,ue.to+1):Math.max(0,ue.from-1):Q=ue.from+e.findClusterBreak(ue.text,Q-ue.from,K),e.EditorSelection.cursor(Q,K?-1:1)}function Be(w,_){return b(w,K=>K.empty?Fe(w.state,K,_):T(K,_))}const Ue=w=>Be(w,!0),He=w=>Be(w,!1);function Ze(w,_){return b(w,K=>K.empty?w.moveByGroup(K,_):T(K,_))}const lt=w=>Ze(w,!O(w)),qt=w=>Ze(w,O(w)),gt=w=>Ze(w,!0),kt=w=>Ze(w,!1);function ht(w,_,K){let Q=w.state.charCategorizer(_),ue=Q(K),ae=ue!=e.CharCategory.Space;return pe=>{let Oe=Q(pe);return Oe!=e.CharCategory.Space?ae&&Oe==ue:(ae=!1,!0)}}const Ft=w=>b(w,_=>_.empty?w.moveByChar(_,!0,K=>ht(w,_.head,K)):T(_,!0)),en=typeof Intl<"u"&&Intl.Segmenter?new Intl.Segmenter(void 0,{granularity:"word"}):null;function At(w,_,K){let Q=w.state.charCategorizer(_.from),ue=e.CharCategory.Space,ae=_.from,pe=0,Oe=!1,Xe=!1,Dt=!1,bt=vn=>{if(Oe)return!1;ae+=K?vn.length:-vn.length;let Cn=Q(vn),bn;if(Cn==e.CharCategory.Word&&vn.charCodeAt(0)<128&&/[\W_]/.test(vn)&&(Cn=-1),ue==e.CharCategory.Space&&(ue=Cn),ue!=Cn)return!1;if(ue==e.CharCategory.Word)if(vn.toLowerCase()==vn){if(!K&&Xe)return!1;Dt=!0}else if(Dt){if(K)return!1;Oe=!0}else{if(Xe&&K&&Q(bn=w.state.sliceDoc(ae,ae+1))==e.CharCategory.Word&&bn.toLowerCase()==bn)return!1;Xe=!0}return pe++,!0},tn=w.moveByChar(_,K,vn=>(bt(vn),bt));if(en&&ue==e.CharCategory.Word&&tn.from==_.from+pe*(K?1:-1)){let vn=Math.min(_.head,tn.head),Cn=Math.max(_.head,tn.head),bn=w.state.sliceDoc(vn,Cn);if(bn.length>1&&/[\u4E00-\uffff]/.test(bn)){let Wi=Array.from(en.segment(bn));if(Wi.length>1)return K?e.EditorSelection.cursor(_.head+Wi[1].index,-1):e.EditorSelection.cursor(tn.head+Wi[Wi.length-1].index,1)}}return tn}function Lt(w,_){return b(w,K=>K.empty?At(w,K,_):T(K,_))}const J=w=>Lt(w,!0),j=w=>Lt(w,!1);function G(w,_,K){if(_.type.prop(K))return!0;let Q=_.to-_.from;return Q&&(Q>2||/[^\s,.;:]/.test(w.sliceDoc(_.from,_.to)))||_.firstChild}function se(w,_,K){let Q=r.syntaxTree(w).resolveInner(_.head),ue=K?o.NodeProp.closedBy:o.NodeProp.openedBy;for(let Xe=_.head;;){let Dt=K?Q.childAfter(Xe):Q.childBefore(Xe);if(!Dt)break;G(w,Dt,ue)?Q=Dt:Xe=K?Dt.to:Dt.from}let ae=Q.type.prop(ue),pe,Oe;return ae&&(pe=K?r.matchBrackets(w,Q.from,1):r.matchBrackets(w,Q.to,-1))&&pe.matched?Oe=K?pe.end.to:pe.end.from:Oe=K?Q.to:Q.from,e.EditorSelection.cursor(Oe,K?-1:1)}const le=w=>b(w,_=>se(w.state,_,!O(w))),fe=w=>b(w,_=>se(w.state,_,O(w)));function Ie(w,_){return b(w,K=>{if(!K.empty)return T(K,_);let Q=w.moveVertically(K,_);return Q.head!=K.head?Q:w.moveToLineBoundary(K,_)})}const _e=w=>Ie(w,!1),Pe=w=>Ie(w,!0);function Rt(w){let _=w.scrollDOM.clientHeight<w.scrollDOM.scrollHeight-2,K=0,Q=0,ue;if(_){for(let ae of w.state.facet(n.EditorView.scrollMargins)){let pe=ae(w);pe?.top&&(K=Math.max(pe?.top,K)),pe?.bottom&&(Q=Math.max(pe?.bottom,Q))}ue=w.scrollDOM.clientHeight-K-Q}else ue=(w.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:K,marginBottom:Q,selfScroll:_,height:Math.max(w.defaultLineHeight,ue-5)}}function Ut(w,_){let K=Rt(w),{state:Q}=w,ue=sn(Q.selection,pe=>pe.empty?w.moveVertically(pe,_,K.height):T(pe,_));if(ue.eq(Q.selection))return!1;let ae;if(K.selfScroll){let pe=w.coordsAtPos(Q.selection.main.head),Oe=w.scrollDOM.getBoundingClientRect(),Xe=Oe.top+K.marginTop,Dt=Oe.bottom-K.marginBottom;pe&&pe.top>Xe&&pe.bottom<Dt&&(ae=n.EditorView.scrollIntoView(ue.main.head,{y:"start",yMargin:pe.top-Xe}))}return w.dispatch(oe(Q,ue),{effects:ae}),!0}const cn=w=>Ut(w,!1),yn=w=>Ut(w,!0);function un(w,_,K){let Q=w.lineBlockAt(_.head),ue=w.moveToLineBoundary(_,K);if(ue.head==_.head&&ue.head!=(K?Q.to:Q.from)&&(ue=w.moveToLineBoundary(_,K,!1)),!K&&ue.head==Q.from&&Q.length){let ae=/^\s*/.exec(w.state.sliceDoc(Q.from,Math.min(Q.from+100,Q.to)))[0].length;ae&&_.head!=Q.from+ae&&(ue=e.EditorSelection.cursor(Q.from+ae))}return ue}const $t=w=>b(w,_=>un(w,_,!0)),Ht=w=>b(w,_=>un(w,_,!1)),pn=w=>b(w,_=>un(w,_,!O(w))),dn=w=>b(w,_=>un(w,_,O(w))),On=w=>b(w,_=>e.EditorSelection.cursor(w.lineBlockAt(_.head).from,1)),Ot=w=>b(w,_=>e.EditorSelection.cursor(w.lineBlockAt(_.head).to,-1));function Xn(w,_,K){let Q=!1,ue=sn(w.selection,ae=>{let pe=r.matchBrackets(w,ae.head,-1)||r.matchBrackets(w,ae.head,1)||ae.head>0&&r.matchBrackets(w,ae.head-1,1)||ae.head<w.doc.length&&r.matchBrackets(w,ae.head+1,-1);if(!pe||!pe.end)return ae;Q=!0;let Oe=pe.start.from==ae.head?pe.end.to:pe.end.from;return K?e.EditorSelection.range(ae.anchor,Oe):e.EditorSelection.cursor(Oe)});return Q?(_(oe(w,ue)),!0):!1}const Ei=({state:w,dispatch:_})=>Xn(w,_,!1),Ai=({state:w,dispatch:_})=>Xn(w,_,!0);function q(w,_){let K=sn(w.state.selection,Q=>{let ue=_(Q);return e.EditorSelection.range(Q.anchor,ue.head,ue.goalColumn,ue.bidiLevel||void 0)});return K.eq(w.state.selection)?!1:(w.dispatch(oe(w.state,K)),!0)}function f(w,_){return q(w,K=>w.moveByChar(K,_))}const m=w=>f(w,!O(w)),E=w=>f(w,O(w)),C=w=>f(w,!0),B=w=>f(w,!1),V=w=>q(w,_=>Fe(w.state,_,!0)),ee=w=>q(w,_=>Fe(w.state,_,!1));function ce(w,_){return q(w,K=>w.moveByGroup(K,_))}const Te=w=>ce(w,!O(w)),De=w=>ce(w,O(w)),je=w=>ce(w,!0),nt=w=>ce(w,!1),it=w=>q(w,_=>w.moveByChar(_,!0,K=>ht(w,_.head,K)));function zt(w,_){return q(w,K=>At(w,K,_))}const An=w=>zt(w,!0),on=w=>zt(w,!1),Zn=w=>q(w,_=>se(w.state,_,!O(w))),wi=w=>q(w,_=>se(w.state,_,O(w)));function ei(w,_){return q(w,K=>w.moveVertically(K,_))}const si=w=>ei(w,!1),ki=w=>ei(w,!0);function U(w,_){return q(w,K=>w.moveVertically(K,_,Rt(w).height))}const x=w=>U(w,!1),M=w=>U(w,!0),S=w=>q(w,_=>un(w,_,!0)),d=w=>q(w,_=>un(w,_,!1)),g=w=>q(w,_=>un(w,_,!O(w))),A=w=>q(w,_=>un(w,_,O(w))),P=w=>q(w,_=>e.EditorSelection.cursor(w.lineBlockAt(_.head).from)),$=w=>q(w,_=>e.EditorSelection.cursor(w.lineBlockAt(_.head).to)),X=({state:w,dispatch:_})=>(_(oe(w,{anchor:0})),!0),he=({state:w,dispatch:_})=>(_(oe(w,{anchor:w.doc.length})),!0),ge=({state:w,dispatch:_})=>(_(oe(w,{anchor:w.selection.main.anchor,head:0})),!0),Re=({state:w,dispatch:_})=>(_(oe(w,{anchor:w.selection.main.anchor,head:w.doc.length})),!0),mt=({state:w,dispatch:_})=>(_(w.update({selection:{anchor:0,head:w.doc.length},userEvent:"select"})),!0),Bt=({state:w,dispatch:_})=>{let K=Ri(w).map(({from:Q,to:ue})=>e.EditorSelection.range(Q,Math.min(ue+1,w.doc.length)));return _(w.update({selection:e.EditorSelection.create(K),userEvent:"select"})),!0},ln=({state:w,dispatch:_})=>{let K=sn(w.selection,Q=>{let ue=r.syntaxTree(w),ae=ue.resolveStack(Q.from,1);if(Q.empty){let pe=ue.resolveStack(Q.from,-1);pe.node.from>=ae.node.from&&pe.node.to<=ae.node.to&&(ae=pe)}for(let pe=ae;pe;pe=pe.next){let{node:Oe}=pe;if((Oe.from<Q.from&&Oe.to>=Q.to||Oe.to>Q.to&&Oe.from<=Q.from)&&pe.next)return e.EditorSelection.range(Oe.to,Oe.from)}return Q});return K.eq(w.selection)?!1:(_(oe(w,K)),!0)},mn=({state:w,dispatch:_})=>{let K=w.selection,Q=null;return K.ranges.length>1?Q=e.EditorSelection.create([K.main]):K.main.empty||(Q=e.EditorSelection.create([e.EditorSelection.cursor(K.main.head)])),Q?(_(oe(w,Q)),!0):!1};function Dn(w,_){if(w.state.readOnly)return!1;let K="delete.selection",{state:Q}=w,ue=Q.changeByRange(ae=>{let{from:pe,to:Oe}=ae;if(pe==Oe){let Xe=_(ae);Xe<pe?(K="delete.backward",Xe=Zt(w,Xe,!1)):Xe>pe&&(K="delete.forward",Xe=Zt(w,Xe,!0)),pe=Math.min(pe,Xe),Oe=Math.max(Oe,Xe)}else pe=Zt(w,pe,!1),Oe=Zt(w,Oe,!0);return pe==Oe?{range:ae}:{changes:{from:pe,to:Oe},range:e.EditorSelection.cursor(pe,pe<ae.head?-1:1)}});return ue.changes.empty?!1:(w.dispatch(Q.update(ue,{scrollIntoView:!0,userEvent:K,effects:K=="delete.selection"?n.EditorView.announce.of(Q.phrase("Selection deleted")):void 0})),!0)}function Zt(w,_,K){if(w instanceof n.EditorView)for(let Q of w.state.facet(n.EditorView.atomicRanges).map(ue=>ue(w)))Q.between(_,_,(ue,ae)=>{ue<_&&ae>_&&(_=K?ae:ue)});return _}const ti=(w,_,K)=>Dn(w,Q=>{let ue=Q.from,{state:ae}=w,pe=ae.doc.lineAt(ue),Oe,Xe;if(K&&!_&&ue>pe.from&&ue<pe.from+200&&!/[^ \t]/.test(Oe=pe.text.slice(0,ue-pe.from))){if(Oe[Oe.length-1]=="	")return ue-1;let Dt=e.countColumn(Oe,ae.tabSize),bt=Dt%r.getIndentUnit(ae)||r.getIndentUnit(ae);for(let tn=0;tn<bt&&Oe[Oe.length-1-tn]==" ";tn++)ue--;Xe=ue}else Xe=e.findClusterBreak(pe.text,ue-pe.from,_,_)+pe.from,Xe==ue&&pe.number!=(_?ae.doc.lines:1)?Xe+=_?1:-1:!_&&/[\ufe00-\ufe0f]/.test(pe.text.slice(Xe-pe.from,ue-pe.from))&&(Xe=e.findClusterBreak(pe.text,Xe-pe.from,!1,!1)+pe.from);return Xe}),Mn=w=>ti(w,!1,!0),$n=w=>ti(w,!1,!1),xi=w=>ti(w,!0,!1),_i=(w,_)=>Dn(w,K=>{let Q=K.head,{state:ue}=w,ae=ue.doc.lineAt(Q),pe=ue.charCategorizer(Q);for(let Oe=null;;){if(Q==(_?ae.to:ae.from)){Q==K.head&&ae.number!=(_?ue.doc.lines:1)&&(Q+=_?1:-1);break}let Xe=e.findClusterBreak(ae.text,Q-ae.from,_)+ae.from,Dt=ae.text.slice(Math.min(Q,Xe)-ae.from,Math.max(Q,Xe)-ae.from),bt=pe(Dt);if(Oe!=null&&bt!=Oe)break;(Dt!=" "||Q!=K.head)&&(Oe=bt),Q=Xe}return Q}),Or=w=>_i(w,!1),ps=w=>_i(w,!0),ms=w=>Dn(w,_=>{let K=w.lineBlockAt(_.head).to;return _.head<K?K:Math.min(w.state.doc.length,_.head+1)}),No=w=>Dn(w,_=>{let K=w.lineBlockAt(_.head).from;return _.head>K?K:Math.max(0,_.head-1)}),gs=w=>Dn(w,_=>{let K=w.moveToLineBoundary(_,!1).head;return _.head>K?K:Math.max(0,_.head-1)}),ys=w=>Dn(w,_=>{let K=w.moveToLineBoundary(_,!0).head;return _.head<K?K:Math.min(w.state.doc.length,_.head+1)}),Mr=({state:w,dispatch:_})=>{if(w.readOnly)return!1;let K=[];for(let Q=0,ue="",ae=w.doc.iter();;){if(ae.next(),ae.lineBreak||ae.done){let pe=ue.search(/\s+$/);if(pe>-1&&K.push({from:Q-(ue.length-pe),to:Q}),ae.done)break;ue=""}else ue=ae.value;Q+=ae.value.length}return K.length?(_(w.update({changes:K,userEvent:"delete"})),!0):!1},Lr=({state:w,dispatch:_})=>{if(w.readOnly)return!1;let K=w.changeByRange(Q=>({changes:{from:Q.from,to:Q.to,insert:e.Text.of(["",""])},range:e.EditorSelection.cursor(Q.from)}));return _(w.update(K,{scrollIntoView:!0,userEvent:"input"})),!0},_r=({state:w,dispatch:_})=>{if(w.readOnly)return!1;let K=w.changeByRange(Q=>{if(!Q.empty||Q.from==0||Q.from==w.doc.length)return{range:Q};let ue=Q.from,ae=w.doc.lineAt(ue),pe=ue==ae.from?ue-1:e.findClusterBreak(ae.text,ue-ae.from,!1)+ae.from,Oe=ue==ae.to?ue+1:e.findClusterBreak(ae.text,ue-ae.from,!0)+ae.from;return{changes:{from:pe,to:Oe,insert:w.doc.slice(ue,Oe).append(w.doc.slice(pe,ue))},range:e.EditorSelection.cursor(Oe)}});return K.changes.empty?!1:(_(w.update(K,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Ri(w){let _=[],K=-1;for(let Q of w.selection.ranges){let ue=w.doc.lineAt(Q.from),ae=w.doc.lineAt(Q.to);if(!Q.empty&&Q.to==ae.from&&(ae=w.doc.lineAt(Q.to-1)),K>=ue.number){let pe=_[_.length-1];pe.to=ae.to,pe.ranges.push(Q)}else _.push({from:ue.from,to:ae.to,ranges:[Q]});K=ae.number+1}return _}function Rr(w,_,K){if(w.readOnly)return!1;let Q=[],ue=[];for(let ae of Ri(w)){if(K?ae.to==w.doc.length:ae.from==0)continue;let pe=w.doc.lineAt(K?ae.to+1:ae.from-1),Oe=pe.length+1;if(K){Q.push({from:ae.to,to:pe.to},{from:ae.from,insert:pe.text+w.lineBreak});for(let Xe of ae.ranges)ue.push(e.EditorSelection.range(Math.min(w.doc.length,Xe.anchor+Oe),Math.min(w.doc.length,Xe.head+Oe)))}else{Q.push({from:pe.from,to:ae.from},{from:ae.to,insert:w.lineBreak+pe.text});for(let Xe of ae.ranges)ue.push(e.EditorSelection.range(Xe.anchor-Oe,Xe.head-Oe))}}return Q.length?(_(w.update({changes:Q,scrollIntoView:!0,selection:e.EditorSelection.create(ue,w.selection.mainIndex),userEvent:"move.line"})),!0):!1}const Fr=({state:w,dispatch:_})=>Rr(w,_,!1),Pr=({state:w,dispatch:_})=>Rr(w,_,!0);function vs(w,_,K){if(w.readOnly)return!1;let Q=[];for(let ue of Ri(w))K?Q.push({from:ue.from,insert:w.doc.slice(ue.from,ue.to)+w.lineBreak}):Q.push({from:ue.to,insert:w.lineBreak+w.doc.slice(ue.from,ue.to)});return _(w.update({changes:Q,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const bs=({state:w,dispatch:_})=>vs(w,_,!1),rr=({state:w,dispatch:_})=>vs(w,_,!0),Ss=w=>{if(w.state.readOnly)return!1;let{state:_}=w,K=_.changes(Ri(_).map(({from:ue,to:ae})=>(ue>0?ue--:ae<_.doc.length&&ae++,{from:ue,to:ae}))),Q=sn(_.selection,ue=>{let ae;if(w.lineWrapping){let pe=w.lineBlockAt(ue.head),Oe=w.coordsAtPos(ue.head,ue.assoc||1);Oe&&(ae=pe.bottom+w.documentTop-Oe.bottom+w.defaultLineHeight/2)}return w.moveVertically(ue,!0,ae)}).map(K);return w.dispatch({changes:K,selection:Q,scrollIntoView:!0,userEvent:"delete.line"}),!0},Ts=({state:w,dispatch:_})=>(_(w.update(w.replaceSelection(w.lineBreak),{scrollIntoView:!0,userEvent:"input"})),!0),Co=({state:w,dispatch:_})=>(_(w.update(w.changeByRange(K=>{let Q=/^\s*/.exec(w.doc.lineAt(K.from).text)[0];return{changes:{from:K.from,to:K.to,insert:w.lineBreak+Q},range:e.EditorSelection.cursor(K.from+Q.length+1)}}),{scrollIntoView:!0,userEvent:"input"})),!0);function Ao(w,_){if(/\(\)|\[\]|\{\}/.test(w.sliceDoc(_-1,_+1)))return{from:_,to:_};let K=r.syntaxTree(w).resolveInner(_),Q=K.childBefore(_),ue=K.childAfter(_),ae;return Q&&ue&&Q.to<=_&&ue.from>=_&&(ae=Q.type.prop(o.NodeProp.closedBy))&&ae.indexOf(ue.name)>-1&&w.doc.lineAt(Q.to).from==w.doc.lineAt(ue.from).from&&!/\S/.test(w.sliceDoc(Q.to,ue.from))?{from:Q.to,to:ue.from}:null}const Fi=Pi(!1),sr=Pi(!0);function Pi(w){return({state:_,dispatch:K})=>{if(_.readOnly)return!1;let Q=_.changeByRange(ue=>{let{from:ae,to:pe}=ue,Oe=_.doc.lineAt(ae),Xe=!w&&ae==pe&&Ao(_,ae);w&&(ae=pe=(pe<=Oe.to?Oe:_.doc.lineAt(pe)).to);let Dt=new r.IndentContext(_,{simulateBreak:ae,simulateDoubleBreak:!!Xe}),bt=r.getIndentation(Dt,ae);for(bt==null&&(bt=e.countColumn(/^\s*/.exec(_.doc.lineAt(ae).text)[0],_.tabSize));pe<Oe.to&&/\s/.test(Oe.text[pe-Oe.from]);)pe++;Xe?{from:ae,to:pe}=Xe:ae>Oe.from&&ae<Oe.from+100&&!/\S/.test(Oe.text.slice(0,ae))&&(ae=Oe.from);let tn=["",r.indentString(_,bt)];return Xe&&tn.push(r.indentString(_,Dt.lineIndent(Oe.from,-1))),{changes:{from:ae,to:pe,insert:e.Text.of(tn)},range:e.EditorSelection.cursor(ae+1+tn[1].length)}});return K(_.update(Q,{scrollIntoView:!0,userEvent:"input"})),!0}}function Br(w,_){let K=-1;return w.changeByRange(Q=>{let ue=[];for(let pe=Q.from;pe<=Q.to;){let Oe=w.doc.lineAt(pe);Oe.number>K&&(Q.empty||Q.to>Oe.from)&&(_(Oe,ue,Q),K=Oe.number),pe=Oe.to+1}let ae=w.changes(ue);return{changes:ue,range:e.EditorSelection.range(ae.mapPos(Q.anchor,1),ae.mapPos(Q.head,1))}})}const Es=({state:w,dispatch:_})=>{if(w.readOnly)return!1;let K=Object.create(null),Q=new r.IndentContext(w,{overrideIndentation:ae=>{let pe=K[ae];return pe??-1}}),ue=Br(w,(ae,pe,Oe)=>{let Xe=r.getIndentation(Q,ae.from);if(Xe==null)return;/\S/.test(ae.text)||(Xe=0);let Dt=/^\s*/.exec(ae.text)[0],bt=r.indentString(w,Xe);(Dt!=bt||Oe.from<ae.from+Dt.length)&&(K[ae.from]=Xe,pe.push({from:ae.from,to:ae.from+Dt.length,insert:bt}))});return ue.changes.empty||_(w.update(ue,{userEvent:"indent"})),!0},Hi=({state:w,dispatch:_})=>w.readOnly?!1:(_(w.update(Br(w,(K,Q)=>{Q.push({from:K.from,insert:w.facet(r.indentUnit)})}),{userEvent:"input.indent"})),!0),Vr=({state:w,dispatch:_})=>w.readOnly?!1:(_(w.update(Br(w,(K,Q)=>{let ue=/^\s*/.exec(K.text)[0];if(!ue)return;let ae=e.countColumn(ue,w.tabSize),pe=0,Oe=r.indentString(w,Math.max(0,ae-r.getIndentUnit(w)));for(;pe<ue.length&&pe<Oe.length&&ue.charCodeAt(pe)==Oe.charCodeAt(pe);)pe++;Q.push({from:K.from+pe,to:K.from+ue.length,insert:Oe.slice(pe)})}),{userEvent:"delete.dedent"})),!0),jr=w=>(w.setTabFocusMode(),!0),Ur=w=>(w.setTabFocusMode(2e3),!0),Do=({state:w,dispatch:_})=>w.selection.ranges.some(K=>!K.empty)?Hi({state:w,dispatch:_}):(_(w.update(w.replaceSelection("	"),{scrollIntoView:!0,userEvent:"input"})),!0),ws=[{key:"Ctrl-b",run:H,shift:m,preventDefault:!0},{key:"Ctrl-f",run:re,shift:E},{key:"Ctrl-p",run:_e,shift:si},{key:"Ctrl-n",run:Pe,shift:ki},{key:"Ctrl-a",run:On,shift:P},{key:"Ctrl-e",run:Ot,shift:$},{key:"Ctrl-d",run:xi},{key:"Ctrl-h",run:Mn},{key:"Ctrl-k",run:ms},{key:"Ctrl-Alt-h",run:Or},{key:"Ctrl-o",run:Lr},{key:"Ctrl-t",run:_r},{key:"Ctrl-v",run:yn}],ks=[{key:"ArrowLeft",run:H,shift:m,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:lt,shift:Te,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:pn,shift:g,preventDefault:!0},{key:"ArrowRight",run:re,shift:E,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:qt,shift:De,preventDefault:!0},{mac:"Cmd-ArrowRight",run:dn,shift:A,preventDefault:!0},{key:"ArrowUp",run:_e,shift:si,preventDefault:!0},{mac:"Cmd-ArrowUp",run:X,shift:ge},{mac:"Ctrl-ArrowUp",run:cn,shift:x},{key:"ArrowDown",run:Pe,shift:ki,preventDefault:!0},{mac:"Cmd-ArrowDown",run:he,shift:Re},{mac:"Ctrl-ArrowDown",run:yn,shift:M},{key:"PageUp",run:cn,shift:x},{key:"PageDown",run:yn,shift:M},{key:"Home",run:Ht,shift:d,preventDefault:!0},{key:"Mod-Home",run:X,shift:ge},{key:"End",run:$t,shift:S,preventDefault:!0},{key:"Mod-End",run:he,shift:Re},{key:"Enter",run:Fi,shift:Fi},{key:"Mod-a",run:mt},{key:"Backspace",run:Mn,shift:Mn},{key:"Delete",run:xi},{key:"Mod-Backspace",mac:"Alt-Backspace",run:Or},{key:"Mod-Delete",mac:"Alt-Delete",run:ps},{mac:"Mod-Backspace",run:gs},{mac:"Mod-Delete",run:ys}].concat(ws.map(w=>({mac:w.key,run:w.run,shift:w.shift}))),Io=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:le,shift:Zn},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:fe,shift:wi},{key:"Alt-ArrowUp",run:Fr},{key:"Shift-Alt-ArrowUp",run:bs},{key:"Alt-ArrowDown",run:Pr},{key:"Shift-Alt-ArrowDown",run:rr},{key:"Escape",run:mn},{key:"Mod-Enter",run:sr},{key:"Alt-l",mac:"Ctrl-l",run:Bt},{key:"Mod-i",run:ln,preventDefault:!0},{key:"Mod-[",run:Vr},{key:"Mod-]",run:Hi},{key:"Mod-Alt-\\",run:Es},{key:"Shift-Mod-k",run:Ss},{key:"Shift-Mod-\\",run:Ei},{key:"Mod-/",run:l},{key:"Alt-A",run:R},{key:"Ctrl-m",mac:"Shift-Alt-m",run:jr}].concat(ks),Oo={key:"Tab",run:Hi,shift:Vr};return Me.blockComment=W,Me.blockUncomment=z,Me.copyLineDown=rr,Me.copyLineUp=bs,Me.cursorCharBackward=Ee,Me.cursorCharBackwardLogical=He,Me.cursorCharForward=me,Me.cursorCharForwardLogical=Ue,Me.cursorCharLeft=H,Me.cursorCharRight=re,Me.cursorDocEnd=he,Me.cursorDocStart=X,Me.cursorGroupBackward=kt,Me.cursorGroupForward=gt,Me.cursorGroupForwardWin=Ft,Me.cursorGroupLeft=lt,Me.cursorGroupRight=qt,Me.cursorLineBoundaryBackward=Ht,Me.cursorLineBoundaryForward=$t,Me.cursorLineBoundaryLeft=pn,Me.cursorLineBoundaryRight=dn,Me.cursorLineDown=Pe,Me.cursorLineEnd=Ot,Me.cursorLineStart=On,Me.cursorLineUp=_e,Me.cursorMatchingBracket=Ei,Me.cursorPageDown=yn,Me.cursorPageUp=cn,Me.cursorSubwordBackward=j,Me.cursorSubwordForward=J,Me.cursorSyntaxLeft=le,Me.cursorSyntaxRight=fe,Me.defaultKeymap=Io,Me.deleteCharBackward=Mn,Me.deleteCharBackwardStrict=$n,Me.deleteCharForward=xi,Me.deleteGroupBackward=Or,Me.deleteGroupForward=ps,Me.deleteLine=Ss,Me.deleteLineBoundaryBackward=gs,Me.deleteLineBoundaryForward=ys,Me.deleteToLineEnd=ms,Me.deleteToLineStart=No,Me.deleteTrailingWhitespace=Mr,Me.emacsStyleKeymap=ws,Me.history=ut,Me.historyField=rn,Me.historyKeymap=gn,Me.indentLess=Vr,Me.indentMore=Hi,Me.indentSelection=Es,Me.indentWithTab=Oo,Me.insertBlankLine=sr,Me.insertNewline=Ts,Me.insertNewlineAndIndent=Fi,Me.insertNewlineKeepIndent=Co,Me.insertTab=Do,Me.invertedEffects=ot,Me.isolateHistory=We,Me.lineComment=N,Me.lineUncomment=D,Me.moveLineDown=Pr,Me.moveLineUp=Fr,Me.redo=Kt,Me.redoDepth=Je,Me.redoSelection=Vt,Me.selectAll=mt,Me.selectCharBackward=B,Me.selectCharBackwardLogical=ee,Me.selectCharForward=C,Me.selectCharForwardLogical=V,Me.selectCharLeft=m,Me.selectCharRight=E,Me.selectDocEnd=Re,Me.selectDocStart=ge,Me.selectGroupBackward=nt,Me.selectGroupForward=je,Me.selectGroupForwardWin=it,Me.selectGroupLeft=Te,Me.selectGroupRight=De,Me.selectLine=Bt,Me.selectLineBoundaryBackward=d,Me.selectLineBoundaryForward=S,Me.selectLineBoundaryLeft=g,Me.selectLineBoundaryRight=A,Me.selectLineDown=ki,Me.selectLineEnd=$,Me.selectLineStart=P,Me.selectLineUp=si,Me.selectMatchingBracket=Ai,Me.selectPageDown=M,Me.selectPageUp=x,Me.selectParentSyntax=ln,Me.selectSubwordBackward=on,Me.selectSubwordForward=An,Me.selectSyntaxLeft=Zn,Me.selectSyntaxRight=wi,Me.simplifySelection=mn,Me.splitLine=Lr,Me.standardKeymap=ks,Me.temporarilySetTabFocusMode=Ur,Me.toggleBlockComment=R,Me.toggleBlockCommentByLine=ne,Me.toggleComment=l,Me.toggleLineComment=y,Me.toggleTabFocusMode=jr,Me.transposeChars=_r,Me.undo=Qt,Me.undoDepth=Mt,Me.undoSelection=pt,Me}var Ln={},gc;function hp(){if(gc)return Ln;gc=1;var e=Nr(),n=tr(),r=Vl();const o=typeof String.prototype.normalize=="function"?J=>J.normalize("NFKD"):J=>J;class l{constructor(j,G,se=0,le=j.length,fe,Ie){this.test=Ie,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=j.iterRange(se,le),this.bufferStart=se,this.normalize=fe?_e=>fe(o(_e)):o,this.query=this.normalize(G)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return n.codePointAt(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let j=this.peek();if(j<0)return this.done=!0,this;let G=n.fromCodePoint(j),se=this.bufferStart+this.bufferPos;this.bufferPos+=n.codePointSize(j);let le=this.normalize(G);if(le.length)for(let fe=0,Ie=se;;fe++){let _e=le.charCodeAt(fe),Pe=this.match(_e,Ie,this.bufferPos+this.bufferStart);if(fe==le.length-1){if(Pe)return this.value=Pe,this;break}Ie==se&&fe<G.length&&G.charCodeAt(fe)==_e&&Ie++}}}match(j,G,se){let le=null;for(let fe=0;fe<this.matches.length;fe+=2){let Ie=this.matches[fe],_e=!1;this.query.charCodeAt(Ie)==j&&(Ie==this.query.length-1?le={from:this.matches[fe+1],to:se}:(this.matches[fe]++,_e=!0)),_e||(this.matches.splice(fe,2),fe-=2)}return this.query.charCodeAt(0)==j&&(this.query.length==1?le={from:G,to:se}:this.matches.push(1,G)),le&&this.test&&!this.test(le.from,le.to,this.buffer,this.bufferStart)&&(le=null),le}}typeof Symbol<"u"&&(l.prototype[Symbol.iterator]=function(){return this});const h={from:-1,to:-1,match:/.*/.exec("")},y="gm"+(/x/.unicode==null?"":"u");class N{constructor(j,G,se,le=0,fe=j.length){if(this.text=j,this.to=fe,this.curLine="",this.done=!1,this.value=h,/\\[sWDnr]|\n|\r|\[\^/.test(G))return new W(j,G,se,le,fe);this.re=new RegExp(G,y+(se?.ignoreCase?"i":"")),this.test=se?.test,this.iter=j.iter();let Ie=j.lineAt(le);this.curLineStart=Ie.from,this.matchPos=ne(j,le),this.getLine(this.curLineStart)}getLine(j){this.iter.next(j),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let j=this.matchPos-this.curLineStart;;){this.re.lastIndex=j;let G=this.matchPos<=this.to&&this.re.exec(this.curLine);if(G){let se=this.curLineStart+G.index,le=se+G[0].length;if(this.matchPos=ne(this.text,le+(se==le?1:0)),se==this.curLineStart+this.curLine.length&&this.nextLine(),(se<le||se>this.value.to)&&(!this.test||this.test(se,le,G)))return this.value={from:se,to:le,match:G},this;j=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),j=0;else return this.done=!0,this}}}const D=new WeakMap;class R{constructor(j,G){this.from=j,this.text=G}get to(){return this.from+this.text.length}static get(j,G,se){let le=D.get(j);if(!le||le.from>=se||le.to<=G){let _e=new R(G,j.sliceString(G,se));return D.set(j,_e),_e}if(le.from==G&&le.to==se)return le;let{text:fe,from:Ie}=le;return Ie>G&&(fe=j.sliceString(G,Ie)+fe,Ie=G),le.to<se&&(fe+=j.sliceString(le.to,se)),D.set(j,new R(Ie,fe)),new R(G,fe.slice(G-Ie,se-Ie))}}class W{constructor(j,G,se,le,fe){this.text=j,this.to=fe,this.done=!1,this.value=h,this.matchPos=ne(j,le),this.re=new RegExp(G,y+(se?.ignoreCase?"i":"")),this.test=se?.test,this.flat=R.get(j,le,this.chunkEnd(le+5e3))}chunkEnd(j){return j>=this.to?this.to:this.text.lineAt(j).to}next(){for(;;){let j=this.re.lastIndex=this.matchPos-this.flat.from,G=this.re.exec(this.flat.text);if(G&&!G[0]&&G.index==j&&(this.re.lastIndex=j+1,G=this.re.exec(this.flat.text)),G){let se=this.flat.from+G.index,le=se+G[0].length;if((this.flat.to>=this.to||G.index+G[0].length<=this.flat.text.length-10)&&(!this.test||this.test(se,le,G)))return this.value={from:se,to:le,match:G},this.matchPos=ne(this.text,le+(se==le?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=R.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol<"u"&&(N.prototype[Symbol.iterator]=W.prototype[Symbol.iterator]=function(){return this});function z(J){try{return new RegExp(J,y),!0}catch{return!1}}function ne(J,j){if(j>=J.length)return j;let G=J.lineAt(j),se;for(;j<G.to&&(se=G.text.charCodeAt(j-G.from))>=56320&&se<57344;)j++;return j}function te(J){let j=String(J.state.doc.lineAt(J.state.selection.main.head).number),G=r("input",{class:"cm-textfield",name:"line",value:j}),se=r("form",{class:"cm-gotoLine",onkeydown:fe=>{fe.keyCode==27?(fe.preventDefault(),J.dispatch({effects:be.of(!1)}),J.focus()):fe.keyCode==13&&(fe.preventDefault(),le())},onsubmit:fe=>{fe.preventDefault(),le()}},r("label",J.state.phrase("Go to line"),": ",G)," ",r("button",{class:"cm-button",type:"submit"},J.state.phrase("go")),r("button",{name:"close",onclick:()=>{J.dispatch({effects:be.of(!1)}),J.focus()},"aria-label":J.state.phrase("close"),type:"button"},["Ã—"]));function le(){let fe=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(G.value);if(!fe)return;let{state:Ie}=J,_e=Ie.doc.lineAt(Ie.selection.main.head),[,Pe,Rt,Ut,cn]=fe,yn=Ut?+Ut.slice(1):0,un=Rt?+Rt:_e.number;if(Rt&&cn){let pn=un/100;Pe&&(pn=pn*(Pe=="-"?-1:1)+_e.number/Ie.doc.lines),un=Math.round(Ie.doc.lines*pn)}else Rt&&Pe&&(un=un*(Pe=="-"?-1:1)+_e.number);let $t=Ie.doc.line(Math.max(1,Math.min(Ie.doc.lines,un))),Ht=n.EditorSelection.cursor($t.from+Math.max(0,Math.min(yn,$t.length)));J.dispatch({effects:[be.of(!1),e.EditorView.scrollIntoView(Ht.from,{y:"center"})],selection:Ht}),J.focus()}return{dom:se}}const be=n.StateEffect.define(),Ne=n.StateField.define({create(){return!0},update(J,j){for(let G of j.effects)G.is(be)&&(J=G.value);return J},provide:J=>e.showPanel.from(J,j=>j?te:null)}),Se=J=>{let j=e.getPanel(J,te);if(!j){let G=[be.of(!0)];J.state.field(Ne,!1)==null&&G.push(n.StateEffect.appendConfig.of([Ne,xe])),J.dispatch({effects:G}),j=e.getPanel(J,te)}return j&&j.dom.querySelector("input").select(),!0},xe=e.EditorView.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px",position:"relative","& label":{fontSize:"80%"},"& [name=close]":{position:"absolute",top:"0",bottom:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:"0"}}}),Qe={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},Ge=n.Facet.define({combine(J){return n.combineConfig(J,Qe,{highlightWordAroundCursor:(j,G)=>j||G,minSelectionLength:Math.min,maxMatches:Math.min})}});function We(J){let j=[Xt,rn];return J&&j.push(Ge.of(J)),j}const ot=e.Decoration.mark({class:"cm-selectionMatch"}),ft=e.Decoration.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function Et(J,j,G,se){return(G==0||J(j.sliceDoc(G-1,G))!=n.CharCategory.Word)&&(se==j.doc.length||J(j.sliceDoc(se,se+1))!=n.CharCategory.Word)}function ut(J,j,G,se){return J(j.sliceDoc(G,G+1))==n.CharCategory.Word&&J(j.sliceDoc(se-1,se))==n.CharCategory.Word}const rn=e.ViewPlugin.fromClass(class{constructor(J){this.decorations=this.getDeco(J)}update(J){(J.selectionSet||J.docChanged||J.viewportChanged)&&(this.decorations=this.getDeco(J.view))}getDeco(J){let j=J.state.facet(Ge),{state:G}=J,se=G.selection;if(se.ranges.length>1)return e.Decoration.none;let le=se.main,fe,Ie=null;if(le.empty){if(!j.highlightWordAroundCursor)return e.Decoration.none;let Pe=G.wordAt(le.head);if(!Pe)return e.Decoration.none;Ie=G.charCategorizer(le.head),fe=G.sliceDoc(Pe.from,Pe.to)}else{let Pe=le.to-le.from;if(Pe<j.minSelectionLength||Pe>200)return e.Decoration.none;if(j.wholeWords){if(fe=G.sliceDoc(le.from,le.to),Ie=G.charCategorizer(le.head),!(Et(Ie,G,le.from,le.to)&&ut(Ie,G,le.from,le.to)))return e.Decoration.none}else if(fe=G.sliceDoc(le.from,le.to),!fe)return e.Decoration.none}let _e=[];for(let Pe of J.visibleRanges){let Rt=new l(G.doc,fe,Pe.from,Pe.to);for(;!Rt.next().done;){let{from:Ut,to:cn}=Rt.value;if((!Ie||Et(Ie,G,Ut,cn))&&(le.empty&&Ut<=le.from&&cn>=le.to?_e.push(ft.range(Ut,cn)):(Ut>=le.to||cn<=le.from)&&_e.push(ot.range(Ut,cn)),_e.length>j.maxMatches))return e.Decoration.none}}return e.Decoration.set(_e)}},{decorations:J=>J.decorations}),Xt=e.EditorView.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),Qt=({state:J,dispatch:j})=>{let{selection:G}=J,se=n.EditorSelection.create(G.ranges.map(le=>J.wordAt(le.head)||n.EditorSelection.cursor(le.head)),G.mainIndex);return se.eq(G)?!1:(j(J.update({selection:se})),!0)};function Kt(J,j){let{main:G,ranges:se}=J.selection,le=J.wordAt(G.head),fe=le&&le.from==G.from&&le.to==G.to;for(let Ie=!1,_e=new l(J.doc,j,se[se.length-1].to);;)if(_e.next(),_e.done){if(Ie)return null;_e=new l(J.doc,j,0,Math.max(0,se[se.length-1].from-1)),Ie=!0}else{if(Ie&&se.some(Pe=>Pe.from==_e.value.from))continue;if(fe){let Pe=J.wordAt(_e.value.from);if(!Pe||Pe.from!=_e.value.from||Pe.to!=_e.value.to)continue}return _e.value}}const pt=({state:J,dispatch:j})=>{let{ranges:G}=J.selection;if(G.some(fe=>fe.from===fe.to))return Qt({state:J,dispatch:j});let se=J.sliceDoc(G[0].from,G[0].to);if(J.selection.ranges.some(fe=>J.sliceDoc(fe.from,fe.to)!=se))return!1;let le=Kt(J,se);return le?(j(J.update({selection:J.selection.addRange(n.EditorSelection.range(le.from,le.to),!1),effects:e.EditorView.scrollIntoView(le.to)})),!0):!1},Vt=n.Facet.define({combine(J){return n.combineConfig(J,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:j=>new gt(j),scrollToMatch:j=>e.EditorView.scrollIntoView(j)})}});function qe(J){return J?[Vt.of(J),Lt]:Lt}class Mt{constructor(j){this.search=j.search,this.caseSensitive=!!j.caseSensitive,this.literal=!!j.literal,this.regexp=!!j.regexp,this.replace=j.replace||"",this.valid=!!this.search&&(!this.regexp||z(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!j.wholeWord}unquote(j){return this.literal?j:j.replace(/\\([nrt\\])/g,(G,se)=>se=="n"?`
`:se=="r"?"\r":se=="t"?"	":"\\")}eq(j){return this.search==j.search&&this.replace==j.replace&&this.caseSensitive==j.caseSensitive&&this.regexp==j.regexp&&this.wholeWord==j.wholeWord}create(){return this.regexp?new jt(this):new rt(this)}getCursor(j,G=0,se){let le=j.doc?j:n.EditorState.create({doc:j});return se==null&&(se=le.doc.length),this.regexp?tt(this,le,G,se):we(this,le,G,se)}}class Je{constructor(j){this.spec=j}}function we(J,j,G,se){return new l(j.doc,J.unquoted,G,se,J.caseSensitive?void 0:le=>le.toLowerCase(),J.wholeWord?ze(j.doc,j.charCategorizer(j.selection.main.head)):void 0)}function ze(J,j){return(G,se,le,fe)=>((fe>G||fe+le.length<se)&&(fe=Math.max(0,G-2),le=J.sliceString(fe,Math.min(J.length,se+2))),(j(Ye(le,G-fe))!=n.CharCategory.Word||j(st(le,G-fe))!=n.CharCategory.Word)&&(j(st(le,se-fe))!=n.CharCategory.Word||j(Ye(le,se-fe))!=n.CharCategory.Word))}class rt extends Je{constructor(j){super(j)}nextMatch(j,G,se){let le=we(this.spec,j,se,j.doc.length).nextOverlapping();if(le.done){let fe=Math.min(j.doc.length,G+this.spec.unquoted.length);le=we(this.spec,j,0,fe).nextOverlapping()}return le.done||le.value.from==G&&le.value.to==se?null:le.value}prevMatchInRange(j,G,se){for(let le=se;;){let fe=Math.max(G,le-1e4-this.spec.unquoted.length),Ie=we(this.spec,j,fe,le),_e=null;for(;!Ie.nextOverlapping().done;)_e=Ie.value;if(_e)return _e;if(fe==G)return null;le-=1e4}}prevMatch(j,G,se){let le=this.prevMatchInRange(j,0,G);return le||(le=this.prevMatchInRange(j,Math.max(0,se-this.spec.unquoted.length),j.doc.length)),le&&(le.from!=G||le.to!=se)?le:null}getReplacement(j){return this.spec.unquote(this.spec.replace)}matchAll(j,G){let se=we(this.spec,j,0,j.doc.length),le=[];for(;!se.next().done;){if(le.length>=G)return null;le.push(se.value)}return le}highlight(j,G,se,le){let fe=we(this.spec,j,Math.max(0,G-this.spec.unquoted.length),Math.min(se+this.spec.unquoted.length,j.doc.length));for(;!fe.next().done;)le(fe.value.from,fe.value.to)}}function tt(J,j,G,se){return new N(j.doc,J.search,{ignoreCase:!J.caseSensitive,test:J.wholeWord?Nt(j.charCategorizer(j.selection.main.head)):void 0},G,se)}function Ye(J,j){return J.slice(n.findClusterBreak(J,j,!1),j)}function st(J,j){return J.slice(j,n.findClusterBreak(J,j))}function Nt(J){return(j,G,se)=>!se[0].length||(J(Ye(se.input,se.index))!=n.CharCategory.Word||J(st(se.input,se.index))!=n.CharCategory.Word)&&(J(st(se.input,se.index+se[0].length))!=n.CharCategory.Word||J(Ye(se.input,se.index+se[0].length))!=n.CharCategory.Word)}class jt extends Je{nextMatch(j,G,se){let le=tt(this.spec,j,se,j.doc.length).next();return le.done&&(le=tt(this.spec,j,0,G).next()),le.done?null:le.value}prevMatchInRange(j,G,se){for(let le=1;;le++){let fe=Math.max(G,se-le*1e4),Ie=tt(this.spec,j,fe,se),_e=null;for(;!Ie.next().done;)_e=Ie.value;if(_e&&(fe==G||_e.from>fe+10))return _e;if(fe==G)return null}}prevMatch(j,G,se){return this.prevMatchInRange(j,0,G)||this.prevMatchInRange(j,se,j.doc.length)}getReplacement(j){return this.spec.unquote(this.spec.replace).replace(/\$([$&]|\d+)/g,(G,se)=>{if(se=="&")return j.match[0];if(se=="$")return"$";for(let le=se.length;le>0;le--){let fe=+se.slice(0,le);if(fe>0&&fe<j.match.length)return j.match[fe]+se.slice(le)}return G})}matchAll(j,G){let se=tt(this.spec,j,0,j.doc.length),le=[];for(;!se.next().done;){if(le.length>=G)return null;le.push(se.value)}return le}highlight(j,G,se,le){let fe=tt(this.spec,j,Math.max(0,G-250),Math.min(se+250,j.doc.length));for(;!fe.next().done;)le(fe.value.from,fe.value.to)}}const Ct=n.StateEffect.define(),yt=n.StateEffect.define(),wt=n.StateField.define({create(J){return new gn(Be(J).create(),null)},update(J,j){for(let G of j.effects)G.is(Ct)?J=new gn(G.value.create(),J.panel):G.is(yt)&&(J=new gn(J.query,G.value?Fe:null));return J},provide:J=>e.showPanel.from(J,j=>j.panel)});function Pt(J){let j=J.field(wt,!1);return j?j.query.spec:Be(J)}function It(J){var j;return((j=J.field(wt,!1))===null||j===void 0?void 0:j.panel)!=null}class gn{constructor(j,G){this.query=j,this.panel=G}}const sn=e.Decoration.mark({class:"cm-searchMatch"}),oe=e.Decoration.mark({class:"cm-searchMatch cm-searchMatch-selected"}),b=e.ViewPlugin.fromClass(class{constructor(J){this.view=J,this.decorations=this.highlight(J.state.field(wt))}update(J){let j=J.state.field(wt);(j!=J.startState.field(wt)||J.docChanged||J.selectionSet||J.viewportChanged)&&(this.decorations=this.highlight(j))}highlight({query:J,panel:j}){if(!j||!J.spec.valid)return e.Decoration.none;let{view:G}=this,se=new n.RangeSetBuilder;for(let le=0,fe=G.visibleRanges,Ie=fe.length;le<Ie;le++){let{from:_e,to:Pe}=fe[le];for(;le<Ie-1&&Pe>fe[le+1].from-2*250;)Pe=fe[++le].to;J.highlight(G.state,_e,Pe,(Rt,Ut)=>{let cn=G.state.selection.ranges.some(yn=>yn.from==Rt&&yn.to==Ut);se.add(Rt,Ut,cn?oe:sn)})}return se.finish()}},{decorations:J=>J.decorations});function T(J){return j=>{let G=j.state.field(wt,!1);return G&&G.query.spec.valid?J(j,G):Ze(j)}}const L=T((J,{query:j})=>{let{to:G}=J.state.selection.main,se=j.nextMatch(J.state,G,G);if(!se)return!1;let le=n.EditorSelection.single(se.from,se.to),fe=J.state.facet(Vt);return J.dispatch({selection:le,effects:[en(J,se),fe.scrollToMatch(le.main,J)],userEvent:"select.search"}),He(J),!0}),O=T((J,{query:j})=>{let{state:G}=J,{from:se}=G.selection.main,le=j.prevMatch(G,se,se);if(!le)return!1;let fe=n.EditorSelection.single(le.from,le.to),Ie=J.state.facet(Vt);return J.dispatch({selection:fe,effects:[en(J,le),Ie.scrollToMatch(fe.main,J)],userEvent:"select.search"}),He(J),!0}),H=T((J,{query:j})=>{let G=j.matchAll(J.state,1e3);return!G||!G.length?!1:(J.dispatch({selection:n.EditorSelection.create(G.map(se=>n.EditorSelection.range(se.from,se.to))),userEvent:"select.search.matches"}),!0)}),re=({state:J,dispatch:j})=>{let G=J.selection;if(G.ranges.length>1||G.main.empty)return!1;let{from:se,to:le}=G.main,fe=[],Ie=0;for(let _e=new l(J.doc,J.sliceDoc(se,le));!_e.next().done;){if(fe.length>1e3)return!1;_e.value.from==se&&(Ie=fe.length),fe.push(n.EditorSelection.range(_e.value.from,_e.value.to))}return j(J.update({selection:n.EditorSelection.create(fe,Ie),userEvent:"select.search.matches"})),!0},me=T((J,{query:j})=>{let{state:G}=J,{from:se,to:le}=G.selection.main;if(G.readOnly)return!1;let fe=j.nextMatch(G,se,se);if(!fe)return!1;let Ie=fe,_e=[],Pe,Rt,Ut=[];Ie.from==se&&Ie.to==le&&(Rt=G.toText(j.getReplacement(Ie)),_e.push({from:Ie.from,to:Ie.to,insert:Rt}),Ie=j.nextMatch(G,Ie.from,Ie.to),Ut.push(e.EditorView.announce.of(G.phrase("replaced match on line $",G.doc.lineAt(se).number)+".")));let cn=J.state.changes(_e);return Ie&&(Pe=n.EditorSelection.single(Ie.from,Ie.to).map(cn),Ut.push(en(J,Ie)),Ut.push(G.facet(Vt).scrollToMatch(Pe.main,J))),J.dispatch({changes:cn,selection:Pe,effects:Ut,userEvent:"input.replace"}),!0}),Ee=T((J,{query:j})=>{if(J.state.readOnly)return!1;let G=j.matchAll(J.state,1e9).map(le=>{let{from:fe,to:Ie}=le;return{from:fe,to:Ie,insert:j.getReplacement(le)}});if(!G.length)return!1;let se=J.state.phrase("replaced $ matches",G.length)+".";return J.dispatch({changes:G,effects:e.EditorView.announce.of(se),userEvent:"input.replace.all"}),!0});function Fe(J){return J.state.facet(Vt).createPanel(J)}function Be(J,j){var G,se,le,fe,Ie;let _e=J.selection.main,Pe=_e.empty||_e.to>_e.from+100?"":J.sliceDoc(_e.from,_e.to);if(j&&!Pe)return j;let Rt=J.facet(Vt);return new Mt({search:((G=j?.literal)!==null&&G!==void 0?G:Rt.literal)?Pe:Pe.replace(/\n/g,"\\n"),caseSensitive:(se=j?.caseSensitive)!==null&&se!==void 0?se:Rt.caseSensitive,literal:(le=j?.literal)!==null&&le!==void 0?le:Rt.literal,regexp:(fe=j?.regexp)!==null&&fe!==void 0?fe:Rt.regexp,wholeWord:(Ie=j?.wholeWord)!==null&&Ie!==void 0?Ie:Rt.wholeWord})}function Ue(J){let j=e.getPanel(J,Fe);return j&&j.dom.querySelector("[main-field]")}function He(J){let j=Ue(J);j&&j==J.root.activeElement&&j.select()}const Ze=J=>{let j=J.state.field(wt,!1);if(j&&j.panel){let G=Ue(J);if(G&&G!=J.root.activeElement){let se=Be(J.state,j.query.spec);se.valid&&J.dispatch({effects:Ct.of(se)}),G.focus(),G.select()}}else J.dispatch({effects:[yt.of(!0),j?Ct.of(Be(J.state,j.query.spec)):n.StateEffect.appendConfig.of(Lt)]});return!0},lt=J=>{let j=J.state.field(wt,!1);if(!j||!j.panel)return!1;let G=e.getPanel(J,Fe);return G&&G.dom.contains(J.root.activeElement)&&J.focus(),J.dispatch({effects:yt.of(!1)}),!0},qt=[{key:"Mod-f",run:Ze,scope:"editor search-panel"},{key:"F3",run:L,shift:O,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:L,shift:O,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:lt,scope:"editor search-panel"},{key:"Mod-Shift-l",run:re},{key:"Mod-Alt-g",run:Se},{key:"Mod-d",run:pt,preventDefault:!0}];class gt{constructor(j){this.view=j;let G=this.query=j.state.field(wt).query.spec;this.commit=this.commit.bind(this),this.searchField=r("input",{value:G.search,placeholder:kt(j,"Find"),"aria-label":kt(j,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=r("input",{value:G.replace,placeholder:kt(j,"Replace"),"aria-label":kt(j,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=r("input",{type:"checkbox",name:"case",form:"",checked:G.caseSensitive,onchange:this.commit}),this.reField=r("input",{type:"checkbox",name:"re",form:"",checked:G.regexp,onchange:this.commit}),this.wordField=r("input",{type:"checkbox",name:"word",form:"",checked:G.wholeWord,onchange:this.commit});function se(le,fe,Ie){return r("button",{class:"cm-button",name:le,onclick:fe,type:"button"},Ie)}this.dom=r("div",{onkeydown:le=>this.keydown(le),class:"cm-search"},[this.searchField,se("next",()=>L(j),[kt(j,"next")]),se("prev",()=>O(j),[kt(j,"previous")]),se("select",()=>H(j),[kt(j,"all")]),r("label",null,[this.caseField,kt(j,"match case")]),r("label",null,[this.reField,kt(j,"regexp")]),r("label",null,[this.wordField,kt(j,"by word")]),...j.state.readOnly?[]:[r("br"),this.replaceField,se("replace",()=>me(j),[kt(j,"replace")]),se("replaceAll",()=>Ee(j),[kt(j,"replace all")])],r("button",{name:"close",onclick:()=>lt(j),"aria-label":kt(j,"close"),type:"button"},["Ã—"])])}commit(){let j=new Mt({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});j.eq(this.query)||(this.query=j,this.view.dispatch({effects:Ct.of(j)}))}keydown(j){e.runScopeHandlers(this.view,j,"search-panel")?j.preventDefault():j.keyCode==13&&j.target==this.searchField?(j.preventDefault(),(j.shiftKey?O:L)(this.view)):j.keyCode==13&&j.target==this.replaceField&&(j.preventDefault(),me(this.view))}update(j){for(let G of j.transactions)for(let se of G.effects)se.is(Ct)&&!se.value.eq(this.query)&&this.setQuery(se.value)}setQuery(j){this.query=j,this.searchField.value=j.search,this.replaceField.value=j.replace,this.caseField.checked=j.caseSensitive,this.reField.checked=j.regexp,this.wordField.checked=j.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(Vt).top}}function kt(J,j){return J.state.phrase(j)}const ht=30,Ft=/[\s\.,:;?!]/;function en(J,{from:j,to:G}){let se=J.state.doc.lineAt(j),le=J.state.doc.lineAt(G).to,fe=Math.max(se.from,j-ht),Ie=Math.min(le,G+ht),_e=J.state.sliceDoc(fe,Ie);if(fe!=se.from){for(let Pe=0;Pe<ht;Pe++)if(!Ft.test(_e[Pe+1])&&Ft.test(_e[Pe])){_e=_e.slice(Pe);break}}if(Ie!=le){for(let Pe=_e.length-1;Pe>_e.length-ht;Pe--)if(!Ft.test(_e[Pe-1])&&Ft.test(_e[Pe])){_e=_e.slice(0,Pe);break}}return e.EditorView.announce.of(`${J.state.phrase("current match")}. ${_e} ${J.state.phrase("on line")} ${se.number}.`)}const At=e.EditorView.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),Lt=[wt,n.Prec.low(b),At];return Ln.RegExpCursor=N,Ln.SearchCursor=l,Ln.SearchQuery=Mt,Ln.closeSearchPanel=lt,Ln.findNext=L,Ln.findPrevious=O,Ln.getSearchQuery=Pt,Ln.gotoLine=Se,Ln.highlightSelectionMatches=We,Ln.openSearchPanel=Ze,Ln.replaceAll=Ee,Ln.replaceNext=me,Ln.search=qe,Ln.searchKeymap=qt,Ln.searchPanelOpen=It,Ln.selectMatches=H,Ln.selectNextOccurrence=pt,Ln.selectSelectionMatches=re,Ln.setSearchQuery=Ct,Ln}var an={},yc;function fp(){if(yc)return an;yc=1;var e=tr(),n=Nr(),r=Ul();class o{constructor(x,M,S,d){this.state=x,this.pos=M,this.explicit=S,this.view=d,this.abortListeners=[],this.abortOnDocChange=!1}tokenBefore(x){let M=r.syntaxTree(this.state).resolveInner(this.pos,-1);for(;M&&x.indexOf(M.name)<0;)M=M.parent;return M?{from:M.from,to:this.pos,text:this.state.sliceDoc(M.from,this.pos),type:M.type}:null}matchBefore(x){let M=this.state.doc.lineAt(this.pos),S=Math.max(M.from,this.pos-250),d=M.text.slice(S-M.from,this.pos-M.from),g=d.search(z(x,!1));return g<0?null:{from:S+g,to:this.pos,text:d.slice(g)}}get aborted(){return this.abortListeners==null}addEventListener(x,M,S){x=="abort"&&this.abortListeners&&(this.abortListeners.push(M),S&&S.onDocChange&&(this.abortOnDocChange=!0))}}function l(U){let x=Object.keys(U).join(""),M=/\w/.test(x);return M&&(x=x.replace(/\w/g,"")),`[${M?"\\w":""}${x.replace(/[^\w\s]/g,"\\$&")}]`}function h(U){let x=Object.create(null),M=Object.create(null);for(let{label:d}of U){x[d[0]]=!0;for(let g=1;g<d.length;g++)M[d[g]]=!0}let S=l(x)+l(M)+"*$";return[new RegExp("^"+S),new RegExp(S)]}function y(U){let x=U.map(d=>typeof d=="string"?{label:d}:d),[M,S]=x.every(d=>/^\w+$/.test(d.label))?[/\w*$/,/\w+$/]:h(x);return d=>{let g=d.matchBefore(S);return g||d.explicit?{from:g?g.from:d.pos,options:x,validFor:M}:null}}function N(U,x){return M=>{for(let S=r.syntaxTree(M.state).resolveInner(M.pos,-1);S;S=S.parent){if(U.indexOf(S.name)>-1)return x(M);if(S.type.isTop)break}return null}}function D(U,x){return M=>{for(let S=r.syntaxTree(M.state).resolveInner(M.pos,-1);S;S=S.parent){if(U.indexOf(S.name)>-1)return null;if(S.type.isTop)break}return x(M)}}class R{constructor(x,M,S,d){this.completion=x,this.source=M,this.match=S,this.score=d}}function W(U){return U.selection.main.from}function z(U,x){var M;let{source:S}=U,d=x&&S[0]!="^",g=S[S.length-1]!="$";return!d&&!g?U:new RegExp(`${d?"^":""}(?:${S})${g?"$":""}`,(M=U.flags)!==null&&M!==void 0?M:U.ignoreCase?"i":"")}const ne=e.Annotation.define();function te(U,x,M,S){let{main:d}=U.selection,g=M-d.from,A=S-d.from;return Object.assign(Object.assign({},U.changeByRange(P=>{if(P!=d&&M!=S&&U.sliceDoc(P.from+g,P.from+A)!=U.sliceDoc(M,S))return{range:P};let $=U.toText(x);return{changes:{from:P.from+g,to:S==d.from?P.to:P.from+A,insert:$},range:e.EditorSelection.cursor(P.from+g+$.length)}})),{scrollIntoView:!0,userEvent:"input.complete"})}const be=new WeakMap;function Ne(U){if(!Array.isArray(U))return U;let x=be.get(U);return x||be.set(U,x=y(U)),x}const Se=e.StateEffect.define(),xe=e.StateEffect.define();class Qe{constructor(x){this.pattern=x,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let M=0;M<x.length;){let S=e.codePointAt(x,M),d=e.codePointSize(S);this.chars.push(S);let g=x.slice(M,M+d),A=g.toUpperCase();this.folded.push(e.codePointAt(A==g?g.toLowerCase():A,0)),M+=d}this.astral=x.length!=this.chars.length}ret(x,M){return this.score=x,this.matched=M,this}match(x){if(this.pattern.length==0)return this.ret(-100,[]);if(x.length<this.pattern.length)return null;let{chars:M,folded:S,any:d,precise:g,byWord:A}=this;if(M.length==1){let Zt=e.codePointAt(x,0),ti=e.codePointSize(Zt),Mn=ti==x.length?0:-100;if(Zt!=M[0])if(Zt==S[0])Mn+=-200;else return null;return this.ret(Mn,[0,ti])}let P=x.indexOf(this.pattern);if(P==0)return this.ret(x.length==this.pattern.length?0:-100,[0,this.pattern.length]);let $=M.length,X=0;if(P<0){for(let Zt=0,ti=Math.min(x.length,200);Zt<ti&&X<$;){let Mn=e.codePointAt(x,Zt);(Mn==M[X]||Mn==S[X])&&(d[X++]=Zt),Zt+=e.codePointSize(Mn)}if(X<$)return null}let he=0,ge=0,Re=!1,mt=0,Bt=-1,ln=-1,mn=/[a-z]/.test(x),Dn=!0;for(let Zt=0,ti=Math.min(x.length,200),Mn=0;Zt<ti&&ge<$;){let $n=e.codePointAt(x,Zt);P<0&&(he<$&&$n==M[he]&&(g[he++]=Zt),mt<$&&($n==M[mt]||$n==S[mt]?(mt==0&&(Bt=Zt),ln=Zt+1,mt++):mt=0));let xi,_i=$n<255?$n>=48&&$n<=57||$n>=97&&$n<=122?2:$n>=65&&$n<=90?1:0:(xi=e.fromCodePoint($n))!=xi.toLowerCase()?1:xi!=xi.toUpperCase()?2:0;(!Zt||_i==1&&mn||Mn==0&&_i!=0)&&(M[ge]==$n||S[ge]==$n&&(Re=!0)?A[ge++]=Zt:A.length&&(Dn=!1)),Mn=_i,Zt+=e.codePointSize($n)}return ge==$&&A[0]==0&&Dn?this.result(-100+(Re?-200:0),A,x):mt==$&&Bt==0?this.ret(-200-x.length+(ln==x.length?0:-100),[0,ln]):P>-1?this.ret(-700-x.length,[P,P+this.pattern.length]):mt==$?this.ret(-900-x.length,[Bt,ln]):ge==$?this.result(-100+(Re?-200:0)+-700+(Dn?0:-1100),A,x):M.length==2?null:this.result((d[0]?-700:0)+-200+-1100,d,x)}result(x,M,S){let d=[],g=0;for(let A of M){let P=A+(this.astral?e.codePointSize(e.codePointAt(S,A)):1);g&&d[g-1]==A?d[g-1]=P:(d[g++]=A,d[g++]=P)}return this.ret(x-S.length,d)}}class Ge{constructor(x){this.pattern=x,this.matched=[],this.score=0,this.folded=x.toLowerCase()}match(x){if(x.length<this.pattern.length)return null;let M=x.slice(0,this.pattern.length),S=M==this.pattern?0:M.toLowerCase()==this.folded?-200:null;return S==null?null:(this.matched=[0,M.length],this.score=S+(x.length==this.pattern.length?0:-100),this)}}const We=e.Facet.define({combine(U){return e.combineConfig(U,{activateOnTyping:!0,activateOnCompletion:()=>!1,activateOnTypingDelay:100,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:ft,filterStrict:!1,compareCompletions:(x,M)=>x.label.localeCompare(M.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(x,M)=>x&&M,closeOnBlur:(x,M)=>x&&M,icons:(x,M)=>x&&M,tooltipClass:(x,M)=>S=>ot(x(S),M(S)),optionClass:(x,M)=>S=>ot(x(S),M(S)),addToOptions:(x,M)=>x.concat(M),filterStrict:(x,M)=>x||M})}});function ot(U,x){return U?x?U+" "+x:U:x}function ft(U,x,M,S,d,g){let A=U.textDirection==n.Direction.RTL,P=A,$=!1,X="top",he,ge,Re=x.left-d.left,mt=d.right-x.right,Bt=S.right-S.left,ln=S.bottom-S.top;if(P&&Re<Math.min(Bt,mt)?P=!1:!P&&mt<Math.min(Bt,Re)&&(P=!0),Bt<=(P?Re:mt))he=Math.max(d.top,Math.min(M.top,d.bottom-ln))-x.top,ge=Math.min(400,P?Re:mt);else{$=!0,ge=Math.min(400,(A?x.right:d.right-x.left)-30);let Zt=d.bottom-x.bottom;Zt>=ln||Zt>x.top?he=M.bottom-x.top:(X="bottom",he=x.bottom-M.top)}let mn=(x.bottom-x.top)/g.offsetHeight,Dn=(x.right-x.left)/g.offsetWidth;return{style:`${X}: ${he/mn}px; max-width: ${ge/Dn}px`,class:"cm-completionInfo-"+($?A?"left-narrow":"right-narrow":P?"left":"right")}}function Et(U){let x=U.addToOptions.slice();return U.icons&&x.push({render(M){let S=document.createElement("div");return S.classList.add("cm-completionIcon"),M.type&&S.classList.add(...M.type.split(/\s+/g).map(d=>"cm-completionIcon-"+d)),S.setAttribute("aria-hidden","true"),S},position:20}),x.push({render(M,S,d,g){let A=document.createElement("span");A.className="cm-completionLabel";let P=M.displayLabel||M.label,$=0;for(let X=0;X<g.length;){let he=g[X++],ge=g[X++];he>$&&A.appendChild(document.createTextNode(P.slice($,he)));let Re=A.appendChild(document.createElement("span"));Re.appendChild(document.createTextNode(P.slice(he,ge))),Re.className="cm-completionMatchedText",$=ge}return $<P.length&&A.appendChild(document.createTextNode(P.slice($))),A},position:50},{render(M){if(!M.detail)return null;let S=document.createElement("span");return S.className="cm-completionDetail",S.textContent=M.detail,S},position:80}),x.sort((M,S)=>M.position-S.position).map(M=>M.render)}function ut(U,x,M){if(U<=M)return{from:0,to:U};if(x<0&&(x=0),x<=U>>1){let d=Math.floor(x/M);return{from:d*M,to:(d+1)*M}}let S=Math.floor((U-x)/M);return{from:U-(S+1)*M,to:U-S*M}}class rn{constructor(x,M,S){this.view=x,this.stateField=M,this.applyCompletion=S,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:$=>this.placeInfo($),key:this},this.space=null,this.currentClass="";let d=x.state.field(M),{options:g,selected:A}=d.open,P=x.state.facet(We);this.optionContent=Et(P),this.optionClass=P.optionClass,this.tooltipClass=P.tooltipClass,this.range=ut(g.length,A,P.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(x.state),this.dom.addEventListener("mousedown",$=>{let{options:X}=x.state.field(M).open;for(let he=$.target,ge;he&&he!=this.dom;he=he.parentNode)if(he.nodeName=="LI"&&(ge=/-(\d+)$/.exec(he.id))&&+ge[1]<X.length){this.applyCompletion(x,X[+ge[1]]),$.preventDefault();return}}),this.dom.addEventListener("focusout",$=>{let X=x.state.field(this.stateField,!1);X&&X.tooltip&&x.state.facet(We).closeOnBlur&&$.relatedTarget!=x.contentDOM&&x.dispatch({effects:xe.of(null)})}),this.showOptions(g,d.id)}mount(){this.updateSel()}showOptions(x,M){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(x,M,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(x){var M;let S=x.state.field(this.stateField),d=x.startState.field(this.stateField);if(this.updateTooltipClass(x.state),S!=d){let{options:g,selected:A,disabled:P}=S.open;(!d.open||d.open.options!=g)&&(this.range=ut(g.length,A,x.state.facet(We).maxRenderedOptions),this.showOptions(g,S.id)),this.updateSel(),P!=((M=d.open)===null||M===void 0?void 0:M.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!P)}}updateTooltipClass(x){let M=this.tooltipClass(x);if(M!=this.currentClass){for(let S of this.currentClass.split(" "))S&&this.dom.classList.remove(S);for(let S of M.split(" "))S&&this.dom.classList.add(S);this.currentClass=M}}positioned(x){this.space=x,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let x=this.view.state.field(this.stateField),M=x.open;if((M.selected>-1&&M.selected<this.range.from||M.selected>=this.range.to)&&(this.range=ut(M.options.length,M.selected,this.view.state.facet(We).maxRenderedOptions),this.showOptions(M.options,x.id)),this.updateSelectedOption(M.selected)){this.destroyInfo();let{completion:S}=M.options[M.selected],{info:d}=S;if(!d)return;let g=typeof d=="string"?document.createTextNode(d):d(S);if(!g)return;"then"in g?g.then(A=>{A&&this.view.state.field(this.stateField,!1)==x&&this.addInfoPane(A,S)}).catch(A=>n.logException(this.view.state,A,"completion info")):this.addInfoPane(g,S)}}addInfoPane(x,M){this.destroyInfo();let S=this.info=document.createElement("div");if(S.className="cm-tooltip cm-completionInfo",x.nodeType!=null)S.appendChild(x),this.infoDestroy=null;else{let{dom:d,destroy:g}=x;S.appendChild(d),this.infoDestroy=g||null}this.dom.appendChild(S),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(x){let M=null;for(let S=this.list.firstChild,d=this.range.from;S;S=S.nextSibling,d++)S.nodeName!="LI"||!S.id?d--:d==x?S.hasAttribute("aria-selected")||(S.setAttribute("aria-selected","true"),M=S):S.hasAttribute("aria-selected")&&S.removeAttribute("aria-selected");return M&&Qt(this.list,M),M}measureInfo(){let x=this.dom.querySelector("[aria-selected]");if(!x||!this.info)return null;let M=this.dom.getBoundingClientRect(),S=this.info.getBoundingClientRect(),d=x.getBoundingClientRect(),g=this.space;if(!g){let A=this.dom.ownerDocument.documentElement;g={left:0,top:0,right:A.clientWidth,bottom:A.clientHeight}}return d.top>Math.min(g.bottom,M.bottom)-10||d.bottom<Math.max(g.top,M.top)+10?null:this.view.state.facet(We).positionInfo(this.view,M,d,S,g,this.dom)}placeInfo(x){this.info&&(x?(x.style&&(this.info.style.cssText=x.style),this.info.className="cm-tooltip cm-completionInfo "+(x.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(x,M,S){const d=document.createElement("ul");d.id=M,d.setAttribute("role","listbox"),d.setAttribute("aria-expanded","true"),d.setAttribute("aria-label",this.view.state.phrase("Completions")),d.addEventListener("mousedown",A=>{A.target==d&&A.preventDefault()});let g=null;for(let A=S.from;A<S.to;A++){let{completion:P,match:$}=x[A],{section:X}=P;if(X){let Re=typeof X=="string"?X:X.name;if(Re!=g&&(A>S.from||S.from==0))if(g=Re,typeof X!="string"&&X.header)d.appendChild(X.header(X));else{let mt=d.appendChild(document.createElement("completion-section"));mt.textContent=Re}}const he=d.appendChild(document.createElement("li"));he.id=M+"-"+A,he.setAttribute("role","option");let ge=this.optionClass(P);ge&&(he.className=ge);for(let Re of this.optionContent){let mt=Re(P,this.view.state,this.view,$);mt&&he.appendChild(mt)}}return S.from&&d.classList.add("cm-completionListIncompleteTop"),S.to<x.length&&d.classList.add("cm-completionListIncompleteBottom"),d}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function Xt(U,x){return M=>new rn(M,U,x)}function Qt(U,x){let M=U.getBoundingClientRect(),S=x.getBoundingClientRect(),d=M.height/U.offsetHeight;S.top<M.top?U.scrollTop-=(M.top-S.top)/d:S.bottom>M.bottom&&(U.scrollTop+=(S.bottom-M.bottom)/d)}function Kt(U){return(U.boost||0)*100+(U.apply?10:0)+(U.info?5:0)+(U.type?1:0)}function pt(U,x){let M=[],S=null,d=X=>{M.push(X);let{section:he}=X.completion;if(he){S||(S=[]);let ge=typeof he=="string"?he:he.name;S.some(Re=>Re.name==ge)||S.push(typeof he=="string"?{name:ge}:he)}},g=x.facet(We);for(let X of U)if(X.hasResult()){let he=X.result.getMatch;if(X.result.filter===!1)for(let ge of X.result.options)d(new R(ge,X.source,he?he(ge):[],1e9-M.length));else{let ge=x.sliceDoc(X.from,X.to),Re,mt=g.filterStrict?new Ge(ge):new Qe(ge);for(let Bt of X.result.options)if(Re=mt.match(Bt.label)){let ln=Bt.displayLabel?he?he(Bt,Re.matched):[]:Re.matched;d(new R(Bt,X.source,ln,Re.score+(Bt.boost||0)))}}}if(S){let X=Object.create(null),he=0,ge=(Re,mt)=>{var Bt,ln;return((Bt=Re.rank)!==null&&Bt!==void 0?Bt:1e9)-((ln=mt.rank)!==null&&ln!==void 0?ln:1e9)||(Re.name<mt.name?-1:1)};for(let Re of S.sort(ge))he-=1e5,X[Re.name]=he;for(let Re of M){let{section:mt}=Re.completion;mt&&(Re.score+=X[typeof mt=="string"?mt:mt.name])}}let A=[],P=null,$=g.compareCompletions;for(let X of M.sort((he,ge)=>ge.score-he.score||$(he.completion,ge.completion))){let he=X.completion;!P||P.label!=he.label||P.detail!=he.detail||P.type!=null&&he.type!=null&&P.type!=he.type||P.apply!=he.apply||P.boost!=he.boost?A.push(X):Kt(X.completion)>Kt(P)&&(A[A.length-1]=X),P=X.completion}return A}class Vt{constructor(x,M,S,d,g,A){this.options=x,this.attrs=M,this.tooltip=S,this.timestamp=d,this.selected=g,this.disabled=A}setSelected(x,M){return x==this.selected||x>=this.options.length?this:new Vt(this.options,ze(M,x),this.tooltip,this.timestamp,x,this.disabled)}static build(x,M,S,d,g,A){if(d&&!A&&x.some(X=>X.isPending))return d.setDisabled();let P=pt(x,M);if(!P.length)return d&&x.some(X=>X.isPending)?d.setDisabled():null;let $=M.facet(We).selectOnOpen?0:-1;if(d&&d.selected!=$&&d.selected!=-1){let X=d.options[d.selected].completion;for(let he=0;he<P.length;he++)if(P[he].completion==X){$=he;break}}return new Vt(P,ze(S,$),{pos:x.reduce((X,he)=>he.hasResult()?Math.min(X,he.from):X,1e8),create:Pt,above:g.aboveCursor},d?d.timestamp:Date.now(),$,!1)}map(x){return new Vt(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:x.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}setDisabled(){return new Vt(this.options,this.attrs,this.tooltip,this.timestamp,this.selected,!0)}}class qe{constructor(x,M,S){this.active=x,this.id=M,this.open=S}static start(){return new qe(rt,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(x){let{state:M}=x,S=M.facet(We),g=(S.override||M.languageDataAt("autocomplete",W(M)).map(Ne)).map($=>(this.active.find(he=>he.source==$)||new Ye($,this.active.some(he=>he.state!=0)?1:0)).update(x,S));g.length==this.active.length&&g.every(($,X)=>$==this.active[X])&&(g=this.active);let A=this.open,P=x.effects.some($=>$.is(jt));A&&x.docChanged&&(A=A.map(x.changes)),x.selection||g.some($=>$.hasResult()&&x.changes.touchesRange($.from,$.to))||!Mt(g,this.active)||P?A=Vt.build(g,M,this.id,A,S,P):A&&A.disabled&&!g.some($=>$.isPending)&&(A=null),!A&&g.every($=>!$.isPending)&&g.some($=>$.hasResult())&&(g=g.map($=>$.hasResult()?new Ye($.source,0):$));for(let $ of x.effects)$.is(Ct)&&(A=A&&A.setSelected($.value,this.id));return g==this.active&&A==this.open?this:new qe(g,this.id,A)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:this.active.length?Je:we}}function Mt(U,x){if(U==x)return!0;for(let M=0,S=0;;){for(;M<U.length&&!U[M].hasResult();)M++;for(;S<x.length&&!x[S].hasResult();)S++;let d=M==U.length,g=S==x.length;if(d||g)return d==g;if(U[M++].result!=x[S++].result)return!1}}const Je={"aria-autocomplete":"list"},we={};function ze(U,x){let M={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":U};return x>-1&&(M["aria-activedescendant"]=U+"-"+x),M}const rt=[];function tt(U,x){if(U.isUserEvent("input.complete")){let S=U.annotation(ne);if(S&&x.activateOnCompletion(S))return 12}let M=U.isUserEvent("input.type");return M&&x.activateOnTyping?5:M?1:U.isUserEvent("delete.backward")?2:U.selection?8:U.docChanged?16:0}class Ye{constructor(x,M,S=!1){this.source=x,this.state=M,this.explicit=S}hasResult(){return!1}get isPending(){return this.state==1}update(x,M){let S=tt(x,M),d=this;(S&8||S&16&&this.touches(x))&&(d=new Ye(d.source,0)),S&4&&d.state==0&&(d=new Ye(this.source,1)),d=d.updateFor(x,S);for(let g of x.effects)if(g.is(Se))d=new Ye(d.source,1,g.value);else if(g.is(xe))d=new Ye(d.source,0);else if(g.is(jt))for(let A of g.value)A.source==d.source&&(d=A);return d}updateFor(x,M){return this.map(x.changes)}map(x){return this}touches(x){return x.changes.touchesRange(W(x.state))}}class st extends Ye{constructor(x,M,S,d,g,A){super(x,3,M),this.limit=S,this.result=d,this.from=g,this.to=A}hasResult(){return!0}updateFor(x,M){var S;if(!(M&3))return this.map(x.changes);let d=this.result;d.map&&!x.changes.empty&&(d=d.map(d,x.changes));let g=x.changes.mapPos(this.from),A=x.changes.mapPos(this.to,1),P=W(x.state);if(P>A||!d||M&2&&(W(x.startState)==this.from||P<this.limit))return new Ye(this.source,M&4?1:0);let $=x.changes.mapPos(this.limit);return Nt(d.validFor,x.state,g,A)?new st(this.source,this.explicit,$,d,g,A):d.update&&(d=d.update(d,g,A,new o(x.state,P,!1)))?new st(this.source,this.explicit,$,d,d.from,(S=d.to)!==null&&S!==void 0?S:W(x.state)):new Ye(this.source,1,this.explicit)}map(x){return x.empty?this:(this.result.map?this.result.map(this.result,x):this.result)?new st(this.source,this.explicit,x.mapPos(this.limit),this.result,x.mapPos(this.from),x.mapPos(this.to,1)):new Ye(this.source,0)}touches(x){return x.changes.touchesRange(this.from,this.to)}}function Nt(U,x,M,S){if(!U)return!1;let d=x.sliceDoc(M,S);return typeof U=="function"?U(d,M,S,x):z(U,!0).test(d)}const jt=e.StateEffect.define({map(U,x){return U.map(M=>M.map(x))}}),Ct=e.StateEffect.define(),yt=e.StateField.define({create(){return qe.start()},update(U,x){return U.update(x)},provide:U=>[n.showTooltip.from(U,x=>x.tooltip),n.EditorView.contentAttributes.from(U,x=>x.attrs)]});function wt(U,x){const M=x.completion.apply||x.completion.label;let S=U.state.field(yt).active.find(d=>d.source==x.source);return S instanceof st?(typeof M=="string"?U.dispatch(Object.assign(Object.assign({},te(U.state,M,S.from,S.to)),{annotations:ne.of(x.completion)})):M(U,x.completion,S.from,S.to),!0):!1}const Pt=Xt(yt,wt);function It(U,x="option"){return M=>{let S=M.state.field(yt,!1);if(!S||!S.open||S.open.disabled||Date.now()-S.open.timestamp<M.state.facet(We).interactionDelay)return!1;let d=1,g;x=="page"&&(g=n.getTooltip(M,S.open.tooltip))&&(d=Math.max(2,Math.floor(g.dom.offsetHeight/g.dom.querySelector("li").offsetHeight)-1));let{length:A}=S.open.options,P=S.open.selected>-1?S.open.selected+d*(U?1:-1):U?0:A-1;return P<0?P=x=="page"?0:A-1:P>=A&&(P=x=="page"?A-1:0),M.dispatch({effects:Ct.of(P)}),!0}}const gn=U=>{let x=U.state.field(yt,!1);return U.state.readOnly||!x||!x.open||x.open.selected<0||x.open.disabled||Date.now()-x.open.timestamp<U.state.facet(We).interactionDelay?!1:wt(U,x.open.options[x.open.selected])},sn=U=>U.state.field(yt,!1)?(U.dispatch({effects:Se.of(!0)}),!0):!1,oe=U=>{let x=U.state.field(yt,!1);return!x||!x.active.some(M=>M.state!=0)?!1:(U.dispatch({effects:xe.of(null)}),!0)};class b{constructor(x,M){this.active=x,this.context=M,this.time=Date.now(),this.updates=[],this.done=void 0}}const T=50,L=1e3,O=n.ViewPlugin.fromClass(class{constructor(U){this.view=U,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.pendingStart=!1,this.composing=0;for(let x of U.state.field(yt).active)x.isPending&&this.startQuery(x)}update(U){let x=U.state.field(yt),M=U.state.facet(We);if(!U.selectionSet&&!U.docChanged&&U.startState.field(yt)==x)return;let S=U.transactions.some(g=>{let A=tt(g,M);return A&8||(g.selection||g.docChanged)&&!(A&3)});for(let g=0;g<this.running.length;g++){let A=this.running[g];if(S||A.context.abortOnDocChange&&U.docChanged||A.updates.length+U.transactions.length>T&&Date.now()-A.time>L){for(let P of A.context.abortListeners)try{P()}catch($){n.logException(this.view.state,$)}A.context.abortListeners=null,this.running.splice(g--,1)}else A.updates.push(...U.transactions)}this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),U.transactions.some(g=>g.effects.some(A=>A.is(Se)))&&(this.pendingStart=!0);let d=this.pendingStart?50:M.activateOnTypingDelay;if(this.debounceUpdate=x.active.some(g=>g.isPending&&!this.running.some(A=>A.active.source==g.source))?setTimeout(()=>this.startUpdate(),d):-1,this.composing!=0)for(let g of U.transactions)g.isUserEvent("input.type")?this.composing=2:this.composing==2&&g.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1,this.pendingStart=!1;let{state:U}=this.view,x=U.field(yt);for(let M of x.active)M.isPending&&!this.running.some(S=>S.active.source==M.source)&&this.startQuery(M);this.running.length&&x.open&&x.open.disabled&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(We).updateSyncTime))}startQuery(U){let{state:x}=this.view,M=W(x),S=new o(x,M,U.explicit,this.view),d=new b(U,S);this.running.push(d),Promise.resolve(U.source(S)).then(g=>{d.context.aborted||(d.done=g||null,this.scheduleAccept())},g=>{this.view.dispatch({effects:xe.of(null)}),n.logException(this.view.state,g)})}scheduleAccept(){this.running.every(U=>U.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(We).updateSyncTime))}accept(){var U;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let x=[],M=this.view.state.facet(We),S=this.view.state.field(yt);for(let d=0;d<this.running.length;d++){let g=this.running[d];if(g.done===void 0)continue;if(this.running.splice(d--,1),g.done){let P=W(g.updates.length?g.updates[0].startState:this.view.state),$=Math.min(P,g.done.from+(g.active.explicit?0:1)),X=new st(g.active.source,g.active.explicit,$,g.done,g.done.from,(U=g.done.to)!==null&&U!==void 0?U:P);for(let he of g.updates)X=X.update(he,M);if(X.hasResult()){x.push(X);continue}}let A=S.active.find(P=>P.source==g.active.source);if(A&&A.isPending)if(g.done==null){let P=new Ye(g.active.source,0);for(let $ of g.updates)P=P.update($,M);P.isPending||x.push(P)}else this.startQuery(A)}(x.length||S.open&&S.open.disabled)&&this.view.dispatch({effects:jt.of(x)})}},{eventHandlers:{blur(U){let x=this.view.state.field(yt,!1);if(x&&x.tooltip&&this.view.state.facet(We).closeOnBlur){let M=x.open&&n.getTooltip(this.view,x.open.tooltip);(!M||!M.dom.contains(U.relatedTarget))&&setTimeout(()=>this.view.dispatch({effects:xe.of(null)}),10)}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Se.of(!1)}),20),this.composing=0}}}),H=typeof navigator=="object"&&/Win/.test(navigator.platform),re=e.Prec.highest(n.EditorView.domEventHandlers({keydown(U,x){let M=x.state.field(yt,!1);if(!M||!M.open||M.open.disabled||M.open.selected<0||U.key.length>1||U.ctrlKey&&!(H&&U.altKey)||U.metaKey)return!1;let S=M.open.options[M.open.selected],d=M.active.find(A=>A.source==S.source),g=S.completion.commitCharacters||d.result.commitCharacters;return g&&g.indexOf(U.key)>-1&&wt(x,S),!1}})),me=n.EditorView.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"Â·Â·Â·"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:"400px",boxSizing:"border-box",whiteSpace:"pre-line"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:"30px"},".cm-completionInfo.cm-completionInfo-right-narrow":{left:"30px"},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'Æ’'"}},".cm-completionIcon-class":{"&:after":{content:"'â—‹'"}},".cm-completionIcon-interface":{"&:after":{content:"'â—Œ'"}},".cm-completionIcon-variable":{"&:after":{content:"'ð‘¥'"}},".cm-completionIcon-constant":{"&:after":{content:"'ð¶'"}},".cm-completionIcon-type":{"&:after":{content:"'ð‘¡'"}},".cm-completionIcon-enum":{"&:after":{content:"'âˆª'"}},".cm-completionIcon-property":{"&:after":{content:"'â–¡'"}},".cm-completionIcon-keyword":{"&:after":{content:"'ðŸ”‘ï¸Ž'"}},".cm-completionIcon-namespace":{"&:after":{content:"'â–¢'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class Ee{constructor(x,M,S,d){this.field=x,this.line=M,this.from=S,this.to=d}}class Fe{constructor(x,M,S){this.field=x,this.from=M,this.to=S}map(x){let M=x.mapPos(this.from,-1,e.MapMode.TrackDel),S=x.mapPos(this.to,1,e.MapMode.TrackDel);return M==null||S==null?null:new Fe(this.field,M,S)}}class Be{constructor(x,M){this.lines=x,this.fieldPositions=M}instantiate(x,M){let S=[],d=[M],g=x.doc.lineAt(M),A=/^\s*/.exec(g.text)[0];for(let $ of this.lines){if(S.length){let X=A,he=/^\t*/.exec($)[0].length;for(let ge=0;ge<he;ge++)X+=x.facet(r.indentUnit);d.push(M+X.length-he),$=X+$.slice(he)}S.push($),M+=$.length+1}let P=this.fieldPositions.map($=>new Fe($.field,d[$.line]+$.from,d[$.line]+$.to));return{text:S,ranges:P}}static parse(x){let M=[],S=[],d=[],g;for(let A of x.split(/\r\n?|\n/)){for(;g=/[#$]\{(?:(\d+)(?::([^}]*))?|((?:\\[{}]|[^}])*))\}/.exec(A);){let P=g[1]?+g[1]:null,$=g[2]||g[3]||"",X=-1,he=$.replace(/\\[{}]/g,ge=>ge[1]);for(let ge=0;ge<M.length;ge++)(P!=null?M[ge].seq==P:he&&M[ge].name==he)&&(X=ge);if(X<0){let ge=0;for(;ge<M.length&&(P==null||M[ge].seq!=null&&M[ge].seq<P);)ge++;M.splice(ge,0,{seq:P,name:he}),X=ge;for(let Re of d)Re.field>=X&&Re.field++}d.push(new Ee(X,S.length,g.index,g.index+he.length)),A=A.slice(0,g.index)+$+A.slice(g.index+g[0].length)}A=A.replace(/\\([{}])/g,(P,$,X)=>{for(let he of d)he.line==S.length&&he.from>X&&(he.from--,he.to--);return $}),S.push(A)}return new Be(S,d)}}let Ue=n.Decoration.widget({widget:new class extends n.WidgetType{toDOM(){let U=document.createElement("span");return U.className="cm-snippetFieldPosition",U}ignoreEvent(){return!1}}}),He=n.Decoration.mark({class:"cm-snippetField"});class Ze{constructor(x,M){this.ranges=x,this.active=M,this.deco=n.Decoration.set(x.map(S=>(S.from==S.to?Ue:He).range(S.from,S.to)))}map(x){let M=[];for(let S of this.ranges){let d=S.map(x);if(!d)return null;M.push(d)}return new Ze(M,this.active)}selectionInsideField(x){return x.ranges.every(M=>this.ranges.some(S=>S.field==this.active&&S.from<=M.from&&S.to>=M.to))}}const lt=e.StateEffect.define({map(U,x){return U&&U.map(x)}}),qt=e.StateEffect.define(),gt=e.StateField.define({create(){return null},update(U,x){for(let M of x.effects){if(M.is(lt))return M.value;if(M.is(qt)&&U)return new Ze(U.ranges,M.value)}return U&&x.docChanged&&(U=U.map(x.changes)),U&&x.selection&&!U.selectionInsideField(x.selection)&&(U=null),U},provide:U=>n.EditorView.decorations.from(U,x=>x?x.deco:n.Decoration.none)});function kt(U,x){return e.EditorSelection.create(U.filter(M=>M.field==x).map(M=>e.EditorSelection.range(M.from,M.to)))}function ht(U){let x=Be.parse(U);return(M,S,d,g)=>{let{text:A,ranges:P}=x.instantiate(M.state,d),{main:$}=M.state.selection,X={changes:{from:d,to:g==$.from?$.to:g,insert:e.Text.of(A)},scrollIntoView:!0,annotations:S?[ne.of(S),e.Transaction.userEvent.of("input.complete")]:void 0};if(P.length&&(X.selection=kt(P,0)),P.some(he=>he.field>0)){let he=new Ze(P,0),ge=X.effects=[lt.of(he)];M.state.field(gt,!1)===void 0&&ge.push(e.StateEffect.appendConfig.of([gt,le,Ie,me]))}M.dispatch(M.state.update(X))}}function Ft(U){return({state:x,dispatch:M})=>{let S=x.field(gt,!1);if(!S||U<0&&S.active==0)return!1;let d=S.active+U,g=U>0&&!S.ranges.some(A=>A.field==d+U);return M(x.update({selection:kt(S.ranges,d),effects:lt.of(g?null:new Ze(S.ranges,d)),scrollIntoView:!0})),!0}}const en=({state:U,dispatch:x})=>U.field(gt,!1)?(x(U.update({effects:lt.of(null)})),!0):!1,At=Ft(1),Lt=Ft(-1);function J(U){let x=U.field(gt,!1);return!!(x&&x.ranges.some(M=>M.field==x.active+1))}function j(U){let x=U.field(gt,!1);return!!(x&&x.active>0)}const G=[{key:"Tab",run:At,shift:Lt},{key:"Escape",run:en}],se=e.Facet.define({combine(U){return U.length?U[0]:G}}),le=e.Prec.highest(n.keymap.compute([se],U=>U.facet(se)));function fe(U,x){return Object.assign(Object.assign({},x),{apply:ht(U)})}const Ie=n.EditorView.domEventHandlers({mousedown(U,x){let M=x.state.field(gt,!1),S;if(!M||(S=x.posAtCoords({x:U.clientX,y:U.clientY}))==null)return!1;let d=M.ranges.find(g=>g.from<=S&&g.to>=S);return!d||d.field==M.active?!1:(x.dispatch({selection:kt(M.ranges,d.field),effects:lt.of(M.ranges.some(g=>g.field>d.field)?new Ze(M.ranges,d.field):null),scrollIntoView:!0}),!0)}});function _e(U){let x=U.replace(/[\]\-\\]/g,"\\$&");try{return new RegExp(`[\\p{Alphabetic}\\p{Number}_${x}]+`,"ug")}catch{return new RegExp(`[w${x}]`,"g")}}function Pe(U,x){return new RegExp(x(U.source),U.unicode?"u":"")}const Rt=Object.create(null);function Ut(U){return Rt[U]||(Rt[U]=new WeakMap)}function cn(U,x,M,S,d){for(let g=U.iterLines(),A=0;!g.next().done;){let{value:P}=g,$;for(x.lastIndex=0;$=x.exec(P);)if(!S[$[0]]&&A+$.index!=d&&(M.push({type:"text",label:$[0]}),S[$[0]]=!0,M.length>=2e3))return;A+=P.length+1}}function yn(U,x,M,S,d){let g=U.length>=1e3,A=g&&x.get(U);if(A)return A;let P=[],$=Object.create(null);if(U.children){let X=0;for(let he of U.children){if(he.length>=1e3)for(let ge of yn(he,x,M,S-X,d-X))$[ge.label]||($[ge.label]=!0,P.push(ge));else cn(he,M,P,$,d-X);X+=he.length+1}}else cn(U,M,P,$,d);return g&&P.length<2e3&&x.set(U,P),P}const un=U=>{let x=U.state.languageDataAt("wordChars",U.pos).join(""),M=_e(x),S=U.matchBefore(Pe(M,A=>A+"$"));if(!S&&!U.explicit)return null;let d=S?S.from:U.pos,g=yn(U.state.doc,Ut(x),M,5e4,d);return{from:d,options:g,validFor:Pe(M,A=>"^"+A)}},$t={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},Ht=e.StateEffect.define({map(U,x){let M=x.mapPos(U,-1,e.MapMode.TrackAfter);return M??void 0}}),pn=new class extends e.RangeValue{};pn.startSide=1,pn.endSide=-1;const dn=e.StateField.define({create(){return e.RangeSet.empty},update(U,x){if(U=U.map(x.changes),x.selection){let M=x.state.doc.lineAt(x.selection.main.head);U=U.update({filter:S=>S>=M.from&&S<=M.to})}for(let M of x.effects)M.is(Ht)&&(U=U.update({add:[pn.range(M.value,M.value+1)]}));return U}});function On(){return[q,dn]}const Ot="()[]{}<>Â«Â»Â»Â«ï¼»ï¼½ï½›ï½";function Xn(U){for(let x=0;x<Ot.length;x+=2)if(Ot.charCodeAt(x)==U)return Ot.charAt(x+1);return e.fromCodePoint(U<128?U:U+1)}function Ei(U,x){return U.languageDataAt("closeBrackets",x)[0]||$t}const Ai=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),q=n.EditorView.inputHandler.of((U,x,M,S)=>{if((Ai?U.composing:U.compositionStarted)||U.state.readOnly)return!1;let d=U.state.selection.main;if(S.length>2||S.length==2&&e.codePointSize(e.codePointAt(S,0))==1||x!=d.from||M!=d.to)return!1;let g=E(U.state,S);return g?(U.dispatch(g),!0):!1}),f=({state:U,dispatch:x})=>{if(U.readOnly)return!1;let S=Ei(U,U.selection.main.head).brackets||$t.brackets,d=null,g=U.changeByRange(A=>{if(A.empty){let P=V(U.doc,A.head);for(let $ of S)if($==P&&B(U.doc,A.head)==Xn(e.codePointAt($,0)))return{changes:{from:A.head-$.length,to:A.head+$.length},range:e.EditorSelection.cursor(A.head-$.length)}}return{range:d=A}});return d||x(U.update(g,{scrollIntoView:!0,userEvent:"delete.backward"})),!d},m=[{key:"Backspace",run:f}];function E(U,x){let M=Ei(U,U.selection.main.head),S=M.brackets||$t.brackets;for(let d of S){let g=Xn(e.codePointAt(d,0));if(x==d)return g==d?Te(U,d,S.indexOf(d+d+d)>-1,M):ee(U,d,g,M.before||$t.before);if(x==g&&C(U,U.selection.main.from))return ce(U,d,g)}return null}function C(U,x){let M=!1;return U.field(dn).between(0,U.doc.length,S=>{S==x&&(M=!0)}),M}function B(U,x){let M=U.sliceString(x,x+2);return M.slice(0,e.codePointSize(e.codePointAt(M,0)))}function V(U,x){let M=U.sliceString(x-2,x);return e.codePointSize(e.codePointAt(M,0))==M.length?M:M.slice(1)}function ee(U,x,M,S){let d=null,g=U.changeByRange(A=>{if(!A.empty)return{changes:[{insert:x,from:A.from},{insert:M,from:A.to}],effects:Ht.of(A.to+x.length),range:e.EditorSelection.range(A.anchor+x.length,A.head+x.length)};let P=B(U.doc,A.head);return!P||/\s/.test(P)||S.indexOf(P)>-1?{changes:{insert:x+M,from:A.head},effects:Ht.of(A.head+x.length),range:e.EditorSelection.cursor(A.head+x.length)}:{range:d=A}});return d?null:U.update(g,{scrollIntoView:!0,userEvent:"input.type"})}function ce(U,x,M){let S=null,d=U.changeByRange(g=>g.empty&&B(U.doc,g.head)==M?{changes:{from:g.head,to:g.head+M.length,insert:M},range:e.EditorSelection.cursor(g.head+M.length)}:S={range:g});return S?null:U.update(d,{scrollIntoView:!0,userEvent:"input.type"})}function Te(U,x,M,S){let d=S.stringPrefixes||$t.stringPrefixes,g=null,A=U.changeByRange(P=>{if(!P.empty)return{changes:[{insert:x,from:P.from},{insert:x,from:P.to}],effects:Ht.of(P.to+x.length),range:e.EditorSelection.range(P.anchor+x.length,P.head+x.length)};let $=P.head,X=B(U.doc,$),he;if(X==x){if(De(U,$))return{changes:{insert:x+x,from:$},effects:Ht.of($+x.length),range:e.EditorSelection.cursor($+x.length)};if(C(U,$)){let Re=M&&U.sliceDoc($,$+x.length*3)==x+x+x?x+x+x:x;return{changes:{from:$,to:$+Re.length,insert:Re},range:e.EditorSelection.cursor($+Re.length)}}}else{if(M&&U.sliceDoc($-2*x.length,$)==x+x&&(he=nt(U,$-2*x.length,d))>-1&&De(U,he))return{changes:{insert:x+x+x+x,from:$},effects:Ht.of($+x.length),range:e.EditorSelection.cursor($+x.length)};if(U.charCategorizer($)(X)!=e.CharCategory.Word&&nt(U,$,d)>-1&&!je(U,$,x,d))return{changes:{insert:x+x,from:$},effects:Ht.of($+x.length),range:e.EditorSelection.cursor($+x.length)}}return{range:g=P}});return g?null:U.update(A,{scrollIntoView:!0,userEvent:"input.type"})}function De(U,x){let M=r.syntaxTree(U).resolveInner(x+1);return M.parent&&M.from==x}function je(U,x,M,S){let d=r.syntaxTree(U).resolveInner(x,-1),g=S.reduce((A,P)=>Math.max(A,P.length),0);for(let A=0;A<5;A++){let P=U.sliceDoc(d.from,Math.min(d.to,d.from+M.length+g)),$=P.indexOf(M);if(!$||$>-1&&S.indexOf(P.slice(0,$))>-1){let he=d.firstChild;for(;he&&he.from==d.from&&he.to-he.from>M.length+$;){if(U.sliceDoc(he.to-M.length,he.to)==M)return!1;he=he.firstChild}return!0}let X=d.to==x&&d.parent;if(!X)break;d=X}return!1}function nt(U,x,M){let S=U.charCategorizer(x);if(S(U.sliceDoc(x-1,x))!=e.CharCategory.Word)return x;for(let d of M){let g=x-d.length;if(U.sliceDoc(g,x)==d&&S(U.sliceDoc(g-1,g))!=e.CharCategory.Word)return g}return-1}function it(U={}){return[re,yt,We.of(U),O,An,me]}const zt=[{key:"Ctrl-Space",run:sn},{mac:"Alt-`",run:sn},{key:"Escape",run:oe},{key:"ArrowDown",run:It(!0)},{key:"ArrowUp",run:It(!1)},{key:"PageDown",run:It(!0,"page")},{key:"PageUp",run:It(!1,"page")},{key:"Enter",run:gn}],An=e.Prec.highest(n.keymap.computeN([We],U=>U.facet(We).defaultKeymap?[zt]:[]));function on(U){let x=U.field(yt,!1);return x&&x.active.some(M=>M.isPending)?"pending":x&&x.active.some(M=>M.state!=0)?"active":null}const Zn=new WeakMap;function wi(U){var x;let M=(x=U.field(yt,!1))===null||x===void 0?void 0:x.open;if(!M||M.disabled)return[];let S=Zn.get(M.options);return S||Zn.set(M.options,S=M.options.map(d=>d.completion)),S}function ei(U){var x;let M=(x=U.field(yt,!1))===null||x===void 0?void 0:x.open;return M&&!M.disabled&&M.selected>=0?M.options[M.selected].completion:null}function si(U){var x;let M=(x=U.field(yt,!1))===null||x===void 0?void 0:x.open;return M&&!M.disabled&&M.selected>=0?M.selected:null}function ki(U){return Ct.of(U)}return an.CompletionContext=o,an.acceptCompletion=gn,an.autocompletion=it,an.clearSnippet=en,an.closeBrackets=On,an.closeBracketsKeymap=m,an.closeCompletion=oe,an.completeAnyWord=un,an.completeFromList=y,an.completionKeymap=zt,an.completionStatus=on,an.currentCompletions=wi,an.deleteBracketPair=f,an.hasNextSnippetField=J,an.hasPrevSnippetField=j,an.ifIn=N,an.ifNotIn=D,an.insertBracket=E,an.insertCompletionText=te,an.moveCompletionSelection=It,an.nextSnippetField=At,an.pickedCompletion=ne,an.prevSnippetField=Lt,an.selectedCompletion=ei,an.selectedCompletionIndex=si,an.setSelectedCompletion=ki,an.snippet=ht,an.snippetCompletion=fe,an.snippetKeymap=se,an.startCompletion=sn,an}var ni={},vc;function dp(){if(vc)return ni;vc=1;var e=Nr(),n=tr(),r=Vl();class o{constructor(T,L,O){this.from=T,this.to=L,this.diagnostic=O}}class l{constructor(T,L,O){this.diagnostics=T,this.panel=L,this.selected=O}static init(T,L,O){let H=O.facet(ut).markerFilter;H&&(T=H(T,O));let re=T.slice().sort((Ue,He)=>Ue.from-He.from||Ue.to-He.to),me=new n.RangeSetBuilder,Ee=[],Fe=0;for(let Ue=0;;){let He=Ue==re.length?null:re[Ue];if(!He&&!Ee.length)break;let Ze,lt;for(Ee.length?(Ze=Fe,lt=Ee.reduce((gt,kt)=>Math.min(gt,kt.to),He&&He.from>Ze?He.from:1e8)):(Ze=He.from,lt=He.to,Ee.push(He),Ue++);Ue<re.length;){let gt=re[Ue];if(gt.from==Ze&&(gt.to>gt.from||gt.to==Ze))Ee.push(gt),Ue++,lt=Math.min(gt.to,lt);else{lt=Math.min(gt.from,lt);break}}let qt=rt(Ee);if(Ee.some(gt=>gt.from==gt.to||gt.from==gt.to-1&&O.doc.lineAt(gt.from).to==gt.from))me.add(Ze,Ze,e.Decoration.widget({widget:new pt(qt),diagnostics:Ee.slice()}));else{let gt=Ee.reduce((kt,ht)=>ht.markClass?kt+" "+ht.markClass:kt,"");me.add(Ze,lt,e.Decoration.mark({class:"cm-lintRange cm-lintRange-"+qt+gt,diagnostics:Ee.slice(),inclusiveEnd:Ee.some(kt=>kt.to>lt)}))}Fe=lt;for(let gt=0;gt<Ee.length;gt++)Ee[gt].to<=Fe&&Ee.splice(gt--,1)}let Be=me.finish();return new l(Be,L,h(Be))}}function h(b,T=null,L=0){let O=null;return b.between(L,1e9,(H,re,{spec:me})=>{if(!(T&&me.diagnostics.indexOf(T)<0))if(!O)O=new o(H,re,T||me.diagnostics[0]);else{if(me.diagnostics.indexOf(O.diagnostic)<0)return!1;O=new o(O.from,re,O.diagnostic)}}),O}function y(b,T){let L=T.pos,O=T.end||L,H=b.state.facet(ut).hideOn(b,L,O);if(H!=null)return H;let re=b.startState.doc.lineAt(T.pos);return!!(b.effects.some(me=>me.is(R))||b.changes.touchesRange(re.from,Math.max(re.to,O)))}function N(b,T){return b.field(ne,!1)?T:T.concat(n.StateEffect.appendConfig.of(It))}function D(b,T){return{effects:N(b,[R.of(T)])}}const R=n.StateEffect.define(),W=n.StateEffect.define(),z=n.StateEffect.define(),ne=n.StateField.define({create(){return new l(e.Decoration.none,null,null)},update(b,T){if(T.docChanged&&b.diagnostics.size){let L=b.diagnostics.map(T.changes),O=null,H=b.panel;if(b.selected){let re=T.changes.mapPos(b.selected.from,1);O=h(L,b.selected.diagnostic,re)||h(L,null,re)}!L.size&&H&&T.state.facet(ut).autoPanel&&(H=null),b=new l(L,H,O)}for(let L of T.effects)if(L.is(R)){let O=T.state.facet(ut).autoPanel?L.value.length?qe.open:null:b.panel;b=l.init(L.value,O,T.state)}else L.is(W)?b=new l(b.diagnostics,L.value?qe.open:null,b.selected):L.is(z)&&(b=new l(b.diagnostics,b.panel,L.value));return b},provide:b=>[e.showPanel.from(b,T=>T.panel),e.EditorView.decorations.from(b,T=>T.diagnostics)]});function te(b){let T=b.field(ne,!1);return T?T.diagnostics.size:0}const be=e.Decoration.mark({class:"cm-lintRange cm-lintRange-active"});function Ne(b,T,L){let{diagnostics:O}=b.state.field(ne),H,re=-1,me=-1;O.between(T-(L<0?1:0),T+(L>0?1:0),(Fe,Be,{spec:Ue})=>{if(T>=Fe&&T<=Be&&(Fe==Be||(T>Fe||L>0)&&(T<Be||L<0)))return H=Ue.diagnostics,re=Fe,me=Be,!1});let Ee=b.state.facet(ut).tooltipFilter;return H&&Ee&&(H=Ee(H,b.state)),H?{pos:re,end:me,above:b.state.doc.lineAt(re).to<me,create(){return{dom:Se(b,H)}}}:null}function Se(b,T){return r("ul",{class:"cm-tooltip-lint"},T.map(L=>Kt(b,L,!1)))}const xe=b=>{let T=b.state.field(ne,!1);(!T||!T.panel)&&b.dispatch({effects:N(b.state,[W.of(!0)])});let L=e.getPanel(b,qe.open);return L&&L.dom.querySelector(".cm-panel-lint ul").focus(),!0},Qe=b=>{let T=b.state.field(ne,!1);return!T||!T.panel?!1:(b.dispatch({effects:W.of(!1)}),!0)},Ge=b=>{let T=b.state.field(ne,!1);if(!T)return!1;let L=b.state.selection.main,O=T.diagnostics.iter(L.to+1);return!O.value&&(O=T.diagnostics.iter(0),!O.value||O.from==L.from&&O.to==L.to)?!1:(b.dispatch({selection:{anchor:O.from,head:O.to},scrollIntoView:!0}),!0)},We=b=>{let{state:T}=b,L=T.field(ne,!1);if(!L)return!1;let O=T.selection.main,H,re,me,Ee;return L.diagnostics.between(0,T.doc.length,(Fe,Be)=>{Be<O.to&&(H==null||H<Fe)&&(H=Fe,re=Be),(me==null||Fe>me)&&(me=Fe,Ee=Be)}),me==null||H==null&&me==O.from?!1:(b.dispatch({selection:{anchor:H??me,head:re??Ee},scrollIntoView:!0}),!0)},ot=[{key:"Mod-Shift-m",run:xe,preventDefault:!0},{key:"F8",run:Ge}],ft=e.ViewPlugin.fromClass(class{constructor(b){this.view=b,this.timeout=-1,this.set=!0;let{delay:T}=b.state.facet(ut);this.lintTime=Date.now()+T,this.run=this.run.bind(this),this.timeout=setTimeout(this.run,T)}run(){clearTimeout(this.timeout);let b=Date.now();if(b<this.lintTime-10)this.timeout=setTimeout(this.run,this.lintTime-b);else{this.set=!1;let{state:T}=this.view,{sources:L}=T.facet(ut);L.length&&Et(L.map(O=>Promise.resolve(O(this.view))),O=>{this.view.state.doc==T.doc&&this.view.dispatch(D(this.view.state,O.reduce((H,re)=>H.concat(re))))},O=>{e.logException(this.view.state,O)})}}update(b){let T=b.state.facet(ut);(b.docChanged||T!=b.startState.facet(ut)||T.needsRefresh&&T.needsRefresh(b))&&(this.lintTime=Date.now()+T.delay,this.set||(this.set=!0,this.timeout=setTimeout(this.run,T.delay)))}force(){this.set&&(this.lintTime=Date.now(),this.run())}destroy(){clearTimeout(this.timeout)}});function Et(b,T,L){let O=[],H=-1;for(let re of b)re.then(me=>{O.push(me),clearTimeout(H),O.length==b.length?T(O):H=setTimeout(()=>T(O),200)},L)}const ut=n.Facet.define({combine(b){return Object.assign({sources:b.map(T=>T.source).filter(T=>T!=null)},n.combineConfig(b.map(T=>T.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(T,L)=>T?L?O=>T(O)||L(O):T:L}))}});function rn(b,T={}){return[ut.of({source:b,config:T}),ft,It]}function Xt(b){let T=b.plugin(ft);T&&T.force()}function Qt(b){let T=[];if(b)e:for(let{name:L}of b){for(let O=0;O<L.length;O++){let H=L[O];if(/[a-zA-Z]/.test(H)&&!T.some(re=>re.toLowerCase()==H.toLowerCase())){T.push(H);continue e}}T.push("")}return T}function Kt(b,T,L){var O;let H=L?Qt(T.actions):[];return r("li",{class:"cm-diagnostic cm-diagnostic-"+T.severity},r("span",{class:"cm-diagnosticText"},T.renderMessage?T.renderMessage(b):T.message),(O=T.actions)===null||O===void 0?void 0:O.map((re,me)=>{let Ee=!1,Fe=Ze=>{if(Ze.preventDefault(),Ee)return;Ee=!0;let lt=h(b.state.field(ne).diagnostics,T);lt&&re.apply(b,lt.from,lt.to)},{name:Be}=re,Ue=H[me]?Be.indexOf(H[me]):-1,He=Ue<0?Be:[Be.slice(0,Ue),r("u",Be.slice(Ue,Ue+1)),Be.slice(Ue+1)];return r("button",{type:"button",class:"cm-diagnosticAction",onclick:Fe,onmousedown:Fe,"aria-label":` Action: ${Be}${Ue<0?"":` (access key "${H[me]})"`}.`},He)}),T.source&&r("div",{class:"cm-diagnosticSource"},T.source))}class pt extends e.WidgetType{constructor(T){super(),this.sev=T}eq(T){return T.sev==this.sev}toDOM(){return r("span",{class:"cm-lintPoint cm-lintPoint-"+this.sev})}}class Vt{constructor(T,L){this.diagnostic=L,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=Kt(T,L,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class qe{constructor(T){this.view=T,this.items=[];let L=H=>{if(H.keyCode==27)Qe(this.view),this.view.focus();else if(H.keyCode==38||H.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(H.keyCode==40||H.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(H.keyCode==36)this.moveSelection(0);else if(H.keyCode==35)this.moveSelection(this.items.length-1);else if(H.keyCode==13)this.view.focus();else if(H.keyCode>=65&&H.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:re}=this.items[this.selectedIndex],me=Qt(re.actions);for(let Ee=0;Ee<me.length;Ee++)if(me[Ee].toUpperCase().charCodeAt(0)==H.keyCode){let Fe=h(this.view.state.field(ne).diagnostics,re);Fe&&re.actions[Ee].apply(T,Fe.from,Fe.to)}}else return;H.preventDefault()},O=H=>{for(let re=0;re<this.items.length;re++)this.items[re].dom.contains(H.target)&&this.moveSelection(re)};this.list=r("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:L,onclick:O}),this.dom=r("div",{class:"cm-panel-lint"},this.list,r("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>Qe(this.view)},"Ã—")),this.update()}get selectedIndex(){let T=this.view.state.field(ne).selected;if(!T)return-1;for(let L=0;L<this.items.length;L++)if(this.items[L].diagnostic==T.diagnostic)return L;return-1}update(){let{diagnostics:T,selected:L}=this.view.state.field(ne),O=0,H=!1,re=null,me=new Set;for(T.between(0,this.view.state.doc.length,(Ee,Fe,{spec:Be})=>{for(let Ue of Be.diagnostics){if(me.has(Ue))continue;me.add(Ue);let He=-1,Ze;for(let lt=O;lt<this.items.length;lt++)if(this.items[lt].diagnostic==Ue){He=lt;break}He<0?(Ze=new Vt(this.view,Ue),this.items.splice(O,0,Ze),H=!0):(Ze=this.items[He],He>O&&(this.items.splice(O,He-O),H=!0)),L&&Ze.diagnostic==L.diagnostic?Ze.dom.hasAttribute("aria-selected")||(Ze.dom.setAttribute("aria-selected","true"),re=Ze):Ze.dom.hasAttribute("aria-selected")&&Ze.dom.removeAttribute("aria-selected"),O++}});O<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)H=!0,this.items.pop();this.items.length==0&&(this.items.push(new Vt(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),H=!0),re?(this.list.setAttribute("aria-activedescendant",re.id),this.view.requestMeasure({key:this,read:()=>({sel:re.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:Ee,panel:Fe})=>{let Be=Fe.height/this.list.offsetHeight;Ee.top<Fe.top?this.list.scrollTop-=(Fe.top-Ee.top)/Be:Ee.bottom>Fe.bottom&&(this.list.scrollTop+=(Ee.bottom-Fe.bottom)/Be)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),H&&this.sync()}sync(){let T=this.list.firstChild;function L(){let O=T;T=O.nextSibling,O.remove()}for(let O of this.items)if(O.dom.parentNode==this.list){for(;T!=O.dom;)L();T=O.dom.nextSibling}else this.list.insertBefore(O.dom,T);for(;T;)L()}moveSelection(T){if(this.selectedIndex<0)return;let L=this.view.state.field(ne),O=h(L.diagnostics,this.items[T].diagnostic);O&&this.view.dispatch({selection:{anchor:O.from,head:O.to},scrollIntoView:!0,effects:z.of(O)})}static open(T){return new qe(T)}}function Mt(b,T='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${T}>${encodeURIComponent(b)}</svg>')`}function Je(b){return Mt(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${b}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const we=e.EditorView.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Je("#d11")},".cm-lintRange-warning":{backgroundImage:Je("orange")},".cm-lintRange-info":{backgroundImage:Je("#999")},".cm-lintRange-hint":{backgroundImage:Je("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function ze(b){return b=="error"?4:b=="warning"?3:b=="info"?2:1}function rt(b){let T="hint",L=1;for(let O of b){let H=ze(O.severity);H>L&&(L=H,T=O.severity)}return T}class tt extends e.GutterMarker{constructor(T){super(),this.diagnostics=T,this.severity=rt(T)}toDOM(T){let L=document.createElement("div");L.className="cm-lint-marker cm-lint-marker-"+this.severity;let O=this.diagnostics,H=T.state.facet(gn).tooltipFilter;return H&&(O=H(O,T.state)),O.length&&(L.onmouseover=()=>st(T,L,O)),L}}function Ye(b,T){let L=O=>{let H=T.getBoundingClientRect();if(!(O.clientX>H.left-10&&O.clientX<H.right+10&&O.clientY>H.top-10&&O.clientY<H.bottom+10)){for(let re=O.target;re;re=re.parentNode)if(re.nodeType==1&&re.classList.contains("cm-tooltip-lint"))return;window.removeEventListener("mousemove",L),b.state.field(wt)&&b.dispatch({effects:yt.of(null)})}};window.addEventListener("mousemove",L)}function st(b,T,L){function O(){let me=b.elementAtHeight(T.getBoundingClientRect().top+5-b.documentTop);b.coordsAtPos(me.from)&&b.dispatch({effects:yt.of({pos:me.from,above:!1,clip:!1,create(){return{dom:Se(b,L),getCoords:()=>T.getBoundingClientRect()}}})}),T.onmouseout=T.onmousemove=null,Ye(b,T)}let{hoverTime:H}=b.state.facet(gn),re=setTimeout(O,H);T.onmouseout=()=>{clearTimeout(re),T.onmouseout=T.onmousemove=null},T.onmousemove=()=>{clearTimeout(re),re=setTimeout(O,H)}}function Nt(b,T){let L=Object.create(null);for(let H of T){let re=b.lineAt(H.from);(L[re.from]||(L[re.from]=[])).push(H)}let O=[];for(let H in L)O.push(new tt(L[H]).range(+H));return n.RangeSet.of(O,!0)}const jt=e.gutter({class:"cm-gutter-lint",markers:b=>b.state.field(Ct),widgetMarker:(b,T,L)=>{let O=[];return b.state.field(Ct).between(L.from,L.to,(H,re,me)=>{H>L.from&&H<L.to&&O.push(...me.diagnostics)}),O.length?new tt(O):null}}),Ct=n.StateField.define({create(){return n.RangeSet.empty},update(b,T){b=b.map(T.changes);let L=T.state.facet(gn).markerFilter;for(let O of T.effects)if(O.is(R)){let H=O.value;L&&(H=L(H||[],T.state)),b=Nt(T.state.doc,H.slice(0))}return b}}),yt=n.StateEffect.define(),wt=n.StateField.define({create(){return null},update(b,T){return b&&T.docChanged&&(b=y(T,b)?null:Object.assign(Object.assign({},b),{pos:T.changes.mapPos(b.pos)})),T.effects.reduce((L,O)=>O.is(yt)?O.value:L,b)},provide:b=>e.showTooltip.from(b)}),Pt=e.EditorView.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:Mt('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:Mt('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error":{content:Mt('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),It=[ne,e.EditorView.decorations.compute([ne],b=>{let{selected:T,panel:L}=b.field(ne);return!T||!L||T.from==T.to?e.Decoration.none:e.Decoration.set([be.range(T.from,T.to)])}),e.hoverTooltip(Ne,{hideOn:y}),we],gn=n.Facet.define({combine(b){return n.combineConfig(b,{hoverTime:300,markerFilter:null,tooltipFilter:null})}});function sn(b={}){return[gn.of(b),Ct,jt,Pt,wt]}function oe(b,T){let L=b.field(ne,!1);if(L&&L.diagnostics.size){let O=[],H=[],re=-1;for(let me=n.RangeSet.iter([L.diagnostics]);;me.next()){for(let Ee=0;Ee<O.length;Ee++)(!me.value||me.value.spec.diagnostics.indexOf(O[Ee])<0)&&(T(O[Ee],H[Ee],re),O.splice(Ee,1),H.splice(Ee--,1));if(!me.value)break;for(let Ee of me.value.spec.diagnostics)O.indexOf(Ee)<0&&(O.push(Ee),H.push(me.from));re=me.to}}}return ni.closeLintPanel=Qe,ni.diagnosticCount=te,ni.forEachDiagnostic=oe,ni.forceLinting=Xt,ni.lintGutter=sn,ni.lintKeymap=ot,ni.linter=rn,ni.nextDiagnostic=Ge,ni.openLintPanel=xe,ni.previousDiagnostic=We,ni.setDiagnostics=D,ni.setDiagnosticsEffect=R,ni}var bc;function pp(){return bc||(bc=1,function(e){var n=Nr(),r=tr(),o=Ul(),l=up(),h=hp(),y=fp(),N=dp();const D=[n.lineNumbers(),n.highlightActiveLineGutter(),n.highlightSpecialChars(),l.history(),o.foldGutter(),n.drawSelection(),n.dropCursor(),r.EditorState.allowMultipleSelections.of(!0),o.indentOnInput(),o.syntaxHighlighting(o.defaultHighlightStyle,{fallback:!0}),o.bracketMatching(),y.closeBrackets(),y.autocompletion(),n.rectangularSelection(),n.crosshairCursor(),n.highlightActiveLine(),h.highlightSelectionMatches(),n.keymap.of([...y.closeBracketsKeymap,...l.defaultKeymap,...h.searchKeymap,...l.historyKeymap,...o.foldKeymap,...y.completionKeymap,...N.lintKeymap])],R=[n.highlightSpecialChars(),l.history(),n.drawSelection(),o.syntaxHighlighting(o.defaultHighlightStyle,{fallback:!0}),n.keymap.of([...l.defaultKeymap,...l.historyKeymap])];Object.defineProperty(e,"EditorView",{enumerable:!0,get:function(){return n.EditorView}}),e.basicSetup=D,e.minimalSetup=R}(Zo)),Zo}var hr={};function hn(e,n){if(!!!e)throw new Error(n)}function Xi(e){return typeof e=="object"&&e!==null}function li(e,n){if(!!!e)throw new Error(n??"Unexpected invariant triggered.")}const mp=/\r\n|[\n\r]/g;function fl(e,n){let r=0,o=1;for(const l of e.body.matchAll(mp)){if(typeof l.index=="number"||li(!1),l.index>=n)break;r=l.index+l[0].length,o+=1}return{line:o,column:n+1-r}}function gp(e){return qu(e.source,fl(e.source,e.start))}function qu(e,n){const r=e.locationOffset.column-1,o="".padStart(r)+e.body,l=n.line-1,h=e.locationOffset.line-1,y=n.line+h,N=n.line===1?r:0,D=n.column+N,R=`${e.name}:${y}:${D}
`,W=o.split(/\r\n|[\n\r]/g),z=W[l];if(z.length>120){const ne=Math.floor(D/80),te=D%80,be=[];for(let Ne=0;Ne<z.length;Ne+=80)be.push(z.slice(Ne,Ne+80));return R+Sc([[`${y} |`,be[0]],...be.slice(1,ne+1).map(Ne=>["|",Ne]),["|","^".padStart(te)],["|",be[ne+1]]])}return R+Sc([[`${y-1} |`,W[l-1]],[`${y} |`,z],["|","^".padStart(D)],[`${y+1} |`,W[l+1]]])}function Sc(e){const n=e.filter(([o,l])=>l!==void 0),r=Math.max(...n.map(([o])=>o.length));return n.map(([o,l])=>o.padStart(r)+(l?" "+l:"")).join(`
`)}function yp(e){const n=e[0];return n==null||"kind"in n||"length"in n?{nodes:n,source:e[1],positions:e[2],path:e[3],originalError:e[4],extensions:e[5]}:n}class Ve extends Error{constructor(n,...r){var o,l,h;const{nodes:y,source:N,positions:D,path:R,originalError:W,extensions:z}=yp(r);super(n),this.name="GraphQLError",this.path=R??void 0,this.originalError=W??void 0,this.nodes=Tc(Array.isArray(y)?y:y?[y]:void 0);const ne=Tc((o=this.nodes)===null||o===void 0?void 0:o.map(be=>be.loc).filter(be=>be!=null));this.source=N??(ne==null||(l=ne[0])===null||l===void 0?void 0:l.source),this.positions=D??ne?.map(be=>be.start),this.locations=D&&N?D.map(be=>fl(N,be)):ne?.map(be=>fl(be.source,be.start));const te=Xi(W?.extensions)?W?.extensions:void 0;this.extensions=(h=z??te)!==null&&h!==void 0?h:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),W!=null&&W.stack?Object.defineProperty(this,"stack",{value:W.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,Ve):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let n=this.message;if(this.nodes)for(const r of this.nodes)r.loc&&(n+=`

`+gp(r.loc));else if(this.source&&this.locations)for(const r of this.locations)n+=`

`+qu(this.source,r);return n}toJSON(){const n={message:this.message};return this.locations!=null&&(n.locations=this.locations),this.path!=null&&(n.path=this.path),this.extensions!=null&&Object.keys(this.extensions).length>0&&(n.extensions=this.extensions),n}}function Tc(e){return e===void 0||e.length===0?void 0:e}function Wn(e,n,r){return new Ve(`Syntax Error: ${r}`,{source:e,positions:[n]})}let vp=class{constructor(n,r,o){this.start=n.start,this.end=r.end,this.startToken=n,this.endToken=r,this.source=o}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}};class zu{constructor(n,r,o,l,h,y){this.kind=n,this.start=r,this.end=o,this.line=l,this.column=h,this.value=y,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}const Gu={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},bp=new Set(Object.keys(Gu));function dl(e){const n=e?.kind;return typeof n=="string"&&bp.has(n)}var Kn;(function(e){e.QUERY="query",e.MUTATION="mutation",e.SUBSCRIPTION="subscription"})(Kn||(Kn={}));var et;(function(e){e.QUERY="QUERY",e.MUTATION="MUTATION",e.SUBSCRIPTION="SUBSCRIPTION",e.FIELD="FIELD",e.FRAGMENT_DEFINITION="FRAGMENT_DEFINITION",e.FRAGMENT_SPREAD="FRAGMENT_SPREAD",e.INLINE_FRAGMENT="INLINE_FRAGMENT",e.VARIABLE_DEFINITION="VARIABLE_DEFINITION",e.SCHEMA="SCHEMA",e.SCALAR="SCALAR",e.OBJECT="OBJECT",e.FIELD_DEFINITION="FIELD_DEFINITION",e.ARGUMENT_DEFINITION="ARGUMENT_DEFINITION",e.INTERFACE="INTERFACE",e.UNION="UNION",e.ENUM="ENUM",e.ENUM_VALUE="ENUM_VALUE",e.INPUT_OBJECT="INPUT_OBJECT",e.INPUT_FIELD_DEFINITION="INPUT_FIELD_DEFINITION"})(et||(et={}));var Z;(function(e){e.NAME="Name",e.DOCUMENT="Document",e.OPERATION_DEFINITION="OperationDefinition",e.VARIABLE_DEFINITION="VariableDefinition",e.SELECTION_SET="SelectionSet",e.FIELD="Field",e.ARGUMENT="Argument",e.FRAGMENT_SPREAD="FragmentSpread",e.INLINE_FRAGMENT="InlineFragment",e.FRAGMENT_DEFINITION="FragmentDefinition",e.VARIABLE="Variable",e.INT="IntValue",e.FLOAT="FloatValue",e.STRING="StringValue",e.BOOLEAN="BooleanValue",e.NULL="NullValue",e.ENUM="EnumValue",e.LIST="ListValue",e.OBJECT="ObjectValue",e.OBJECT_FIELD="ObjectField",e.DIRECTIVE="Directive",e.NAMED_TYPE="NamedType",e.LIST_TYPE="ListType",e.NON_NULL_TYPE="NonNullType",e.SCHEMA_DEFINITION="SchemaDefinition",e.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",e.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",e.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",e.FIELD_DEFINITION="FieldDefinition",e.INPUT_VALUE_DEFINITION="InputValueDefinition",e.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",e.UNION_TYPE_DEFINITION="UnionTypeDefinition",e.ENUM_TYPE_DEFINITION="EnumTypeDefinition",e.ENUM_VALUE_DEFINITION="EnumValueDefinition",e.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",e.DIRECTIVE_DEFINITION="DirectiveDefinition",e.SCHEMA_EXTENSION="SchemaExtension",e.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",e.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",e.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",e.UNION_TYPE_EXTENSION="UnionTypeExtension",e.ENUM_TYPE_EXTENSION="EnumTypeExtension",e.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"})(Z||(Z={}));function pl(e){return e===9||e===32}function rs(e){return e>=48&&e<=57}function Yu(e){return e>=97&&e<=122||e>=65&&e<=90}function $l(e){return Yu(e)||e===95}function Ju(e){return Yu(e)||rs(e)||e===95}function Sp(e){var n;let r=Number.MAX_SAFE_INTEGER,o=null,l=-1;for(let y=0;y<e.length;++y){var h;const N=e[y],D=Tp(N);D!==N.length&&(o=(h=o)!==null&&h!==void 0?h:y,l=y,y!==0&&D<r&&(r=D))}return e.map((y,N)=>N===0?y:y.slice(r)).slice((n=o)!==null&&n!==void 0?n:0,l+1)}function Tp(e){let n=0;for(;n<e.length&&pl(e.charCodeAt(n));)++n;return n}function Ep(e,n){const r=e.replace(/"""/g,'\\"""'),o=r.split(/\r\n|[\n\r]/g),l=o.length===1,h=o.length>1&&o.slice(1).every(te=>te.length===0||pl(te.charCodeAt(0))),y=r.endsWith('\\"""'),N=e.endsWith('"')&&!y,D=e.endsWith("\\"),R=N||D,W=!l||e.length>70||R||h||y;let z="";const ne=l&&pl(e.charCodeAt(0));return(W&&!ne||h)&&(z+=`
`),z+=r,(W||R)&&(z+=`
`),'"""'+z+'"""'}var Le;(function(e){e.SOF="<SOF>",e.EOF="<EOF>",e.BANG="!",e.DOLLAR="$",e.AMP="&",e.PAREN_L="(",e.PAREN_R=")",e.SPREAD="...",e.COLON=":",e.EQUALS="=",e.AT="@",e.BRACKET_L="[",e.BRACKET_R="]",e.BRACE_L="{",e.PIPE="|",e.BRACE_R="}",e.NAME="Name",e.INT="Int",e.FLOAT="Float",e.STRING="String",e.BLOCK_STRING="BlockString",e.COMMENT="Comment"})(Le||(Le={}));class wp{constructor(n){const r=new zu(Le.SOF,0,0,0,0);this.source=n,this.lastToken=r,this.token=r,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){return this.lastToken=this.token,this.token=this.lookahead()}lookahead(){let n=this.token;if(n.kind!==Le.EOF)do if(n.next)n=n.next;else{const r=xp(this,n.end);n.next=r,r.prev=n,n=r}while(n.kind===Le.COMMENT);return n}}function kp(e){return e===Le.BANG||e===Le.DOLLAR||e===Le.AMP||e===Le.PAREN_L||e===Le.PAREN_R||e===Le.SPREAD||e===Le.COLON||e===Le.EQUALS||e===Le.AT||e===Le.BRACKET_L||e===Le.BRACKET_R||e===Le.BRACE_L||e===Le.PIPE||e===Le.BRACE_R}function Cr(e){return e>=0&&e<=55295||e>=57344&&e<=1114111}function go(e,n){return Xu(e.charCodeAt(n))&&Qu(e.charCodeAt(n+1))}function Xu(e){return e>=55296&&e<=56319}function Qu(e){return e>=56320&&e<=57343}function Qi(e,n){const r=e.source.body.codePointAt(n);if(r===void 0)return Le.EOF;if(r>=32&&r<=126){const o=String.fromCodePoint(r);return o==='"'?`'"'`:`"${o}"`}return"U+"+r.toString(16).toUpperCase().padStart(4,"0")}function Bn(e,n,r,o,l){const h=e.line,y=1+r-e.lineStart;return new zu(n,r,o,h,y,l)}function xp(e,n){const r=e.source.body,o=r.length;let l=n;for(;l<o;){const h=r.charCodeAt(l);switch(h){case 65279:case 9:case 32:case 44:++l;continue;case 10:++l,++e.line,e.lineStart=l;continue;case 13:r.charCodeAt(l+1)===10?l+=2:++l,++e.line,e.lineStart=l;continue;case 35:return Np(e,l);case 33:return Bn(e,Le.BANG,l,l+1);case 36:return Bn(e,Le.DOLLAR,l,l+1);case 38:return Bn(e,Le.AMP,l,l+1);case 40:return Bn(e,Le.PAREN_L,l,l+1);case 41:return Bn(e,Le.PAREN_R,l,l+1);case 46:if(r.charCodeAt(l+1)===46&&r.charCodeAt(l+2)===46)return Bn(e,Le.SPREAD,l,l+3);break;case 58:return Bn(e,Le.COLON,l,l+1);case 61:return Bn(e,Le.EQUALS,l,l+1);case 64:return Bn(e,Le.AT,l,l+1);case 91:return Bn(e,Le.BRACKET_L,l,l+1);case 93:return Bn(e,Le.BRACKET_R,l,l+1);case 123:return Bn(e,Le.BRACE_L,l,l+1);case 124:return Bn(e,Le.PIPE,l,l+1);case 125:return Bn(e,Le.BRACE_R,l,l+1);case 34:return r.charCodeAt(l+1)===34&&r.charCodeAt(l+2)===34?Mp(e,l):Ap(e,l)}if(rs(h)||h===45)return Cp(e,l,h);if($l(h))return Lp(e,l);throw Wn(e.source,l,h===39?`Unexpected single quote character ('), did you mean to use a double quote (")?`:Cr(h)||go(r,l)?`Unexpected character: ${Qi(e,l)}.`:`Invalid character: ${Qi(e,l)}.`)}return Bn(e,Le.EOF,o,o)}function Np(e,n){const r=e.source.body,o=r.length;let l=n+1;for(;l<o;){const h=r.charCodeAt(l);if(h===10||h===13)break;if(Cr(h))++l;else if(go(r,l))l+=2;else break}return Bn(e,Le.COMMENT,n,l,r.slice(n+1,l))}function Cp(e,n,r){const o=e.source.body;let l=n,h=r,y=!1;if(h===45&&(h=o.charCodeAt(++l)),h===48){if(h=o.charCodeAt(++l),rs(h))throw Wn(e.source,l,`Invalid number, unexpected digit after 0: ${Qi(e,l)}.`)}else l=sl(e,l,h),h=o.charCodeAt(l);if(h===46&&(y=!0,h=o.charCodeAt(++l),l=sl(e,l,h),h=o.charCodeAt(l)),(h===69||h===101)&&(y=!0,h=o.charCodeAt(++l),(h===43||h===45)&&(h=o.charCodeAt(++l)),l=sl(e,l,h),h=o.charCodeAt(l)),h===46||$l(h))throw Wn(e.source,l,`Invalid number, expected digit but got: ${Qi(e,l)}.`);return Bn(e,y?Le.FLOAT:Le.INT,n,l,o.slice(n,l))}function sl(e,n,r){if(!rs(r))throw Wn(e.source,n,`Invalid number, expected digit but got: ${Qi(e,n)}.`);const o=e.source.body;let l=n+1;for(;rs(o.charCodeAt(l));)++l;return l}function Ap(e,n){const r=e.source.body,o=r.length;let l=n+1,h=l,y="";for(;l<o;){const N=r.charCodeAt(l);if(N===34)return y+=r.slice(h,l),Bn(e,Le.STRING,n,l+1,y);if(N===92){y+=r.slice(h,l);const D=r.charCodeAt(l+1)===117?r.charCodeAt(l+2)===123?Dp(e,l):Ip(e,l):Op(e,l);y+=D.value,l+=D.size,h=l;continue}if(N===10||N===13)break;if(Cr(N))++l;else if(go(r,l))l+=2;else throw Wn(e.source,l,`Invalid character within String: ${Qi(e,l)}.`)}throw Wn(e.source,l,"Unterminated string.")}function Dp(e,n){const r=e.source.body;let o=0,l=3;for(;l<12;){const h=r.charCodeAt(n+l++);if(h===125){if(l<5||!Cr(o))break;return{value:String.fromCodePoint(o),size:l}}if(o=o<<4|Qr(h),o<0)break}throw Wn(e.source,n,`Invalid Unicode escape sequence: "${r.slice(n,n+l)}".`)}function Ip(e,n){const r=e.source.body,o=Ec(r,n+2);if(Cr(o))return{value:String.fromCodePoint(o),size:6};if(Xu(o)&&r.charCodeAt(n+6)===92&&r.charCodeAt(n+7)===117){const l=Ec(r,n+8);if(Qu(l))return{value:String.fromCodePoint(o,l),size:12}}throw Wn(e.source,n,`Invalid Unicode escape sequence: "${r.slice(n,n+6)}".`)}function Ec(e,n){return Qr(e.charCodeAt(n))<<12|Qr(e.charCodeAt(n+1))<<8|Qr(e.charCodeAt(n+2))<<4|Qr(e.charCodeAt(n+3))}function Qr(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:-1}function Op(e,n){const r=e.source.body;switch(r.charCodeAt(n+1)){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:`
`,size:2};case 114:return{value:"\r",size:2};case 116:return{value:"	",size:2}}throw Wn(e.source,n,`Invalid character escape sequence: "${r.slice(n,n+2)}".`)}function Mp(e,n){const r=e.source.body,o=r.length;let l=e.lineStart,h=n+3,y=h,N="";const D=[];for(;h<o;){const R=r.charCodeAt(h);if(R===34&&r.charCodeAt(h+1)===34&&r.charCodeAt(h+2)===34){N+=r.slice(y,h),D.push(N);const W=Bn(e,Le.BLOCK_STRING,n,h+3,Sp(D).join(`
`));return e.line+=D.length-1,e.lineStart=l,W}if(R===92&&r.charCodeAt(h+1)===34&&r.charCodeAt(h+2)===34&&r.charCodeAt(h+3)===34){N+=r.slice(y,h),y=h+1,h+=4;continue}if(R===10||R===13){N+=r.slice(y,h),D.push(N),R===13&&r.charCodeAt(h+1)===10?h+=2:++h,N="",y=h,l=h;continue}if(Cr(R))++h;else if(go(r,h))h+=2;else throw Wn(e.source,h,`Invalid character within String: ${Qi(e,h)}.`)}throw Wn(e.source,h,"Unterminated string.")}function Lp(e,n){const r=e.source.body,o=r.length;let l=n+1;for(;l<o;){const h=r.charCodeAt(l);if(Ju(h))++l;else break}return Bn(e,Le.NAME,n,l,r.slice(n,l))}const _p=10,Ku=2;function Ke(e){return yo(e,[])}function yo(e,n){switch(typeof e){case"string":return JSON.stringify(e);case"function":return e.name?`[function ${e.name}]`:"[function]";case"object":return Rp(e,n);default:return String(e)}}function Rp(e,n){if(e===null)return"null";if(n.includes(e))return"[Circular]";const r=[...n,e];if(Fp(e)){const o=e.toJSON();if(o!==e)return typeof o=="string"?o:yo(o,r)}else if(Array.isArray(e))return Bp(e,r);return Pp(e,r)}function Fp(e){return typeof e.toJSON=="function"}function Pp(e,n){const r=Object.entries(e);return r.length===0?"{}":n.length>Ku?"["+Vp(e)+"]":"{ "+r.map(([l,h])=>l+": "+yo(h,n)).join(", ")+" }"}function Bp(e,n){if(e.length===0)return"[]";if(n.length>Ku)return"[Array]";const r=Math.min(_p,e.length),o=e.length-r,l=[];for(let h=0;h<r;++h)l.push(yo(e[h],n));return o===1?l.push("... 1 more item"):o>1&&l.push(`... ${o} more items`),"["+l.join(", ")+"]"}function Vp(e){const n=Object.prototype.toString.call(e).replace(/^\[object /,"").replace(/]$/,"");if(n==="Object"&&typeof e.constructor=="function"){const r=e.constructor.name;if(typeof r=="string"&&r!=="")return r}return n}const jp=globalThis.process&&process.env.NODE_ENV==="production",Si=jp?function(n,r){return n instanceof r}:function(n,r){if(n instanceof r)return!0;if(typeof n=="object"&&n!==null){var o;const l=r.prototype[Symbol.toStringTag],h=Symbol.toStringTag in n?n[Symbol.toStringTag]:(o=n.constructor)===null||o===void 0?void 0:o.name;if(l===h){const y=Ke(n);throw new Error(`Cannot use ${l} "${y}" from another module or realm.

Ensure that there is only one instance of "graphql" in the node_modules
directory. If different versions of "graphql" are the dependencies of other
relied on modules, use "resolutions" to ensure only one version is installed.

https://yarnpkg.com/en/docs/selective-version-resolutions

Duplicate "graphql" modules cannot be used at the same time since different
versions may have different capabilities and behavior. The data from one
version used in the function from another could produce confusing and
spurious results.`)}}return!1};class Zu{constructor(n,r="GraphQL request",o={line:1,column:1}){typeof n=="string"||hn(!1,`Body must be a string. Received: ${Ke(n)}.`),this.body=n,this.name=r,this.locationOffset=o,this.locationOffset.line>0||hn(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||hn(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}function Up(e){return Si(e,Zu)}function Ar(e,n){const r=new $p(e,n),o=r.parseDocument();return Object.defineProperty(o,"tokenCount",{enumerable:!1,value:r.tokenCount}),o}class $p{constructor(n,r={}){const o=Up(n)?n:new Zu(n);this._lexer=new wp(o),this._options=r,this._tokenCounter=0}get tokenCount(){return this._tokenCounter}parseName(){const n=this.expectToken(Le.NAME);return this.node(n,{kind:Z.NAME,value:n.value})}parseDocument(){return this.node(this._lexer.token,{kind:Z.DOCUMENT,definitions:this.many(Le.SOF,this.parseDefinition,Le.EOF)})}parseDefinition(){if(this.peek(Le.BRACE_L))return this.parseOperationDefinition();const n=this.peekDescription(),r=n?this._lexer.lookahead():this._lexer.token;if(r.kind===Le.NAME){switch(r.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(n)throw Wn(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(r.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(r)}parseOperationDefinition(){const n=this._lexer.token;if(this.peek(Le.BRACE_L))return this.node(n,{kind:Z.OPERATION_DEFINITION,operation:Kn.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});const r=this.parseOperationType();let o;return this.peek(Le.NAME)&&(o=this.parseName()),this.node(n,{kind:Z.OPERATION_DEFINITION,operation:r,name:o,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){const n=this.expectToken(Le.NAME);switch(n.value){case"query":return Kn.QUERY;case"mutation":return Kn.MUTATION;case"subscription":return Kn.SUBSCRIPTION}throw this.unexpected(n)}parseVariableDefinitions(){return this.optionalMany(Le.PAREN_L,this.parseVariableDefinition,Le.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:Z.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(Le.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(Le.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){const n=this._lexer.token;return this.expectToken(Le.DOLLAR),this.node(n,{kind:Z.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:Z.SELECTION_SET,selections:this.many(Le.BRACE_L,this.parseSelection,Le.BRACE_R)})}parseSelection(){return this.peek(Le.SPREAD)?this.parseFragment():this.parseField()}parseField(){const n=this._lexer.token,r=this.parseName();let o,l;return this.expectOptionalToken(Le.COLON)?(o=r,l=this.parseName()):l=r,this.node(n,{kind:Z.FIELD,alias:o,name:l,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(Le.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(n){const r=n?this.parseConstArgument:this.parseArgument;return this.optionalMany(Le.PAREN_L,r,Le.PAREN_R)}parseArgument(n=!1){const r=this._lexer.token,o=this.parseName();return this.expectToken(Le.COLON),this.node(r,{kind:Z.ARGUMENT,name:o,value:this.parseValueLiteral(n)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){const n=this._lexer.token;this.expectToken(Le.SPREAD);const r=this.expectOptionalKeyword("on");return!r&&this.peek(Le.NAME)?this.node(n,{kind:Z.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(n,{kind:Z.INLINE_FRAGMENT,typeCondition:r?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){const n=this._lexer.token;return this.expectKeyword("fragment"),this._options.allowLegacyFragmentVariables===!0?this.node(n,{kind:Z.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(n,{kind:Z.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if(this._lexer.token.value==="on")throw this.unexpected();return this.parseName()}parseValueLiteral(n){const r=this._lexer.token;switch(r.kind){case Le.BRACKET_L:return this.parseList(n);case Le.BRACE_L:return this.parseObject(n);case Le.INT:return this.advanceLexer(),this.node(r,{kind:Z.INT,value:r.value});case Le.FLOAT:return this.advanceLexer(),this.node(r,{kind:Z.FLOAT,value:r.value});case Le.STRING:case Le.BLOCK_STRING:return this.parseStringLiteral();case Le.NAME:switch(this.advanceLexer(),r.value){case"true":return this.node(r,{kind:Z.BOOLEAN,value:!0});case"false":return this.node(r,{kind:Z.BOOLEAN,value:!1});case"null":return this.node(r,{kind:Z.NULL});default:return this.node(r,{kind:Z.ENUM,value:r.value})}case Le.DOLLAR:if(n)if(this.expectToken(Le.DOLLAR),this._lexer.token.kind===Le.NAME){const o=this._lexer.token.value;throw Wn(this._lexer.source,r.start,`Unexpected variable "$${o}" in constant value.`)}else throw this.unexpected(r);return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){const n=this._lexer.token;return this.advanceLexer(),this.node(n,{kind:Z.STRING,value:n.value,block:n.kind===Le.BLOCK_STRING})}parseList(n){const r=()=>this.parseValueLiteral(n);return this.node(this._lexer.token,{kind:Z.LIST,values:this.any(Le.BRACKET_L,r,Le.BRACKET_R)})}parseObject(n){const r=()=>this.parseObjectField(n);return this.node(this._lexer.token,{kind:Z.OBJECT,fields:this.any(Le.BRACE_L,r,Le.BRACE_R)})}parseObjectField(n){const r=this._lexer.token,o=this.parseName();return this.expectToken(Le.COLON),this.node(r,{kind:Z.OBJECT_FIELD,name:o,value:this.parseValueLiteral(n)})}parseDirectives(n){const r=[];for(;this.peek(Le.AT);)r.push(this.parseDirective(n));return r}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(n){const r=this._lexer.token;return this.expectToken(Le.AT),this.node(r,{kind:Z.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(n)})}parseTypeReference(){const n=this._lexer.token;let r;if(this.expectOptionalToken(Le.BRACKET_L)){const o=this.parseTypeReference();this.expectToken(Le.BRACKET_R),r=this.node(n,{kind:Z.LIST_TYPE,type:o})}else r=this.parseNamedType();return this.expectOptionalToken(Le.BANG)?this.node(n,{kind:Z.NON_NULL_TYPE,type:r}):r}parseNamedType(){return this.node(this._lexer.token,{kind:Z.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(Le.STRING)||this.peek(Le.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){const n=this._lexer.token,r=this.parseDescription();this.expectKeyword("schema");const o=this.parseConstDirectives(),l=this.many(Le.BRACE_L,this.parseOperationTypeDefinition,Le.BRACE_R);return this.node(n,{kind:Z.SCHEMA_DEFINITION,description:r,directives:o,operationTypes:l})}parseOperationTypeDefinition(){const n=this._lexer.token,r=this.parseOperationType();this.expectToken(Le.COLON);const o=this.parseNamedType();return this.node(n,{kind:Z.OPERATION_TYPE_DEFINITION,operation:r,type:o})}parseScalarTypeDefinition(){const n=this._lexer.token,r=this.parseDescription();this.expectKeyword("scalar");const o=this.parseName(),l=this.parseConstDirectives();return this.node(n,{kind:Z.SCALAR_TYPE_DEFINITION,description:r,name:o,directives:l})}parseObjectTypeDefinition(){const n=this._lexer.token,r=this.parseDescription();this.expectKeyword("type");const o=this.parseName(),l=this.parseImplementsInterfaces(),h=this.parseConstDirectives(),y=this.parseFieldsDefinition();return this.node(n,{kind:Z.OBJECT_TYPE_DEFINITION,description:r,name:o,interfaces:l,directives:h,fields:y})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(Le.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(Le.BRACE_L,this.parseFieldDefinition,Le.BRACE_R)}parseFieldDefinition(){const n=this._lexer.token,r=this.parseDescription(),o=this.parseName(),l=this.parseArgumentDefs();this.expectToken(Le.COLON);const h=this.parseTypeReference(),y=this.parseConstDirectives();return this.node(n,{kind:Z.FIELD_DEFINITION,description:r,name:o,arguments:l,type:h,directives:y})}parseArgumentDefs(){return this.optionalMany(Le.PAREN_L,this.parseInputValueDef,Le.PAREN_R)}parseInputValueDef(){const n=this._lexer.token,r=this.parseDescription(),o=this.parseName();this.expectToken(Le.COLON);const l=this.parseTypeReference();let h;this.expectOptionalToken(Le.EQUALS)&&(h=this.parseConstValueLiteral());const y=this.parseConstDirectives();return this.node(n,{kind:Z.INPUT_VALUE_DEFINITION,description:r,name:o,type:l,defaultValue:h,directives:y})}parseInterfaceTypeDefinition(){const n=this._lexer.token,r=this.parseDescription();this.expectKeyword("interface");const o=this.parseName(),l=this.parseImplementsInterfaces(),h=this.parseConstDirectives(),y=this.parseFieldsDefinition();return this.node(n,{kind:Z.INTERFACE_TYPE_DEFINITION,description:r,name:o,interfaces:l,directives:h,fields:y})}parseUnionTypeDefinition(){const n=this._lexer.token,r=this.parseDescription();this.expectKeyword("union");const o=this.parseName(),l=this.parseConstDirectives(),h=this.parseUnionMemberTypes();return this.node(n,{kind:Z.UNION_TYPE_DEFINITION,description:r,name:o,directives:l,types:h})}parseUnionMemberTypes(){return this.expectOptionalToken(Le.EQUALS)?this.delimitedMany(Le.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){const n=this._lexer.token,r=this.parseDescription();this.expectKeyword("enum");const o=this.parseName(),l=this.parseConstDirectives(),h=this.parseEnumValuesDefinition();return this.node(n,{kind:Z.ENUM_TYPE_DEFINITION,description:r,name:o,directives:l,values:h})}parseEnumValuesDefinition(){return this.optionalMany(Le.BRACE_L,this.parseEnumValueDefinition,Le.BRACE_R)}parseEnumValueDefinition(){const n=this._lexer.token,r=this.parseDescription(),o=this.parseEnumValueName(),l=this.parseConstDirectives();return this.node(n,{kind:Z.ENUM_VALUE_DEFINITION,description:r,name:o,directives:l})}parseEnumValueName(){if(this._lexer.token.value==="true"||this._lexer.token.value==="false"||this._lexer.token.value==="null")throw Wn(this._lexer.source,this._lexer.token.start,`${Ys(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){const n=this._lexer.token,r=this.parseDescription();this.expectKeyword("input");const o=this.parseName(),l=this.parseConstDirectives(),h=this.parseInputFieldsDefinition();return this.node(n,{kind:Z.INPUT_OBJECT_TYPE_DEFINITION,description:r,name:o,directives:l,fields:h})}parseInputFieldsDefinition(){return this.optionalMany(Le.BRACE_L,this.parseInputValueDef,Le.BRACE_R)}parseTypeSystemExtension(){const n=this._lexer.lookahead();if(n.kind===Le.NAME)switch(n.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(n)}parseSchemaExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");const r=this.parseConstDirectives(),o=this.optionalMany(Le.BRACE_L,this.parseOperationTypeDefinition,Le.BRACE_R);if(r.length===0&&o.length===0)throw this.unexpected();return this.node(n,{kind:Z.SCHEMA_EXTENSION,directives:r,operationTypes:o})}parseScalarTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");const r=this.parseName(),o=this.parseConstDirectives();if(o.length===0)throw this.unexpected();return this.node(n,{kind:Z.SCALAR_TYPE_EXTENSION,name:r,directives:o})}parseObjectTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");const r=this.parseName(),o=this.parseImplementsInterfaces(),l=this.parseConstDirectives(),h=this.parseFieldsDefinition();if(o.length===0&&l.length===0&&h.length===0)throw this.unexpected();return this.node(n,{kind:Z.OBJECT_TYPE_EXTENSION,name:r,interfaces:o,directives:l,fields:h})}parseInterfaceTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");const r=this.parseName(),o=this.parseImplementsInterfaces(),l=this.parseConstDirectives(),h=this.parseFieldsDefinition();if(o.length===0&&l.length===0&&h.length===0)throw this.unexpected();return this.node(n,{kind:Z.INTERFACE_TYPE_EXTENSION,name:r,interfaces:o,directives:l,fields:h})}parseUnionTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");const r=this.parseName(),o=this.parseConstDirectives(),l=this.parseUnionMemberTypes();if(o.length===0&&l.length===0)throw this.unexpected();return this.node(n,{kind:Z.UNION_TYPE_EXTENSION,name:r,directives:o,types:l})}parseEnumTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");const r=this.parseName(),o=this.parseConstDirectives(),l=this.parseEnumValuesDefinition();if(o.length===0&&l.length===0)throw this.unexpected();return this.node(n,{kind:Z.ENUM_TYPE_EXTENSION,name:r,directives:o,values:l})}parseInputObjectTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");const r=this.parseName(),o=this.parseConstDirectives(),l=this.parseInputFieldsDefinition();if(o.length===0&&l.length===0)throw this.unexpected();return this.node(n,{kind:Z.INPUT_OBJECT_TYPE_EXTENSION,name:r,directives:o,fields:l})}parseDirectiveDefinition(){const n=this._lexer.token,r=this.parseDescription();this.expectKeyword("directive"),this.expectToken(Le.AT);const o=this.parseName(),l=this.parseArgumentDefs(),h=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");const y=this.parseDirectiveLocations();return this.node(n,{kind:Z.DIRECTIVE_DEFINITION,description:r,name:o,arguments:l,repeatable:h,locations:y})}parseDirectiveLocations(){return this.delimitedMany(Le.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){const n=this._lexer.token,r=this.parseName();if(Object.prototype.hasOwnProperty.call(et,r.value))return r;throw this.unexpected(n)}node(n,r){return this._options.noLocation!==!0&&(r.loc=new vp(n,this._lexer.lastToken,this._lexer.source)),r}peek(n){return this._lexer.token.kind===n}expectToken(n){const r=this._lexer.token;if(r.kind===n)return this.advanceLexer(),r;throw Wn(this._lexer.source,r.start,`Expected ${eh(n)}, found ${Ys(r)}.`)}expectOptionalToken(n){return this._lexer.token.kind===n?(this.advanceLexer(),!0):!1}expectKeyword(n){const r=this._lexer.token;if(r.kind===Le.NAME&&r.value===n)this.advanceLexer();else throw Wn(this._lexer.source,r.start,`Expected "${n}", found ${Ys(r)}.`)}expectOptionalKeyword(n){const r=this._lexer.token;return r.kind===Le.NAME&&r.value===n?(this.advanceLexer(),!0):!1}unexpected(n){const r=n??this._lexer.token;return Wn(this._lexer.source,r.start,`Unexpected ${Ys(r)}.`)}any(n,r,o){this.expectToken(n);const l=[];for(;!this.expectOptionalToken(o);)l.push(r.call(this));return l}optionalMany(n,r,o){if(this.expectOptionalToken(n)){const l=[];do l.push(r.call(this));while(!this.expectOptionalToken(o));return l}return[]}many(n,r,o){this.expectToken(n);const l=[];do l.push(r.call(this));while(!this.expectOptionalToken(o));return l}delimitedMany(n,r){this.expectOptionalToken(n);const o=[];do o.push(r.call(this));while(this.expectOptionalToken(n));return o}advanceLexer(){const{maxTokens:n}=this._options,r=this._lexer.advance();if(r.kind!==Le.EOF&&(++this._tokenCounter,n!==void 0&&this._tokenCounter>n))throw Wn(this._lexer.source,r.start,`Document contains more that ${n} tokens. Parsing aborted.`)}}function Ys(e){const n=e.value;return eh(e.kind)+(n!=null?` "${n}"`:"")}function eh(e){return kp(e)?`"${e}"`:e}const Hp=5;function Ui(e,n){const[r,o]=n?[e,n]:[void 0,e];let l=" Did you mean ";r&&(l+=r+" ");const h=o.map(D=>`"${D}"`);switch(h.length){case 0:return"";case 1:return l+h[0]+"?";case 2:return l+h[0]+" or "+h[1]+"?"}const y=h.slice(0,Hp),N=y.pop();return l+y.join(", ")+", or "+N+"?"}function wc(e){return e}function Sr(e,n){const r=Object.create(null);for(const o of e)r[n(o)]=o;return r}function Hl(e,n,r){const o=Object.create(null);for(const l of e)o[n(l)]=r(l);return o}function vo(e,n){const r=Object.create(null);for(const o of Object.keys(e))r[o]=n(e[o],o);return r}function Wl(e,n){let r=0,o=0;for(;r<e.length&&o<n.length;){let l=e.charCodeAt(r),h=n.charCodeAt(o);if(Js(l)&&Js(h)){let y=0;do++r,y=y*10+l-ml,l=e.charCodeAt(r);while(Js(l)&&y>0);let N=0;do++o,N=N*10+h-ml,h=n.charCodeAt(o);while(Js(h)&&N>0);if(y<N)return-1;if(y>N)return 1}else{if(l<h)return-1;if(l>h)return 1;++r,++o}}return e.length-n.length}const ml=48,Wp=57;function Js(e){return!isNaN(e)&&ml<=e&&e<=Wp}function nr(e,n){const r=Object.create(null),o=new qp(e),l=Math.floor(e.length*.4)+1;for(const h of n){const y=o.measure(h,l);y!==void 0&&(r[h]=y)}return Object.keys(r).sort((h,y)=>{const N=r[h]-r[y];return N!==0?N:Wl(h,y)})}class qp{constructor(n){this._input=n,this._inputLowerCase=n.toLowerCase(),this._inputArray=kc(this._inputLowerCase),this._rows=[new Array(n.length+1).fill(0),new Array(n.length+1).fill(0),new Array(n.length+1).fill(0)]}measure(n,r){if(this._input===n)return 0;const o=n.toLowerCase();if(this._inputLowerCase===o)return 1;let l=kc(o),h=this._inputArray;if(l.length<h.length){const W=l;l=h,h=W}const y=l.length,N=h.length;if(y-N>r)return;const D=this._rows;for(let W=0;W<=N;W++)D[0][W]=W;for(let W=1;W<=y;W++){const z=D[(W-1)%3],ne=D[W%3];let te=ne[0]=W;for(let be=1;be<=N;be++){const Ne=l[W-1]===h[be-1]?0:1;let Se=Math.min(z[be]+1,ne[be-1]+1,z[be-1]+Ne);if(W>1&&be>1&&l[W-1]===h[be-2]&&l[W-2]===h[be-1]){const xe=D[(W-2)%3][be-2];Se=Math.min(Se,xe+1)}Se<te&&(te=Se),ne[be]=Se}if(te>r)return}const R=D[y%3][N];return R<=r?R:void 0}}function kc(e){const n=e.length,r=new Array(n);for(let o=0;o<n;++o)r[o]=e.charCodeAt(o);return r}function fi(e){if(e==null)return Object.create(null);if(Object.getPrototypeOf(e)===null)return e;const n=Object.create(null);for(const[r,o]of Object.entries(e))n[r]=o;return n}function zp(e){return`"${e.replace(Gp,Yp)}"`}const Gp=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function Yp(e){return Jp[e.charCodeAt(0)]}const Jp=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],mr=Object.freeze({});function Ci(e,n,r=Gu){const o=new Map;for(const xe of Object.values(Z))o.set(xe,to(n,xe));let l,h=Array.isArray(e),y=[e],N=-1,D=[],R=e,W,z;const ne=[],te=[];do{N++;const xe=N===y.length,Qe=xe&&D.length!==0;if(xe){if(W=te.length===0?void 0:ne[ne.length-1],R=z,z=te.pop(),Qe)if(h){R=R.slice();let We=0;for(const[ot,ft]of D){const Et=ot-We;ft===null?(R.splice(Et,1),We++):R[Et]=ft}}else{R={...R};for(const[We,ot]of D)R[We]=ot}N=l.index,y=l.keys,D=l.edits,h=l.inArray,l=l.prev}else if(z){if(W=h?N:y[N],R=z[W],R==null)continue;ne.push(W)}let Ge;if(!Array.isArray(R)){var be,Ne;dl(R)||hn(!1,`Invalid AST Node: ${Ke(R)}.`);const We=xe?(be=o.get(R.kind))===null||be===void 0?void 0:be.leave:(Ne=o.get(R.kind))===null||Ne===void 0?void 0:Ne.enter;if(Ge=We?.call(n,R,W,z,ne,te),Ge===mr)break;if(Ge===!1){if(!xe){ne.pop();continue}}else if(Ge!==void 0&&(D.push([W,Ge]),!xe))if(dl(Ge))R=Ge;else{ne.pop();continue}}if(Ge===void 0&&Qe&&D.push([W,R]),xe)ne.pop();else{var Se;l={inArray:h,index:N,keys:y,edits:D,prev:l},h=Array.isArray(R),y=h?R:(Se=r[R.kind])!==null&&Se!==void 0?Se:[],N=-1,D=[],z&&te.push(z),z=R}}while(l!==void 0);return D.length!==0?D[D.length-1][1]:e}function Xp(e){const n=new Array(e.length).fill(null),r=Object.create(null);for(const o of Object.values(Z)){let l=!1;const h=new Array(e.length).fill(void 0),y=new Array(e.length).fill(void 0);for(let D=0;D<e.length;++D){const{enter:R,leave:W}=to(e[D],o);l||(l=R!=null||W!=null),h[D]=R,y[D]=W}if(!l)continue;const N={enter(...D){const R=D[0];for(let z=0;z<e.length;z++)if(n[z]===null){var W;const ne=(W=h[z])===null||W===void 0?void 0:W.apply(e[z],D);if(ne===!1)n[z]=R;else if(ne===mr)n[z]=mr;else if(ne!==void 0)return ne}},leave(...D){const R=D[0];for(let z=0;z<e.length;z++)if(n[z]===null){var W;const ne=(W=y[z])===null||W===void 0?void 0:W.apply(e[z],D);if(ne===mr)n[z]=mr;else if(ne!==void 0&&ne!==!1)return ne}else n[z]===R&&(n[z]=null)}};r[o]=N}return r}function to(e,n){const r=e[n];return typeof r=="object"?r:typeof r=="function"?{enter:r,leave:void 0}:{enter:e.enter,leave:e.leave}}function jn(e){return Ci(e,Kp)}const Qp=80,Kp={Name:{leave:e=>e.value},Variable:{leave:e=>"$"+e.name},Document:{leave:e=>ct(e.definitions,`

`)},OperationDefinition:{leave(e){const n=Yt("(",ct(e.variableDefinitions,", "),")"),r=ct([e.operation,ct([e.name,n]),ct(e.directives," ")]," ");return(r==="query"?"":r+" ")+e.selectionSet}},VariableDefinition:{leave:({variable:e,type:n,defaultValue:r,directives:o})=>e+": "+n+Yt(" = ",r)+Yt(" ",ct(o," "))},SelectionSet:{leave:({selections:e})=>mi(e)},Field:{leave({alias:e,name:n,arguments:r,directives:o,selectionSet:l}){const h=Yt("",e,": ")+n;let y=h+Yt("(",ct(r,", "),")");return y.length>Qp&&(y=h+Yt(`(
`,Zs(ct(r,`
`)),`
)`)),ct([y,ct(o," "),l]," ")}},Argument:{leave:({name:e,value:n})=>e+": "+n},FragmentSpread:{leave:({name:e,directives:n})=>"..."+e+Yt(" ",ct(n," "))},InlineFragment:{leave:({typeCondition:e,directives:n,selectionSet:r})=>ct(["...",Yt("on ",e),ct(n," "),r]," ")},FragmentDefinition:{leave:({name:e,typeCondition:n,variableDefinitions:r,directives:o,selectionSet:l})=>`fragment ${e}${Yt("(",ct(r,", "),")")} on ${n} ${Yt("",ct(o," ")," ")}`+l},IntValue:{leave:({value:e})=>e},FloatValue:{leave:({value:e})=>e},StringValue:{leave:({value:e,block:n})=>n?Ep(e):zp(e)},BooleanValue:{leave:({value:e})=>e?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:e})=>e},ListValue:{leave:({values:e})=>"["+ct(e,", ")+"]"},ObjectValue:{leave:({fields:e})=>"{"+ct(e,", ")+"}"},ObjectField:{leave:({name:e,value:n})=>e+": "+n},Directive:{leave:({name:e,arguments:n})=>"@"+e+Yt("(",ct(n,", "),")")},NamedType:{leave:({name:e})=>e},ListType:{leave:({type:e})=>"["+e+"]"},NonNullType:{leave:({type:e})=>e+"!"},SchemaDefinition:{leave:({description:e,directives:n,operationTypes:r})=>Yt("",e,`
`)+ct(["schema",ct(n," "),mi(r)]," ")},OperationTypeDefinition:{leave:({operation:e,type:n})=>e+": "+n},ScalarTypeDefinition:{leave:({description:e,name:n,directives:r})=>Yt("",e,`
`)+ct(["scalar",n,ct(r," ")]," ")},ObjectTypeDefinition:{leave:({description:e,name:n,interfaces:r,directives:o,fields:l})=>Yt("",e,`
`)+ct(["type",n,Yt("implements ",ct(r," & ")),ct(o," "),mi(l)]," ")},FieldDefinition:{leave:({description:e,name:n,arguments:r,type:o,directives:l})=>Yt("",e,`
`)+n+(xc(r)?Yt(`(
`,Zs(ct(r,`
`)),`
)`):Yt("(",ct(r,", "),")"))+": "+o+Yt(" ",ct(l," "))},InputValueDefinition:{leave:({description:e,name:n,type:r,defaultValue:o,directives:l})=>Yt("",e,`
`)+ct([n+": "+r,Yt("= ",o),ct(l," ")]," ")},InterfaceTypeDefinition:{leave:({description:e,name:n,interfaces:r,directives:o,fields:l})=>Yt("",e,`
`)+ct(["interface",n,Yt("implements ",ct(r," & ")),ct(o," "),mi(l)]," ")},UnionTypeDefinition:{leave:({description:e,name:n,directives:r,types:o})=>Yt("",e,`
`)+ct(["union",n,ct(r," "),Yt("= ",ct(o," | "))]," ")},EnumTypeDefinition:{leave:({description:e,name:n,directives:r,values:o})=>Yt("",e,`
`)+ct(["enum",n,ct(r," "),mi(o)]," ")},EnumValueDefinition:{leave:({description:e,name:n,directives:r})=>Yt("",e,`
`)+ct([n,ct(r," ")]," ")},InputObjectTypeDefinition:{leave:({description:e,name:n,directives:r,fields:o})=>Yt("",e,`
`)+ct(["input",n,ct(r," "),mi(o)]," ")},DirectiveDefinition:{leave:({description:e,name:n,arguments:r,repeatable:o,locations:l})=>Yt("",e,`
`)+"directive @"+n+(xc(r)?Yt(`(
`,Zs(ct(r,`
`)),`
)`):Yt("(",ct(r,", "),")"))+(o?" repeatable":"")+" on "+ct(l," | ")},SchemaExtension:{leave:({directives:e,operationTypes:n})=>ct(["extend schema",ct(e," "),mi(n)]," ")},ScalarTypeExtension:{leave:({name:e,directives:n})=>ct(["extend scalar",e,ct(n," ")]," ")},ObjectTypeExtension:{leave:({name:e,interfaces:n,directives:r,fields:o})=>ct(["extend type",e,Yt("implements ",ct(n," & ")),ct(r," "),mi(o)]," ")},InterfaceTypeExtension:{leave:({name:e,interfaces:n,directives:r,fields:o})=>ct(["extend interface",e,Yt("implements ",ct(n," & ")),ct(r," "),mi(o)]," ")},UnionTypeExtension:{leave:({name:e,directives:n,types:r})=>ct(["extend union",e,ct(n," "),Yt("= ",ct(r," | "))]," ")},EnumTypeExtension:{leave:({name:e,directives:n,values:r})=>ct(["extend enum",e,ct(n," "),mi(r)]," ")},InputObjectTypeExtension:{leave:({name:e,directives:n,fields:r})=>ct(["extend input",e,ct(n," "),mi(r)]," ")}};function ct(e,n=""){var r;return(r=e?.filter(o=>o).join(n))!==null&&r!==void 0?r:""}function mi(e){return Yt(`{
`,Zs(ct(e,`
`)),`
}`)}function Yt(e,n,r=""){return n!=null&&n!==""?e+n+r:""}function Zs(e){return Yt("  ",e.replace(/\n/g,`
  `))}function xc(e){var n;return(n=e?.some(r=>r.includes(`
`)))!==null&&n!==void 0?n:!1}function gl(e,n){switch(e.kind){case Z.NULL:return null;case Z.INT:return parseInt(e.value,10);case Z.FLOAT:return parseFloat(e.value);case Z.STRING:case Z.ENUM:case Z.BOOLEAN:return e.value;case Z.LIST:return e.values.map(r=>gl(r,n));case Z.OBJECT:return Hl(e.fields,r=>r.name.value,r=>gl(r.value,n));case Z.VARIABLE:return n?.[e.name.value]}}function Ti(e){if(e!=null||hn(!1,"Must provide name."),typeof e=="string"||hn(!1,"Expected name to be a string."),e.length===0)throw new Ve("Expected name to be a non-empty string.");for(let n=1;n<e.length;++n)if(!Ju(e.charCodeAt(n)))throw new Ve(`Names must only contain [_a-zA-Z0-9] but "${e}" does not.`);if(!$l(e.charCodeAt(0)))throw new Ve(`Names must start with [_a-zA-Z] but "${e}" does not.`);return e}function Zp(e){if(e==="true"||e==="false"||e==="null")throw new Ve(`Enum values cannot be named: ${e}`);return Ti(e)}function ql(e){return bi(e)||kn(e)||Nn(e)||hi(e)||ri(e)||Fn(e)||Un(e)||fn(e)}function bi(e){return Si(e,Dr)}function kn(e){return Si(e,Li)}function Nn(e){return Si(e,ns)}function hi(e){return Si(e,nm)}function ri(e){return Si(e,us)}function Fn(e){return Si(e,ch)}function Un(e){return Si(e,ii)}function fn(e){return Si(e,Jt)}function ui(e){return bi(e)||ri(e)||Fn(e)||zl(e)&&ui(e.ofType)}function gr(e){return bi(e)||kn(e)||Nn(e)||hi(e)||ri(e)||zl(e)&&gr(e.ofType)}function Tr(e){return bi(e)||ri(e)}function ai(e){return kn(e)||Nn(e)||hi(e)}function Ni(e){return Nn(e)||hi(e)}function em(e){if(!Ni(e))throw new Error(`Expected ${Ke(e)} to be a GraphQL abstract type.`);return e}class ii{constructor(n){ql(n)||hn(!1,`Expected ${Ke(n)} to be a GraphQL type.`),this.ofType=n}get[Symbol.toStringTag](){return"GraphQLList"}toString(){return"["+String(this.ofType)+"]"}toJSON(){return this.toString()}}class Jt{constructor(n){th(n)||hn(!1,`Expected ${Ke(n)} to be a GraphQL nullable type.`),this.ofType=n}get[Symbol.toStringTag](){return"GraphQLNonNull"}toString(){return String(this.ofType)+"!"}toJSON(){return this.toString()}}function zl(e){return Un(e)||fn(e)}function th(e){return ql(e)&&!fn(e)}function Gl(e){if(e)return fn(e)?e.ofType:e}function tm(e){return bi(e)||kn(e)||Nn(e)||hi(e)||ri(e)||Fn(e)}function _n(e){if(e){let n=e;for(;zl(n);)n=n.ofType;return n}}function nh(e){return typeof e=="function"?e():e}function ih(e){return typeof e=="function"?e():e}class Dr{constructor(n){var r,o,l,h;const y=(r=n.parseValue)!==null&&r!==void 0?r:wc;this.name=Ti(n.name),this.description=n.description,this.specifiedByURL=n.specifiedByURL,this.serialize=(o=n.serialize)!==null&&o!==void 0?o:wc,this.parseValue=y,this.parseLiteral=(l=n.parseLiteral)!==null&&l!==void 0?l:(N,D)=>y(gl(N,D)),this.extensions=fi(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(h=n.extensionASTNodes)!==null&&h!==void 0?h:[],n.specifiedByURL==null||typeof n.specifiedByURL=="string"||hn(!1,`${this.name} must provide "specifiedByURL" as a string, but got: ${Ke(n.specifiedByURL)}.`),n.serialize==null||typeof n.serialize=="function"||hn(!1,`${this.name} must provide "serialize" function. If this custom Scalar is also used as an input type, ensure "parseValue" and "parseLiteral" functions are also provided.`),n.parseLiteral&&(typeof n.parseValue=="function"&&typeof n.parseLiteral=="function"||hn(!1,`${this.name} must provide both "parseValue" and "parseLiteral" functions.`))}get[Symbol.toStringTag](){return"GraphQLScalarType"}toConfig(){return{name:this.name,description:this.description,specifiedByURL:this.specifiedByURL,serialize:this.serialize,parseValue:this.parseValue,parseLiteral:this.parseLiteral,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}class Li{constructor(n){var r;this.name=Ti(n.name),this.description=n.description,this.isTypeOf=n.isTypeOf,this.extensions=fi(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(r=n.extensionASTNodes)!==null&&r!==void 0?r:[],this._fields=()=>sh(n),this._interfaces=()=>rh(n),n.isTypeOf==null||typeof n.isTypeOf=="function"||hn(!1,`${this.name} must provide "isTypeOf" as a function, but got: ${Ke(n.isTypeOf)}.`)}get[Symbol.toStringTag](){return"GraphQLObjectType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}getInterfaces(){return typeof this._interfaces=="function"&&(this._interfaces=this._interfaces()),this._interfaces}toConfig(){return{name:this.name,description:this.description,interfaces:this.getInterfaces(),fields:lh(this.getFields()),isTypeOf:this.isTypeOf,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function rh(e){var n;const r=nh((n=e.interfaces)!==null&&n!==void 0?n:[]);return Array.isArray(r)||hn(!1,`${e.name} interfaces must be an Array or a function which returns an Array.`),r}function sh(e){const n=ih(e.fields);return yr(n)||hn(!1,`${e.name} fields must be an object with field names as keys or a function which returns such an object.`),vo(n,(r,o)=>{var l;yr(r)||hn(!1,`${e.name}.${o} field config must be an object.`),r.resolve==null||typeof r.resolve=="function"||hn(!1,`${e.name}.${o} field resolver must be a function if provided, but got: ${Ke(r.resolve)}.`);const h=(l=r.args)!==null&&l!==void 0?l:{};return yr(h)||hn(!1,`${e.name}.${o} args must be an object with argument names as keys.`),{name:Ti(o),description:r.description,type:r.type,args:oh(h),resolve:r.resolve,subscribe:r.subscribe,deprecationReason:r.deprecationReason,extensions:fi(r.extensions),astNode:r.astNode}})}function oh(e){return Object.entries(e).map(([n,r])=>({name:Ti(n),description:r.description,type:r.type,defaultValue:r.defaultValue,deprecationReason:r.deprecationReason,extensions:fi(r.extensions),astNode:r.astNode}))}function yr(e){return Xi(e)&&!Array.isArray(e)}function lh(e){return vo(e,n=>({description:n.description,type:n.type,args:ah(n.args),resolve:n.resolve,subscribe:n.subscribe,deprecationReason:n.deprecationReason,extensions:n.extensions,astNode:n.astNode}))}function ah(e){return Hl(e,n=>n.name,n=>({description:n.description,type:n.type,defaultValue:n.defaultValue,deprecationReason:n.deprecationReason,extensions:n.extensions,astNode:n.astNode}))}function cs(e){return fn(e.type)&&e.defaultValue===void 0}class ns{constructor(n){var r;this.name=Ti(n.name),this.description=n.description,this.resolveType=n.resolveType,this.extensions=fi(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(r=n.extensionASTNodes)!==null&&r!==void 0?r:[],this._fields=sh.bind(void 0,n),this._interfaces=rh.bind(void 0,n),n.resolveType==null||typeof n.resolveType=="function"||hn(!1,`${this.name} must provide "resolveType" as a function, but got: ${Ke(n.resolveType)}.`)}get[Symbol.toStringTag](){return"GraphQLInterfaceType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}getInterfaces(){return typeof this._interfaces=="function"&&(this._interfaces=this._interfaces()),this._interfaces}toConfig(){return{name:this.name,description:this.description,interfaces:this.getInterfaces(),fields:lh(this.getFields()),resolveType:this.resolveType,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}class nm{constructor(n){var r;this.name=Ti(n.name),this.description=n.description,this.resolveType=n.resolveType,this.extensions=fi(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(r=n.extensionASTNodes)!==null&&r!==void 0?r:[],this._types=im.bind(void 0,n),n.resolveType==null||typeof n.resolveType=="function"||hn(!1,`${this.name} must provide "resolveType" as a function, but got: ${Ke(n.resolveType)}.`)}get[Symbol.toStringTag](){return"GraphQLUnionType"}getTypes(){return typeof this._types=="function"&&(this._types=this._types()),this._types}toConfig(){return{name:this.name,description:this.description,types:this.getTypes(),resolveType:this.resolveType,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function im(e){const n=nh(e.types);return Array.isArray(n)||hn(!1,`Must provide Array of types or a function which returns such an array for Union ${e.name}.`),n}class us{constructor(n){var r;this.name=Ti(n.name),this.description=n.description,this.extensions=fi(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(r=n.extensionASTNodes)!==null&&r!==void 0?r:[],this._values=typeof n.values=="function"?n.values:Nc(this.name,n.values),this._valueLookup=null,this._nameLookup=null}get[Symbol.toStringTag](){return"GraphQLEnumType"}getValues(){return typeof this._values=="function"&&(this._values=Nc(this.name,this._values())),this._values}getValue(n){return this._nameLookup===null&&(this._nameLookup=Sr(this.getValues(),r=>r.name)),this._nameLookup[n]}serialize(n){this._valueLookup===null&&(this._valueLookup=new Map(this.getValues().map(o=>[o.value,o])));const r=this._valueLookup.get(n);if(r===void 0)throw new Ve(`Enum "${this.name}" cannot represent value: ${Ke(n)}`);return r.name}parseValue(n){if(typeof n!="string"){const o=Ke(n);throw new Ve(`Enum "${this.name}" cannot represent non-string value: ${o}.`+Xs(this,o))}const r=this.getValue(n);if(r==null)throw new Ve(`Value "${n}" does not exist in "${this.name}" enum.`+Xs(this,n));return r.value}parseLiteral(n,r){if(n.kind!==Z.ENUM){const l=jn(n);throw new Ve(`Enum "${this.name}" cannot represent non-enum value: ${l}.`+Xs(this,l),{nodes:n})}const o=this.getValue(n.value);if(o==null){const l=jn(n);throw new Ve(`Value "${l}" does not exist in "${this.name}" enum.`+Xs(this,l),{nodes:n})}return o.value}toConfig(){const n=Hl(this.getValues(),r=>r.name,r=>({description:r.description,value:r.value,deprecationReason:r.deprecationReason,extensions:r.extensions,astNode:r.astNode}));return{name:this.name,description:this.description,values:n,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function Xs(e,n){const r=e.getValues().map(l=>l.name),o=nr(n,r);return Ui("the enum value",o)}function Nc(e,n){return yr(n)||hn(!1,`${e} values must be an object with value names as keys.`),Object.entries(n).map(([r,o])=>(yr(o)||hn(!1,`${e}.${r} must refer to an object with a "value" key representing an internal value but got: ${Ke(o)}.`),{name:Zp(r),description:o.description,value:o.value!==void 0?o.value:r,deprecationReason:o.deprecationReason,extensions:fi(o.extensions),astNode:o.astNode}))}class ch{constructor(n){var r,o;this.name=Ti(n.name),this.description=n.description,this.extensions=fi(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(r=n.extensionASTNodes)!==null&&r!==void 0?r:[],this.isOneOf=(o=n.isOneOf)!==null&&o!==void 0?o:!1,this._fields=rm.bind(void 0,n)}get[Symbol.toStringTag](){return"GraphQLInputObjectType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}toConfig(){const n=vo(this.getFields(),r=>({description:r.description,type:r.type,defaultValue:r.defaultValue,deprecationReason:r.deprecationReason,extensions:r.extensions,astNode:r.astNode}));return{name:this.name,description:this.description,fields:n,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes,isOneOf:this.isOneOf}}toString(){return this.name}toJSON(){return this.toString()}}function rm(e){const n=ih(e.fields);return yr(n)||hn(!1,`${e.name} fields must be an object with field names as keys or a function which returns such an object.`),vo(n,(r,o)=>(!("resolve"in r)||hn(!1,`${e.name}.${o} field has a resolve property, but Input Types cannot define resolvers.`),{name:Ti(o),description:r.description,type:r.type,defaultValue:r.defaultValue,deprecationReason:r.deprecationReason,extensions:fi(r.extensions),astNode:r.astNode}))}function uh(e){return fn(e.type)&&e.defaultValue===void 0}function yl(e,n){return e===n?!0:fn(e)&&fn(n)||Un(e)&&Un(n)?yl(e.ofType,n.ofType):!1}function vr(e,n,r){return n===r?!0:fn(r)?fn(n)?vr(e,n.ofType,r.ofType):!1:fn(n)?vr(e,n.ofType,r):Un(r)?Un(n)?vr(e,n.ofType,r.ofType):!1:Un(n)?!1:Ni(r)&&(Nn(n)||kn(n))&&e.isSubType(r,n)}function vl(e,n,r){return n===r?!0:Ni(n)?Ni(r)?e.getPossibleTypes(n).some(o=>e.isSubType(r,o)):e.isSubType(n,r):Ni(r)?e.isSubType(r,n):!1}const ol=2147483647,ll=-2147483648,sm=new Dr({name:"Int",description:"The `Int` scalar type represents non-fractional signed whole numeric values. Int can represent values between -(2^31) and 2^31 - 1.",serialize(e){const n=hs(e);if(typeof n=="boolean")return n?1:0;let r=n;if(typeof n=="string"&&n!==""&&(r=Number(n)),typeof r!="number"||!Number.isInteger(r))throw new Ve(`Int cannot represent non-integer value: ${Ke(n)}`);if(r>ol||r<ll)throw new Ve("Int cannot represent non 32-bit signed integer value: "+Ke(n));return r},parseValue(e){if(typeof e!="number"||!Number.isInteger(e))throw new Ve(`Int cannot represent non-integer value: ${Ke(e)}`);if(e>ol||e<ll)throw new Ve(`Int cannot represent non 32-bit signed integer value: ${e}`);return e},parseLiteral(e){if(e.kind!==Z.INT)throw new Ve(`Int cannot represent non-integer value: ${jn(e)}`,{nodes:e});const n=parseInt(e.value,10);if(n>ol||n<ll)throw new Ve(`Int cannot represent non 32-bit signed integer value: ${e.value}`,{nodes:e});return n}}),hh=new Dr({name:"Float",description:"The `Float` scalar type represents signed double-precision fractional values as specified by [IEEE 754](https://en.wikipedia.org/wiki/IEEE_floating_point).",serialize(e){const n=hs(e);if(typeof n=="boolean")return n?1:0;let r=n;if(typeof n=="string"&&n!==""&&(r=Number(n)),typeof r!="number"||!Number.isFinite(r))throw new Ve(`Float cannot represent non numeric value: ${Ke(n)}`);return r},parseValue(e){if(typeof e!="number"||!Number.isFinite(e))throw new Ve(`Float cannot represent non numeric value: ${Ke(e)}`);return e},parseLiteral(e){if(e.kind!==Z.FLOAT&&e.kind!==Z.INT)throw new Ve(`Float cannot represent non numeric value: ${jn(e)}`,e);return parseFloat(e.value)}}),Rn=new Dr({name:"String",description:"The `String` scalar type represents textual data, represented as UTF-8 character sequences. The String type is most often used by GraphQL to represent free-form human-readable text.",serialize(e){const n=hs(e);if(typeof n=="string")return n;if(typeof n=="boolean")return n?"true":"false";if(typeof n=="number"&&Number.isFinite(n))return n.toString();throw new Ve(`String cannot represent value: ${Ke(e)}`)},parseValue(e){if(typeof e!="string")throw new Ve(`String cannot represent a non string value: ${Ke(e)}`);return e},parseLiteral(e){if(e.kind!==Z.STRING)throw new Ve(`String cannot represent a non string value: ${jn(e)}`,{nodes:e});return e.value}}),qn=new Dr({name:"Boolean",description:"The `Boolean` scalar type represents `true` or `false`.",serialize(e){const n=hs(e);if(typeof n=="boolean")return n;if(Number.isFinite(n))return n!==0;throw new Ve(`Boolean cannot represent a non boolean value: ${Ke(n)}`)},parseValue(e){if(typeof e!="boolean")throw new Ve(`Boolean cannot represent a non boolean value: ${Ke(e)}`);return e},parseLiteral(e){if(e.kind!==Z.BOOLEAN)throw new Ve(`Boolean cannot represent a non boolean value: ${jn(e)}`,{nodes:e});return e.value}}),fh=new Dr({name:"ID",description:'The `ID` scalar type represents a unique identifier, often used to refetch an object or as key for a cache. The ID type appears in a JSON response as a String; however, it is not intended to be human-readable. When expected as an input type, any string (such as `"4"`) or integer (such as `4`) input value will be accepted as an ID.',serialize(e){const n=hs(e);if(typeof n=="string")return n;if(Number.isInteger(n))return String(n);throw new Ve(`ID cannot represent value: ${Ke(e)}`)},parseValue(e){if(typeof e=="string")return e;if(typeof e=="number"&&Number.isInteger(e))return e.toString();throw new Ve(`ID cannot represent value: ${Ke(e)}`)},parseLiteral(e){if(e.kind!==Z.STRING&&e.kind!==Z.INT)throw new Ve("ID cannot represent a non-string and non-integer value: "+jn(e),{nodes:e});return e.value}}),om=Object.freeze([Rn,sm,hh,qn,fh]);function hs(e){if(Xi(e)){if(typeof e.valueOf=="function"){const n=e.valueOf();if(!Xi(n))return n}if(typeof e.toJSON=="function")return e.toJSON()}return e}function dh(e){return Si(e,Ir)}class Ir{constructor(n){var r,o;this.name=Ti(n.name),this.description=n.description,this.locations=n.locations,this.isRepeatable=(r=n.isRepeatable)!==null&&r!==void 0?r:!1,this.extensions=fi(n.extensions),this.astNode=n.astNode,Array.isArray(n.locations)||hn(!1,`@${n.name} locations must be an Array.`);const l=(o=n.args)!==null&&o!==void 0?o:{};Xi(l)&&!Array.isArray(l)||hn(!1,`@${n.name} args must be an object with argument names as keys.`),this.args=oh(l)}get[Symbol.toStringTag](){return"GraphQLDirective"}toConfig(){return{name:this.name,description:this.description,locations:this.locations,args:ah(this.args),isRepeatable:this.isRepeatable,extensions:this.extensions,astNode:this.astNode}}toString(){return"@"+this.name}toJSON(){return this.toString()}}const ph=new Ir({name:"include",description:"Directs the executor to include this field or fragment only when the `if` argument is true.",locations:[et.FIELD,et.FRAGMENT_SPREAD,et.INLINE_FRAGMENT],args:{if:{type:new Jt(qn),description:"Included when true."}}}),mh=new Ir({name:"skip",description:"Directs the executor to skip this field or fragment when the `if` argument is true.",locations:[et.FIELD,et.FRAGMENT_SPREAD,et.INLINE_FRAGMENT],args:{if:{type:new Jt(qn),description:"Skipped when true."}}}),lm="No longer supported",gh=new Ir({name:"deprecated",description:"Marks an element of a GraphQL schema as no longer supported.",locations:[et.FIELD_DEFINITION,et.ARGUMENT_DEFINITION,et.INPUT_FIELD_DEFINITION,et.ENUM_VALUE],args:{reason:{type:Rn,description:"Explains why this element was deprecated, usually also including a suggestion for how to access supported similar data. Formatted using the Markdown syntax, as specified by [CommonMark](https://commonmark.org/).",defaultValue:lm}}}),am=new Ir({name:"specifiedBy",description:"Exposes a URL that specifies the behavior of this scalar.",locations:[et.SCALAR],args:{url:{type:new Jt(Rn),description:"The URL that specifies the behavior of this scalar."}}}),cm=new Ir({name:"oneOf",description:"Indicates exactly one field must be supplied and this field must not be `null`.",locations:[et.INPUT_OBJECT],args:{}}),fs=Object.freeze([ph,mh,gh,am,cm]);function um(e){return typeof e=="object"&&typeof e?.[Symbol.iterator]=="function"}function Kr(e,n){if(fn(n)){const r=Kr(e,n.ofType);return r?.kind===Z.NULL?null:r}if(e===null)return{kind:Z.NULL};if(e===void 0)return null;if(Un(n)){const r=n.ofType;if(um(e)){const o=[];for(const l of e){const h=Kr(l,r);h!=null&&o.push(h)}return{kind:Z.LIST,values:o}}return Kr(e,r)}if(Fn(n)){if(!Xi(e))return null;const r=[];for(const o of Object.values(n.getFields())){const l=Kr(e[o.name],o.type);l&&r.push({kind:Z.OBJECT_FIELD,name:{kind:Z.NAME,value:o.name},value:l})}return{kind:Z.OBJECT,fields:r}}if(Tr(n)){const r=n.serialize(e);if(r==null)return null;if(typeof r=="boolean")return{kind:Z.BOOLEAN,value:r};if(typeof r=="number"&&Number.isFinite(r)){const o=String(r);return Cc.test(o)?{kind:Z.INT,value:o}:{kind:Z.FLOAT,value:o}}if(typeof r=="string")return ri(n)?{kind:Z.ENUM,value:r}:n===fh&&Cc.test(r)?{kind:Z.INT,value:r}:{kind:Z.STRING,value:r};throw new TypeError(`Cannot convert value to AST: ${Ke(r)}.`)}li(!1,"Unexpected input type: "+Ke(n))}const Cc=/^-?(?:0|[1-9][0-9]*)$/,Yl=new Li({name:"__Schema",description:"A GraphQL Schema defines the capabilities of a GraphQL server. It exposes all available types and directives on the server, as well as the entry points for query, mutation, and subscription operations.",fields:()=>({description:{type:Rn,resolve:e=>e.description},types:{description:"A list of all types supported by this server.",type:new Jt(new ii(new Jt(vi))),resolve(e){return Object.values(e.getTypeMap())}},queryType:{description:"The type that query operations will be rooted at.",type:new Jt(vi),resolve:e=>e.getQueryType()},mutationType:{description:"If this server supports mutation, the type that mutation operations will be rooted at.",type:vi,resolve:e=>e.getMutationType()},subscriptionType:{description:"If this server support subscription, the type that subscription operations will be rooted at.",type:vi,resolve:e=>e.getSubscriptionType()},directives:{description:"A list of all directives supported by this server.",type:new Jt(new ii(new Jt(yh))),resolve:e=>e.getDirectives()}})}),yh=new Li({name:"__Directive",description:`A Directive provides a way to describe alternate runtime execution and type validation behavior in a GraphQL document.

In some cases, you need to provide options to alter GraphQL's execution behavior in ways field arguments will not suffice, such as conditionally including or skipping a field. Directives provide this by describing additional information to the executor.`,fields:()=>({name:{type:new Jt(Rn),resolve:e=>e.name},description:{type:Rn,resolve:e=>e.description},isRepeatable:{type:new Jt(qn),resolve:e=>e.isRepeatable},locations:{type:new Jt(new ii(new Jt(vh))),resolve:e=>e.locations},args:{type:new Jt(new ii(new Jt(bo))),args:{includeDeprecated:{type:qn,defaultValue:!1}},resolve(e,{includeDeprecated:n}){return n?e.args:e.args.filter(r=>r.deprecationReason==null)}}})}),vh=new us({name:"__DirectiveLocation",description:"A Directive can be adjacent to many parts of the GraphQL language, a __DirectiveLocation describes one such possible adjacencies.",values:{QUERY:{value:et.QUERY,description:"Location adjacent to a query operation."},MUTATION:{value:et.MUTATION,description:"Location adjacent to a mutation operation."},SUBSCRIPTION:{value:et.SUBSCRIPTION,description:"Location adjacent to a subscription operation."},FIELD:{value:et.FIELD,description:"Location adjacent to a field."},FRAGMENT_DEFINITION:{value:et.FRAGMENT_DEFINITION,description:"Location adjacent to a fragment definition."},FRAGMENT_SPREAD:{value:et.FRAGMENT_SPREAD,description:"Location adjacent to a fragment spread."},INLINE_FRAGMENT:{value:et.INLINE_FRAGMENT,description:"Location adjacent to an inline fragment."},VARIABLE_DEFINITION:{value:et.VARIABLE_DEFINITION,description:"Location adjacent to a variable definition."},SCHEMA:{value:et.SCHEMA,description:"Location adjacent to a schema definition."},SCALAR:{value:et.SCALAR,description:"Location adjacent to a scalar definition."},OBJECT:{value:et.OBJECT,description:"Location adjacent to an object type definition."},FIELD_DEFINITION:{value:et.FIELD_DEFINITION,description:"Location adjacent to a field definition."},ARGUMENT_DEFINITION:{value:et.ARGUMENT_DEFINITION,description:"Location adjacent to an argument definition."},INTERFACE:{value:et.INTERFACE,description:"Location adjacent to an interface definition."},UNION:{value:et.UNION,description:"Location adjacent to a union definition."},ENUM:{value:et.ENUM,description:"Location adjacent to an enum definition."},ENUM_VALUE:{value:et.ENUM_VALUE,description:"Location adjacent to an enum value definition."},INPUT_OBJECT:{value:et.INPUT_OBJECT,description:"Location adjacent to an input object type definition."},INPUT_FIELD_DEFINITION:{value:et.INPUT_FIELD_DEFINITION,description:"Location adjacent to an input object field definition."}}}),vi=new Li({name:"__Type",description:"The fundamental unit of any GraphQL Schema is the type. There are many kinds of types in GraphQL as represented by the `__TypeKind` enum.\n\nDepending on the kind of a type, certain fields describe information about that type. Scalar types provide no information beyond a name, description and optional `specifiedByURL`, while Enum types provide their values. Object and Interface types provide the fields they describe. Abstract types, Union and Interface, provide the Object types possible at runtime. List and NonNull types compose other types.",fields:()=>({kind:{type:new Jt(Th),resolve(e){if(bi(e))return Hn.SCALAR;if(kn(e))return Hn.OBJECT;if(Nn(e))return Hn.INTERFACE;if(hi(e))return Hn.UNION;if(ri(e))return Hn.ENUM;if(Fn(e))return Hn.INPUT_OBJECT;if(Un(e))return Hn.LIST;if(fn(e))return Hn.NON_NULL;li(!1,`Unexpected type: "${Ke(e)}".`)}},name:{type:Rn,resolve:e=>"name"in e?e.name:void 0},description:{type:Rn,resolve:e=>"description"in e?e.description:void 0},specifiedByURL:{type:Rn,resolve:e=>"specifiedByURL"in e?e.specifiedByURL:void 0},fields:{type:new ii(new Jt(bh)),args:{includeDeprecated:{type:qn,defaultValue:!1}},resolve(e,{includeDeprecated:n}){if(kn(e)||Nn(e)){const r=Object.values(e.getFields());return n?r:r.filter(o=>o.deprecationReason==null)}}},interfaces:{type:new ii(new Jt(vi)),resolve(e){if(kn(e)||Nn(e))return e.getInterfaces()}},possibleTypes:{type:new ii(new Jt(vi)),resolve(e,n,r,{schema:o}){if(Ni(e))return o.getPossibleTypes(e)}},enumValues:{type:new ii(new Jt(Sh)),args:{includeDeprecated:{type:qn,defaultValue:!1}},resolve(e,{includeDeprecated:n}){if(ri(e)){const r=e.getValues();return n?r:r.filter(o=>o.deprecationReason==null)}}},inputFields:{type:new ii(new Jt(bo)),args:{includeDeprecated:{type:qn,defaultValue:!1}},resolve(e,{includeDeprecated:n}){if(Fn(e)){const r=Object.values(e.getFields());return n?r:r.filter(o=>o.deprecationReason==null)}}},ofType:{type:vi,resolve:e=>"ofType"in e?e.ofType:void 0},isOneOf:{type:qn,resolve:e=>{if(Fn(e))return e.isOneOf}}})}),bh=new Li({name:"__Field",description:"Object and Interface types are described by a list of Fields, each of which has a name, potentially a list of arguments, and a return type.",fields:()=>({name:{type:new Jt(Rn),resolve:e=>e.name},description:{type:Rn,resolve:e=>e.description},args:{type:new Jt(new ii(new Jt(bo))),args:{includeDeprecated:{type:qn,defaultValue:!1}},resolve(e,{includeDeprecated:n}){return n?e.args:e.args.filter(r=>r.deprecationReason==null)}},type:{type:new Jt(vi),resolve:e=>e.type},isDeprecated:{type:new Jt(qn),resolve:e=>e.deprecationReason!=null},deprecationReason:{type:Rn,resolve:e=>e.deprecationReason}})}),bo=new Li({name:"__InputValue",description:"Arguments provided to Fields or Directives and the input fields of an InputObject are represented as Input Values which describe their type and optionally a default value.",fields:()=>({name:{type:new Jt(Rn),resolve:e=>e.name},description:{type:Rn,resolve:e=>e.description},type:{type:new Jt(vi),resolve:e=>e.type},defaultValue:{type:Rn,description:"A GraphQL-formatted string representing the default value for this input value.",resolve(e){const{type:n,defaultValue:r}=e,o=Kr(r,n);return o?jn(o):null}},isDeprecated:{type:new Jt(qn),resolve:e=>e.deprecationReason!=null},deprecationReason:{type:Rn,resolve:e=>e.deprecationReason}})}),Sh=new Li({name:"__EnumValue",description:"One possible value for a given Enum. Enum values are unique values, not a placeholder for a string or numeric value. However an Enum value is returned in a JSON response as a string.",fields:()=>({name:{type:new Jt(Rn),resolve:e=>e.name},description:{type:Rn,resolve:e=>e.description},isDeprecated:{type:new Jt(qn),resolve:e=>e.deprecationReason!=null},deprecationReason:{type:Rn,resolve:e=>e.deprecationReason}})});var Hn;(function(e){e.SCALAR="SCALAR",e.OBJECT="OBJECT",e.INTERFACE="INTERFACE",e.UNION="UNION",e.ENUM="ENUM",e.INPUT_OBJECT="INPUT_OBJECT",e.LIST="LIST",e.NON_NULL="NON_NULL"})(Hn||(Hn={}));const Th=new us({name:"__TypeKind",description:"An enum describing what kind of type a given `__Type` is.",values:{SCALAR:{value:Hn.SCALAR,description:"Indicates this type is a scalar."},OBJECT:{value:Hn.OBJECT,description:"Indicates this type is an object. `fields` and `interfaces` are valid fields."},INTERFACE:{value:Hn.INTERFACE,description:"Indicates this type is an interface. `fields`, `interfaces`, and `possibleTypes` are valid fields."},UNION:{value:Hn.UNION,description:"Indicates this type is a union. `possibleTypes` is a valid field."},ENUM:{value:Hn.ENUM,description:"Indicates this type is an enum. `enumValues` is a valid field."},INPUT_OBJECT:{value:Hn.INPUT_OBJECT,description:"Indicates this type is an input object. `inputFields` is a valid field."},LIST:{value:Hn.LIST,description:"Indicates this type is a list. `ofType` is a valid field."},NON_NULL:{value:Hn.NON_NULL,description:"Indicates this type is a non-null. `ofType` is a valid field."}}}),ss={name:"__schema",type:new Jt(Yl),description:"Access the current type schema of this server.",args:[],resolve:(e,n,r,{schema:o})=>o,deprecationReason:void 0,extensions:Object.create(null),astNode:void 0},os={name:"__type",type:vi,description:"Request the type information of a single type.",args:[{name:"name",description:void 0,type:new Jt(Rn),defaultValue:void 0,deprecationReason:void 0,extensions:Object.create(null),astNode:void 0}],resolve:(e,{name:n},r,{schema:o})=>o.getType(n),deprecationReason:void 0,extensions:Object.create(null),astNode:void 0},ls={name:"__typename",type:new Jt(Rn),description:"The name of the current Object type at runtime.",args:[],resolve:(e,n,r,{parentType:o})=>o.name,deprecationReason:void 0,extensions:Object.create(null),astNode:void 0},Eh=Object.freeze([Yl,yh,vh,vi,bh,bo,Sh,Th]);function hm(e){return Eh.some(({name:n})=>e.name===n)}function fm(e){return Si(e,pm)}function dm(e){if(!fm(e))throw new Error(`Expected ${Ke(e)} to be a GraphQL schema.`);return e}class pm{constructor(n){var r,o;this.__validationErrors=n.assumeValid===!0?[]:void 0,Xi(n)||hn(!1,"Must provide configuration object."),!n.types||Array.isArray(n.types)||hn(!1,`"types" must be Array if provided but got: ${Ke(n.types)}.`),!n.directives||Array.isArray(n.directives)||hn(!1,`"directives" must be Array if provided but got: ${Ke(n.directives)}.`),this.description=n.description,this.extensions=fi(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(r=n.extensionASTNodes)!==null&&r!==void 0?r:[],this._queryType=n.query,this._mutationType=n.mutation,this._subscriptionType=n.subscription,this._directives=(o=n.directives)!==null&&o!==void 0?o:fs;const l=new Set(n.types);if(n.types!=null)for(const h of n.types)l.delete(h),gi(h,l);this._queryType!=null&&gi(this._queryType,l),this._mutationType!=null&&gi(this._mutationType,l),this._subscriptionType!=null&&gi(this._subscriptionType,l);for(const h of this._directives)if(dh(h))for(const y of h.args)gi(y.type,l);gi(Yl,l),this._typeMap=Object.create(null),this._subTypeMap=Object.create(null),this._implementationsMap=Object.create(null);for(const h of l){if(h==null)continue;const y=h.name;if(y||hn(!1,"One of the provided types for building the Schema is missing a name."),this._typeMap[y]!==void 0)throw new Error(`Schema must contain uniquely named types but contains multiple types named "${y}".`);if(this._typeMap[y]=h,Nn(h)){for(const N of h.getInterfaces())if(Nn(N)){let D=this._implementationsMap[N.name];D===void 0&&(D=this._implementationsMap[N.name]={objects:[],interfaces:[]}),D.interfaces.push(h)}}else if(kn(h)){for(const N of h.getInterfaces())if(Nn(N)){let D=this._implementationsMap[N.name];D===void 0&&(D=this._implementationsMap[N.name]={objects:[],interfaces:[]}),D.objects.push(h)}}}}get[Symbol.toStringTag](){return"GraphQLSchema"}getQueryType(){return this._queryType}getMutationType(){return this._mutationType}getSubscriptionType(){return this._subscriptionType}getRootType(n){switch(n){case Kn.QUERY:return this.getQueryType();case Kn.MUTATION:return this.getMutationType();case Kn.SUBSCRIPTION:return this.getSubscriptionType()}}getTypeMap(){return this._typeMap}getType(n){return this.getTypeMap()[n]}getPossibleTypes(n){return hi(n)?n.getTypes():this.getImplementations(n).objects}getImplementations(n){const r=this._implementationsMap[n.name];return r??{objects:[],interfaces:[]}}isSubType(n,r){let o=this._subTypeMap[n.name];if(o===void 0){if(o=Object.create(null),hi(n))for(const l of n.getTypes())o[l.name]=!0;else{const l=this.getImplementations(n);for(const h of l.objects)o[h.name]=!0;for(const h of l.interfaces)o[h.name]=!0}this._subTypeMap[n.name]=o}return o[r.name]!==void 0}getDirectives(){return this._directives}getDirective(n){return this.getDirectives().find(r=>r.name===n)}toConfig(){return{description:this.description,query:this.getQueryType(),mutation:this.getMutationType(),subscription:this.getSubscriptionType(),types:Object.values(this.getTypeMap()),directives:this.getDirectives(),extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes,assumeValid:this.__validationErrors!==void 0}}}function gi(e,n){const r=_n(e);if(!n.has(r)){if(n.add(r),hi(r))for(const o of r.getTypes())gi(o,n);else if(kn(r)||Nn(r)){for(const o of r.getInterfaces())gi(o,n);for(const o of Object.values(r.getFields())){gi(o.type,n);for(const l of o.args)gi(l.type,n)}}else if(Fn(r))for(const o of Object.values(r.getFields()))gi(o.type,n)}return n}function mm(e){if(dm(e),e.__validationErrors)return e.__validationErrors;const n=new ym(e);vm(n),bm(n),Sm(n);const r=n.getErrors();return e.__validationErrors=r,r}function gm(e){const n=mm(e);if(n.length!==0)throw new Error(n.map(r=>r.message).join(`

`))}class ym{constructor(n){this._errors=[],this.schema=n}reportError(n,r){const o=Array.isArray(r)?r.filter(Boolean):r;this._errors.push(new Ve(n,{nodes:o}))}getErrors(){return this._errors}}function vm(e){const n=e.schema,r=n.getQueryType();if(!r)e.reportError("Query root type must be provided.",n.astNode);else if(!kn(r)){var o;e.reportError(`Query root type must be Object type, it cannot be ${Ke(r)}.`,(o=al(n,Kn.QUERY))!==null&&o!==void 0?o:r.astNode)}const l=n.getMutationType();if(l&&!kn(l)){var h;e.reportError(`Mutation root type must be Object type if provided, it cannot be ${Ke(l)}.`,(h=al(n,Kn.MUTATION))!==null&&h!==void 0?h:l.astNode)}const y=n.getSubscriptionType();if(y&&!kn(y)){var N;e.reportError(`Subscription root type must be Object type if provided, it cannot be ${Ke(y)}.`,(N=al(n,Kn.SUBSCRIPTION))!==null&&N!==void 0?N:y.astNode)}}function al(e,n){var r;return(r=[e.astNode,...e.extensionASTNodes].flatMap(o=>{var l;return(l=o?.operationTypes)!==null&&l!==void 0?l:[]}).find(o=>o.operation===n))===null||r===void 0?void 0:r.type}function bm(e){for(const r of e.schema.getDirectives()){if(!dh(r)){e.reportError(`Expected directive but got: ${Ke(r)}.`,r?.astNode);continue}Ki(e,r),r.locations.length===0&&e.reportError(`Directive @${r.name} must include 1 or more locations.`,r.astNode);for(const o of r.args)if(Ki(e,o),ui(o.type)||e.reportError(`The type of @${r.name}(${o.name}:) must be Input Type but got: ${Ke(o.type)}.`,o.astNode),cs(o)&&o.deprecationReason!=null){var n;e.reportError(`Required argument @${r.name}(${o.name}:) cannot be deprecated.`,[Jl(o.astNode),(n=o.astNode)===null||n===void 0?void 0:n.type])}}}function Ki(e,n){n.name.startsWith("__")&&e.reportError(`Name "${n.name}" must not begin with "__", which is reserved by GraphQL introspection.`,n.astNode)}function Sm(e){const n=Cm(e),r=e.schema.getTypeMap();for(const o of Object.values(r)){if(!tm(o)){e.reportError(`Expected GraphQL named type but got: ${Ke(o)}.`,o.astNode);continue}hm(o)||Ki(e,o),kn(o)||Nn(o)?(Ac(e,o),Dc(e,o)):hi(o)?wm(e,o):ri(o)?km(e,o):Fn(o)&&(xm(e,o),n(o))}}function Ac(e,n){const r=Object.values(n.getFields());r.length===0&&e.reportError(`Type ${n.name} must define one or more fields.`,[n.astNode,...n.extensionASTNodes]);for(const y of r){if(Ki(e,y),!gr(y.type)){var o;e.reportError(`The type of ${n.name}.${y.name} must be Output Type but got: ${Ke(y.type)}.`,(o=y.astNode)===null||o===void 0?void 0:o.type)}for(const N of y.args){const D=N.name;if(Ki(e,N),!ui(N.type)){var l;e.reportError(`The type of ${n.name}.${y.name}(${D}:) must be Input Type but got: ${Ke(N.type)}.`,(l=N.astNode)===null||l===void 0?void 0:l.type)}if(cs(N)&&N.deprecationReason!=null){var h;e.reportError(`Required argument ${n.name}.${y.name}(${D}:) cannot be deprecated.`,[Jl(N.astNode),(h=N.astNode)===null||h===void 0?void 0:h.type])}}}}function Dc(e,n){const r=Object.create(null);for(const o of n.getInterfaces()){if(!Nn(o)){e.reportError(`Type ${Ke(n)} must only implement Interface types, it cannot implement ${Ke(o)}.`,is(n,o));continue}if(n===o){e.reportError(`Type ${n.name} cannot implement itself because it would create a circular reference.`,is(n,o));continue}if(r[o.name]){e.reportError(`Type ${n.name} can only implement ${o.name} once.`,is(n,o));continue}r[o.name]=!0,Em(e,n,o),Tm(e,n,o)}}function Tm(e,n,r){const o=n.getFields();for(const D of Object.values(r.getFields())){const R=D.name,W=o[R];if(!W){e.reportError(`Interface field ${r.name}.${R} expected but ${n.name} does not provide it.`,[D.astNode,n.astNode,...n.extensionASTNodes]);continue}if(!vr(e.schema,W.type,D.type)){var l,h;e.reportError(`Interface field ${r.name}.${R} expects type ${Ke(D.type)} but ${n.name}.${R} is type ${Ke(W.type)}.`,[(l=D.astNode)===null||l===void 0?void 0:l.type,(h=W.astNode)===null||h===void 0?void 0:h.type])}for(const z of D.args){const ne=z.name,te=W.args.find(be=>be.name===ne);if(!te){e.reportError(`Interface field argument ${r.name}.${R}(${ne}:) expected but ${n.name}.${R} does not provide it.`,[z.astNode,W.astNode]);continue}if(!yl(z.type,te.type)){var y,N;e.reportError(`Interface field argument ${r.name}.${R}(${ne}:) expects type ${Ke(z.type)} but ${n.name}.${R}(${ne}:) is type ${Ke(te.type)}.`,[(y=z.astNode)===null||y===void 0?void 0:y.type,(N=te.astNode)===null||N===void 0?void 0:N.type])}}for(const z of W.args){const ne=z.name;!D.args.find(be=>be.name===ne)&&cs(z)&&e.reportError(`Object field ${n.name}.${R} includes required argument ${ne} that is missing from the Interface field ${r.name}.${R}.`,[z.astNode,D.astNode])}}}function Em(e,n,r){const o=n.getInterfaces();for(const l of r.getInterfaces())o.includes(l)||e.reportError(l===n?`Type ${n.name} cannot implement ${r.name} because it would create a circular reference.`:`Type ${n.name} must implement ${l.name} because it is implemented by ${r.name}.`,[...is(r,l),...is(n,r)])}function wm(e,n){const r=n.getTypes();r.length===0&&e.reportError(`Union type ${n.name} must define one or more member types.`,[n.astNode,...n.extensionASTNodes]);const o=Object.create(null);for(const l of r){if(o[l.name]){e.reportError(`Union type ${n.name} can only include type ${l.name} once.`,Ic(n,l.name));continue}o[l.name]=!0,kn(l)||e.reportError(`Union type ${n.name} can only include Object types, it cannot include ${Ke(l)}.`,Ic(n,String(l)))}}function km(e,n){const r=n.getValues();r.length===0&&e.reportError(`Enum type ${n.name} must define one or more values.`,[n.astNode,...n.extensionASTNodes]);for(const o of r)Ki(e,o)}function xm(e,n){const r=Object.values(n.getFields());r.length===0&&e.reportError(`Input Object type ${n.name} must define one or more fields.`,[n.astNode,...n.extensionASTNodes]);for(const h of r){if(Ki(e,h),!ui(h.type)){var o;e.reportError(`The type of ${n.name}.${h.name} must be Input Type but got: ${Ke(h.type)}.`,(o=h.astNode)===null||o===void 0?void 0:o.type)}if(uh(h)&&h.deprecationReason!=null){var l;e.reportError(`Required input field ${n.name}.${h.name} cannot be deprecated.`,[Jl(h.astNode),(l=h.astNode)===null||l===void 0?void 0:l.type])}n.isOneOf&&Nm(n,h,e)}}function Nm(e,n,r){if(fn(n.type)){var o;r.reportError(`OneOf input field ${e.name}.${n.name} must be nullable.`,(o=n.astNode)===null||o===void 0?void 0:o.type)}n.defaultValue!==void 0&&r.reportError(`OneOf input field ${e.name}.${n.name} cannot have a default value.`,n.astNode)}function Cm(e){const n=Object.create(null),r=[],o=Object.create(null);return l;function l(h){if(n[h.name])return;n[h.name]=!0,o[h.name]=r.length;const y=Object.values(h.getFields());for(const N of y)if(fn(N.type)&&Fn(N.type.ofType)){const D=N.type.ofType,R=o[D.name];if(r.push(N),R===void 0)l(D);else{const W=r.slice(R),z=W.map(ne=>ne.name).join(".");e.reportError(`Cannot reference Input Object "${D.name}" within itself through a series of non-null fields: "${z}".`,W.map(ne=>ne.astNode))}r.pop()}o[h.name]=void 0}}function is(e,n){const{astNode:r,extensionASTNodes:o}=e;return(r!=null?[r,...o]:o).flatMap(h=>{var y;return(y=h.interfaces)!==null&&y!==void 0?y:[]}).filter(h=>h.name.value===n.name)}function Ic(e,n){const{astNode:r,extensionASTNodes:o}=e;return(r!=null?[r,...o]:o).flatMap(h=>{var y;return(y=h.types)!==null&&y!==void 0?y:[]}).filter(h=>h.name.value===n)}function Jl(e){var n;return e==null||(n=e.directives)===null||n===void 0?void 0:n.find(r=>r.name.value===gh.name)}function ci(e,n){switch(n.kind){case Z.LIST_TYPE:{const r=ci(e,n.type);return r&&new ii(r)}case Z.NON_NULL_TYPE:{const r=ci(e,n.type);return r&&new Jt(r)}case Z.NAMED_TYPE:return e.getType(n.name.value)}}class wh{constructor(n,r,o){this._schema=n,this._typeStack=[],this._parentTypeStack=[],this._inputTypeStack=[],this._fieldDefStack=[],this._defaultValueStack=[],this._directive=null,this._argument=null,this._enumValue=null,this._getFieldDef=o??Am,r&&(ui(r)&&this._inputTypeStack.push(r),ai(r)&&this._parentTypeStack.push(r),gr(r)&&this._typeStack.push(r))}get[Symbol.toStringTag](){return"TypeInfo"}getType(){if(this._typeStack.length>0)return this._typeStack[this._typeStack.length-1]}getParentType(){if(this._parentTypeStack.length>0)return this._parentTypeStack[this._parentTypeStack.length-1]}getInputType(){if(this._inputTypeStack.length>0)return this._inputTypeStack[this._inputTypeStack.length-1]}getParentInputType(){if(this._inputTypeStack.length>1)return this._inputTypeStack[this._inputTypeStack.length-2]}getFieldDef(){if(this._fieldDefStack.length>0)return this._fieldDefStack[this._fieldDefStack.length-1]}getDefaultValue(){if(this._defaultValueStack.length>0)return this._defaultValueStack[this._defaultValueStack.length-1]}getDirective(){return this._directive}getArgument(){return this._argument}getEnumValue(){return this._enumValue}enter(n){const r=this._schema;switch(n.kind){case Z.SELECTION_SET:{const l=_n(this.getType());this._parentTypeStack.push(ai(l)?l:void 0);break}case Z.FIELD:{const l=this.getParentType();let h,y;l&&(h=this._getFieldDef(r,l,n),h&&(y=h.type)),this._fieldDefStack.push(h),this._typeStack.push(gr(y)?y:void 0);break}case Z.DIRECTIVE:this._directive=r.getDirective(n.name.value);break;case Z.OPERATION_DEFINITION:{const l=r.getRootType(n.operation);this._typeStack.push(kn(l)?l:void 0);break}case Z.INLINE_FRAGMENT:case Z.FRAGMENT_DEFINITION:{const l=n.typeCondition,h=l?ci(r,l):_n(this.getType());this._typeStack.push(gr(h)?h:void 0);break}case Z.VARIABLE_DEFINITION:{const l=ci(r,n.type);this._inputTypeStack.push(ui(l)?l:void 0);break}case Z.ARGUMENT:{var o;let l,h;const y=(o=this.getDirective())!==null&&o!==void 0?o:this.getFieldDef();y&&(l=y.args.find(N=>N.name===n.name.value),l&&(h=l.type)),this._argument=l,this._defaultValueStack.push(l?l.defaultValue:void 0),this._inputTypeStack.push(ui(h)?h:void 0);break}case Z.LIST:{const l=Gl(this.getInputType()),h=Un(l)?l.ofType:l;this._defaultValueStack.push(void 0),this._inputTypeStack.push(ui(h)?h:void 0);break}case Z.OBJECT_FIELD:{const l=_n(this.getInputType());let h,y;Fn(l)&&(y=l.getFields()[n.name.value],y&&(h=y.type)),this._defaultValueStack.push(y?y.defaultValue:void 0),this._inputTypeStack.push(ui(h)?h:void 0);break}case Z.ENUM:{const l=_n(this.getInputType());let h;ri(l)&&(h=l.getValue(n.value)),this._enumValue=h;break}}}leave(n){switch(n.kind){case Z.SELECTION_SET:this._parentTypeStack.pop();break;case Z.FIELD:this._fieldDefStack.pop(),this._typeStack.pop();break;case Z.DIRECTIVE:this._directive=null;break;case Z.OPERATION_DEFINITION:case Z.INLINE_FRAGMENT:case Z.FRAGMENT_DEFINITION:this._typeStack.pop();break;case Z.VARIABLE_DEFINITION:this._inputTypeStack.pop();break;case Z.ARGUMENT:this._argument=null,this._defaultValueStack.pop(),this._inputTypeStack.pop();break;case Z.LIST:case Z.OBJECT_FIELD:this._defaultValueStack.pop(),this._inputTypeStack.pop();break;case Z.ENUM:this._enumValue=null;break}}}function Am(e,n,r){const o=r.name.value;if(o===ss.name&&e.getQueryType()===n)return ss;if(o===os.name&&e.getQueryType()===n)return os;if(o===ls.name&&ai(n))return ls;if(kn(n)||Nn(n))return n.getFields()[o]}function kh(e,n){return{enter(...r){const o=r[0];e.enter(o);const l=to(n,o.kind).enter;if(l){const h=l.apply(n,r);return h!==void 0&&(e.leave(o),dl(h)&&e.enter(h)),h}},leave(...r){const o=r[0],l=to(n,o.kind).leave;let h;return l&&(h=l.apply(n,r)),e.leave(o),h}}}function Dm(e){return e.kind===Z.OPERATION_DEFINITION||e.kind===Z.FRAGMENT_DEFINITION}function Im(e){return e.kind===Z.SCHEMA_DEFINITION||So(e)||e.kind===Z.DIRECTIVE_DEFINITION}function So(e){return e.kind===Z.SCALAR_TYPE_DEFINITION||e.kind===Z.OBJECT_TYPE_DEFINITION||e.kind===Z.INTERFACE_TYPE_DEFINITION||e.kind===Z.UNION_TYPE_DEFINITION||e.kind===Z.ENUM_TYPE_DEFINITION||e.kind===Z.INPUT_OBJECT_TYPE_DEFINITION}function Om(e){return e.kind===Z.SCHEMA_EXTENSION||xh(e)}function xh(e){return e.kind===Z.SCALAR_TYPE_EXTENSION||e.kind===Z.OBJECT_TYPE_EXTENSION||e.kind===Z.INTERFACE_TYPE_EXTENSION||e.kind===Z.UNION_TYPE_EXTENSION||e.kind===Z.ENUM_TYPE_EXTENSION||e.kind===Z.INPUT_OBJECT_TYPE_EXTENSION}function Nh(e){return{Document(n){for(const r of n.definitions)if(!Dm(r)){const o=r.kind===Z.SCHEMA_DEFINITION||r.kind===Z.SCHEMA_EXTENSION?"schema":'"'+r.name.value+'"';e.reportError(new Ve(`The ${o} definition is not executable.`,{nodes:r}))}return!1}}}function Mm(e){return{Field(n){const r=e.getParentType();if(r&&!e.getFieldDef()){const l=e.getSchema(),h=n.name.value;let y=Ui("to use an inline fragment on",Lm(l,r,h));y===""&&(y=Ui(_m(r,h))),e.reportError(new Ve(`Cannot query field "${h}" on type "${r.name}".`+y,{nodes:n}))}}}}function Lm(e,n,r){if(!Ni(n))return[];const o=new Set,l=Object.create(null);for(const y of e.getPossibleTypes(n))if(y.getFields()[r]){o.add(y),l[y.name]=1;for(const N of y.getInterfaces()){var h;N.getFields()[r]&&(o.add(N),l[N.name]=((h=l[N.name])!==null&&h!==void 0?h:0)+1)}}return[...o].sort((y,N)=>{const D=l[N.name]-l[y.name];return D!==0?D:Nn(y)&&e.isSubType(y,N)?-1:Nn(N)&&e.isSubType(N,y)?1:Wl(y.name,N.name)}).map(y=>y.name)}function _m(e,n){if(kn(e)||Nn(e)){const r=Object.keys(e.getFields());return nr(n,r)}return[]}function Ch(e){return{InlineFragment(n){const r=n.typeCondition;if(r){const o=ci(e.getSchema(),r);if(o&&!ai(o)){const l=jn(r);e.reportError(new Ve(`Fragment cannot condition on non composite type "${l}".`,{nodes:r}))}}},FragmentDefinition(n){const r=ci(e.getSchema(),n.typeCondition);if(r&&!ai(r)){const o=jn(n.typeCondition);e.reportError(new Ve(`Fragment "${n.name.value}" cannot condition on non composite type "${o}".`,{nodes:n.typeCondition}))}}}}function Rm(e){return{...Fm(e),Argument(n){const r=e.getArgument(),o=e.getFieldDef(),l=e.getParentType();if(!r&&o&&l){const h=n.name.value,y=o.args.map(D=>D.name),N=nr(h,y);e.reportError(new Ve(`Unknown argument "${h}" on field "${l.name}.${o.name}".`+Ui(N),{nodes:n}))}}}}function Fm(e){const n=Object.create(null),r=e.getSchema(),o=r?r.getDirectives():fs;for(const y of o)n[y.name]=y.args.map(N=>N.name);const l=e.getDocument().definitions;for(const y of l)if(y.kind===Z.DIRECTIVE_DEFINITION){var h;const N=(h=y.arguments)!==null&&h!==void 0?h:[];n[y.name.value]=N.map(D=>D.name.value)}return{Directive(y){const N=y.name.value,D=n[N];if(y.arguments&&D)for(const R of y.arguments){const W=R.name.value;if(!D.includes(W)){const z=nr(W,D);e.reportError(new Ve(`Unknown argument "${W}" on directive "@${N}".`+Ui(z),{nodes:R}))}}return!1}}}function Ah(e){const n=Object.create(null),r=e.getSchema(),o=r?r.getDirectives():fs;for(const h of o)n[h.name]=h.locations;const l=e.getDocument().definitions;for(const h of l)h.kind===Z.DIRECTIVE_DEFINITION&&(n[h.name.value]=h.locations.map(y=>y.value));return{Directive(h,y,N,D,R){const W=h.name.value,z=n[W];if(!z){e.reportError(new Ve(`Unknown directive "@${W}".`,{nodes:h}));return}const ne=Pm(R);ne&&!z.includes(ne)&&e.reportError(new Ve(`Directive "@${W}" may not be used on ${ne}.`,{nodes:h}))}}}function Pm(e){const n=e[e.length-1];switch("kind"in n||li(!1),n.kind){case Z.OPERATION_DEFINITION:return Bm(n.operation);case Z.FIELD:return et.FIELD;case Z.FRAGMENT_SPREAD:return et.FRAGMENT_SPREAD;case Z.INLINE_FRAGMENT:return et.INLINE_FRAGMENT;case Z.FRAGMENT_DEFINITION:return et.FRAGMENT_DEFINITION;case Z.VARIABLE_DEFINITION:return et.VARIABLE_DEFINITION;case Z.SCHEMA_DEFINITION:case Z.SCHEMA_EXTENSION:return et.SCHEMA;case Z.SCALAR_TYPE_DEFINITION:case Z.SCALAR_TYPE_EXTENSION:return et.SCALAR;case Z.OBJECT_TYPE_DEFINITION:case Z.OBJECT_TYPE_EXTENSION:return et.OBJECT;case Z.FIELD_DEFINITION:return et.FIELD_DEFINITION;case Z.INTERFACE_TYPE_DEFINITION:case Z.INTERFACE_TYPE_EXTENSION:return et.INTERFACE;case Z.UNION_TYPE_DEFINITION:case Z.UNION_TYPE_EXTENSION:return et.UNION;case Z.ENUM_TYPE_DEFINITION:case Z.ENUM_TYPE_EXTENSION:return et.ENUM;case Z.ENUM_VALUE_DEFINITION:return et.ENUM_VALUE;case Z.INPUT_OBJECT_TYPE_DEFINITION:case Z.INPUT_OBJECT_TYPE_EXTENSION:return et.INPUT_OBJECT;case Z.INPUT_VALUE_DEFINITION:{const r=e[e.length-3];return"kind"in r||li(!1),r.kind===Z.INPUT_OBJECT_TYPE_DEFINITION?et.INPUT_FIELD_DEFINITION:et.ARGUMENT_DEFINITION}default:li(!1,"Unexpected kind: "+Ke(n.kind))}}function Bm(e){switch(e){case Kn.QUERY:return et.QUERY;case Kn.MUTATION:return et.MUTATION;case Kn.SUBSCRIPTION:return et.SUBSCRIPTION}}function Dh(e){return{FragmentSpread(n){const r=n.name.value;e.getFragment(r)||e.reportError(new Ve(`Unknown fragment "${r}".`,{nodes:n.name}))}}}function Ih(e){const n=e.getSchema(),r=n?n.getTypeMap():Object.create(null),o=Object.create(null);for(const h of e.getDocument().definitions)So(h)&&(o[h.name.value]=!0);const l=[...Object.keys(r),...Object.keys(o)];return{NamedType(h,y,N,D,R){const W=h.name.value;if(!r[W]&&!o[W]){var z;const ne=(z=R[2])!==null&&z!==void 0?z:N,te=ne!=null&&Vm(ne);if(te&&Oc.includes(W))return;const be=nr(W,te?Oc.concat(l):l);e.reportError(new Ve(`Unknown type "${W}".`+Ui(be),{nodes:h}))}}}}const Oc=[...om,...Eh].map(e=>e.name);function Vm(e){return"kind"in e&&(Im(e)||Om(e))}function jm(e){let n=0;return{Document(r){n=r.definitions.filter(o=>o.kind===Z.OPERATION_DEFINITION).length},OperationDefinition(r){!r.name&&n>1&&e.reportError(new Ve("This anonymous operation must be the only defined operation.",{nodes:r}))}}}function Um(e){var n,r,o;const l=e.getSchema(),h=(n=(r=(o=l?.astNode)!==null&&o!==void 0?o:l?.getQueryType())!==null&&r!==void 0?r:l?.getMutationType())!==null&&n!==void 0?n:l?.getSubscriptionType();let y=0;return{SchemaDefinition(N){if(h){e.reportError(new Ve("Cannot define a new schema within a schema extension.",{nodes:N}));return}y>0&&e.reportError(new Ve("Must provide only one schema definition.",{nodes:N})),++y}}}const $m=3;function Hm(e){function n(r,o=Object.create(null),l=0){if(r.kind===Z.FRAGMENT_SPREAD){const h=r.name.value;if(o[h]===!0)return!1;const y=e.getFragment(h);if(!y)return!1;try{return o[h]=!0,n(y,o,l)}finally{o[h]=void 0}}if(r.kind===Z.FIELD&&(r.name.value==="fields"||r.name.value==="interfaces"||r.name.value==="possibleTypes"||r.name.value==="inputFields")&&(l++,l>=$m))return!0;if("selectionSet"in r&&r.selectionSet){for(const h of r.selectionSet.selections)if(n(h,o,l))return!0}return!1}return{Field(r){if((r.name.value==="__schema"||r.name.value==="__type")&&n(r))return e.reportError(new Ve("Maximum introspection depth exceeded",{nodes:[r]})),!1}}}function Wm(e){const n=Object.create(null),r=[],o=Object.create(null);return{OperationDefinition:()=>!1,FragmentDefinition(h){return l(h),!1}};function l(h){if(n[h.name.value])return;const y=h.name.value;n[y]=!0;const N=e.getFragmentSpreads(h.selectionSet);if(N.length!==0){o[y]=r.length;for(const D of N){const R=D.name.value,W=o[R];if(r.push(D),W===void 0){const z=e.getFragment(R);z&&l(z)}else{const z=r.slice(W),ne=z.slice(0,-1).map(te=>'"'+te.name.value+'"').join(", ");e.reportError(new Ve(`Cannot spread fragment "${R}" within itself`+(ne!==""?` via ${ne}.`:"."),{nodes:z}))}r.pop()}o[y]=void 0}}}function qm(e){let n=Object.create(null);return{OperationDefinition:{enter(){n=Object.create(null)},leave(r){const o=e.getRecursiveVariableUsages(r);for(const{node:l}of o){const h=l.name.value;n[h]!==!0&&e.reportError(new Ve(r.name?`Variable "$${h}" is not defined by operation "${r.name.value}".`:`Variable "$${h}" is not defined.`,{nodes:[l,r]}))}}},VariableDefinition(r){n[r.variable.name.value]=!0}}}function Oh(e){const n=[],r=[];return{OperationDefinition(o){return n.push(o),!1},FragmentDefinition(o){return r.push(o),!1},Document:{leave(){const o=Object.create(null);for(const l of n)for(const h of e.getRecursivelyReferencedFragments(l))o[h.name.value]=!0;for(const l of r){const h=l.name.value;o[h]!==!0&&e.reportError(new Ve(`Fragment "${h}" is never used.`,{nodes:l}))}}}}}function zm(e){let n=[];return{OperationDefinition:{enter(){n=[]},leave(r){const o=Object.create(null),l=e.getRecursiveVariableUsages(r);for(const{node:h}of l)o[h.name.value]=!0;for(const h of n){const y=h.variable.name.value;o[y]!==!0&&e.reportError(new Ve(r.name?`Variable "$${y}" is never used in operation "${r.name.value}".`:`Variable "$${y}" is never used.`,{nodes:h}))}}},VariableDefinition(r){n.push(r)}}}function Xl(e){switch(e.kind){case Z.OBJECT:return{...e,fields:Gm(e.fields)};case Z.LIST:return{...e,values:e.values.map(Xl)};case Z.INT:case Z.FLOAT:case Z.STRING:case Z.BOOLEAN:case Z.NULL:case Z.ENUM:case Z.VARIABLE:return e}}function Gm(e){return e.map(n=>({...n,value:Xl(n.value)})).sort((n,r)=>Wl(n.name.value,r.name.value))}function Mh(e){return Array.isArray(e)?e.map(([n,r])=>`subfields "${n}" conflict because `+Mh(r)).join(" and "):e}function Ym(e){const n=new Rh,r=new eg,o=new Map;return{SelectionSet(l){const h=Jm(e,o,n,r,e.getParentType(),l);for(const[[y,N],D,R]of h){const W=Mh(N);e.reportError(new Ve(`Fields "${y}" conflict because ${W}. Use different aliases on the fields to fetch both if this was intentional.`,{nodes:D.concat(R)}))}}}}function Jm(e,n,r,o,l,h){const y=[],[N,D]=ro(e,n,l,h);if(Qm(e,y,n,r,o,N),D.length!==0)for(let R=0;R<D.length;R++){no(e,y,n,r,o,!1,N,D[R]);for(let W=R+1;W<D.length;W++)io(e,y,n,r,o,!1,D[R],D[W])}return y}function no(e,n,r,o,l,h,y,N){if(o.has(y,N,h))return;o.add(y,N,h);const D=e.getFragment(N);if(!D)return;const[R,W]=Sl(e,r,D);if(y!==R){Ql(e,n,r,o,l,h,y,R);for(const z of W)no(e,n,r,o,l,h,y,z)}}function io(e,n,r,o,l,h,y,N){if(y===N||l.has(y,N,h))return;l.add(y,N,h);const D=e.getFragment(y),R=e.getFragment(N);if(!D||!R)return;const[W,z]=Sl(e,r,D),[ne,te]=Sl(e,r,R);Ql(e,n,r,o,l,h,W,ne);for(const be of te)io(e,n,r,o,l,h,y,be);for(const be of z)io(e,n,r,o,l,h,be,N)}function Xm(e,n,r,o,l,h,y,N,D){const R=[],[W,z]=ro(e,n,h,y),[ne,te]=ro(e,n,N,D);Ql(e,R,n,r,o,l,W,ne);for(const be of te)no(e,R,n,r,o,l,W,be);for(const be of z)no(e,R,n,r,o,l,ne,be);for(const be of z)for(const Ne of te)io(e,R,n,r,o,l,be,Ne);return R}function Qm(e,n,r,o,l,h){for(const[y,N]of Object.entries(h))if(N.length>1)for(let D=0;D<N.length;D++)for(let R=D+1;R<N.length;R++){const W=Lh(e,r,o,l,!1,y,N[D],N[R]);W&&n.push(W)}}function Ql(e,n,r,o,l,h,y,N){for(const[D,R]of Object.entries(y)){const W=N[D];if(W)for(const z of R)for(const ne of W){const te=Lh(e,r,o,l,h,D,z,ne);te&&n.push(te)}}}function Lh(e,n,r,o,l,h,y,N){const[D,R,W]=y,[z,ne,te]=N,be=l||D!==z&&kn(D)&&kn(z);if(!be){const Ge=R.name.value,We=ne.name.value;if(Ge!==We)return[[h,`"${Ge}" and "${We}" are different fields`],[R],[ne]];if(!Km(R,ne))return[[h,"they have differing arguments"],[R],[ne]]}const Ne=W?.type,Se=te?.type;if(Ne&&Se&&bl(Ne,Se))return[[h,`they return conflicting types "${Ke(Ne)}" and "${Ke(Se)}"`],[R],[ne]];const xe=R.selectionSet,Qe=ne.selectionSet;if(xe&&Qe){const Ge=Xm(e,n,r,o,be,_n(Ne),xe,_n(Se),Qe);return Zm(Ge,h,R,ne)}}function Km(e,n){const r=e.arguments,o=n.arguments;if(r===void 0||r.length===0)return o===void 0||o.length===0;if(o===void 0||o.length===0||r.length!==o.length)return!1;const l=new Map(o.map(({name:h,value:y})=>[h.value,y]));return r.every(h=>{const y=h.value,N=l.get(h.name.value);return N===void 0?!1:Mc(y)===Mc(N)})}function Mc(e){return jn(Xl(e))}function bl(e,n){return Un(e)?Un(n)?bl(e.ofType,n.ofType):!0:Un(n)?!0:fn(e)?fn(n)?bl(e.ofType,n.ofType):!0:fn(n)?!0:Tr(e)||Tr(n)?e!==n:!1}function ro(e,n,r,o){const l=n.get(o);if(l)return l;const h=Object.create(null),y=Object.create(null);_h(e,r,o,h,y);const N=[h,Object.keys(y)];return n.set(o,N),N}function Sl(e,n,r){const o=n.get(r.selectionSet);if(o)return o;const l=ci(e.getSchema(),r.typeCondition);return ro(e,n,l,r.selectionSet)}function _h(e,n,r,o,l){for(const h of r.selections)switch(h.kind){case Z.FIELD:{const y=h.name.value;let N;(kn(n)||Nn(n))&&(N=n.getFields()[y]);const D=h.alias?h.alias.value:y;o[D]||(o[D]=[]),o[D].push([n,h,N]);break}case Z.FRAGMENT_SPREAD:l[h.name.value]=!0;break;case Z.INLINE_FRAGMENT:{const y=h.typeCondition,N=y?ci(e.getSchema(),y):n;_h(e,N,h.selectionSet,o,l);break}}}function Zm(e,n,r,o){if(e.length>0)return[[n,e.map(([l])=>l)],[r,...e.map(([,l])=>l).flat()],[o,...e.map(([,,l])=>l).flat()]]}class Rh{constructor(){this._data=new Map}has(n,r,o){var l;const h=(l=this._data.get(n))===null||l===void 0?void 0:l.get(r);return h===void 0?!1:o?!0:o===h}add(n,r,o){const l=this._data.get(n);l===void 0?this._data.set(n,new Map([[r,o]])):l.set(r,o)}}class eg{constructor(){this._orderedPairSet=new Rh}has(n,r,o){return n<r?this._orderedPairSet.has(n,r,o):this._orderedPairSet.has(r,n,o)}add(n,r,o){n<r?this._orderedPairSet.add(n,r,o):this._orderedPairSet.add(r,n,o)}}function tg(e){return{InlineFragment(n){const r=e.getType(),o=e.getParentType();if(ai(r)&&ai(o)&&!vl(e.getSchema(),r,o)){const l=Ke(o),h=Ke(r);e.reportError(new Ve(`Fragment cannot be spread here as objects of type "${l}" can never be of type "${h}".`,{nodes:n}))}},FragmentSpread(n){const r=n.name.value,o=ng(e,r),l=e.getParentType();if(o&&l&&!vl(e.getSchema(),o,l)){const h=Ke(l),y=Ke(o);e.reportError(new Ve(`Fragment "${r}" cannot be spread here as objects of type "${h}" can never be of type "${y}".`,{nodes:n}))}}}}function ng(e,n){const r=e.getFragment(n);if(r){const o=ci(e.getSchema(),r.typeCondition);if(ai(o))return o}}function ig(e){const n=e.getSchema(),r=Object.create(null);for(const l of e.getDocument().definitions)So(l)&&(r[l.name.value]=l);return{ScalarTypeExtension:o,ObjectTypeExtension:o,InterfaceTypeExtension:o,UnionTypeExtension:o,EnumTypeExtension:o,InputObjectTypeExtension:o};function o(l){const h=l.name.value,y=r[h],N=n?.getType(h);let D;if(y?D=rg[y.kind]:N&&(D=sg(N)),D){if(D!==l.kind){const R=og(l.kind);e.reportError(new Ve(`Cannot extend non-${R} type "${h}".`,{nodes:y?[y,l]:l}))}}else{const R=Object.keys({...r,...n?.getTypeMap()}),W=nr(h,R);e.reportError(new Ve(`Cannot extend type "${h}" because it is not defined.`+Ui(W),{nodes:l.name}))}}}const rg={[Z.SCALAR_TYPE_DEFINITION]:Z.SCALAR_TYPE_EXTENSION,[Z.OBJECT_TYPE_DEFINITION]:Z.OBJECT_TYPE_EXTENSION,[Z.INTERFACE_TYPE_DEFINITION]:Z.INTERFACE_TYPE_EXTENSION,[Z.UNION_TYPE_DEFINITION]:Z.UNION_TYPE_EXTENSION,[Z.ENUM_TYPE_DEFINITION]:Z.ENUM_TYPE_EXTENSION,[Z.INPUT_OBJECT_TYPE_DEFINITION]:Z.INPUT_OBJECT_TYPE_EXTENSION};function sg(e){if(bi(e))return Z.SCALAR_TYPE_EXTENSION;if(kn(e))return Z.OBJECT_TYPE_EXTENSION;if(Nn(e))return Z.INTERFACE_TYPE_EXTENSION;if(hi(e))return Z.UNION_TYPE_EXTENSION;if(ri(e))return Z.ENUM_TYPE_EXTENSION;if(Fn(e))return Z.INPUT_OBJECT_TYPE_EXTENSION;li(!1,"Unexpected type: "+Ke(e))}function og(e){switch(e){case Z.SCALAR_TYPE_EXTENSION:return"scalar";case Z.OBJECT_TYPE_EXTENSION:return"object";case Z.INTERFACE_TYPE_EXTENSION:return"interface";case Z.UNION_TYPE_EXTENSION:return"union";case Z.ENUM_TYPE_EXTENSION:return"enum";case Z.INPUT_OBJECT_TYPE_EXTENSION:return"input object";default:li(!1,"Unexpected kind: "+Ke(e))}}function Fh(e){return{...lg(e),Field:{leave(n){var r;const o=e.getFieldDef();if(!o)return!1;const l=new Set((r=n.arguments)===null||r===void 0?void 0:r.map(h=>h.name.value));for(const h of o.args)if(!l.has(h.name)&&cs(h)){const y=Ke(h.type);e.reportError(new Ve(`Field "${o.name}" argument "${h.name}" of type "${y}" is required, but it was not provided.`,{nodes:n}))}}}}}function lg(e){var n;const r=Object.create(null),o=e.getSchema(),l=(n=o?.getDirectives())!==null&&n!==void 0?n:fs;for(const N of l)r[N.name]=Sr(N.args.filter(cs),D=>D.name);const h=e.getDocument().definitions;for(const N of h)if(N.kind===Z.DIRECTIVE_DEFINITION){var y;const D=(y=N.arguments)!==null&&y!==void 0?y:[];r[N.name.value]=Sr(D.filter(ag),R=>R.name.value)}return{Directive:{leave(N){const D=N.name.value,R=r[D];if(R){var W;const z=(W=N.arguments)!==null&&W!==void 0?W:[],ne=new Set(z.map(te=>te.name.value));for(const[te,be]of Object.entries(R))if(!ne.has(te)){const Ne=ql(be.type)?Ke(be.type):jn(be.type);e.reportError(new Ve(`Directive "@${D}" argument "${te}" of type "${Ne}" is required, but it was not provided.`,{nodes:N}))}}}}}}function ag(e){return e.type.kind===Z.NON_NULL_TYPE&&e.defaultValue==null}function cg(e){return{Field(n){const r=e.getType(),o=n.selectionSet;if(r)if(Tr(_n(r))){if(o){const l=n.name.value,h=Ke(r);e.reportError(new Ve(`Field "${l}" must not have a selection since type "${h}" has no subfields.`,{nodes:o}))}}else if(o){if(o.selections.length===0){const l=n.name.value,h=Ke(r);e.reportError(new Ve(`Field "${l}" of type "${h}" must have at least one field selected.`,{nodes:n}))}}else{const l=n.name.value,h=Ke(r);e.reportError(new Ve(`Field "${l}" of type "${h}" must have a selection of subfields. Did you mean "${l} { ... }"?`,{nodes:n}))}}}}function Zr(e,n,r){if(e){if(e.kind===Z.VARIABLE){const o=e.name.value;if(r==null||r[o]===void 0)return;const l=r[o];return l===null&&fn(n)?void 0:l}if(fn(n))return e.kind===Z.NULL?void 0:Zr(e,n.ofType,r);if(e.kind===Z.NULL)return null;if(Un(n)){const o=n.ofType;if(e.kind===Z.LIST){const h=[];for(const y of e.values)if(Lc(y,r)){if(fn(o))return;h.push(null)}else{const N=Zr(y,o,r);if(N===void 0)return;h.push(N)}return h}const l=Zr(e,o,r);return l===void 0?void 0:[l]}if(Fn(n)){if(e.kind!==Z.OBJECT)return;const o=Object.create(null),l=Sr(e.fields,h=>h.name.value);for(const h of Object.values(n.getFields())){const y=l[h.name];if(!y||Lc(y.value,r)){if(h.defaultValue!==void 0)o[h.name]=h.defaultValue;else if(fn(h.type))return;continue}const N=Zr(y.value,h.type,r);if(N===void 0)return;o[h.name]=N}if(n.isOneOf){const h=Object.keys(o);if(h.length!==1||o[h[0]]===null)return}return o}if(Tr(n)){let o;try{o=n.parseLiteral(e,r)}catch{return}return o===void 0?void 0:o}li(!1,"Unexpected input type: "+Ke(n))}}function Lc(e,n){return e.kind===Z.VARIABLE&&(n==null||n[e.name.value]===void 0)}function ug(e,n,r){var o;const l={},h=(o=n.arguments)!==null&&o!==void 0?o:[],y=Sr(h,N=>N.name.value);for(const N of e.args){const D=N.name,R=N.type,W=y[D];if(!W){if(N.defaultValue!==void 0)l[D]=N.defaultValue;else if(fn(R))throw new Ve(`Argument "${D}" of required type "${Ke(R)}" was not provided.`,{nodes:n});continue}const z=W.value;let ne=z.kind===Z.NULL;if(z.kind===Z.VARIABLE){const be=z.name.value;if(r==null||!hg(r,be)){if(N.defaultValue!==void 0)l[D]=N.defaultValue;else if(fn(R))throw new Ve(`Argument "${D}" of required type "${Ke(R)}" was provided the variable "$${be}" which was not provided a runtime value.`,{nodes:z});continue}ne=r[be]==null}if(ne&&fn(R))throw new Ve(`Argument "${D}" of non-null type "${Ke(R)}" must not be null.`,{nodes:z});const te=Zr(z,R,r);if(te===void 0)throw new Ve(`Argument "${D}" has invalid value ${jn(z)}.`,{nodes:z});l[D]=te}return l}function _c(e,n,r){var o;const l=(o=n.directives)===null||o===void 0?void 0:o.find(h=>h.name.value===e.name);if(l)return ug(e,l,r)}function hg(e,n){return Object.prototype.hasOwnProperty.call(e,n)}function fg(e,n,r,o,l){const h=new Map;return Tl(e,n,r,o,l,h,new Set),h}function Tl(e,n,r,o,l,h,y){for(const N of l.selections)switch(N.kind){case Z.FIELD:{if(!cl(r,N))continue;const D=dg(N),R=h.get(D);R!==void 0?R.push(N):h.set(D,[N]);break}case Z.INLINE_FRAGMENT:{if(!cl(r,N)||!Rc(e,N,o))continue;Tl(e,n,r,o,N.selectionSet,h,y);break}case Z.FRAGMENT_SPREAD:{const D=N.name.value;if(y.has(D)||!cl(r,N))continue;y.add(D);const R=n[D];if(!R||!Rc(e,R,o))continue;Tl(e,n,r,o,R.selectionSet,h,y);break}}}function cl(e,n){const r=_c(mh,n,e);if(r?.if===!0)return!1;const o=_c(ph,n,e);return o?.if!==!1}function Rc(e,n,r){const o=n.typeCondition;if(!o)return!0;const l=ci(e,o);return l===r?!0:Ni(l)?e.isSubType(l,r):!1}function dg(e){return e.alias?e.alias.value:e.name.value}function pg(e){return{OperationDefinition(n){if(n.operation==="subscription"){const r=e.getSchema(),o=r.getSubscriptionType();if(o){const l=n.name?n.name.value:null,h=Object.create(null),y=e.getDocument(),N=Object.create(null);for(const R of y.definitions)R.kind===Z.FRAGMENT_DEFINITION&&(N[R.name.value]=R);const D=fg(r,N,h,o,n.selectionSet);if(D.size>1){const z=[...D.values()].slice(1).flat();e.reportError(new Ve(l!=null?`Subscription "${l}" must select only one top level field.`:"Anonymous Subscription must select only one top level field.",{nodes:z}))}for(const R of D.values())R[0].name.value.startsWith("__")&&e.reportError(new Ve(l!=null?`Subscription "${l}" must not select an introspection top level field.`:"Anonymous Subscription must not select an introspection top level field.",{nodes:R}))}}}}}function Ph(e,n){const r=new Map;for(const o of e){const l=n(o),h=r.get(l);h===void 0?r.set(l,[o]):h.push(o)}return r}function Bh(e){return{Field:n,Directive:n};function n(r){var o;const l=(o=r.arguments)!==null&&o!==void 0?o:[],h=Ph(l,y=>y.name.value);for(const[y,N]of h)N.length>1&&e.reportError(new Ve(`There can be only one argument named "${y}".`,{nodes:N.map(D=>D.name)}))}}function mg(e){const n=Object.create(null),r=e.getSchema();return{DirectiveDefinition(o){const l=o.name.value;if(r!=null&&r.getDirective(l)){e.reportError(new Ve(`Directive "@${l}" already exists in the schema. It cannot be redefined.`,{nodes:o.name}));return}return n[l]?e.reportError(new Ve(`There can be only one directive named "@${l}".`,{nodes:[n[l],o.name]})):n[l]=o.name,!1}}}function Vh(e){const n=Object.create(null),r=e.getSchema(),o=r?r.getDirectives():fs;for(const N of o)n[N.name]=!N.isRepeatable;const l=e.getDocument().definitions;for(const N of l)N.kind===Z.DIRECTIVE_DEFINITION&&(n[N.name.value]=!N.repeatable);const h=Object.create(null),y=Object.create(null);return{enter(N){if(!("directives"in N)||!N.directives)return;let D;if(N.kind===Z.SCHEMA_DEFINITION||N.kind===Z.SCHEMA_EXTENSION)D=h;else if(So(N)||xh(N)){const R=N.name.value;D=y[R],D===void 0&&(y[R]=D=Object.create(null))}else D=Object.create(null);for(const R of N.directives){const W=R.name.value;n[W]&&(D[W]?e.reportError(new Ve(`The directive "@${W}" can only be used once at this location.`,{nodes:[D[W],R]})):D[W]=R)}}}}function gg(e){const n=e.getSchema(),r=n?n.getTypeMap():Object.create(null),o=Object.create(null);return{EnumTypeDefinition:l,EnumTypeExtension:l};function l(h){var y;const N=h.name.value;o[N]||(o[N]=Object.create(null));const D=(y=h.values)!==null&&y!==void 0?y:[],R=o[N];for(const W of D){const z=W.name.value,ne=r[N];ri(ne)&&ne.getValue(z)?e.reportError(new Ve(`Enum value "${N}.${z}" already exists in the schema. It cannot also be defined in this type extension.`,{nodes:W.name})):R[z]?e.reportError(new Ve(`Enum value "${N}.${z}" can only be defined once.`,{nodes:[R[z],W.name]})):R[z]=W.name}return!1}}function yg(e){const n=e.getSchema(),r=n?n.getTypeMap():Object.create(null),o=Object.create(null);return{InputObjectTypeDefinition:l,InputObjectTypeExtension:l,InterfaceTypeDefinition:l,InterfaceTypeExtension:l,ObjectTypeDefinition:l,ObjectTypeExtension:l};function l(h){var y;const N=h.name.value;o[N]||(o[N]=Object.create(null));const D=(y=h.fields)!==null&&y!==void 0?y:[],R=o[N];for(const W of D){const z=W.name.value;vg(r[N],z)?e.reportError(new Ve(`Field "${N}.${z}" already exists in the schema. It cannot also be defined in this type extension.`,{nodes:W.name})):R[z]?e.reportError(new Ve(`Field "${N}.${z}" can only be defined once.`,{nodes:[R[z],W.name]})):R[z]=W.name}return!1}}function vg(e,n){return kn(e)||Nn(e)||Fn(e)?e.getFields()[n]!=null:!1}function bg(e){const n=Object.create(null);return{OperationDefinition:()=>!1,FragmentDefinition(r){const o=r.name.value;return n[o]?e.reportError(new Ve(`There can be only one fragment named "${o}".`,{nodes:[n[o],r.name]})):n[o]=r.name,!1}}}function jh(e){const n=[];let r=Object.create(null);return{ObjectValue:{enter(){n.push(r),r=Object.create(null)},leave(){const o=n.pop();o||li(!1),r=o}},ObjectField(o){const l=o.name.value;r[l]?e.reportError(new Ve(`There can be only one input field named "${l}".`,{nodes:[r[l],o.name]})):r[l]=o.name}}}function Sg(e){const n=Object.create(null);return{OperationDefinition(r){const o=r.name;return o&&(n[o.value]?e.reportError(new Ve(`There can be only one operation named "${o.value}".`,{nodes:[n[o.value],o]})):n[o.value]=o),!1},FragmentDefinition:()=>!1}}function Tg(e){const n=e.getSchema(),r=Object.create(null),o=n?{query:n.getQueryType(),mutation:n.getMutationType(),subscription:n.getSubscriptionType()}:{};return{SchemaDefinition:l,SchemaExtension:l};function l(h){var y;const N=(y=h.operationTypes)!==null&&y!==void 0?y:[];for(const D of N){const R=D.operation,W=r[R];o[R]?e.reportError(new Ve(`Type for ${R} already defined in the schema. It cannot be redefined.`,{nodes:D})):W?e.reportError(new Ve(`There can be only one ${R} type in schema.`,{nodes:[W,D]})):r[R]=D}return!1}}function Eg(e){const n=Object.create(null),r=e.getSchema();return{ScalarTypeDefinition:o,ObjectTypeDefinition:o,InterfaceTypeDefinition:o,UnionTypeDefinition:o,EnumTypeDefinition:o,InputObjectTypeDefinition:o};function o(l){const h=l.name.value;if(r!=null&&r.getType(h)){e.reportError(new Ve(`Type "${h}" already exists in the schema. It cannot also be defined in this type definition.`,{nodes:l.name}));return}return n[h]?e.reportError(new Ve(`There can be only one type named "${h}".`,{nodes:[n[h],l.name]})):n[h]=l.name,!1}}function Uh(e){return{OperationDefinition(n){var r;const o=(r=n.variableDefinitions)!==null&&r!==void 0?r:[],l=Ph(o,h=>h.variable.name.value);for(const[h,y]of l)y.length>1&&e.reportError(new Ve(`There can be only one variable named "$${h}".`,{nodes:y.map(N=>N.variable.name)}))}}}function wg(e){let n={};return{OperationDefinition:{enter(){n={}}},VariableDefinition(r){n[r.variable.name.value]=r},ListValue(r){const o=Gl(e.getParentInputType());if(!Un(o))return Yi(e,r),!1},ObjectValue(r){const o=_n(e.getInputType());if(!Fn(o))return Yi(e,r),!1;const l=Sr(r.fields,h=>h.name.value);for(const h of Object.values(o.getFields()))if(!l[h.name]&&uh(h)){const N=Ke(h.type);e.reportError(new Ve(`Field "${o.name}.${h.name}" of required type "${N}" was not provided.`,{nodes:r}))}o.isOneOf&&kg(e,r,o,l,n)},ObjectField(r){const o=_n(e.getParentInputType());if(!e.getInputType()&&Fn(o)){const h=nr(r.name.value,Object.keys(o.getFields()));e.reportError(new Ve(`Field "${r.name.value}" is not defined by type "${o.name}".`+Ui(h),{nodes:r}))}},NullValue(r){const o=e.getInputType();fn(o)&&e.reportError(new Ve(`Expected value of type "${Ke(o)}", found ${jn(r)}.`,{nodes:r}))},EnumValue:r=>Yi(e,r),IntValue:r=>Yi(e,r),FloatValue:r=>Yi(e,r),StringValue:r=>Yi(e,r),BooleanValue:r=>Yi(e,r)}}function Yi(e,n){const r=e.getInputType();if(!r)return;const o=_n(r);if(!Tr(o)){const l=Ke(r);e.reportError(new Ve(`Expected value of type "${l}", found ${jn(n)}.`,{nodes:n}));return}try{if(o.parseLiteral(n,void 0)===void 0){const h=Ke(r);e.reportError(new Ve(`Expected value of type "${h}", found ${jn(n)}.`,{nodes:n}))}}catch(l){const h=Ke(r);l instanceof Ve?e.reportError(l):e.reportError(new Ve(`Expected value of type "${h}", found ${jn(n)}; `+l.message,{nodes:n,originalError:l}))}}function kg(e,n,r,o,l){var h;const y=Object.keys(o);if(y.length!==1){e.reportError(new Ve(`OneOf Input Object "${r.name}" must specify exactly one key.`,{nodes:[n]}));return}const D=(h=o[y[0]])===null||h===void 0?void 0:h.value,R=!D||D.kind===Z.NULL,W=D?.kind===Z.VARIABLE;if(R){e.reportError(new Ve(`Field "${r.name}.${y[0]}" must be non-null.`,{nodes:[n]}));return}if(W){const z=D.name.value;l[z].type.kind!==Z.NON_NULL_TYPE&&e.reportError(new Ve(`Variable "${z}" must be non-nullable to be used for OneOf Input Object "${r.name}".`,{nodes:[n]}))}}function xg(e){return{VariableDefinition(n){const r=ci(e.getSchema(),n.type);if(r!==void 0&&!ui(r)){const o=n.variable.name.value,l=jn(n.type);e.reportError(new Ve(`Variable "$${o}" cannot be non-input type "${l}".`,{nodes:n.type}))}}}}function Ng(e){let n=Object.create(null);return{OperationDefinition:{enter(){n=Object.create(null)},leave(r){const o=e.getRecursiveVariableUsages(r);for(const{node:l,type:h,defaultValue:y,parentType:N}of o){const D=l.name.value,R=n[D];if(R&&h){const W=e.getSchema(),z=ci(W,R.type);if(z&&!Cg(W,z,R.defaultValue,h,y)){const ne=Ke(z),te=Ke(h);e.reportError(new Ve(`Variable "$${D}" of type "${ne}" used in position expecting type "${te}".`,{nodes:[R,l]}))}Fn(N)&&N.isOneOf&&th(z)&&e.reportError(new Ve(`Variable "$${D}" is of type "${z}" but must be non-nullable to be used for OneOf Input Object "${N}".`,{nodes:[R,l]}))}}}},VariableDefinition(r){n[r.variable.name.value]=r}}}function Cg(e,n,r,o,l){if(fn(o)&&!fn(n)){if(!(r!=null&&r.kind!==Z.NULL)&&!(l!==void 0))return!1;const N=o.ofType;return vr(e,n,N)}return vr(e,n,o)}const Ag=Object.freeze([Hm]),$h=Object.freeze([Nh,Sg,jm,pg,Ih,Ch,xg,cg,Mm,bg,Dh,Oh,tg,Wm,Uh,qm,zm,Ah,Vh,Rm,Bh,wg,Fh,Ng,Ym,jh,...Ag]);class Dg{constructor(n,r){this._ast=n,this._fragments=void 0,this._fragmentSpreads=new Map,this._recursivelyReferencedFragments=new Map,this._onError=r}get[Symbol.toStringTag](){return"ASTValidationContext"}reportError(n){this._onError(n)}getDocument(){return this._ast}getFragment(n){let r;if(this._fragments)r=this._fragments;else{r=Object.create(null);for(const o of this.getDocument().definitions)o.kind===Z.FRAGMENT_DEFINITION&&(r[o.name.value]=o);this._fragments=r}return r[n]}getFragmentSpreads(n){let r=this._fragmentSpreads.get(n);if(!r){r=[];const o=[n];let l;for(;l=o.pop();)for(const h of l.selections)h.kind===Z.FRAGMENT_SPREAD?r.push(h):h.selectionSet&&o.push(h.selectionSet);this._fragmentSpreads.set(n,r)}return r}getRecursivelyReferencedFragments(n){let r=this._recursivelyReferencedFragments.get(n);if(!r){r=[];const o=Object.create(null),l=[n.selectionSet];let h;for(;h=l.pop();)for(const y of this.getFragmentSpreads(h)){const N=y.name.value;if(o[N]!==!0){o[N]=!0;const D=this.getFragment(N);D&&(r.push(D),l.push(D.selectionSet))}}this._recursivelyReferencedFragments.set(n,r)}return r}}class Ig extends Dg{constructor(n,r,o,l){super(r,l),this._schema=n,this._typeInfo=o,this._variableUsages=new Map,this._recursiveVariableUsages=new Map}get[Symbol.toStringTag](){return"ValidationContext"}getSchema(){return this._schema}getVariableUsages(n){let r=this._variableUsages.get(n);if(!r){const o=[],l=new wh(this._schema);Ci(n,kh(l,{VariableDefinition:()=>!1,Variable(h){o.push({node:h,type:l.getInputType(),defaultValue:l.getDefaultValue(),parentType:l.getParentInputType()})}})),r=o,this._variableUsages.set(n,r)}return r}getRecursiveVariableUsages(n){let r=this._recursiveVariableUsages.get(n);if(!r){r=this.getVariableUsages(n);for(const o of this.getRecursivelyReferencedFragments(n))r=r.concat(this.getVariableUsages(o));this._recursiveVariableUsages.set(n,r)}return r}getType(){return this._typeInfo.getType()}getParentType(){return this._typeInfo.getParentType()}getInputType(){return this._typeInfo.getInputType()}getParentInputType(){return this._typeInfo.getParentInputType()}getFieldDef(){return this._typeInfo.getFieldDef()}getDirective(){return this._typeInfo.getDirective()}getArgument(){return this._typeInfo.getArgument()}getEnumValue(){return this._typeInfo.getEnumValue()}}function Hh(e,n,r=$h,o,l=new wh(e)){var h;const y=(h=void 0)!==null&&h!==void 0?h:100;n||hn(!1,"Must provide document."),gm(e);const N=Object.freeze({}),D=[],R=new Ig(e,n,l,z=>{if(D.length>=y)throw D.push(new Ve("Too many validation errors, error limit reached. Validation aborted.")),N;D.push(z)}),W=Xp(r.map(z=>z(R)));try{Ci(n,kh(l,W))}catch(z){if(z!==N)throw z}return D}function Og(e){return{Field(n){const r=e.getFieldDef(),o=r?.deprecationReason;if(r&&o!=null){const l=e.getParentType();l!=null||li(!1),e.reportError(new Ve(`The field ${l.name}.${r.name} is deprecated. ${o}`,{nodes:n}))}},Argument(n){const r=e.getArgument(),o=r?.deprecationReason;if(r&&o!=null){const l=e.getDirective();if(l!=null)e.reportError(new Ve(`Directive "@${l.name}" argument "${r.name}" is deprecated. ${o}`,{nodes:n}));else{const h=e.getParentType(),y=e.getFieldDef();h!=null&&y!=null||li(!1),e.reportError(new Ve(`Field "${h.name}.${y.name}" argument "${r.name}" is deprecated. ${o}`,{nodes:n}))}}},ObjectField(n){const r=_n(e.getParentInputType());if(Fn(r)){const o=r.getFields()[n.name.value],l=o?.deprecationReason;l!=null&&e.reportError(new Ve(`The input field ${r.name}.${o.name} is deprecated. ${l}`,{nodes:n}))}},EnumValue(n){const r=e.getEnumValue(),o=r?.deprecationReason;if(r&&o!=null){const l=_n(e.getInputType());l!=null||li(!1),e.reportError(new Ve(`The enum value "${l.name}.${r.name}" is deprecated. ${o}`,{nodes:n}))}}}}function Zi(e){const n=Object.keys(e),r=n.length,o=new Array(r);for(let l=0;l<r;++l)o[l]=e[n[l]];return o}function wn(e,n){return Mg(n,Wh(e.string))}function Mg(e,n){if(!n||n.trim()===""||n.trim()===":"||n.trim()==="{")return ul(e,o=>!o.isDeprecated);const r=e.map(o=>({proximity:Lg(Wh(o.label),n),entry:o}));return ul(ul(r,o=>o.proximity<=2),o=>!o.entry.isDeprecated).sort((o,l)=>(o.entry.isDeprecated?1:0)-(l.entry.isDeprecated?1:0)||o.proximity-l.proximity||o.entry.label.length-l.entry.label.length).map(o=>o.entry)}function ul(e,n){const r=e.filter(n);return r.length===0?e:r}function Wh(e){return e.toLowerCase().replaceAll(/\W/g,"")}function Lg(e,n){let r=_g(n,e);return e.length>n.length&&(r-=e.length-n.length-1,r+=e.indexOf(n)===0?0:.5),r}function _g(e,n){let r,o;const l=[],h=e.length,y=n.length;for(r=0;r<=h;r++)l[r]=[r];for(o=1;o<=y;o++)l[0][o]=o;for(r=1;r<=h;r++)for(o=1;o<=y;o++){const N=e[r-1]===n[o-1]?0:1;l[r][o]=Math.min(l[r-1][o]+1,l[r][o-1]+1,l[r-1][o-1]+N),r>1&&o>1&&e[r-1]===n[o-2]&&e[r-2]===n[o-1]&&(l[r][o]=Math.min(l[r][o],l[r-2][o-2]+N))}return l[h][y]}const Rg=e=>` {
   $1
}`,so=(e,n,r)=>{if(!n)return r??e;const o=_n(n);return kn(o)||Fn(o)||Un(o)||Ni(o)?e+Rg():r??e},Fc=(e,n,r)=>{if(Un(n)){const o=_n(n.ofType);return e+`[${so("",o,"$1")}]`}return so(e,n,r)},Fg=e=>{const n=e.args.filter(r=>r.type.toString().endsWith("!"));if(n.length)return e.name+`(${n.map((r,o)=>`${r.name}: $${o+1}`)}) ${so("",e.type,`
`)}`};var Pc;(function(e){function n(r){return typeof r=="string"}e.is=n})(Pc||(Pc={}));var El;(function(e){function n(r){return typeof r=="string"}e.is=n})(El||(El={}));var Bc;(function(e){e.MIN_VALUE=-2147483648,e.MAX_VALUE=2147483647;function n(r){return typeof r=="number"&&e.MIN_VALUE<=r&&r<=e.MAX_VALUE}e.is=n})(Bc||(Bc={}));var oo;(function(e){e.MIN_VALUE=0,e.MAX_VALUE=2147483647;function n(r){return typeof r=="number"&&e.MIN_VALUE<=r&&r<=e.MAX_VALUE}e.is=n})(oo||(oo={}));var yi;(function(e){function n(o,l){return o===Number.MAX_VALUE&&(o=oo.MAX_VALUE),l===Number.MAX_VALUE&&(l=oo.MAX_VALUE),{line:o,character:l}}e.create=n;function r(o){let l=o;return ye.objectLiteral(l)&&ye.uinteger(l.line)&&ye.uinteger(l.character)}e.is=r})(yi||(yi={}));var Pn;(function(e){function n(o,l,h,y){if(ye.uinteger(o)&&ye.uinteger(l)&&ye.uinteger(h)&&ye.uinteger(y))return{start:yi.create(o,l),end:yi.create(h,y)};if(yi.is(o)&&yi.is(l))return{start:o,end:l};throw new Error(`Range#create called with invalid arguments[${o}, ${l}, ${h}, ${y}]`)}e.create=n;function r(o){let l=o;return ye.objectLiteral(l)&&yi.is(l.start)&&yi.is(l.end)}e.is=r})(Pn||(Pn={}));var lo;(function(e){function n(o,l){return{uri:o,range:l}}e.create=n;function r(o){let l=o;return ye.objectLiteral(l)&&Pn.is(l.range)&&(ye.string(l.uri)||ye.undefined(l.uri))}e.is=r})(lo||(lo={}));var Vc;(function(e){function n(o,l,h,y){return{targetUri:o,targetRange:l,targetSelectionRange:h,originSelectionRange:y}}e.create=n;function r(o){let l=o;return ye.objectLiteral(l)&&Pn.is(l.targetRange)&&ye.string(l.targetUri)&&Pn.is(l.targetSelectionRange)&&(Pn.is(l.originSelectionRange)||ye.undefined(l.originSelectionRange))}e.is=r})(Vc||(Vc={}));var wl;(function(e){function n(o,l,h,y){return{red:o,green:l,blue:h,alpha:y}}e.create=n;function r(o){const l=o;return ye.objectLiteral(l)&&ye.numberRange(l.red,0,1)&&ye.numberRange(l.green,0,1)&&ye.numberRange(l.blue,0,1)&&ye.numberRange(l.alpha,0,1)}e.is=r})(wl||(wl={}));var jc;(function(e){function n(o,l){return{range:o,color:l}}e.create=n;function r(o){const l=o;return ye.objectLiteral(l)&&Pn.is(l.range)&&wl.is(l.color)}e.is=r})(jc||(jc={}));var Uc;(function(e){function n(o,l,h){return{label:o,textEdit:l,additionalTextEdits:h}}e.create=n;function r(o){const l=o;return ye.objectLiteral(l)&&ye.string(l.label)&&(ye.undefined(l.textEdit)||wr.is(l))&&(ye.undefined(l.additionalTextEdits)||ye.typedArray(l.additionalTextEdits,wr.is))}e.is=r})(Uc||(Uc={}));var $c;(function(e){e.Comment="comment",e.Imports="imports",e.Region="region"})($c||($c={}));var Hc;(function(e){function n(o,l,h,y,N,D){const R={startLine:o,endLine:l};return ye.defined(h)&&(R.startCharacter=h),ye.defined(y)&&(R.endCharacter=y),ye.defined(N)&&(R.kind=N),ye.defined(D)&&(R.collapsedText=D),R}e.create=n;function r(o){const l=o;return ye.objectLiteral(l)&&ye.uinteger(l.startLine)&&ye.uinteger(l.startLine)&&(ye.undefined(l.startCharacter)||ye.uinteger(l.startCharacter))&&(ye.undefined(l.endCharacter)||ye.uinteger(l.endCharacter))&&(ye.undefined(l.kind)||ye.string(l.kind))}e.is=r})(Hc||(Hc={}));var kl;(function(e){function n(o,l){return{location:o,message:l}}e.create=n;function r(o){let l=o;return ye.defined(l)&&lo.is(l.location)&&ye.string(l.message)}e.is=r})(kl||(kl={}));var Wc;(function(e){e.Error=1,e.Warning=2,e.Information=3,e.Hint=4})(Wc||(Wc={}));var qc;(function(e){e.Unnecessary=1,e.Deprecated=2})(qc||(qc={}));var zc;(function(e){function n(r){const o=r;return ye.objectLiteral(o)&&ye.string(o.href)}e.is=n})(zc||(zc={}));var ao;(function(e){function n(o,l,h,y,N,D){let R={range:o,message:l};return ye.defined(h)&&(R.severity=h),ye.defined(y)&&(R.code=y),ye.defined(N)&&(R.source=N),ye.defined(D)&&(R.relatedInformation=D),R}e.create=n;function r(o){var l;let h=o;return ye.defined(h)&&Pn.is(h.range)&&ye.string(h.message)&&(ye.number(h.severity)||ye.undefined(h.severity))&&(ye.integer(h.code)||ye.string(h.code)||ye.undefined(h.code))&&(ye.undefined(h.codeDescription)||ye.string((l=h.codeDescription)===null||l===void 0?void 0:l.href))&&(ye.string(h.source)||ye.undefined(h.source))&&(ye.undefined(h.relatedInformation)||ye.typedArray(h.relatedInformation,kl.is))}e.is=r})(ao||(ao={}));var Er;(function(e){function n(o,l,...h){let y={title:o,command:l};return ye.defined(h)&&h.length>0&&(y.arguments=h),y}e.create=n;function r(o){let l=o;return ye.defined(l)&&ye.string(l.title)&&ye.string(l.command)}e.is=r})(Er||(Er={}));var wr;(function(e){function n(h,y){return{range:h,newText:y}}e.replace=n;function r(h,y){return{range:{start:h,end:h},newText:y}}e.insert=r;function o(h){return{range:h,newText:""}}e.del=o;function l(h){const y=h;return ye.objectLiteral(y)&&ye.string(y.newText)&&Pn.is(y.range)}e.is=l})(wr||(wr={}));var xl;(function(e){function n(o,l,h){const y={label:o};return l!==void 0&&(y.needsConfirmation=l),h!==void 0&&(y.description=h),y}e.create=n;function r(o){const l=o;return ye.objectLiteral(l)&&ye.string(l.label)&&(ye.boolean(l.needsConfirmation)||l.needsConfirmation===void 0)&&(ye.string(l.description)||l.description===void 0)}e.is=r})(xl||(xl={}));var kr;(function(e){function n(r){const o=r;return ye.string(o)}e.is=n})(kr||(kr={}));var Gc;(function(e){function n(h,y,N){return{range:h,newText:y,annotationId:N}}e.replace=n;function r(h,y,N){return{range:{start:h,end:h},newText:y,annotationId:N}}e.insert=r;function o(h,y){return{range:h,newText:"",annotationId:y}}e.del=o;function l(h){const y=h;return wr.is(y)&&(xl.is(y.annotationId)||kr.is(y.annotationId))}e.is=l})(Gc||(Gc={}));var Nl;(function(e){function n(o,l){return{textDocument:o,edits:l}}e.create=n;function r(o){let l=o;return ye.defined(l)&&Ol.is(l.textDocument)&&Array.isArray(l.edits)}e.is=r})(Nl||(Nl={}));var Cl;(function(e){function n(o,l,h){let y={kind:"create",uri:o};return l!==void 0&&(l.overwrite!==void 0||l.ignoreIfExists!==void 0)&&(y.options=l),h!==void 0&&(y.annotationId=h),y}e.create=n;function r(o){let l=o;return l&&l.kind==="create"&&ye.string(l.uri)&&(l.options===void 0||(l.options.overwrite===void 0||ye.boolean(l.options.overwrite))&&(l.options.ignoreIfExists===void 0||ye.boolean(l.options.ignoreIfExists)))&&(l.annotationId===void 0||kr.is(l.annotationId))}e.is=r})(Cl||(Cl={}));var Al;(function(e){function n(o,l,h,y){let N={kind:"rename",oldUri:o,newUri:l};return h!==void 0&&(h.overwrite!==void 0||h.ignoreIfExists!==void 0)&&(N.options=h),y!==void 0&&(N.annotationId=y),N}e.create=n;function r(o){let l=o;return l&&l.kind==="rename"&&ye.string(l.oldUri)&&ye.string(l.newUri)&&(l.options===void 0||(l.options.overwrite===void 0||ye.boolean(l.options.overwrite))&&(l.options.ignoreIfExists===void 0||ye.boolean(l.options.ignoreIfExists)))&&(l.annotationId===void 0||kr.is(l.annotationId))}e.is=r})(Al||(Al={}));var Dl;(function(e){function n(o,l,h){let y={kind:"delete",uri:o};return l!==void 0&&(l.recursive!==void 0||l.ignoreIfNotExists!==void 0)&&(y.options=l),h!==void 0&&(y.annotationId=h),y}e.create=n;function r(o){let l=o;return l&&l.kind==="delete"&&ye.string(l.uri)&&(l.options===void 0||(l.options.recursive===void 0||ye.boolean(l.options.recursive))&&(l.options.ignoreIfNotExists===void 0||ye.boolean(l.options.ignoreIfNotExists)))&&(l.annotationId===void 0||kr.is(l.annotationId))}e.is=r})(Dl||(Dl={}));var Il;(function(e){function n(r){let o=r;return o&&(o.changes!==void 0||o.documentChanges!==void 0)&&(o.documentChanges===void 0||o.documentChanges.every(l=>ye.string(l.kind)?Cl.is(l)||Al.is(l)||Dl.is(l):Nl.is(l)))}e.is=n})(Il||(Il={}));var Yc;(function(e){function n(o){return{uri:o}}e.create=n;function r(o){let l=o;return ye.defined(l)&&ye.string(l.uri)}e.is=r})(Yc||(Yc={}));var Jc;(function(e){function n(o,l){return{uri:o,version:l}}e.create=n;function r(o){let l=o;return ye.defined(l)&&ye.string(l.uri)&&ye.integer(l.version)}e.is=r})(Jc||(Jc={}));var Ol;(function(e){function n(o,l){return{uri:o,version:l}}e.create=n;function r(o){let l=o;return ye.defined(l)&&ye.string(l.uri)&&(l.version===null||ye.integer(l.version))}e.is=r})(Ol||(Ol={}));var Xc;(function(e){function n(o,l,h,y){return{uri:o,languageId:l,version:h,text:y}}e.create=n;function r(o){let l=o;return ye.defined(l)&&ye.string(l.uri)&&ye.string(l.languageId)&&ye.integer(l.version)&&ye.string(l.text)}e.is=r})(Xc||(Xc={}));var Ml;(function(e){e.PlainText="plaintext",e.Markdown="markdown";function n(r){const o=r;return o===e.PlainText||o===e.Markdown}e.is=n})(Ml||(Ml={}));var as;(function(e){function n(r){const o=r;return ye.objectLiteral(r)&&Ml.is(o.kind)&&ye.string(o.value)}e.is=n})(as||(as={}));var Qc;(function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25})(Qc||(Qc={}));var br;(function(e){e.PlainText=1,e.Snippet=2})(br||(br={}));var Kc;(function(e){e.Deprecated=1})(Kc||(Kc={}));var Zc;(function(e){function n(o,l,h){return{newText:o,insert:l,replace:h}}e.create=n;function r(o){const l=o;return l&&ye.string(l.newText)&&Pn.is(l.insert)&&Pn.is(l.replace)}e.is=r})(Zc||(Zc={}));var Ji;(function(e){e.asIs=1,e.adjustIndentation=2})(Ji||(Ji={}));var eu;(function(e){function n(r){const o=r;return o&&(ye.string(o.detail)||o.detail===void 0)&&(ye.string(o.description)||o.description===void 0)}e.is=n})(eu||(eu={}));var tu;(function(e){function n(r){return{label:r}}e.create=n})(tu||(tu={}));var nu;(function(e){function n(r,o){return{items:r||[],isIncomplete:!!o}}e.create=n})(nu||(nu={}));var co;(function(e){function n(o){return o.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}e.fromPlainText=n;function r(o){const l=o;return ye.string(l)||ye.objectLiteral(l)&&ye.string(l.language)&&ye.string(l.value)}e.is=r})(co||(co={}));var iu;(function(e){function n(r){let o=r;return!!o&&ye.objectLiteral(o)&&(as.is(o.contents)||co.is(o.contents)||ye.typedArray(o.contents,co.is))&&(r.range===void 0||Pn.is(r.range))}e.is=n})(iu||(iu={}));var ru;(function(e){function n(r,o){return o?{label:r,documentation:o}:{label:r}}e.create=n})(ru||(ru={}));var su;(function(e){function n(r,o,...l){let h={label:r};return ye.defined(o)&&(h.documentation=o),ye.defined(l)?h.parameters=l:h.parameters=[],h}e.create=n})(su||(su={}));var ou;(function(e){e.Text=1,e.Read=2,e.Write=3})(ou||(ou={}));var lu;(function(e){function n(r,o){let l={range:r};return ye.number(o)&&(l.kind=o),l}e.create=n})(lu||(lu={}));var au;(function(e){e.File=1,e.Module=2,e.Namespace=3,e.Package=4,e.Class=5,e.Method=6,e.Property=7,e.Field=8,e.Constructor=9,e.Enum=10,e.Interface=11,e.Function=12,e.Variable=13,e.Constant=14,e.String=15,e.Number=16,e.Boolean=17,e.Array=18,e.Object=19,e.Key=20,e.Null=21,e.EnumMember=22,e.Struct=23,e.Event=24,e.Operator=25,e.TypeParameter=26})(au||(au={}));var cu;(function(e){e.Deprecated=1})(cu||(cu={}));var uu;(function(e){function n(r,o,l,h,y){let N={name:r,kind:o,location:{uri:h,range:l}};return y&&(N.containerName=y),N}e.create=n})(uu||(uu={}));var hu;(function(e){function n(r,o,l,h){return h!==void 0?{name:r,kind:o,location:{uri:l,range:h}}:{name:r,kind:o,location:{uri:l}}}e.create=n})(hu||(hu={}));var fu;(function(e){function n(o,l,h,y,N,D){let R={name:o,detail:l,kind:h,range:y,selectionRange:N};return D!==void 0&&(R.children=D),R}e.create=n;function r(o){let l=o;return l&&ye.string(l.name)&&ye.number(l.kind)&&Pn.is(l.range)&&Pn.is(l.selectionRange)&&(l.detail===void 0||ye.string(l.detail))&&(l.deprecated===void 0||ye.boolean(l.deprecated))&&(l.children===void 0||Array.isArray(l.children))&&(l.tags===void 0||Array.isArray(l.tags))}e.is=r})(fu||(fu={}));var du;(function(e){e.Empty="",e.QuickFix="quickfix",e.Refactor="refactor",e.RefactorExtract="refactor.extract",e.RefactorInline="refactor.inline",e.RefactorRewrite="refactor.rewrite",e.Source="source",e.SourceOrganizeImports="source.organizeImports",e.SourceFixAll="source.fixAll"})(du||(du={}));var uo;(function(e){e.Invoked=1,e.Automatic=2})(uo||(uo={}));var pu;(function(e){function n(o,l,h){let y={diagnostics:o};return l!=null&&(y.only=l),h!=null&&(y.triggerKind=h),y}e.create=n;function r(o){let l=o;return ye.defined(l)&&ye.typedArray(l.diagnostics,ao.is)&&(l.only===void 0||ye.typedArray(l.only,ye.string))&&(l.triggerKind===void 0||l.triggerKind===uo.Invoked||l.triggerKind===uo.Automatic)}e.is=r})(pu||(pu={}));var mu;(function(e){function n(o,l,h){let y={title:o},N=!0;return typeof l=="string"?(N=!1,y.kind=l):Er.is(l)?y.command=l:y.edit=l,N&&h!==void 0&&(y.kind=h),y}e.create=n;function r(o){let l=o;return l&&ye.string(l.title)&&(l.diagnostics===void 0||ye.typedArray(l.diagnostics,ao.is))&&(l.kind===void 0||ye.string(l.kind))&&(l.edit!==void 0||l.command!==void 0)&&(l.command===void 0||Er.is(l.command))&&(l.isPreferred===void 0||ye.boolean(l.isPreferred))&&(l.edit===void 0||Il.is(l.edit))}e.is=r})(mu||(mu={}));var gu;(function(e){function n(o,l){let h={range:o};return ye.defined(l)&&(h.data=l),h}e.create=n;function r(o){let l=o;return ye.defined(l)&&Pn.is(l.range)&&(ye.undefined(l.command)||Er.is(l.command))}e.is=r})(gu||(gu={}));var yu;(function(e){function n(o,l){return{tabSize:o,insertSpaces:l}}e.create=n;function r(o){let l=o;return ye.defined(l)&&ye.uinteger(l.tabSize)&&ye.boolean(l.insertSpaces)}e.is=r})(yu||(yu={}));var vu;(function(e){function n(o,l,h){return{range:o,target:l,data:h}}e.create=n;function r(o){let l=o;return ye.defined(l)&&Pn.is(l.range)&&(ye.undefined(l.target)||ye.string(l.target))}e.is=r})(vu||(vu={}));var bu;(function(e){function n(o,l){return{range:o,parent:l}}e.create=n;function r(o){let l=o;return ye.objectLiteral(l)&&Pn.is(l.range)&&(l.parent===void 0||e.is(l.parent))}e.is=r})(bu||(bu={}));var Su;(function(e){e.namespace="namespace",e.type="type",e.class="class",e.enum="enum",e.interface="interface",e.struct="struct",e.typeParameter="typeParameter",e.parameter="parameter",e.variable="variable",e.property="property",e.enumMember="enumMember",e.event="event",e.function="function",e.method="method",e.macro="macro",e.keyword="keyword",e.modifier="modifier",e.comment="comment",e.string="string",e.number="number",e.regexp="regexp",e.operator="operator",e.decorator="decorator"})(Su||(Su={}));var Tu;(function(e){e.declaration="declaration",e.definition="definition",e.readonly="readonly",e.static="static",e.deprecated="deprecated",e.abstract="abstract",e.async="async",e.modification="modification",e.documentation="documentation",e.defaultLibrary="defaultLibrary"})(Tu||(Tu={}));var Eu;(function(e){function n(r){const o=r;return ye.objectLiteral(o)&&(o.resultId===void 0||typeof o.resultId=="string")&&Array.isArray(o.data)&&(o.data.length===0||typeof o.data[0]=="number")}e.is=n})(Eu||(Eu={}));var wu;(function(e){function n(o,l){return{range:o,text:l}}e.create=n;function r(o){const l=o;return l!=null&&Pn.is(l.range)&&ye.string(l.text)}e.is=r})(wu||(wu={}));var ku;(function(e){function n(o,l,h){return{range:o,variableName:l,caseSensitiveLookup:h}}e.create=n;function r(o){const l=o;return l!=null&&Pn.is(l.range)&&ye.boolean(l.caseSensitiveLookup)&&(ye.string(l.variableName)||l.variableName===void 0)}e.is=r})(ku||(ku={}));var xu;(function(e){function n(o,l){return{range:o,expression:l}}e.create=n;function r(o){const l=o;return l!=null&&Pn.is(l.range)&&(ye.string(l.expression)||l.expression===void 0)}e.is=r})(xu||(xu={}));var Nu;(function(e){function n(o,l){return{frameId:o,stoppedLocation:l}}e.create=n;function r(o){const l=o;return ye.defined(l)&&Pn.is(o.stoppedLocation)}e.is=r})(Nu||(Nu={}));var Ll;(function(e){e.Type=1,e.Parameter=2;function n(r){return r===1||r===2}e.is=n})(Ll||(Ll={}));var _l;(function(e){function n(o){return{value:o}}e.create=n;function r(o){const l=o;return ye.objectLiteral(l)&&(l.tooltip===void 0||ye.string(l.tooltip)||as.is(l.tooltip))&&(l.location===void 0||lo.is(l.location))&&(l.command===void 0||Er.is(l.command))}e.is=r})(_l||(_l={}));var Cu;(function(e){function n(o,l,h){const y={position:o,label:l};return h!==void 0&&(y.kind=h),y}e.create=n;function r(o){const l=o;return ye.objectLiteral(l)&&yi.is(l.position)&&(ye.string(l.label)||ye.typedArray(l.label,_l.is))&&(l.kind===void 0||Ll.is(l.kind))&&l.textEdits===void 0||ye.typedArray(l.textEdits,wr.is)&&(l.tooltip===void 0||ye.string(l.tooltip)||as.is(l.tooltip))&&(l.paddingLeft===void 0||ye.boolean(l.paddingLeft))&&(l.paddingRight===void 0||ye.boolean(l.paddingRight))}e.is=r})(Cu||(Cu={}));var Au;(function(e){function n(r){return{kind:"snippet",value:r}}e.createSnippet=n})(Au||(Au={}));var Du;(function(e){function n(r,o,l,h){return{insertText:r,filterText:o,range:l,command:h}}e.create=n})(Du||(Du={}));var Iu;(function(e){function n(r){return{items:r}}e.create=n})(Iu||(Iu={}));var Ou;(function(e){e.Invoked=0,e.Automatic=1})(Ou||(Ou={}));var Mu;(function(e){function n(r,o){return{range:r,text:o}}e.create=n})(Mu||(Mu={}));var Lu;(function(e){function n(r,o){return{triggerKind:r,selectedCompletionInfo:o}}e.create=n})(Lu||(Lu={}));var _u;(function(e){function n(r){const o=r;return ye.objectLiteral(o)&&El.is(o.uri)&&ye.string(o.name)}e.is=n})(_u||(_u={}));var Ru;(function(e){function n(h,y,N,D){return new Pg(h,y,N,D)}e.create=n;function r(h){let y=h;return!!(ye.defined(y)&&ye.string(y.uri)&&(ye.undefined(y.languageId)||ye.string(y.languageId))&&ye.uinteger(y.lineCount)&&ye.func(y.getText)&&ye.func(y.positionAt)&&ye.func(y.offsetAt))}e.is=r;function o(h,y){let N=h.getText(),D=l(y,(W,z)=>{let ne=W.range.start.line-z.range.start.line;return ne===0?W.range.start.character-z.range.start.character:ne}),R=N.length;for(let W=D.length-1;W>=0;W--){let z=D[W],ne=h.offsetAt(z.range.start),te=h.offsetAt(z.range.end);if(te<=R)N=N.substring(0,ne)+z.newText+N.substring(te,N.length);else throw new Error("Overlapping edit");R=ne}return N}e.applyEdits=o;function l(h,y){if(h.length<=1)return h;const N=h.length/2|0,D=h.slice(0,N),R=h.slice(N);l(D,y),l(R,y);let W=0,z=0,ne=0;for(;W<D.length&&z<R.length;)y(D[W],R[z])<=0?h[ne++]=D[W++]:h[ne++]=R[z++];for(;W<D.length;)h[ne++]=D[W++];for(;z<R.length;)h[ne++]=R[z++];return h}})(Ru||(Ru={}));class Pg{constructor(n,r,o,l){this._uri=n,this._languageId=r,this._version=o,this._content=l,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(n){if(n){let r=this.offsetAt(n.start),o=this.offsetAt(n.end);return this._content.substring(r,o)}return this._content}update(n,r){this._content=n.text,this._version=r,this._lineOffsets=void 0}getLineOffsets(){if(this._lineOffsets===void 0){let n=[],r=this._content,o=!0;for(let l=0;l<r.length;l++){o&&(n.push(l),o=!1);let h=r.charAt(l);o=h==="\r"||h===`
`,h==="\r"&&l+1<r.length&&r.charAt(l+1)===`
`&&l++}o&&r.length>0&&n.push(r.length),this._lineOffsets=n}return this._lineOffsets}positionAt(n){n=Math.max(Math.min(n,this._content.length),0);let r=this.getLineOffsets(),o=0,l=r.length;if(l===0)return yi.create(0,n);for(;o<l;){let y=Math.floor((o+l)/2);r[y]>n?l=y:o=y+1}let h=o-1;return yi.create(h,n-r[h])}offsetAt(n){let r=this.getLineOffsets();if(n.line>=r.length)return this._content.length;if(n.line<0)return 0;let o=r[n.line],l=n.line+1<r.length?r[n.line+1]:this._content.length;return Math.max(Math.min(o+n.character,l),o)}get lineCount(){return this.getLineOffsets().length}}var ye;(function(e){const n=Object.prototype.toString;function r(te){return typeof te<"u"}e.defined=r;function o(te){return typeof te>"u"}e.undefined=o;function l(te){return te===!0||te===!1}e.boolean=l;function h(te){return n.call(te)==="[object String]"}e.string=h;function y(te){return n.call(te)==="[object Number]"}e.number=y;function N(te,be,Ne){return n.call(te)==="[object Number]"&&be<=te&&te<=Ne}e.numberRange=N;function D(te){return n.call(te)==="[object Number]"&&-2147483648<=te&&te<=2147483647}e.integer=D;function R(te){return n.call(te)==="[object Number]"&&0<=te&&te<=2147483647}e.uinteger=R;function W(te){return n.call(te)==="[object Function]"}e.func=W;function z(te){return te!==null&&typeof te=="object"}e.objectLiteral=z;function ne(te,be){return Array.isArray(te)&&te.every(be)}e.typedArray=ne})(ye||(ye={}));class ho{constructor(n){this._start=0,this._pos=0,this.getStartOfToken=()=>this._start,this.getCurrentPosition=()=>this._pos,this.eol=()=>this._sourceText.length===this._pos,this.sol=()=>this._pos===0,this.peek=()=>this._sourceText.charAt(this._pos)||null,this.next=()=>{const r=this._sourceText.charAt(this._pos);return this._pos++,r},this.eat=r=>{if(this._testNextCharacter(r))return this._start=this._pos,this._pos++,this._sourceText.charAt(this._pos-1)},this.eatWhile=r=>{let o=this._testNextCharacter(r),l=!1;for(o&&(l=o,this._start=this._pos);o;)this._pos++,o=this._testNextCharacter(r),l=!0;return l},this.eatSpace=()=>this.eatWhile(/[\s\u00a0]/),this.skipToEnd=()=>{this._pos=this._sourceText.length},this.skipTo=r=>{this._pos=r},this.match=(r,o=!0,l=!1)=>{let h=null,y=null;return typeof r=="string"?(y=new RegExp(r,l?"i":"g").test(this._sourceText.slice(this._pos,this._pos+r.length)),h=r):r instanceof RegExp&&(y=this._sourceText.slice(this._pos).match(r),h=y?.[0]),y!=null&&(typeof r=="string"||y instanceof Array&&this._sourceText.startsWith(y[0],this._pos))?(o&&(this._start=this._pos,h&&h.length&&(this._pos+=h.length)),y):!1},this.backUp=r=>{this._pos-=r},this.column=()=>this._pos,this.indentation=()=>{const r=this._sourceText.match(/\s*/);let o=0;if(r&&r.length!==0){const l=r[0];let h=0;for(;l.length>h;)l.charCodeAt(h)===9?o+=2:o++,h++}return o},this.current=()=>this._sourceText.slice(this._start,this._pos),this._sourceText=n}_testNextCharacter(n){const r=this._sourceText.charAt(this._pos);let o=!1;return typeof n=="string"?o=r===n:o=n instanceof RegExp?n.test(r):n(r),o}}function In(e){return{ofRule:e}}function nn(e,n){return{ofRule:e,isList:!0,separator:n}}function Bg(e,n){const r=e.match;return e.match=o=>{let l=!1;return r&&(l=r(o)),l&&n.every(h=>h.match&&!h.match(o))},e}function eo(e,n){return{style:n,match:r=>r.kind===e}}function _t(e,n){return{style:n||"punctuation",match:r=>r.kind==="Punctuation"&&r.value===e}}const qh=e=>e===" "||e==="	"||e===","||e===`
`||e==="\r"||e==="\uFEFF"||e==="Â ",zh={Name:/^[_A-Za-z][_0-9A-Za-z]*/,Punctuation:/^(?:!|\$|\(|\)|\.\.\.|:|=|&|@|\[|]|\{|\||\})/,Number:/^-?(?:0|(?:[1-9][0-9]*))(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?/,String:/^(?:"""(?:\\"""|[^"]|"[^"]|""[^"])*(?:""")?|"(?:[^"\\]|\\(?:"|\/|\\|b|f|n|r|t|u[0-9a-fA-F]{4}))*"?)/,Comment:/^#.*/},Gh={Document:[nn("Definition")],Definition(e){switch(e.value){case"{":return"ShortQuery";case"query":return"Query";case"mutation":return"Mutation";case"subscription":return"Subscription";case"fragment":return Z.FRAGMENT_DEFINITION;case"schema":return"SchemaDef";case"scalar":return"ScalarDef";case"type":return"ObjectTypeDef";case"interface":return"InterfaceDef";case"union":return"UnionDef";case"enum":return"EnumDef";case"input":return"InputDef";case"extend":return"ExtendDef";case"directive":return"DirectiveDef"}},ShortQuery:["SelectionSet"],Query:[Yn("query"),In(Tn("def")),In("VariableDefinitions"),nn("Directive"),"SelectionSet"],Mutation:[Yn("mutation"),In(Tn("def")),In("VariableDefinitions"),nn("Directive"),"SelectionSet"],Subscription:[Yn("subscription"),In(Tn("def")),In("VariableDefinitions"),nn("Directive"),"SelectionSet"],VariableDefinitions:[_t("("),nn("VariableDefinition"),_t(")")],VariableDefinition:["Variable",_t(":"),"Type",In("DefaultValue")],Variable:[_t("$","variable"),Tn("variable")],DefaultValue:[_t("="),"Value"],SelectionSet:[_t("{"),nn("Selection"),_t("}")],Selection(e,n){return e.value==="..."?n.match(/[\s\u00a0,]*(on\b|@|{)/,!1)?"InlineFragment":"FragmentSpread":n.match(/[\s\u00a0,]*:/,!1)?"AliasedField":"Field"},AliasedField:[Tn("property"),_t(":"),Tn("qualifier"),In("Arguments"),nn("Directive"),In("SelectionSet")],Field:[Tn("property"),In("Arguments"),nn("Directive"),In("SelectionSet")],Arguments:[_t("("),nn("Argument"),_t(")")],Argument:[Tn("attribute"),_t(":"),"Value"],FragmentSpread:[_t("..."),Tn("def"),nn("Directive")],InlineFragment:[_t("..."),In("TypeCondition"),nn("Directive"),"SelectionSet"],FragmentDefinition:[Yn("fragment"),In(Bg(Tn("def"),[Yn("on")])),"TypeCondition",nn("Directive"),"SelectionSet"],TypeCondition:[Yn("on"),"NamedType"],Value(e){switch(e.kind){case"Number":return"NumberValue";case"String":return"StringValue";case"Punctuation":switch(e.value){case"[":return"ListValue";case"{":return"ObjectValue";case"$":return"Variable";case"&":return"NamedType"}return null;case"Name":switch(e.value){case"true":case"false":return"BooleanValue"}return e.value==="null"?"NullValue":"EnumValue"}},NumberValue:[eo("Number","number")],StringValue:[{style:"string",match:e=>e.kind==="String",update(e,n){n.value.startsWith('"""')&&(e.inBlockstring=!n.value.slice(3).endsWith('"""'))}}],BooleanValue:[eo("Name","builtin")],NullValue:[eo("Name","keyword")],EnumValue:[Tn("string-2")],ListValue:[_t("["),nn("Value"),_t("]")],ObjectValue:[_t("{"),nn("ObjectField"),_t("}")],ObjectField:[Tn("attribute"),_t(":"),"Value"],Type(e){return e.value==="["?"ListType":"NonNullType"},ListType:[_t("["),"Type",_t("]"),In(_t("!"))],NonNullType:["NamedType",In(_t("!"))],NamedType:[Vg("atom")],Directive:[_t("@","meta"),Tn("meta"),In("Arguments")],DirectiveDef:[Yn("directive"),_t("@","meta"),Tn("meta"),In("ArgumentsDef"),Yn("on"),nn("DirectiveLocation",_t("|"))],InterfaceDef:[Yn("interface"),Tn("atom"),In("Implements"),nn("Directive"),_t("{"),nn("FieldDef"),_t("}")],Implements:[Yn("implements"),nn("NamedType",_t("&"))],DirectiveLocation:[Tn("string-2")],SchemaDef:[Yn("schema"),nn("Directive"),_t("{"),nn("OperationTypeDef"),_t("}")],OperationTypeDef:[Tn("keyword"),_t(":"),Tn("atom")],ScalarDef:[Yn("scalar"),Tn("atom"),nn("Directive")],ObjectTypeDef:[Yn("type"),Tn("atom"),In("Implements"),nn("Directive"),_t("{"),nn("FieldDef"),_t("}")],FieldDef:[Tn("property"),In("ArgumentsDef"),_t(":"),"Type",nn("Directive")],ArgumentsDef:[_t("("),nn("InputValueDef"),_t(")")],InputValueDef:[Tn("attribute"),_t(":"),"Type",In("DefaultValue"),nn("Directive")],UnionDef:[Yn("union"),Tn("atom"),nn("Directive"),_t("="),nn("UnionMember",_t("|"))],UnionMember:["NamedType"],EnumDef:[Yn("enum"),Tn("atom"),nn("Directive"),_t("{"),nn("EnumValueDef"),_t("}")],EnumValueDef:[Tn("string-2"),nn("Directive")],InputDef:[Yn("input"),Tn("atom"),nn("Directive"),_t("{"),nn("InputValueDef"),_t("}")],ExtendDef:[Yn("extend"),"ExtensionDefinition"],ExtensionDefinition(e){switch(e.value){case"schema":return Z.SCHEMA_EXTENSION;case"scalar":return Z.SCALAR_TYPE_EXTENSION;case"type":return Z.OBJECT_TYPE_EXTENSION;case"interface":return Z.INTERFACE_TYPE_EXTENSION;case"union":return Z.UNION_TYPE_EXTENSION;case"enum":return Z.ENUM_TYPE_EXTENSION;case"input":return Z.INPUT_OBJECT_TYPE_EXTENSION}},[Z.SCHEMA_EXTENSION]:["SchemaDef"],[Z.SCALAR_TYPE_EXTENSION]:["ScalarDef"],[Z.OBJECT_TYPE_EXTENSION]:["ObjectTypeDef"],[Z.INTERFACE_TYPE_EXTENSION]:["InterfaceDef"],[Z.UNION_TYPE_EXTENSION]:["UnionDef"],[Z.ENUM_TYPE_EXTENSION]:["EnumDef"],[Z.INPUT_OBJECT_TYPE_EXTENSION]:["InputDef"]};function Yn(e){return{style:"keyword",match:n=>n.kind==="Name"&&n.value===e}}function Tn(e){return{style:e,match:n=>n.kind==="Name",update(n,r){n.name=r.value}}}function Vg(e){return{style:e,match:n=>n.kind==="Name",update(n,r){var o;!((o=n.prevState)===null||o===void 0)&&o.prevState&&(n.name=r.value,n.prevState.prevState.type=r.value)}}}function Kl(e={eatWhitespace:n=>n.eatWhile(qh),lexRules:zh,parseRules:Gh,editorConfig:{}}){return{startState(){const n={level:0,step:0,name:null,kind:null,type:null,rule:null,needsSeparator:!1,prevState:null};return es(e.parseRules,n,Z.DOCUMENT),n},token(n,r){return jg(n,r,e)}}}function jg(e,n,r){var o;if(n.inBlockstring)return e.match(/.*"""/)?(n.inBlockstring=!1,"string"):(e.skipToEnd(),"string");const{lexRules:l,parseRules:h,eatWhitespace:y,editorConfig:N}=r;if(n.rule&&n.rule.length===0?Zl(n):n.needsAdvance&&(n.needsAdvance=!1,Rl(n,!0)),e.sol()){const W=N?.tabSize||2;n.indentLevel=Math.floor(e.indentation()/W)}if(y(e))return"ws";const D=$g(l,e);if(!D)return e.match(/\S+/)||e.match(/\s/),es(hl,n,"Invalid"),"invalidchar";if(D.kind==="Comment")return es(hl,n,"Comment"),"comment";const R=Fu({},n);if(D.kind==="Punctuation"){if(/^[{([]/.test(D.value))n.indentLevel!==void 0&&(n.levels=(n.levels||[]).concat(n.indentLevel+1));else if(/^[})\]]/.test(D.value)){const W=n.levels=(n.levels||[]).slice(0,-1);n.indentLevel&&W.length>0&&W.at(-1)<n.indentLevel&&(n.indentLevel=W.at(-1))}}for(;n.rule;){let W=typeof n.rule=="function"?n.step===0?n.rule(D,e):null:n.rule[n.step];if(n.needsSeparator&&(W=W?.separator),W){if(W.ofRule&&(W=W.ofRule),typeof W=="string"){es(h,n,W);continue}if(!((o=W.match)===null||o===void 0)&&o.call(W,D))return W.update&&W.update(n,D),D.kind==="Punctuation"?Rl(n,!0):n.needsAdvance=!0,W.style}Ug(n)}return Fu(n,R),es(hl,n,"Invalid"),"invalidchar"}function Fu(e,n){const r=Object.keys(n);for(let o=0;o<r.length;o++)e[r[o]]=n[r[o]];return e}const hl={Invalid:[],Comment:[]};function es(e,n,r){if(!e[r])throw new TypeError("Unknown rule: "+r);n.prevState=Object.assign({},n),n.kind=r,n.name=null,n.type=null,n.rule=e[r],n.step=0,n.needsSeparator=!1}function Zl(e){e.prevState&&(e.kind=e.prevState.kind,e.name=e.prevState.name,e.type=e.prevState.type,e.rule=e.prevState.rule,e.step=e.prevState.step,e.needsSeparator=e.prevState.needsSeparator,e.prevState=e.prevState.prevState)}function Rl(e,n){var r;if(Pu(e)&&e.rule){const o=e.rule[e.step];if(o.separator){const{separator:l}=o;if(e.needsSeparator=!e.needsSeparator,!e.needsSeparator&&l.ofRule)return}if(n)return}for(e.needsSeparator=!1,e.step++;e.rule&&!(Array.isArray(e.rule)&&e.step<e.rule.length);)Zl(e),e.rule&&(Pu(e)?!((r=e.rule)===null||r===void 0)&&r[e.step].separator&&(e.needsSeparator=!e.needsSeparator):(e.needsSeparator=!1,e.step++))}function Pu(e){const n=Array.isArray(e.rule)&&typeof e.rule[e.step]!="string"&&e.rule[e.step];return n&&n.isList}function Ug(e){for(;e.rule&&!(Array.isArray(e.rule)&&e.rule[e.step].ofRule);)Zl(e);e.rule&&Rl(e,!1)}function $g(e,n){const r=Object.keys(e);for(let o=0;o<r.length;o++){const l=n.match(e[r[o]]);if(l&&l instanceof Array)return{kind:r[o],value:l[0]}}}function To(e,n){const r=e.split(`
`),o=Kl();let l=o.startState(),h="",y=new ho("");for(let N=0;N<r.length;N++){for(y=new ho(r[N]);!y.eol()&&(h=o.token(y,l),n(y,l,h,N)!=="BREAK"););n(y,l,h,N),l.kind||(l=o.startState())}return{start:y.getStartOfToken(),end:y.getCurrentPosition(),string:y.current(),state:l,style:h}}var Mi;(function(e){e.TYPE_SYSTEM="TYPE_SYSTEM",e.EXECUTABLE="EXECUTABLE",e.UNKNOWN="UNKNOWN"})(Mi||(Mi={}));const Hg=[Z.SCHEMA_DEFINITION,Z.OPERATION_TYPE_DEFINITION,Z.SCALAR_TYPE_DEFINITION,Z.OBJECT_TYPE_DEFINITION,Z.INTERFACE_TYPE_DEFINITION,Z.UNION_TYPE_DEFINITION,Z.ENUM_TYPE_DEFINITION,Z.INPUT_OBJECT_TYPE_DEFINITION,Z.DIRECTIVE_DEFINITION,Z.SCHEMA_EXTENSION,Z.SCALAR_TYPE_EXTENSION,Z.OBJECT_TYPE_EXTENSION,Z.INTERFACE_TYPE_EXTENSION,Z.UNION_TYPE_EXTENSION,Z.ENUM_TYPE_EXTENSION,Z.INPUT_OBJECT_TYPE_EXTENSION],Wg=e=>{let n=Mi.UNKNOWN;if(e)try{Ci(Ar(e),{enter(r){if(r.kind==="Document"){n=Mi.EXECUTABLE;return}return Hg.includes(r.kind)?(n=Mi.TYPE_SYSTEM,mr):!1}})}catch{return n}return n};function qg(e,n){return n?.endsWith(".graphqls")?Mi.TYPE_SYSTEM:Wg(e)}function Yh(e,n,r=0){let o=null,l=null,h=null;const y=To(e,(N,D,R,W)=>{if(!(W!==n.line||N.getCurrentPosition()+r<n.character+1))return o=R,l=Object.assign({},D),h=N.current(),"BREAK"});return{start:y.start,end:y.end,string:h||y.string,state:l||y.state,style:o||y.style}}function Jh(e,n,r,o,l){const h=o||Yh(e,n,1);if(!h)return null;const y=h.state.kind==="Invalid"?h.state.prevState:h.state;if(!y)return null;const N=Kh(r,h.state),D=l?.mode||qg(e,l?.uri);return{token:h,state:y,typeInfo:N,mode:D}}function Fl(e,n,r){return r===ss.name&&e.getQueryType()===n?ss:r===os.name&&e.getQueryType()===n?os:r===ls.name&&ai(n)?ls:"getFields"in n?n.getFields()[r]:null}function Xh(e,n){const r=[];let o=e;for(;o?.kind;)r.push(o),o=o.prevState;for(let l=r.length-1;l>=0;l--)n(r[l])}function Qh(e){let n;return Xh(e,r=>{switch(r.kind){case"Query":case"ShortQuery":case"Mutation":case"Subscription":case"FragmentDefinition":n=r;break}}),n}function Kh(e,n){let r,o,l,h,y,N,D,R,W,z,ne;return Xh(n,te=>{var be;switch(te.kind){case $e.QUERY:case"ShortQuery":z=e.getQueryType();break;case $e.MUTATION:z=e.getMutationType();break;case $e.SUBSCRIPTION:z=e.getSubscriptionType();break;case $e.INLINE_FRAGMENT:case $e.FRAGMENT_DEFINITION:te.type&&(z=e.getType(te.type));break;case $e.FIELD:case $e.ALIASED_FIELD:{!z||!te.name?y=null:(y=W?Fl(e,W,te.name):null,z=y?y.type:null);break}case $e.SELECTION_SET:W=_n(z);break;case $e.DIRECTIVE:l=te.name?e.getDirective(te.name):null;break;case $e.INTERFACE_DEF:te.name&&(D=null,ne=new ns({name:te.name,interfaces:[],fields:{}}));break;case $e.OBJECT_TYPE_DEF:te.name&&(ne=null,D=new Li({name:te.name,interfaces:[],fields:{}}));break;case $e.ARGUMENTS:{if(te.prevState)switch(te.prevState.kind){case $e.FIELD:o=y&&y.args;break;case $e.DIRECTIVE:o=l&&l.args;break;case $e.ALIASED_FIELD:{const Ge=(be=te.prevState)===null||be===void 0?void 0:be.name;if(!Ge){o=null;break}const We=W?Fl(e,W,Ge):null;if(!We){o=null;break}o=We.args;break}default:o=null;break}else o=null;break}case $e.ARGUMENT:if(o){for(let Ge=0;Ge<o.length;Ge++)if(o[Ge].name===te.name){r=o[Ge];break}}N=r?.type;break;case $e.VARIABLE_DEFINITION:case $e.VARIABLE:z=N;break;case $e.ENUM_VALUE:const Ne=_n(N);h=Ne instanceof us?Ne.getValues().find(Ge=>Ge.value===te.name):null;break;case $e.LIST_VALUE:const Se=Gl(N);N=Se instanceof ii?Se.ofType:null;break;case $e.OBJECT_VALUE:const xe=_n(N);R=xe instanceof ch?xe.getFields():null;break;case $e.OBJECT_FIELD:const Qe=te.name&&R?R[te.name]:null;N=Qe?.type,y=Qe,z=y?y.type:null;break;case $e.NAMED_TYPE:te.name&&(z=e.getType(te.name));break}}),{argDef:r,argDefs:o,directiveDef:l,enumValue:h,fieldDef:y,inputType:N,objectFieldDefs:R,parentType:W,type:z,interfaceDef:ne,objectTypeDef:D}}const zg={ALIASED_FIELD:"AliasedField",ARGUMENTS:"Arguments",SHORT_QUERY:"ShortQuery",QUERY:"Query",MUTATION:"Mutation",SUBSCRIPTION:"Subscription",TYPE_CONDITION:"TypeCondition",INVALID:"Invalid",COMMENT:"Comment",SCHEMA_DEF:"SchemaDef",SCALAR_DEF:"ScalarDef",OBJECT_TYPE_DEF:"ObjectTypeDef",OBJECT_VALUE:"ObjectValue",LIST_VALUE:"ListValue",INTERFACE_DEF:"InterfaceDef",UNION_DEF:"UnionDef",ENUM_DEF:"EnumDef",ENUM_VALUE:"EnumValue",FIELD_DEF:"FieldDef",INPUT_DEF:"InputDef",INPUT_VALUE_DEF:"InputValueDef",ARGUMENTS_DEF:"ArgumentsDef",EXTEND_DEF:"ExtendDef",EXTENSION_DEFINITION:"ExtensionDefinition",DIRECTIVE_DEF:"DirectiveDef",IMPLEMENTS:"Implements",VARIABLE_DEFINITIONS:"VariableDefinitions",TYPE:"Type",VARIABLE:"Variable"},$e=Object.assign(Object.assign({},Z),zg),Gg={Created:1,Changed:2,Deleted:3};var Wt;(function(e){e.Text=1,e.Method=2,e.Function=3,e.Constructor=4,e.Field=5,e.Variable=6,e.Class=7,e.Interface=8,e.Module=9,e.Property=10,e.Unit=11,e.Value=12,e.Enum=13,e.Keyword=14,e.Snippet=15,e.Color=16,e.File=17,e.Reference=18,e.Folder=19,e.EnumMember=20,e.Constant=21,e.Struct=22,e.Event=23,e.Operator=24,e.TypeParameter=25})(Wt||(Wt={}));const fo={command:"editor.action.triggerSuggest",title:"Suggestions"},Yg=e=>{const n=[];if(e)try{Ci(Ar(e),{FragmentDefinition(r){n.push(r)}})}catch{return[]}return n};function Jg(e,n,r,o,l,h){var y;const N=Object.assign(Object.assign({},h),{schema:e}),D=Jh(n,r,e,o,h);if(!D)return[];const{state:R,typeInfo:W,mode:z,token:ne}=D,{kind:te,step:be,prevState:Ne}=R;if(te===$e.DOCUMENT)return z===Mi.TYPE_SYSTEM?Xg(ne):z===Mi.EXECUTABLE?Qg(ne):Kg(ne);if(te===$e.EXTEND_DEF)return Zg(ne);if(((y=Ne?.prevState)===null||y===void 0?void 0:y.kind)===$e.EXTENSION_DEFINITION&&R.name)return wn(ne,[]);if(Ne?.kind===Z.SCALAR_TYPE_EXTENSION)return wn(ne,Object.values(e.getTypeMap()).filter(bi).map(xe=>({label:xe.name,kind:Wt.Function})));if(Ne?.kind===Z.OBJECT_TYPE_EXTENSION)return wn(ne,Object.values(e.getTypeMap()).filter(xe=>kn(xe)&&!xe.name.startsWith("__")).map(xe=>({label:xe.name,kind:Wt.Function})));if(Ne?.kind===Z.INTERFACE_TYPE_EXTENSION)return wn(ne,Object.values(e.getTypeMap()).filter(Nn).map(xe=>({label:xe.name,kind:Wt.Function})));if(Ne?.kind===Z.UNION_TYPE_EXTENSION)return wn(ne,Object.values(e.getTypeMap()).filter(hi).map(xe=>({label:xe.name,kind:Wt.Function})));if(Ne?.kind===Z.ENUM_TYPE_EXTENSION)return wn(ne,Object.values(e.getTypeMap()).filter(xe=>ri(xe)&&!xe.name.startsWith("__")).map(xe=>({label:xe.name,kind:Wt.Function})));if(Ne?.kind===Z.INPUT_OBJECT_TYPE_EXTENSION)return wn(ne,Object.values(e.getTypeMap()).filter(Fn).map(xe=>({label:xe.name,kind:Wt.Function})));if(te===$e.IMPLEMENTS||te===$e.NAMED_TYPE&&Ne?.kind===$e.IMPLEMENTS)return n0(ne,R,e,n,W);if(te===$e.SELECTION_SET||te===$e.FIELD||te===$e.ALIASED_FIELD)return e0(ne,W,N);if(te===$e.ARGUMENTS||te===$e.ARGUMENT&&be===0){const{argDefs:xe}=W;if(xe)return wn(ne,xe.map(Qe=>{var Ge;return{label:Qe.name,insertText:Fc(Qe.name+": ",Qe.type),insertTextMode:Ji.adjustIndentation,insertTextFormat:br.Snippet,command:fo,labelDetails:{detail:" "+String(Qe.type)},documentation:(Ge=Qe.description)!==null&&Ge!==void 0?Ge:void 0,kind:Wt.Variable,type:Qe.type}}))}if((te===$e.OBJECT_VALUE||te===$e.OBJECT_FIELD&&be===0)&&W.objectFieldDefs){const xe=Zi(W.objectFieldDefs),Qe=te===$e.OBJECT_VALUE?Wt.Value:Wt.Field;return wn(ne,xe.map(Ge=>{var We;return{label:Ge.name,detail:String(Ge.type),documentation:(We=Ge?.description)!==null&&We!==void 0?We:void 0,kind:Qe,type:Ge.type,insertText:Fc(Ge.name+": ",Ge.type),insertTextMode:Ji.adjustIndentation,insertTextFormat:br.Snippet,command:fo}}))}if(te===$e.ENUM_VALUE||te===$e.LIST_VALUE&&be===1||te===$e.OBJECT_FIELD&&be===2||te===$e.ARGUMENT&&be===2)return t0(ne,W,n,e);if(te===$e.VARIABLE&&be===1){const xe=_n(W.inputType),Qe=ta(n,e,ne);return wn(ne,Qe.filter(Ge=>Ge.detail===xe?.name))}if(te===$e.TYPE_CONDITION&&be===1||te===$e.NAMED_TYPE&&Ne!=null&&Ne.kind===$e.TYPE_CONDITION)return i0(ne,W,e);if(te===$e.FRAGMENT_SPREAD&&be===1)return r0(ne,W,e,n,Array.isArray(l)?l:Yg(l));const Se=nf(R);return Se.kind===$e.FIELD_DEF?wn(ne,Object.values(e.getTypeMap()).filter(xe=>gr(xe)&&!xe.name.startsWith("__")).map(xe=>({label:xe.name,kind:Wt.Function,insertText:h?.fillLeafsOnComplete?xe.name+`
`:xe.name,insertTextMode:Ji.adjustIndentation}))):Se.kind===$e.INPUT_VALUE_DEF&&be===2?wn(ne,Object.values(e.getTypeMap()).filter(xe=>ui(xe)&&!xe.name.startsWith("__")).map(xe=>({label:xe.name,kind:Wt.Function,insertText:h?.fillLeafsOnComplete?xe.name+`
$1`:xe.name,insertTextMode:Ji.adjustIndentation,insertTextFormat:br.Snippet}))):te===$e.VARIABLE_DEFINITION&&be===2||te===$e.LIST_TYPE&&be===1||te===$e.NAMED_TYPE&&Ne&&(Ne.kind===$e.VARIABLE_DEFINITION||Ne.kind===$e.LIST_TYPE||Ne.kind===$e.NON_NULL_TYPE)?o0(ne,e):te===$e.DIRECTIVE?l0(ne,R,e):te===$e.DIRECTIVE_DEF?a0(ne,R,e):[]}const ea=[{label:"type",kind:Wt.Function},{label:"interface",kind:Wt.Function},{label:"union",kind:Wt.Function},{label:"input",kind:Wt.Function},{label:"scalar",kind:Wt.Function},{label:"schema",kind:Wt.Function}],Zh=[{label:"query",kind:Wt.Function},{label:"mutation",kind:Wt.Function},{label:"subscription",kind:Wt.Function},{label:"fragment",kind:Wt.Function},{label:"{",kind:Wt.Constructor}];function Xg(e){return wn(e,[{label:"extend",kind:Wt.Function},...ea])}function Qg(e){return wn(e,Zh)}function Kg(e){return wn(e,[{label:"extend",kind:Wt.Function},...Zh,...ea])}function Zg(e){return wn(e,ea)}function e0(e,n,r){var o;if(n.parentType){const{parentType:l}=n;let h=[];return"getFields"in l&&(h=Zi(l.getFields())),ai(l)&&h.push(ls),l===((o=r?.schema)===null||o===void 0?void 0:o.getQueryType())&&h.push(ss,os),wn(e,h.map((y,N)=>{var D;const R={sortText:String(N)+y.name,label:y.name,detail:String(y.type),documentation:(D=y.description)!==null&&D!==void 0?D:void 0,deprecated:!!y.deprecationReason,isDeprecated:!!y.deprecationReason,deprecationReason:y.deprecationReason,kind:Wt.Field,labelDetails:{detail:" "+y.type.toString()},type:y.type};return r?.fillLeafsOnComplete&&(R.insertText=Fg(y),R.insertText||(R.insertText=so(y.name,y.type,y.name+(e.state.needsAdvance?"":`
`))),R.insertText&&(R.insertTextFormat=br.Snippet,R.insertTextMode=Ji.adjustIndentation,R.command=fo)),R}))}return[]}function t0(e,n,r,o){const l=_n(n.inputType),h=ta(r,o,e).filter(y=>y.detail===l?.name);if(l instanceof us){const y=l.getValues();return wn(e,y.map(N=>{var D;return{label:N.name,detail:String(l),documentation:(D=N.description)!==null&&D!==void 0?D:void 0,deprecated:!!N.deprecationReason,isDeprecated:!!N.deprecationReason,deprecationReason:N.deprecationReason,kind:Wt.EnumMember,type:l}}).concat(h))}return l===qn?wn(e,h.concat([{label:"true",detail:String(qn),documentation:"Not false.",kind:Wt.Variable,type:qn},{label:"false",detail:String(qn),documentation:"Not true.",kind:Wt.Variable,type:qn}])):h}function n0(e,n,r,o,l){if(n.needsSeparator)return[];const h=r.getTypeMap(),y=Zi(h).filter(Nn),N=y.map(({name:te})=>te),D=new Set;To(o,(te,be)=>{var Ne,Se,xe,Qe,Ge;if(be.name&&(be.kind===$e.INTERFACE_DEF&&!N.includes(be.name)&&D.add(be.name),be.kind===$e.NAMED_TYPE&&((Ne=be.prevState)===null||Ne===void 0?void 0:Ne.kind)===$e.IMPLEMENTS)){if(l.interfaceDef){if((Se=l.interfaceDef)===null||Se===void 0?void 0:Se.getInterfaces().find(({name:Et})=>Et===be.name))return;const ot=r.getType(be.name),ft=(xe=l.interfaceDef)===null||xe===void 0?void 0:xe.toConfig();l.interfaceDef=new ns(Object.assign(Object.assign({},ft),{interfaces:[...ft.interfaces,ot||new ns({name:be.name,fields:{}})]}))}else if(l.objectTypeDef){if((Qe=l.objectTypeDef)===null||Qe===void 0?void 0:Qe.getInterfaces().find(({name:Et})=>Et===be.name))return;const ot=r.getType(be.name),ft=(Ge=l.objectTypeDef)===null||Ge===void 0?void 0:Ge.toConfig();l.objectTypeDef=new Li(Object.assign(Object.assign({},ft),{interfaces:[...ft.interfaces,ot||new ns({name:be.name,fields:{}})]}))}}});const R=l.interfaceDef||l.objectTypeDef,z=(R?.getInterfaces()||[]).map(({name:te})=>te),ne=y.concat([...D].map(te=>({name:te}))).filter(({name:te})=>te!==R?.name&&!z.includes(te));return wn(e,ne.map(te=>{const be={label:te.name,kind:Wt.Interface,type:te};return te?.description&&(be.documentation=te.description),be}))}function i0(e,n,r,o){let l;if(n.parentType)if(Ni(n.parentType)){const h=em(n.parentType),y=r.getPossibleTypes(h),N=Object.create(null);for(const D of y)for(const R of D.getInterfaces())N[R.name]=R;l=y.concat(Zi(N))}else l=[n.parentType];else{const h=r.getTypeMap();l=Zi(h).filter(y=>ai(y)&&!y.name.startsWith("__"))}return wn(e,l.map(h=>{const y=_n(h);return{label:String(h),documentation:y?.description||"",kind:Wt.Field}}))}function r0(e,n,r,o,l){if(!o)return[];const h=r.getTypeMap(),y=Qh(e.state),N=ef(o);l&&l.length>0&&N.push(...l);const D=N.filter(R=>h[R.typeCondition.name.value]&&!(y&&y.kind===$e.FRAGMENT_DEFINITION&&y.name===R.name.value)&&ai(n.parentType)&&ai(h[R.typeCondition.name.value])&&vl(r,n.parentType,h[R.typeCondition.name.value]));return wn(e,D.map(R=>({label:R.name.value,detail:String(h[R.typeCondition.name.value]),documentation:`fragment ${R.name.value} on ${R.typeCondition.name.value}`,labelDetails:{detail:`fragment ${R.name.value} on ${R.typeCondition.name.value}`},kind:Wt.Field,type:h[R.typeCondition.name.value]})))}const s0=(e,n)=>{var r,o,l,h,y,N,D,R,W,z;if(((r=e.prevState)===null||r===void 0?void 0:r.kind)===n)return e.prevState;if(((l=(o=e.prevState)===null||o===void 0?void 0:o.prevState)===null||l===void 0?void 0:l.kind)===n)return e.prevState.prevState;if(((N=(y=(h=e.prevState)===null||h===void 0?void 0:h.prevState)===null||y===void 0?void 0:y.prevState)===null||N===void 0?void 0:N.kind)===n)return e.prevState.prevState.prevState;if(((z=(W=(R=(D=e.prevState)===null||D===void 0?void 0:D.prevState)===null||R===void 0?void 0:R.prevState)===null||W===void 0?void 0:W.prevState)===null||z===void 0?void 0:z.kind)===n)return e.prevState.prevState.prevState.prevState};function ta(e,n,r){let o=null,l;const h=Object.create({});return To(e,(y,N)=>{var D;if(N?.kind===$e.VARIABLE&&N.name&&(o=N.name),N?.kind===$e.NAMED_TYPE&&o){const R=s0(N,$e.TYPE);R?.type&&(l=n.getType(R?.type))}if(o&&l&&!h[o]){const R=r.string==="$"||((D=r?.state)===null||D===void 0?void 0:D.kind)==="Variable"?o:"$"+o;h[o]={detail:l.toString(),insertText:R,label:"$"+o,rawInsert:R,type:l,kind:Wt.Variable},o=null,l=null}}),Zi(h)}function ef(e){const n=[];return To(e,(r,o)=>{o.kind===$e.FRAGMENT_DEFINITION&&o.name&&o.type&&n.push({kind:$e.FRAGMENT_DEFINITION,name:{kind:Z.NAME,value:o.name},selectionSet:{kind:$e.SELECTION_SET,selections:[]},typeCondition:{kind:$e.NAMED_TYPE,name:{kind:Z.NAME,value:o.type}}})}),n}function o0(e,n,r){const o=n.getTypeMap(),l=Zi(o).filter(ui);return wn(e,l.map(h=>({label:h.name,documentation:h?.description||"",kind:Wt.Variable})))}function l0(e,n,r,o){var l;if(!((l=n.prevState)===null||l===void 0)&&l.kind){const h=r.getDirectives().filter(y=>tf(n.prevState,y));return wn(e,h.map(y=>({label:y.name,documentation:y?.description||"",kind:Wt.Function})))}return[]}function a0(e,n,r,o){const l=r.getDirectives().find(h=>h.name===n.name);return wn(e,l?.args.map(h=>({label:h.name,documentation:h.description||"",kind:Wt.Field}))||[])}function tf(e,n){if(!e?.kind)return!1;const{kind:r,prevState:o}=e,{locations:l}=n;switch(r){case $e.QUERY:return l.includes(et.QUERY);case $e.MUTATION:return l.includes(et.MUTATION);case $e.SUBSCRIPTION:return l.includes(et.SUBSCRIPTION);case $e.FIELD:case $e.ALIASED_FIELD:return l.includes(et.FIELD);case $e.FRAGMENT_DEFINITION:return l.includes(et.FRAGMENT_DEFINITION);case $e.FRAGMENT_SPREAD:return l.includes(et.FRAGMENT_SPREAD);case $e.INLINE_FRAGMENT:return l.includes(et.INLINE_FRAGMENT);case $e.SCHEMA_DEF:return l.includes(et.SCHEMA);case $e.SCALAR_DEF:return l.includes(et.SCALAR);case $e.OBJECT_TYPE_DEF:return l.includes(et.OBJECT);case $e.FIELD_DEF:return l.includes(et.FIELD_DEFINITION);case $e.INTERFACE_DEF:return l.includes(et.INTERFACE);case $e.UNION_DEF:return l.includes(et.UNION);case $e.ENUM_DEF:return l.includes(et.ENUM);case $e.ENUM_VALUE:return l.includes(et.ENUM_VALUE);case $e.INPUT_DEF:return l.includes(et.INPUT_OBJECT);case $e.INPUT_VALUE_DEF:switch(o?.kind){case $e.ARGUMENTS_DEF:return l.includes(et.ARGUMENT_DEFINITION);case $e.INPUT_DEF:return l.includes(et.INPUT_FIELD_DEFINITION)}}return!1}function nf(e){return e.prevState&&e.kind&&[$e.NAMED_TYPE,$e.LIST_TYPE,$e.TYPE,$e.NON_NULL_TYPE].includes(e.kind)?nf(e.prevState):e}var Xr={exports:{}},Bu;function c0(){if(Bu)return Xr.exports;Bu=1;function e(n,r){if(n!=null)return n;var o=new Error(r!==void 0?r:"Got unexpected "+n);throw o.framesToPop=1,o}return Xr.exports=e,Xr.exports.default=e,Object.defineProperty(Xr.exports,"__esModule",{value:!0}),Xr.exports}var u0=c0();const Vu=sp(u0),h0=(e,n)=>{if(!n)return[];let r;try{r=Ar(e)}catch{return[]}return rf(r,n)},rf=(e,n)=>{if(!n)return[];const r=new Map,o=new Set;Ci(e,{FragmentDefinition(y){r.set(y.name.value,!0)},FragmentSpread(y){o.has(y.name.value)||o.add(y.name.value)}});const l=new Set;for(const y of o)!r.has(y)&&n.has(y)&&l.add(Vu(n.get(y)));const h=[];for(const y of l)Ci(y,{FragmentSpread(N){!o.has(N.name.value)&&n.get(N.name.value)&&(l.add(Vu(n.get(N.name.value))),o.add(N.name.value))}}),r.has(y.name.value)||h.push(y);return h};function Qn(e,n){e.push(n)}function Pl(e,n){fn(n)?(Pl(e,n.ofType),Qn(e,"!")):Un(n)?(Qn(e,"["),Pl(e,n.ofType),Qn(e,"]")):Qn(e,n.name)}function Qs(e,n,r){const o=[],l="type"in e?e.type:e;return"type"in e&&e.description&&(Qn(o,e.description),Qn(o,`

`)),Qn(o,f0(l,n)),r?(Qn(o,`
`),Qn(o,r)):!bi(l)&&"description"in l&&l.description?(Qn(o,`
`),Qn(o,l.description)):"ofType"in l&&!bi(l.ofType)&&"description"in l.ofType&&l.ofType.description&&(Qn(o,`
`),Qn(o,l.ofType.description)),o.join("")}function f0(e,n){const r=[];return n&&Qn(r,"```graphql\n"),Pl(r,e),n&&Qn(r,"\n```"),r.join("")}const d0={Int:{type:"integer"},String:{type:"string"},Float:{type:"number"},ID:{type:"string"},Boolean:{type:"boolean"},DateTime:{type:"string"}};class p0{constructor(){this.set=new Set}mark(n){return this.set.has(n)?!1:(this.set.add(n),!0)}}function Bl(e,n){var r,o;let l=Object.create(null);const h=Object.create(null),N="type"in e?e.type:e,D=fn(N)?N.ofType:N,R=fn(N);if(bi(D))!((r=n?.scalarSchemas)===null||r===void 0)&&r[D.name]?l=JSON.parse(JSON.stringify(n.scalarSchemas[D.name])):l.type=["string","number","boolean","integer"],R||(Array.isArray(l.type)?l.type.push("null"):l.type?l.type=[l.type,"null"]:l.enum?l.enum.push(null):l.oneOf?l.oneOf.push({type:"null"}):l={oneOf:[l,{type:"null"}]});else if(ri(D))l.enum=D.getValues().map(z=>z.name),R||l.enum.push(null);else if(Un(D)){R?l.type="array":l.type=["array","null"];const{definition:z,definitions:ne}=Bl(D.ofType,n);if(l.items=z,ne)for(const te of Object.keys(ne))h[te]=ne[te]}else if(Fn(D)&&(R?l.$ref=`#/definitions/${D.name}`:l.oneOf=[{$ref:`#/definitions/${D.name}`},{type:"null"}],!((o=n?.definitionMarker)===null||o===void 0)&&o.mark(D.name))){const z=D.getFields(),ne={type:"object",properties:{},required:[]};ne.description=Qs(D),n?.useMarkdownDescription&&(ne.markdownDescription=Qs(D,!0));for(const te of Object.keys(z)){const be=z[te],{required:Ne,definition:Se,definitions:xe}=Bl(be,n);if(ne.properties[te]=Se,Ne&&ne.required.push(te),xe)for(const[Qe,Ge]of Object.entries(xe))h[Qe]=Ge}h[D.name]=ne}"defaultValue"in e&&e.defaultValue!==void 0&&(l.default=e.defaultValue);const{description:W}=l;return l.description=Qs(e,!1,W),n?.useMarkdownDescription&&(l.markdownDescription=Qs(e,!0,W)),{required:R,definition:l,definitions:h}}function m0(e,n){var r;const o={$schema:"http://json-schema.org/draft-04/schema",type:"object",properties:{},required:[],additionalProperties:!1},l=Object.assign(Object.assign({},n),{definitionMarker:new p0,scalarSchemas:Object.assign(Object.assign({},d0),n?.scalarSchemas)});if(e)for(const[h,y]of Object.entries(e)){const{definition:N,required:D,definitions:R}=Bl(y,l);o.properties[h]=N,D&&((r=o.required)===null||r===void 0||r.push(h)),R&&(o.definitions=Object.assign(Object.assign({},o?.definitions),R))}return o}function g0(e,n,r){const o=sf(e,r);let l;return Ci(n,{enter(h){if(h.kind!=="Name"&&h.loc&&h.loc.start<=o&&o<=h.loc.end)l=h;else return!1},leave(h){if(h.loc&&h.loc.start<=o&&o<=h.loc.end)return!1}}),l}function sf(e,n){const r=e.split(`
`).slice(0,n.line);return n.character+r.map(o=>o.length+1).reduce((o,l)=>o+l,0)}class Eo{constructor(n,r){this.containsPosition=o=>this.start.line===o.line?this.start.character<=o.character:this.end.line===o.line?this.end.character>=o.character:this.start.line<=o.line&&this.end.line>=o.line,this.start=n,this.end=r}setStart(n,r){this.start=new $i(n,r)}setEnd(n,r){this.end=new $i(n,r)}}class $i{constructor(n,r){this.lessThanOrEqualTo=o=>this.line<o.line||this.line===o.line&&this.character<=o.character,this.line=n,this.character=r}setLine(n){this.line=n}setCharacter(n){this.character=n}}function xr(e,n){const r=`
`,o=e.slice(0,n),l=o.split(r).length-1,h=o.lastIndexOf(r);return new $i(l,n-h-1)}function y0(e,n){const r=xr(e,n.start),o=xr(e,n.end);return new Eo(r,o)}const v0=[Um,Tg,Eg,gg,yg,mg,Ih,Ah,Vh,ig,Bh,jh,Uh,Ch,Fh];function of(e,n,r,o,l){const h=$h.filter(N=>!(N===Oh||N===Nh||o&&N===Dh));return r&&Array.prototype.push.apply(h,r),l&&Array.prototype.push.apply(h,v0),Hh(e,n,h).filter(N=>{if(N.message.includes("Unknown directive")&&N.nodes){const D=N.nodes[0];if(D&&D.kind===Z.DIRECTIVE){const R=D.name.value;if(R==="arguments"||R==="argumentDefinitions")return!1}}return!0})}function lf(e,n){const r=Object.create(null);for(const o of n.definitions)if(o.kind==="OperationDefinition"){const{variableDefinitions:l}=o;if(l)for(const{variable:h,type:y}of l){const N=ci(e,y);N?r[h.name.value]=N:y.kind===Z.NAMED_TYPE&&y.name.value==="Float"&&(r[h.name.value]=hh)}}return r}function af(e,n){const r=n?lf(n,e):void 0,o=[];return Ci(e,{OperationDefinition(l){o.push(l)}}),{variableToType:r,operations:o}}function cf(e,n){if(n)try{const r=Ar(n);return Object.assign(Object.assign({},af(r,e)),{documentAST:r})}catch{return}}const b0=cf;var wo=function(e,n,r,o){function l(h){return h instanceof r?h:new r(function(y){y(h)})}return new(r||(r=Promise))(function(h,y){function N(W){try{R(o.next(W))}catch(z){y(z)}}function D(W){try{R(o.throw(W))}catch(z){y(z)}}function R(W){W.done?h(W.value):l(W.value).then(N,D)}R((o=o.apply(e,n||[])).next())})};const ko="GraphQL";function ds(e,n){if(!e)throw new Error(n)}function ir(e,n){const r=n.loc;return ds(r,"Expected ASTNode to have a location."),y0(e,r)}function xo(e,n){const r=n.loc;return ds(r,"Expected ASTNode to have a location."),xr(e,r.start)}function S0(e,n,r){return wo(this,void 0,void 0,function*(){const o=n.name.value,l=r.filter(({definition:y})=>y.name&&y.name.value===o);if(l.length===0)throw new Error(`Definition not found for GraphQL type ${o}`);const h=l.map(({filePath:y,content:N,definition:D})=>x0(y||"",N,D));return{definitions:h,queryRange:h.map(y=>ir(e,n)),printedName:o}})}function T0(e,n,r){var o;return wo(this,void 0,void 0,function*(){const l=r.filter(({definition:y})=>y.name&&y.name.value===n);if(l.length===0)throw new Error(`Definition not found for GraphQL type ${n}`);const h=[];for(const{filePath:y,content:N,definition:D}of l){const R=(o=D.fields)===null||o===void 0?void 0:o.find(W=>W.name.value===e);R!=null&&h.push(N0(y||"",N,R))}return{definitions:h,queryRange:[],printedName:[n,e].join(".")}})}function E0(e,n,r,o){var l,h,y;return wo(this,void 0,void 0,function*(){const N=[];for(const{filePath:D,content:R,definition:W}of o){const z=(y=(h=(l=W.fields)===null||l===void 0?void 0:l.find(ne=>ne.name.value===n))===null||h===void 0?void 0:h.arguments)===null||y===void 0?void 0:y.find(ne=>ne.name.value===e);z!=null&&N.push(C0(D||"",R,z))}return{definitions:N,queryRange:[],printedName:`${[r,n].join(".")}(${e})`}})}function w0(e,n,r){return wo(this,void 0,void 0,function*(){const o=n.name.value,l=r.filter(({definition:y})=>y.name.value===o);if(l.length===0)throw new Error(`Definition not found for GraphQL fragment ${o}`);const h=l.map(({filePath:y,content:N,definition:D})=>uf(y||"",N,D));return{definitions:h,queryRange:h.map(y=>ir(e,n)),printedName:o}})}function k0(e,n,r){var o;return{definitions:[uf(e,n,r)],queryRange:r.name?[ir(n,r.name)]:[],printedName:(o=r.name)===null||o===void 0?void 0:o.value}}function uf(e,n,r){const{name:o}=r;if(!o)throw new Error("Expected ASTNode to have a Name.");return{path:e,position:xo(n,r),range:ir(n,r),name:o.value||"",language:ko,projectRoot:e}}function x0(e,n,r){const{name:o}=r;return ds(o,"Expected ASTNode to have a Name."),{path:e,position:xo(n,r),range:ir(n,r),name:o.value||"",language:ko,projectRoot:e}}function N0(e,n,r){const{name:o}=r;return ds(o,"Expected ASTNode to have a Name."),{path:e,position:xo(n,r),range:ir(n,r),name:o.value||"",language:ko,projectRoot:e}}function C0(e,n,r){const{name:o}=r;return ds(o,"Expected ASTNode to have a Name."),{path:e,position:xo(n,r),range:ir(n,r),name:o.value||"",language:ko,projectRoot:e}}const ts={Error:"Error",Warning:"Warning",Information:"Information",Hint:"Hint"},po={[ts.Error]:1,[ts.Warning]:2,[ts.Information]:3,[ts.Hint]:4},mo=(e,n)=>{if(!e)throw new Error(n)};function A0(e,n=null,r,o,l){var h,y;let N=null,D="";l&&(D=typeof l=="string"?l:l.reduce((W,z)=>W+jn(z)+`

`,""));const R=D?`${e}

${D}`:e;try{N=Ar(R)}catch(W){if(W instanceof Ve){const z=ff((y=(h=W.locations)===null||h===void 0?void 0:h[0])!==null&&y!==void 0?y:{line:0},R);return[{severity:po.Error,message:W.message,source:"GraphQL: Syntax",range:z}]}throw W}return hf(N,n,r,o)}function hf(e,n=null,r,o){if(!n)return[];const l=of(n,e,r,o).flatMap(y=>ju(y,po.Error,"Validation")),h=Hh(n,e,[Og]).flatMap(y=>ju(y,po.Warning,"Deprecation"));return l.concat(h)}function ju(e,n,r){if(!e.nodes)return[];const o=[];for(const[l,h]of e.nodes.entries()){const y=h.kind!=="Variable"&&"name"in h&&h.name!==void 0?h.name:"variable"in h&&h.variable!==void 0?h.variable:h;if(y){mo(e.locations,"GraphQL validation error requires locations.");const N=e.locations[l],D=D0(y),R=N.column+(D.end-D.start);o.push({source:`GraphQL: ${r}`,message:e.message,severity:n,range:new Eo(new $i(N.line-1,N.column-1),new $i(N.line-1,R))})}}return o}function ff(e,n){const r=Kl(),o=r.startState(),l=n.split(`
`);mo(l.length>=e.line,"Query text must have more lines than where the error happened");let h=null;for(let R=0;R<e.line;R++)for(h=new ho(l[R]);!h.eol()&&r.token(h,o)!=="invalidchar";);mo(h,"Expected Parser stream to be available.");const y=e.line-1,N=h.getStartOfToken(),D=h.getCurrentPosition();return new Eo(new $i(y,N),new $i(y,D))}function D0(e){const r=e.loc;return mo(r,"Expected ASTNode to have a location."),r}function I0(e){let n;try{n=Ar(e)}catch{return null}const r=O0(e);return{outlineTrees:Ci(n,{leave(l){return r!==void 0&&l.kind in r?r[l.kind](l):null}})}}function O0(e){const n=r=>({representativeName:r.name,startPosition:xr(e,r.loc.start),endPosition:xr(e,r.loc.end),kind:r.kind,children:r.selectionSet||r.fields||r.values||r.arguments||[]});return{Field(r){const o=r.alias?[En("plain",r.alias),En("plain",": ")]:[];return o.push(En("plain",r.name)),Object.assign({tokenizedText:o},n(r))},OperationDefinition:r=>Object.assign({tokenizedText:[En("keyword",r.operation),En("whitespace"," "),En("class-name",r.name)]},n(r)),Document:r=>r.definitions,SelectionSet:r=>M0(r.selections,o=>o.kind===Z.INLINE_FRAGMENT?o.selectionSet:o),Name:r=>r.value,FragmentDefinition:r=>Object.assign({tokenizedText:[En("keyword","fragment"),En("whitespace"," "),En("class-name",r.name)]},n(r)),InterfaceTypeDefinition:r=>Object.assign({tokenizedText:[En("keyword","interface"),En("whitespace"," "),En("class-name",r.name)]},n(r)),EnumTypeDefinition:r=>Object.assign({tokenizedText:[En("keyword","enum"),En("whitespace"," "),En("class-name",r.name)]},n(r)),EnumValueDefinition:r=>Object.assign({tokenizedText:[En("plain",r.name)]},n(r)),ObjectTypeDefinition:r=>Object.assign({tokenizedText:[En("keyword","type"),En("whitespace"," "),En("class-name",r.name)]},n(r)),InputObjectTypeDefinition:r=>Object.assign({tokenizedText:[En("keyword","input"),En("whitespace"," "),En("class-name",r.name)]},n(r)),FragmentSpread:r=>Object.assign({tokenizedText:[En("plain","..."),En("class-name",r.name)]},n(r)),InputValueDefinition(r){return Object.assign({tokenizedText:[En("plain",r.name)]},n(r))},FieldDefinition(r){return Object.assign({tokenizedText:[En("plain",r.name)]},n(r))},InlineFragment:r=>r.selectionSet}}function En(e,n){return{kind:e,value:n}}function M0(e,n){const r=[];for(let o=0;o<e.length;o++){const l=n(e[o],o);Array.isArray(l)?r.push(...l):r.push(l)}return r}function L0(e,n,r,o,l){const h=Object.assign(Object.assign({},l),{schema:e}),y=Jh(n,r,e,o);if(!y)return"";const{typeInfo:N,token:D}=y,{kind:R,step:W}=D.state;if(R==="Field"&&W===0&&N.fieldDef||R==="AliasedField"&&W===2&&N.fieldDef||R==="ObjectField"&&W===0&&N.fieldDef){const z=[];return fr(z,h),_0(z,N,h),dr(z,h),pr(z,h,N.fieldDef),z.join("").trim()}if(R==="Directive"&&W===1&&N.directiveDef){const z=[];return fr(z,h),pf(z,N),dr(z,h),pr(z,h,N.directiveDef),z.join("").trim()}if(R==="Variable"&&N.type){const z=[];return fr(z,h),er(z,N,h,N.type),dr(z,h),pr(z,h,N.type),z.join("").trim()}if(R==="Argument"&&W===0&&N.argDef){const z=[];return fr(z,h),R0(z,N,h),dr(z,h),pr(z,h,N.argDef),z.join("").trim()}if(R==="EnumValue"&&N.enumValue&&"description"in N.enumValue){const z=[];return fr(z,h),F0(z,N,h),dr(z,h),pr(z,h,N.enumValue),z.join("").trim()}if(R==="NamedType"&&N.type&&"description"in N.type){const z=[];return fr(z,h),er(z,N,h,N.type),dr(z,h),pr(z,h,N.type),z.join("").trim()}return""}function fr(e,n){n.useMarkdown&&Vn(e,"```graphql\n")}function dr(e,n){n.useMarkdown&&Vn(e,"\n```")}function _0(e,n,r){df(e,n,r),mf(e,n,r,n.type)}function df(e,n,r){if(!n.fieldDef)return;const o=n.fieldDef.name;o.slice(0,2)!=="__"&&(er(e,n,r,n.parentType),Vn(e,".")),Vn(e,o)}function pf(e,n,r){if(!n.directiveDef)return;const o="@"+n.directiveDef.name;Vn(e,o)}function R0(e,n,r){if(n.directiveDef?pf(e,n):n.fieldDef&&df(e,n,r),!n.argDef)return;const{name:o}=n.argDef;Vn(e,"("),Vn(e,o),mf(e,n,r,n.inputType),Vn(e,")")}function mf(e,n,r,o){Vn(e,": "),er(e,n,r,o)}function F0(e,n,r){if(!n.enumValue)return;const{name:o}=n.enumValue;er(e,n,r,n.inputType),Vn(e,"."),Vn(e,o)}function er(e,n,r,o){o&&(o instanceof Jt?(er(e,n,r,o.ofType),Vn(e,"!")):o instanceof ii?(Vn(e,"["),er(e,n,r,o.ofType),Vn(e,"]")):Vn(e,o.name))}function pr(e,n,r){if(!r)return;const o=typeof r.description=="string"?r.description:null;o&&(Vn(e,`

`),Vn(e,o)),P0(e,n,r)}function P0(e,n,r){if(!r)return;const o=r.deprecationReason;o&&(Vn(e,`

`),Vn(e,"Deprecated: "),Vn(e,o))}function Vn(e,n){e.push(n)}const B0=Object.freeze(Object.defineProperty({__proto__:null,CharacterStream:ho,get CompletionItemKind(){return Wt},DIAGNOSTIC_SEVERITY:po,FileChangeTypeKind:Gg,get GraphQLDocumentMode(){return Mi},LexRules:zh,ParseRules:Gh,Position:$i,Range:Eo,RuleKinds:$e,SEVERITY:ts,SuggestionCommand:fo,canUseDirective:tf,collectVariables:lf,getASTNodeAtPosition:g0,getAutocompleteSuggestions:Jg,getDefinitionQueryResultForArgument:E0,getDefinitionQueryResultForDefinitionNode:k0,getDefinitionQueryResultForField:T0,getDefinitionQueryResultForFragmentSpread:w0,getDefinitionQueryResultForNamedType:S0,getDefinitionState:Qh,getDiagnostics:A0,getFieldDef:Fl,getFragmentDefinitions:ef,getFragmentDependencies:h0,getFragmentDependenciesForAST:rf,getHoverInformation:L0,getOperationASTFacts:af,getOperationFacts:cf,getOutline:I0,getQueryFacts:b0,getRange:ff,getTokenAtPosition:Yh,getTypeInfo:Kh,getVariableCompletions:ta,getVariablesJSONSchema:m0,isIgnored:qh,list:nn,offsetToPosition:xr,onlineParser:Kl,opt:In,p:_t,pointToOffset:sf,t:eo,validateQuery:hf,validateWithCustomRules:of},Symbol.toStringTag,{value:"Module"})),V0=op(B0);var Ks={},Uu;function j0(){if(Uu)return Ks;Uu=1,Object.defineProperty(Ks,"__esModule",{value:!0});function e(n,r){var o,l,h=n.levels,y=n.indentLevel,N=!h||h.length===0?y:h.at(-1)-(!((o=this.electricInput)===null||o===void 0)&&o.test(r)?1:0);return(N||0)*(((l=this.config)===null||l===void 0?void 0:l.indentUnit)||0)}return Ks.default=e,Ks}var $u;function U0(){if($u)return hr;$u=1;var e=hr&&hr.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(hr,"__esModule",{value:!0});var n=V0,r=e(j0()),o=function(l){var h=(0,n.onlineParser)({eatWhitespace:function(y){return y.eatWhile(n.isIgnored)},lexRules:n.LexRules,parseRules:n.ParseRules,editorConfig:{tabSize:l.tabSize}});return{config:l,startState:h.startState,token:h.token,indent:r.default,electricInput:/^\s*[})\]]/,fold:"brace",lineComment:"#",closeBrackets:{pairs:'()[]{}""',explode:"()[]{}"}}};return hr.default=o,hr}var Hu;function $0(){if(Hu)return Jr;Hu=1;var e=Jr&&Jr.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Jr,"__esModule",{value:!0});var n=e(pp()),r=e(U0());return CodeMirror.defineMode("graphql",r.default),Jr}$0();
